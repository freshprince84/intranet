{"version":3,"file":"static/js/908.d7ac2e87.chunk.js","mappings":"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,CACnB,YACA,cACA,gBACA,wBACA,UACA,0BACA,UACA,WACA,UACA,kBACA,mBACA,kBAIIC,GAAgB,CACpB,WACA,QACA,eACA,QACA,QACA,eACA,6BACA,qBACA,gBACA,WACA,UACA,wBACA,WACA,gBACA,WACA,kBACA,QACA,gBACA,eACA,iBACA,wBACA,gBACA,sBAIIC,GAAiB,CAErB,uBACA,gBAGA,iBACA,mBACA,oBACA,mBAGA,cACA,YACA,cACA,cACA,YACA,cAGA,cACA,YACA,cACA,cACA,cACA,YACA,cAGA,sBACA,oBACA,sBAGA,iBACA,gBACA,gBACA,kBAGA,UAGA,qBACA,oBACA,oBAGA,gBACA,cACA,gBAGA,kBACA,yBACA,mBAGA,mBACA,iBACA,eAGA,cACA,YACA,cACA,YACA,sBACA,oBACA,sBACA,uBACA,qBACA,uBAGA,wBACA,sBACA,wBAGA,6BACA,2BACA,6BACA,sCACA,uCACA,oCAIIC,GAAqB,CACzB,SAAY,YACZ,MAAS,cACT,aAAgB,cAChB,MAAS,0BACT,MAAS,0BACT,aAAgB,0BAChB,2BAA8B,0BAC9B,mBAAsB,0BACtB,cAAiB,wBACjB,SAAY,cACZ,QAAW,gBACX,sBAAyB,gBACzB,SAAY,WACZ,cAAiB,UACjB,SAAY,WACZ,gBAAmB,gBACnB,MAAS,kBACT,cAAiB,kBACjB,aAAgB,iBAChB,eAAkB,iBAClB,sBAAyB,iBACzB,cAAiB,iBACjB,mBAAsB,kBAIlBC,GAAsB,CAC1B,qBAAwB,WACxB,cAAiB,WACjB,eAAkB,gBAClB,iBAAoB,gBACpB,kBAAqB,gBACrB,iBAAoB,gBACpB,YAAe,cACf,UAAa,cACb,YAAe,cACf,YAAe,cACf,UAAa,cACb,YAAe,cACf,YAAe,0BACf,UAAa,0BACb,YAAe,0BACf,YAAe,0BACf,YAAe,0BACf,UAAa,0BACb,YAAe,0BACf,oBAAuB,0BACvB,kBAAqB,0BACrB,oBAAuB,0BACvB,eAAkB,cAClB,cAAiB,cACjB,cAAiB,cACjB,gBAAmB,cACnB,QAAW,UACX,mBAAsB,gBACtB,kBAAqB,gB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","sources":["components/shared/CardGrid.tsx","api/tableSettingsApi.ts","hooks/useTableSettings.ts","utils/filterLogic.ts","components/tours/CreateTourBookingModal.tsx","components/TableColumnConfig.tsx","components/CertificateCreationModal.tsx","components/ContractCreationModal.tsx","components/CertificateEditModal.tsx","components/ContractEditModal.tsx","components/SocialSecurityEditor.tsx","components/OffboardingStartModal.tsx","components/OffboardingCompleteModal.tsx","components/LifecycleView.tsx","components/UserManagementTab.tsx","components/RoleManagementTab.tsx","components/branches/RoomDescriptionsSection.tsx","components/BranchManagementTab.tsx","components/tours/CreateTourProviderModal.tsx","components/tours/EditTourProviderModal.tsx","components/tours/TourProvidersTab.tsx","types/tour.ts","components/tours/CreateTourModal.tsx","components/tours/EditTourModal.tsx","components/tours/TourDetailsModal.tsx","components/tours/TourExportDialog.tsx","components/tours/TourImageLightbox.tsx","components/tours/ToursTab.tsx","components/organization/CreateOrganizationModal.tsx","components/organization/JoinOrganizationModal.tsx","components/organization/EditOrganizationModal.tsx","components/organization/MyJoinRequestsList.tsx","components/organization/OrganizationSettings.tsx","components/organization/ProcessJoinRequestModal.tsx","components/organization/JoinRequestsList.tsx","pages/Organisation.tsx"],"sourcesContent":["import React from 'react';\n\nexport interface CardGridProps {\n  children: React.ReactNode;\n  columns?: {\n    mobile?: number;\n    tablet?: number;\n    desktop?: number;\n    largeDesktop?: number;\n  };\n  gap?: 'sm' | 'md' | 'lg';\n  className?: string;\n}\n\nconst CardGrid: React.FC<CardGridProps> = ({\n  children,\n  columns = {\n    mobile: 1,\n    tablet: 1,\n    desktop: 1,\n    largeDesktop: 1\n  },\n  gap = 'md',\n  className = ''\n}) => {\n  const gapClass = {\n    sm: 'gap-0.5',\n    md: 'gap-0.5',\n    lg: 'gap-1'\n  }[gap];\n\n  // Immer 1 Spalte fr bessere bersichtlichkeit - Cards nehmen volle Breite ein\n  return (\n    <div \n      className={`flex flex-col ${gapClass} ${className}`}\n    >\n      {children}\n    </div>\n  );\n};\n\nexport default CardGrid;\n\n","// import axios from 'axios';\nimport axiosInstance from '../config/axios.ts';\nimport { logger } from '../utils/logger.ts';\nimport { API_URL } from '../config/api.ts';\n\nexport interface TableSettings {\n  tableId: string;\n  columnOrder: string[];\n  hiddenColumns: string[];\n  viewMode?: 'table' | 'cards';\n  sortConfig?: { key: string; direction: 'asc' | 'desc' };\n}\n\n// Helfer-Funktion, um den localStorage-Schlssel fr eine Tabelle zu generieren\nconst getLocalStorageKey = (tableId: string) => `table_settings_${tableId}`;\n\n// API zum Verwalten der Tabelleneinstellungen\nexport const tableSettingsApi = {\n  // Benutzerspezifische Tabelleneinstellungen abrufen\n  getTableSettings: async (tableId: string): Promise<TableSettings> => {\n    try {\n      // Zuerst versuchen, Einstellungen vom API-Server zu laden\n      const response = await axiosInstance.get(`/table-settings/${tableId}`);\n      return response.data;\n    } catch (error) {\n      console.error('Fehler beim Abrufen der Tabelleneinstellungen vom Server:', error);\n      \n      // Fallback: Versuchen, aus dem localStorage zu laden\n      try {\n        const localStorageKey = getLocalStorageKey(tableId);\n        const storedSettings = localStorage.getItem(localStorageKey);\n        \n        if (storedSettings) {\n          return JSON.parse(storedSettings);\n        }\n      } catch (localError) {\n        console.error('Fehler beim Laden aus localStorage:', localError);\n      }\n      \n      // Default-Einstellungen zurckgeben, wenn keine gespeicherten verfgbar sind\n      return {\n        tableId,\n        columnOrder: [],\n        hiddenColumns: []\n      };\n    }\n  },\n  \n  // Tabelleneinstellungen speichern (server-side und localStorage)\n  saveTableSettings: async (settings: TableSettings): Promise<void> => {\n    try {\n      // Zum API-Server senden\n      await axiosInstance.post(`/table-settings`, settings);\n      \n      // Auch im localStorage speichern\n      const localStorageKey = getLocalStorageKey(settings.tableId);\n      localStorage.setItem(localStorageKey, JSON.stringify(settings));\n    } catch (error) {\n      console.error('Fehler beim Speichern der Tabelleneinstellungen auf dem Server:', error);\n      \n      // Trotzdem im localStorage speichern\n      try {\n        const localStorageKey = getLocalStorageKey(settings.tableId);\n        localStorage.setItem(localStorageKey, JSON.stringify(settings));\n      } catch (localError) {\n        console.error('Fehler beim Speichern im localStorage:', localError);\n      }\n    }\n  },\n  \n  // Tabelleneinstellungen zurcksetzen\n  resetTableSettings: (tableId: string): void => {\n    try {\n      const localStorageKey = getLocalStorageKey(tableId);\n      localStorage.removeItem(localStorageKey);\n      logger.log(`Tabelleneinstellungen fr ${tableId} zurckgesetzt`);\n    } catch (error) {\n      console.error('Fehler beim Zurcksetzen der Tabelleneinstellungen:', error);\n    }\n  }\n}; ","import { useState, useEffect, useCallback, useRef } from 'react';\nimport { tableSettingsApi, TableSettings } from '../api/tableSettingsApi.ts';\nimport { logger } from '../utils/logger.ts';\n\ninterface UseTableSettingsOptions {\n  defaultColumnOrder?: string[];\n  defaultHiddenColumns?: string[];\n  defaultViewMode?: 'table' | 'cards';\n  defaultVisibleCardMetadata?: string[];\n  defaultCardColumnOrder?: string[];\n  defaultCardSortDirections?: Record<string, 'asc' | 'desc'>;\n}\n\n/**\n * Hook zum Verwalten von benutzerdefinierten Tabelleneinstellungen\n * @param tableId Eindeutige ID der Tabelle\n * @param options Optionale Standardwerte\n */\nexport const useTableSettings = (tableId: string, options?: UseTableSettingsOptions) => {\n  const [settings, setSettings] = useState<TableSettings>({\n    tableId,\n    columnOrder: options?.defaultColumnOrder || [],\n    hiddenColumns: options?.defaultHiddenColumns || []\n  });\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<Error | null>(null);\n\n  // Tabelleneinstellungen laden - beim Mount oder wenn tableId sich ndert\n  useEffect(() => {\n    let isMounted = true;\n    \n    const loadSettings = async () => {\n      try {\n        setIsLoading(true);\n        const loadedSettings = await tableSettingsApi.getTableSettings(tableId);\n        \n        if (!isMounted) return; // Component wurde bereits unmounted\n        \n        logger.log('Geladene Tabelleneinstellungen vom Server:', loadedSettings);\n        \n        // Wenn leere Einstellungen zurckgegeben werden, verwende die Standardwerte\n        if (loadedSettings.columnOrder.length === 0 && options?.defaultColumnOrder) {\n          loadedSettings.columnOrder = options.defaultColumnOrder;\n        }\n        \n        // View-Mode initialisieren, falls nicht vorhanden\n        if (!loadedSettings.viewMode && options?.defaultViewMode) {\n          loadedSettings.viewMode = options.defaultViewMode;\n        }\n        \n        // sortConfig wird bereits vom Server geladen (falls vorhanden)\n        // Keine Initialisierung ntig, da optional\n        \n        logger.log('Finale Tabelleneinstellungen nach Initialisierung:', loadedSettings);\n        setSettings(loadedSettings);\n        setError(null);\n      } catch (err) {\n        if (!isMounted) return;\n        setError(err instanceof Error ? err : new Error('Fehler beim Laden der Einstellungen'));\n        console.error('Fehler beim Laden der Tabelleneinstellungen:', err);\n      } finally {\n        if (isMounted) {\n          setIsLoading(false);\n        }\n      }\n    };\n\n    loadSettings();\n    \n    return () => {\n      isMounted = false;\n    };\n  }, [tableId]); // NUR tableId als Dependency!\n\n  // Spaltenreihenfolge aktualisieren\n  const updateColumnOrder = useCallback(async (newColumnOrder: string[]) => {\n    try {\n      const updatedSettings = { ...settings, columnOrder: newColumnOrder };\n      setSettings(updatedSettings);\n      await tableSettingsApi.saveTableSettings(updatedSettings);\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Fehler beim Speichern der Spaltenreihenfolge'));\n      console.error('Fehler beim Speichern der Spaltenreihenfolge:', err);\n    }\n  }, [settings]);\n\n  // Versteckte Spalten aktualisieren\n  const updateHiddenColumns = useCallback(async (newHiddenColumns: string[]) => {\n    try {\n      const updatedSettings = { ...settings, hiddenColumns: newHiddenColumns };\n      setSettings(updatedSettings);\n      await tableSettingsApi.saveTableSettings(updatedSettings);\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Fehler beim Speichern der versteckten Spalten'));\n      console.error('Fehler beim Speichern der versteckten Spalten:', err);\n    }\n  }, [settings]);\n\n  // Eine einzelne Spalte ein- oder ausblenden\n  const toggleColumnVisibility = useCallback(async (columnId: string) => {\n    try {\n      let newHiddenColumns: string[];\n      \n      if (settings.hiddenColumns.includes(columnId)) {\n        // Spalte einblenden (aus hiddenColumns entfernen)\n        newHiddenColumns = settings.hiddenColumns.filter(id => id !== columnId);\n      } else {\n        // Spalte ausblenden (zu hiddenColumns hinzufgen)\n        newHiddenColumns = [...settings.hiddenColumns, columnId];\n      }\n      \n      const updatedSettings = { ...settings, hiddenColumns: newHiddenColumns };\n      setSettings(updatedSettings);\n      await tableSettingsApi.saveTableSettings(updatedSettings);\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Fehler beim ndern der Spaltenansicht'));\n      console.error('Fehler beim ndern der Spaltenansicht:', err);\n    }\n  }, [settings]);\n\n  // View-Mode aktualisieren\n  const updateViewMode = useCallback(async (newViewMode: 'table' | 'cards') => {\n    try {\n      const updatedSettings = { ...settings, viewMode: newViewMode };\n      setSettings(updatedSettings);\n      await tableSettingsApi.saveTableSettings(updatedSettings);\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Fehler beim Speichern des View-Modes'));\n      console.error('Fehler beim Speichern des View-Modes:', err);\n    }\n  }, [settings]);\n\n  // Sortierung aktualisieren\n  const updateSortConfig = useCallback(async (newSortConfig: { key: string; direction: 'asc' | 'desc' }) => {\n    try {\n      const updatedSettings = { ...settings, sortConfig: newSortConfig };\n      setSettings(updatedSettings);\n      await tableSettingsApi.saveTableSettings(updatedSettings);\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Fehler beim Speichern der Sortierung'));\n      console.error('Fehler beim Speichern der Sortierung:', err);\n    }\n  }, [settings]);\n\n  return {\n    settings,\n    isLoading,\n    error,\n    updateColumnOrder,\n    updateHiddenColumns,\n    toggleColumnVisibility,\n    isColumnVisible: (columnId: string) => !settings.hiddenColumns.includes(columnId),\n    updateViewMode,\n    updateSortConfig\n  };\n}; ","/**\r\n * Zentrale Filter-Logik zur Eliminierung von Code-Duplikation\r\n * \r\n * Diese Datei konsolidiert die Filter-Logik, die zuvor in mehreren Komponenten\r\n * dupliziert war (Requests.tsx, Worktracker.tsx, InvoiceManagementTab.tsx, etc.)\r\n * \r\n * WICHTIG: Die Logik ist exakt identisch mit der vorherigen Implementierung.\r\n * Nur die Code-Duplikation wurde entfernt, keine Funktionalittsnderung!\r\n */\r\n\r\nimport { startOfWeek, endOfWeek, startOfMonth, endOfMonth, startOfYear, endOfYear } from 'date-fns';\r\n\r\nexport interface FilterCondition {\r\n  column: string;\r\n  operator: string;\r\n  value: string | number | Date | null;\r\n}\r\n\r\n/**\r\n * Evaluates a single filter condition against a field value\r\n * @param fieldValue - The value to test against\r\n * @param condition - The filter condition to apply\r\n * @returns true if condition is met, false otherwise\r\n */\r\nexport const evaluateCondition = (\r\n  fieldValue: any,\r\n  condition: FilterCondition\r\n): boolean => {\r\n  const { operator, value } = condition;\r\n  \r\n  // Sicherstellen, dass value definiert ist\r\n  if (value === undefined) {\r\n    console.error('evaluateCondition: value ist undefined', condition);\r\n    return false;\r\n  }\r\n  \r\n  // Handle null/undefined values\r\n  if (fieldValue == null && value == null) {\r\n    return operator === 'equals';\r\n  }\r\n  if (fieldValue == null || value == null) {\r\n    if (operator === 'notEquals') return true;\r\n    return false;\r\n  }\r\n\r\n  // String operations\r\n  // Sicherstellen, dass fieldValue und value Strings sind, bevor toLowerCase() aufgerufen wird\r\n  let strField: string = '';\r\n  let strValue: string = '';\r\n  \r\n  try {\r\n    // Konvertiere fieldValue zu String, auch wenn es ein Objekt ist\r\n    const fieldValueStr = fieldValue == null ? '' : (typeof fieldValue === 'string' ? fieldValue : String(fieldValue));\r\n    if (typeof fieldValueStr !== 'string') {\r\n      return false;\r\n    }\r\n    const lowerField = fieldValueStr.toLowerCase();\r\n    if (lowerField === undefined || lowerField === null || typeof lowerField !== 'string') {\r\n      return false;\r\n    }\r\n    strField = lowerField;\r\n    \r\n    // Konvertiere value zu String, auch wenn es ein Objekt ist\r\n    const valueStr = value == null ? '' : (typeof value === 'string' ? value : String(value));\r\n    if (typeof valueStr !== 'string') {\r\n      return false;\r\n    }\r\n    const lowerValue = valueStr.toLowerCase();\r\n    if (lowerValue === undefined || lowerValue === null || typeof lowerValue !== 'string') {\r\n      return false;\r\n    }\r\n    strValue = lowerValue;\r\n  } catch (error) {\r\n    // Falls toLowerCase() fehlschlgt, gebe false zurck\r\n    return false;\r\n  }\r\n\r\n  // Sicherstellen, dass strField und strValue Strings sind und nicht undefined\r\n  if (typeof strField !== 'string' || typeof strValue !== 'string' || strField === undefined || strValue === undefined || strField === null || strValue === null) {\r\n    return false;\r\n  }\r\n\r\n  switch (operator) {\r\n    case 'equals':\r\n      return strField === strValue;\r\n    case 'notEquals':\r\n      return strField !== strValue;\r\n    case 'contains':\r\n      return strField.includes(strValue);\r\n    case 'startsWith':\r\n      return strField.startsWith(strValue);\r\n    case 'endsWith':\r\n      // Explizite Prfung, dass strField und strValue Strings sind, bevor endsWith aufgerufen wird\r\n      if (strField === undefined || strField === null) {\r\n        console.error('endsWith: strField ist undefined/null', { strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      if (strValue === undefined || strValue === null) {\r\n        console.error('endsWith: strValue ist undefined/null', { strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      if (typeof strField !== 'string') {\r\n        console.error('endsWith: strField ist kein String', { strField, typeof: typeof strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      if (typeof strValue !== 'string') {\r\n        console.error('endsWith: strValue ist kein String', { strField, strValue, typeof: typeof strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      try {\r\n        return strField.endsWith(strValue);\r\n      } catch (error) {\r\n        console.error('endsWith: Fehler bei endsWith-Aufruf', error, { strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n    case 'before':\r\n    case 'after': {\r\n      // Date operations\r\n      const fieldDate = new Date(fieldValue);\r\n      const valueDate = new Date(value as string);\r\n      if (isNaN(fieldDate.getTime()) || isNaN(valueDate.getTime())) {\r\n        return false;\r\n      }\r\n      return operator === 'before' \r\n        ? fieldDate < valueDate \r\n        : fieldDate > valueDate;\r\n    }\r\n    case 'greaterThan':\r\n    case 'lessThan': {\r\n      // Numeric operations\r\n      const fieldNum = parseFloat(String(fieldValue));\r\n      const valueNum = parseFloat(String(value));\r\n      if (isNaN(fieldNum) || isNaN(valueNum)) {\r\n        return false;\r\n      }\r\n      return operator === 'greaterThan'\r\n        ? fieldNum > valueNum\r\n        : fieldNum < valueNum;\r\n    }\r\n    default:\r\n      return true;\r\n  }\r\n};\r\n\r\n/**\r\n * Type for getting field values from items\r\n */\r\nexport type GetFieldValue<T> = (item: T, columnId: string) => any;\r\n\r\n/**\r\n * Type for column-specific evaluation handlers\r\n * Returns true if condition is met, false otherwise\r\n */\r\nexport type ColumnEvaluator<T> = (item: T, condition: FilterCondition) => boolean | null;\r\n\r\n/**\r\n * Applies filter conditions to an array of items\r\n * \r\n * @param items - Array of items to filter\r\n * @param conditions - Array of filter conditions\r\n * @param operators - Array of logical operators ('AND' | 'OR') between conditions\r\n * @param getFieldValue - Function to extract field values from items\r\n * @param columnEvaluators - Optional map of column-specific evaluators for custom logic\r\n * @returns Filtered array of items\r\n * \r\n * @example\r\n * // Standard usage with getFieldValue\r\n * const filtered = applyFilters(items, conditions, operators, (item, col) => item[col]);\r\n * \r\n * // With custom column evaluators\r\n * const filtered = applyFilters(\r\n *   items,\r\n *   conditions,\r\n *   operators,\r\n *   (item, col) => item[col],\r\n *   {\r\n *     'responsible': (item, condition) => {\r\n *       // Custom logic for responsible column\r\n *       return evaluateUserRoleCondition(item.responsible?.id, item.role?.id, condition);\r\n *     }\r\n *   }\r\n * );\r\n */\r\nexport const applyFilters = <T>(\r\n  items: T[],\r\n  conditions: FilterCondition[],\r\n  operators: ('AND' | 'OR')[],\r\n  getFieldValue: GetFieldValue<T>,\r\n  columnEvaluators?: Record<string, ColumnEvaluator<T>>\r\n): T[] => {\r\n  if (conditions.length === 0) {\r\n    return items;\r\n  }\r\n\r\n  return items.filter(item => {\r\n    let result = true;\r\n\r\n    for (let i = 0; i < conditions.length; i++) {\r\n      const condition = conditions[i];\r\n      let conditionMet = false;\r\n\r\n      // Check if there's a custom evaluator for this column\r\n      if (columnEvaluators && columnEvaluators[condition.column]) {\r\n        const customResult = columnEvaluators[condition.column](item, condition);\r\n        if (customResult !== null) {\r\n          conditionMet = customResult;\r\n        } else {\r\n          // Fallback to standard evaluation if custom evaluator returns null\r\n          const fieldValue = getFieldValue(item, condition.column);\r\n          conditionMet = evaluateCondition(fieldValue, condition);\r\n        }\r\n      } else {\r\n        // Standard evaluation\r\n        const fieldValue = getFieldValue(item, condition.column);\r\n        conditionMet = evaluateCondition(fieldValue, condition);\r\n      }\r\n\r\n      // Apply logical operators\r\n      if (i === 0) {\r\n        result = conditionMet;\r\n      } else {\r\n        const operator = operators[i - 1] || 'AND';\r\n        result = operator === 'AND' \r\n          ? (result && conditionMet) \r\n          : (result || conditionMet);\r\n      }\r\n    }\r\n\r\n    return result;\r\n  });\r\n};\r\n\r\n/**\r\n * Helper function to evaluate date conditions with proper date comparison\r\n * Supports __TODAY__ as a dynamic date value\r\n * \r\n * WICHTIG: Extrahiert nur den Datumsteil (Jahr, Monat, Tag) ohne Zeitzone,\r\n * um Zeitzone-Konvertierungsprobleme zu vermeiden (verhindert Tag-Versatz)\r\n */\r\nexport const evaluateDateCondition = (\r\n  dateValue: Date | string | null | undefined,\r\n  condition: FilterCondition\r\n): boolean => {\r\n  if (!dateValue) {\r\n    return false;\r\n  }\r\n\r\n  const date = new Date(dateValue);\r\n  if (isNaN(date.getTime())) {\r\n    return false;\r\n  }\r\n\r\n  // Extrahiere nur den Datumsteil (Jahr, Monat, Tag) mit UTC-Methoden\r\n  // Dies verhindert Zeitzone-Konvertierung, die zu einem Tag-Versatz fhrt\r\n  const dateYear = date.getUTCFullYear();\r\n  const dateMonth = date.getUTCMonth();\r\n  const dateDay = date.getUTCDate();\r\n  // Erstelle lokales Date-Objekt aus den UTC-Werten (ohne Zeitzone)\r\n  const normalizedDate = new Date(dateYear, dateMonth, dateDay);\r\n\r\n  //  PHASE 5: Handle Zeitraum-Platzhalter (__THIS_WEEK__, __THIS_MONTH__, __THIS_YEAR__)\r\n  // Diese funktionieren analog zu __TODAY__, aber fr Zeitrume\r\n  try {\r\n    if (condition.value === '__THIS_WEEK__') {\r\n      if (condition.operator === 'equals') {\r\n        const weekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\r\n        weekStart.setHours(0, 0, 0, 0);\r\n        const weekEnd = endOfWeek(new Date(), { weekStartsOn: 1 });\r\n        weekEnd.setHours(23, 59, 59, 999);\r\n        // Prfe, ob normalizedDate innerhalb des Zeitraums liegt\r\n        return normalizedDate >= weekStart && normalizedDate <= weekEnd;\r\n      }\r\n      // Fr andere Operatoren (before, after) verwende Woche als einzelnes Datum\r\n      const weekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekStart.setHours(0, 0, 0, 0);\r\n      const weekEnd = endOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekEnd.setHours(23, 59, 59, 999);\r\n      if (condition.operator === 'before') {\r\n        return normalizedDate < weekEnd;\r\n      } else if (condition.operator === 'after') {\r\n        return normalizedDate > weekStart;\r\n      }\r\n      return false;\r\n    } else if (condition.value === '__THIS_MONTH__') {\r\n      if (condition.operator === 'equals') {\r\n        const monthStart = startOfMonth(new Date());\r\n        monthStart.setHours(0, 0, 0, 0);\r\n        const monthEnd = endOfMonth(new Date());\r\n        monthEnd.setHours(23, 59, 59, 999);\r\n        // Prfe, ob normalizedDate innerhalb des Zeitraums liegt\r\n        return normalizedDate >= monthStart && normalizedDate <= monthEnd;\r\n      }\r\n      // Fr andere Operatoren (before, after) verwende Monat als einzelnes Datum\r\n      const monthStart = startOfMonth(new Date());\r\n      monthStart.setHours(0, 0, 0, 0);\r\n      const monthEnd = endOfMonth(new Date());\r\n      monthEnd.setHours(23, 59, 59, 999);\r\n      if (condition.operator === 'before') {\r\n        return normalizedDate < monthEnd;\r\n      } else if (condition.operator === 'after') {\r\n        return normalizedDate > monthStart;\r\n      }\r\n      return false;\r\n    } else if (condition.value === '__THIS_YEAR__') {\r\n      if (condition.operator === 'equals') {\r\n        const yearStart = startOfYear(new Date());\r\n        yearStart.setHours(0, 0, 0, 0);\r\n        const yearEnd = endOfYear(new Date());\r\n        yearEnd.setHours(23, 59, 59, 999);\r\n        // Prfe, ob normalizedDate innerhalb des Zeitraums liegt\r\n        return normalizedDate >= yearStart && normalizedDate <= yearEnd;\r\n      }\r\n      // Fr andere Operatoren (before, after) verwende Jahr als einzelnes Datum\r\n      const yearStart = startOfYear(new Date());\r\n      yearStart.setHours(0, 0, 0, 0);\r\n      const yearEnd = endOfYear(new Date());\r\n      yearEnd.setHours(23, 59, 59, 999);\r\n      if (condition.operator === 'before') {\r\n        return normalizedDate < yearEnd;\r\n      } else if (condition.operator === 'after') {\r\n        return normalizedDate > yearStart;\r\n      }\r\n      return false;\r\n    }\r\n\r\n    // Handle __TODAY__, __WEEK_START__, __WEEK_END__, __MONTH_START__, __MONTH_END__, __YEAR_START__, __YEAR_END__ dynamic dates\r\n    let conditionDate: Date;\r\n    if (condition.value === '__TODAY__') {\r\n      // Get today's date in local timezone (set to midnight)\r\n      const localToday = new Date();\r\n      localToday.setHours(0, 0, 0, 0);\r\n      conditionDate = localToday;\r\n    } else if (condition.value === '__WEEK_START__') {\r\n      const weekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekStart.setHours(0, 0, 0, 0);\r\n      conditionDate = weekStart;\r\n    } else if (condition.value === '__WEEK_END__') {\r\n      const weekEnd = endOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekEnd.setHours(23, 59, 59, 999);\r\n      conditionDate = weekEnd;\r\n    } else if (condition.value === '__MONTH_START__') {\r\n      const monthStart = startOfMonth(new Date());\r\n      monthStart.setHours(0, 0, 0, 0);\r\n      conditionDate = monthStart;\r\n    } else if (condition.value === '__MONTH_END__') {\r\n      const monthEnd = endOfMonth(new Date());\r\n      monthEnd.setHours(23, 59, 59, 999);\r\n      conditionDate = monthEnd;\r\n    } else if (condition.value === '__YEAR_START__') {\r\n      const yearStart = startOfYear(new Date());\r\n      yearStart.setHours(0, 0, 0, 0);\r\n      conditionDate = yearStart;\r\n    } else if (condition.value === '__YEAR_END__') {\r\n      const yearEnd = endOfYear(new Date());\r\n      yearEnd.setHours(23, 59, 59, 999);\r\n      conditionDate = yearEnd;\r\n    } else {\r\n      const conditionDateRaw = new Date(condition.value as string);\r\n      if (isNaN(conditionDateRaw.getTime())) {\r\n        return false;\r\n      }\r\n      // Extrahiere nur den Datumsteil (Jahr, Monat, Tag) mit UTC-Methoden\r\n      // Dies verhindert Zeitzone-Konvertierung, die zu einem Tag-Versatz fhrt\r\n      const conditionYear = conditionDateRaw.getUTCFullYear();\r\n      const conditionMonth = conditionDateRaw.getUTCMonth();\r\n      const conditionDay = conditionDateRaw.getUTCDate();\r\n      // Erstelle lokales Date-Objekt aus den UTC-Werten (ohne Zeitzone)\r\n      conditionDate = new Date(conditionYear, conditionMonth, conditionDay);\r\n    }\r\n\r\n    switch (condition.operator) {\r\n      case 'equals':\r\n        return normalizedDate.getTime() === conditionDate.getTime();\r\n      case 'before':\r\n        return normalizedDate < conditionDate;\r\n      case 'after':\r\n        return normalizedDate > conditionDate;\r\n      default:\r\n        return true;\r\n    }\r\n  } catch (error) {\r\n    //  PHASE 5: Error Handling fr ungltige Platzhalter-Werte\r\n    console.error(`[evaluateDateCondition] Error with placeholder ${condition.value}:`, error);\r\n    return false; // Fallback: Filter schliet Datensatz aus\r\n  }\r\n};\r\n\r\n/**\r\n * Helper function to evaluate user/role conditions with user-{id} or role-{id} format\r\n * Supports both user-{id} and role-{id} formats, plus text fallback for legacy support\r\n */\r\nexport const evaluateUserRoleCondition = (\r\n  userId: number | null | undefined,\r\n  roleId: number | null | undefined,\r\n  condition: FilterCondition,\r\n  textValue?: string  // Optional: text representation for fallback (e.g. \"John Doe\")\r\n): boolean => {\r\n  const value = condition.value as string || '';\r\n  \r\n  // Handle user-{id} format\r\n  if (value.startsWith('user-')) {\r\n    const targetUserId = parseInt(value.replace('user-', ''), 10);\r\n    if (isNaN(targetUserId)) return false;\r\n    const matches = userId === targetUserId;\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Handle role-{id} format\r\n  if (value.startsWith('role-')) {\r\n    const targetRoleId = parseInt(value.replace('role-', ''), 10);\r\n    if (isNaN(targetRoleId)) return false;\r\n    const matches = roleId === targetRoleId;\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Empty value matches all\r\n  if (value === '') {\r\n    return true;\r\n  }\r\n  \r\n  // Fallback to text comparison (legacy support)\r\n  if (textValue !== undefined) {\r\n    const textValueLower = textValue.toLowerCase();\r\n    const valueLower = value.toLowerCase();\r\n    if (condition.operator === 'equals') {\r\n      return textValueLower === valueLower;\r\n    } else if (condition.operator === 'notEquals') {\r\n      return textValueLower !== valueLower;\r\n    } else if (condition.operator === 'contains') {\r\n      return textValueLower.includes(valueLower);\r\n    }\r\n  }\r\n  \r\n  return false;\r\n};\r\n\r\n/**\r\n * Helper function for combined responsible/qualityControl filter (specific to Tasks)\r\n */\r\nexport const evaluateResponsibleAndQualityControl = (\r\n  responsibleId: number | null | undefined,\r\n  responsibleRoleId: number | null | undefined,\r\n  qualityControlId: number | null | undefined,\r\n  condition: FilterCondition,\r\n  responsibleText?: string,\r\n  qualityControlText?: string\r\n): boolean => {\r\n  const value = condition.value as string || '';\r\n  \r\n  // Handle user-{id} format - matches either responsible OR qualityControl\r\n  if (value.startsWith('user-')) {\r\n    const targetUserId = parseInt(value.replace('user-', ''), 10);\r\n    if (isNaN(targetUserId)) return false;\r\n    const matches = (responsibleId === targetUserId) || (qualityControlId === targetUserId);\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Handle role-{id} format - only matches with responsible role\r\n  if (value.startsWith('role-')) {\r\n    const targetRoleId = parseInt(value.replace('role-', ''), 10);\r\n    if (isNaN(targetRoleId)) return false;\r\n    const matches = responsibleRoleId === targetRoleId;\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Empty value matches all\r\n  if (value === '') {\r\n    return true;\r\n  }\r\n  \r\n  // Fallback to text comparison (legacy support)\r\n  const valueLower = value.toLowerCase();\r\n  if (condition.operator === 'equals') {\r\n    return (responsibleText?.toLowerCase() === valueLower) || (qualityControlText?.toLowerCase() === valueLower);\r\n  } else if (condition.operator === 'notEquals') {\r\n    return (responsibleText?.toLowerCase() !== valueLower) && (qualityControlText?.toLowerCase() !== valueLower);\r\n  } else if (condition.operator === 'contains') {\r\n    return (responsibleText?.toLowerCase()?.includes(valueLower) ?? false) || (qualityControlText?.toLowerCase()?.includes(valueLower) ?? false);\r\n  }\r\n  \r\n  return false;\r\n};\r\n\r\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { Tour, TourBooking, TourBookingStatus } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\n\ninterface CreateTourBookingModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onBookingCreated: (newBooking: TourBooking) => void;\n    tour?: Tour | null;\n}\n\nconst CreateTourBookingModal = ({ isOpen, onClose, onBookingCreated, tour: preselectedTour }: CreateTourBookingModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    \n    const [tourId, setTourId] = useState<number | ''>(preselectedTour?.id || '');\n    const [tourDate, setTourDate] = useState('');\n    const [numberOfParticipants, setNumberOfParticipants] = useState<number | ''>(1);\n    const [customerName, setCustomerName] = useState('');\n    const [customerEmail, setCustomerEmail] = useState('');\n    const [customerPhone, setCustomerPhone] = useState('');\n    const [customerNotes, setCustomerNotes] = useState('');\n    \n    const [tours, setTours] = useState<Tour[]>([]);\n    const [selectedTour, setSelectedTour] = useState<Tour | null>(preselectedTour || null);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Touren\n    useEffect(() => {\n        const loadData = async () => {\n            try {\n                setLoadingData(true);\n                const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BASE, {\n                    params: { isActive: true }\n                });\n                const toursData = response.data?.data || response.data || [];\n                setTours(Array.isArray(toursData) ? toursData : []);\n            } catch (err: unknown) {\n                console.error('Error loading tours:', err);\n                showMessage(t('errors.loadError'), 'error');\n            } finally {\n                setLoadingData(false);\n            }\n        };\n        \n        if (isOpen) {\n            loadData();\n        }\n    }, [isOpen, t, showMessage]);\n\n    // Setze preselectedTour wenn vorhanden\n    useEffect(() => {\n        if (preselectedTour) {\n            setTourId(preselectedTour.id);\n            setSelectedTour(preselectedTour);\n        }\n    }, [preselectedTour]);\n\n    // Update selectedTour when tourId changes\n    useEffect(() => {\n        if (tourId) {\n            const tour = tours.find(t => t.id === Number(tourId));\n            setSelectedTour(tour || null);\n        } else {\n            setSelectedTour(null);\n        }\n    }, [tourId, tours]);\n\n    // Reset form when modal opens/closes\n    useEffect(() => {\n        if (!isOpen) {\n            if (!preselectedTour) {\n                setTourId('');\n            }\n            setTourDate('');\n            setNumberOfParticipants(1);\n            setCustomerName('');\n            setCustomerEmail('');\n            setCustomerPhone('');\n            setCustomerNotes('');\n            setError(null);\n        }\n    }, [isOpen, preselectedTour]);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n\n        // Validierungen\n        if (!tourId) {\n            setError(t('tourBookings.validation.tourRequired', { defaultValue: 'Tour ist erforderlich' }));\n            return;\n        }\n\n        if (!tourDate) {\n            setError(t('tourBookings.validation.tourDateRequired', { defaultValue: 'Tour-Datum ist erforderlich' }));\n            return;\n        }\n\n        const tourDateObj = new Date(tourDate);\n        if (tourDateObj < new Date()) {\n            setError(t('tours.validation.tourDateFuture', { defaultValue: 'Tour-Datum muss in der Zukunft liegen' }));\n            return;\n        }\n\n        if (!numberOfParticipants || Number(numberOfParticipants) < 1) {\n            setError(t('tourBookings.validation.numberOfParticipantsMin', { defaultValue: 'Anzahl Teilnehmer muss >= 1 sein' }));\n            return;\n        }\n\n        if (!customerName.trim() || customerName.trim().length < 2) {\n            setError(t('tourBookings.validation.customerNameMinLength', { defaultValue: 'Kundenname muss mindestens 2 Zeichen lang sein' }));\n            return;\n        }\n\n        if (!customerPhone.trim() && !customerEmail.trim()) {\n            setError(t('tourBookings.validation.contactRequired', { defaultValue: 'Mindestens eine Kontaktinformation (Telefon oder E-Mail) ist erforderlich' }));\n            return;\n        }\n\n        // Validierung: Anzahl Teilnehmer zwischen min/max\n        if (selectedTour) {\n            const numPart = Number(numberOfParticipants);\n            if (selectedTour.minParticipants && numPart < selectedTour.minParticipants) {\n                setError(t('tours.validation.numberOfParticipantsRange', { \n                    defaultValue: 'Anzahl der Teilnehmer muss zwischen {min} und {max} sein',\n                    min: selectedTour.minParticipants,\n                    max: selectedTour.maxParticipants || ''\n                }));\n                return;\n            }\n            if (selectedTour.maxParticipants && numPart > selectedTour.maxParticipants) {\n                setError(t('tours.validation.numberOfParticipantsRange', { \n                    defaultValue: 'Anzahl der Teilnehmer muss zwischen {min} und {max} sein',\n                    min: selectedTour.minParticipants || 1,\n                    max: selectedTour.maxParticipants\n                }));\n                return;\n            }\n        }\n\n        setLoading(true);\n        try {\n            const response = await axiosInstance.post(API_ENDPOINTS.TOUR_BOOKINGS.BASE, {\n                tourId: Number(tourId),\n                tourDate,\n                numberOfParticipants: Number(numberOfParticipants),\n                customerName: customerName.trim(),\n                customerEmail: customerEmail.trim() || null,\n                customerPhone: customerPhone.trim() || null,\n                customerNotes: customerNotes.trim() || null\n            });\n\n            if (response.data?.success && response.data?.data) {\n                showMessage(\n                    t('tourBookings.created', { defaultValue: 'Tour-Buchung erfolgreich erstellt' }),\n                    'success'\n                );\n                onBookingCreated(response.data.data);\n                onClose();\n            } else {\n                throw new Error(response.data?.message || t('tours.bookings.createError', { defaultValue: 'Fehler beim Erstellen der Buchung' }));\n            }\n        } catch (err: unknown) {\n            console.error('Error creating booking:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('errors.unknownError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                    <div className=\"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700\">\n                        <Dialog.Title className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                            {t('tourBookings.create', { defaultValue: 'Neue Tour-Buchung' })}\n                        </Dialog.Title>\n                        <button\n                            onClick={onClose}\n                            className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                        >\n                            <XMarkIcon className=\"h-6 w-6\" />\n                        </button>\n                    </div>\n\n                    <form onSubmit={handleSubmit} className=\"p-4 space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.tour', { defaultValue: 'Tour' })} *\n                            </label>\n                            <select\n                                value={tourId}\n                                onChange={(e) => setTourId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData || !!preselectedTour}\n                            >\n                                <option value=\"\">{t('common.select', { defaultValue: 'Bitte whlen' })}</option>\n                                {tours.filter(t => t.isActive && t.title).map(tour => (\n                                    <option key={tour.id} value={tour.id}>\n                                        {tour.title || '-'}\n                                    </option>\n                                ))}\n                            </select>\n                            {selectedTour && (\n                                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                                    {selectedTour.minParticipants && selectedTour.maxParticipants\n                                        ? t('tourBookings.participantsRange', { \n                                            defaultValue: 'Teilnehmer: {min} - {max}',\n                                            min: selectedTour.minParticipants,\n                                            max: selectedTour.maxParticipants\n                                        })\n                                        : selectedTour.minParticipants\n                                        ? t('tourBookings.participantsMin', { \n                                            defaultValue: 'Min. Teilnehmer: {min}',\n                                            min: selectedTour.minParticipants\n                                        })\n                                        : selectedTour.maxParticipants\n                                        ? t('tourBookings.participantsMax', { \n                                            defaultValue: 'Max. Teilnehmer: {max}',\n                                            max: selectedTour.maxParticipants\n                                        })\n                                        : null}\n                                </p>\n                            )}\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.tourDate', { defaultValue: 'Tour-Datum' })} *\n                            </label>\n                            <input\n                                type=\"datetime-local\"\n                                value={tourDate}\n                                onChange={(e) => setTourDate(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.numberOfParticipants', { defaultValue: 'Anzahl Teilnehmer' })} *\n                            </label>\n                            <input\n                                type=\"number\"\n                                min={selectedTour?.minParticipants || 1}\n                                max={selectedTour?.maxParticipants || undefined}\n                                value={numberOfParticipants}\n                                onChange={(e) => setNumberOfParticipants(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerName', { defaultValue: 'Kundenname' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={customerName}\n                                onChange={(e) => setCustomerName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerPhone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={customerPhone}\n                                onChange={(e) => setCustomerPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerEmail', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={customerEmail}\n                                onChange={(e) => setCustomerEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tourBookings.customerNotes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={customerNotes}\n                                onChange={(e) => setCustomerNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={onClose}\n                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                title={t('common.cancel', 'Abbrechen')}\n                            >\n                                <XMarkIcon className=\"h-5 w-5\" />\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData}\n                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            >\n                                <CheckIcon className=\"h-5 w-5\" />\n                            </button>\n                        </div>\n                    </form>\n                </Dialog.Panel>\n            </div>\n        </Dialog>\n    );\n};\n\nexport default CreateTourBookingModal;\n\n","import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { EyeIcon, EyeSlashIcon, ArrowsUpDownIcon, ArrowUpIcon, ArrowDownIcon, XMarkIcon } from '@heroicons/react/24/outline';\n\ninterface Column {\n  id: string;\n  label: string;\n}\n\ninterface TableColumnConfigProps {\n  columns: Column[];\n  visibleColumns: string[];\n  columnOrder: string[];\n  onToggleColumnVisibility: (columnId: string) => void;\n  onMoveColumn?: (dragIndex: number, hoverIndex: number) => void; // Optional: Drag & Drop fr Spalten-Reihenfolge\n  onClose?: () => void; // Optional: Callback wenn Modal geschlossen wird\n  buttonTitle?: string; // Optional: Custom Button-Titel\n  modalTitle?: string; // Optional: Custom Modal-Titel\n  mainSortConfig?: { key: string; direction: 'asc' | 'desc' }; // Optional: Hauptsortierung (fr Table & Cards synchron)\n  onMainSortChange?: (key: string, direction: 'asc' | 'desc') => void; // Optional: Callback fr Hauptsortierung\n  showMainSort?: boolean; // Optional: Hauptsortierung anzeigen\n  isOpen?: boolean; // Optional: Externe Steuerung des Modal-Status (wenn nicht bergeben, wird interner State verwendet)\n  onOpenChange?: (open: boolean) => void; // Optional: Callback wenn Modal geffnet/geschlossen wird (fr externe Steuerung)\n}\n\ninterface DraggableItemProps {\n  id: string;\n  label: string;\n  index: number;\n  isVisible: boolean;\n  onToggleVisibility: (id: string) => void;\n  sortDirection?: 'asc' | 'desc'; // Optional: Sortierrichtung fr diese Spalte (wenn diese Spalte die Hauptsortierung ist)\n  onSortDirectionChange?: (id: string, direction: 'asc' | 'desc') => void; // Optional: Callback fr Hauptsortierung\n  showMainSort?: boolean; // Optional: Hauptsortierung anzeigen\n  isMainSort?: boolean; // Optional: Ist diese Spalte die Hauptsortierung?\n}\n\n// Komponente fr eine einzelne Spalte\nconst DraggableColumnItem: React.FC<DraggableItemProps> = ({ \n  id, \n  label, \n  index, \n  isVisible,\n  onToggleVisibility,\n  sortDirection,\n  onSortDirectionChange,\n  showMainSort = false,\n  isMainSort = false\n}) => {\n  const { t } = useTranslation();\n  \n  return (\n    <li \n      className=\"flex items-center justify-between px-2.5 py-2 rounded-md transition-colors duration-150 hover:bg-gray-50 dark:hover:bg-gray-700\"\n    >\n      <div className=\"flex items-center flex-1 min-w-0\">\n        <span className=\"text-sm dark:text-gray-300\">\n          {label}\n        </span>\n      </div>\n      <div className=\"flex items-center gap-2\">\n        {/* Hauptsortierung-Toggle: Nur anzeigen wenn onSortDirectionChange vorhanden ist */}\n        {onSortDirectionChange && (\n          <button\n            onClick={(e) => {\n              e.stopPropagation();\n              // Wenn diese Spalte bereits die Hauptsortierung ist, toggle die Richtung\n              // Sonst setze diese Spalte als neue Hauptsortierung (Standard: 'asc')\n              if (isMainSort && sortDirection !== undefined) {\n                onSortDirectionChange(id, sortDirection === 'asc' ? 'desc' : 'asc');\n              } else {\n                onSortDirectionChange(id, 'asc');\n              }\n            }}\n            className={`inline-flex items-center justify-center p-1.5 rounded-md transition-colors duration-150 ${\n              isMainSort\n                ? 'bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 hover:bg-blue-200 dark:hover:bg-blue-900/50'\n                : 'bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300'\n            }`}\n            title={\n              isMainSort && sortDirection !== undefined\n                ? `${t('tableColumn.mainSort')}: ${sortDirection === 'asc' ? t('tableColumn.ascending') : t('tableColumn.descending')} (${t('tableColumn.clickToToggle')})`\n                : `${t('tableColumn.setMainSort')} (${t('tableColumn.clickToSet')})`\n            }\n          >\n            {isMainSort && sortDirection === 'asc' ? (\n              <ArrowUpIcon className=\"h-4 w-4\" />\n            ) : isMainSort && sortDirection === 'desc' ? (\n              <ArrowDownIcon className=\"h-4 w-4\" />\n            ) : (\n              <ArrowsUpDownIcon className=\"h-4 w-4\" />\n            )}\n          </button>\n        )}\n        <button\n          onClick={() => onToggleVisibility(id)}\n          className=\"inline-flex items-center justify-center p-1.5 rounded-full bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300 transition-colors duration-150\"\n          title={isVisible ? t('tableColumn.hideColumn') : t('tableColumn.showColumn')}\n        >\n          {isVisible ? (\n            <EyeIcon className=\"w-4 h-4 dark:text-gray-300\" />\n          ) : (\n            <EyeSlashIcon className=\"w-4 h-4 text-gray-400 dark:text-gray-500\" />\n          )}\n        </button>\n      </div>\n    </li>\n  );\n};\n\nconst TableColumnConfig: React.FC<TableColumnConfigProps> = ({\n  columns,\n  visibleColumns,\n  columnOrder,\n  onToggleColumnVisibility,\n  onMoveColumn,\n  onClose,\n  buttonTitle,\n  modalTitle,\n  mainSortConfig,\n  onMainSortChange,\n  showMainSort = false,\n  isOpen: externalIsOpen,\n  onOpenChange\n}) => {\n  const { t } = useTranslation();\n  const defaultButtonTitle = buttonTitle || t('tableColumn.configure');\n  const defaultModalTitle = modalTitle || t('tableColumn.configure');\n  // Interner State nur verwenden, wenn keine externe Steuerung bergeben wurde\n  const [internalIsOpen, setInternalIsOpen] = useState(false);\n  const isOpen = externalIsOpen !== undefined ? externalIsOpen : internalIsOpen;\n  const menuRef = useRef<HTMLDivElement>(null);\n\n  // Sortiere die Spalten gem der benutzerdefinierten Reihenfolge\n  const sortedColumns = [...columns].sort((a, b) => {\n    const indexA = columnOrder.indexOf(a.id);\n    const indexB = columnOrder.indexOf(b.id);\n    // Wenn eine Spalte nicht in columnOrder ist, platziere sie am Ende\n    if (indexA === -1) return 1;\n    if (indexB === -1) return -1;\n    return indexA - indexB;\n  });\n\n  // Handler zum Schlieen des Mens\n  const handleClose = useCallback(() => {\n    if (externalIsOpen !== undefined) {\n      // Externe Steuerung: onOpenChange aufrufen\n      onOpenChange?.(false);\n    } else {\n      // Interne Steuerung: internen State aktualisieren\n      setInternalIsOpen(false);\n    }\n    onClose?.();\n  }, [externalIsOpen, onOpenChange, onClose]);\n\n  // Handler zum ffnen des Mens\n  const handleOpen = useCallback(() => {\n    if (externalIsOpen !== undefined) {\n      // Externe Steuerung: onOpenChange aufrufen\n      onOpenChange?.(true);\n    } else {\n      // Interne Steuerung: internen State aktualisieren\n      setInternalIsOpen(true);\n    }\n  }, [externalIsOpen, onOpenChange]);\n\n  // Click outside handler\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (menuRef.current && !menuRef.current.contains(event.target as Node)) {\n        handleClose();\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [isOpen, handleClose]);\n\n  // Keyboard navigation: ESC zum Schlieen\n  useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.key === 'Escape' && isOpen) {\n        handleClose();\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener('keydown', handleKeyDown);\n    }\n\n    return () => {\n      document.removeEventListener('keydown', handleKeyDown);\n    };\n  }, [isOpen, handleClose]);\n\n  return (\n    <div className=\"relative\" ref={menuRef}>\n      {/* Button nur anzeigen, wenn keine externe Steuerung vorhanden ist */}\n      {externalIsOpen === undefined && (\n        <button\n          className=\"inline-flex items-center justify-center p-2 rounded-md bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300 transition-colors duration-150\"\n          onClick={isOpen ? handleClose : handleOpen}\n          title={defaultButtonTitle}\n        >\n        {showMainSort ? (\n          <ArrowsUpDownIcon className=\"w-5 h-5\" />\n        ) : (\n          <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\" className=\"w-5 h-5\">\n            <path fillRule=\"evenodd\" d=\"M2 4.75A.75.75 0 012.75 4h14.5a.75.75 0 010 1.5H2.75A.75.75 0 012 4.75zm0 10.5a.75.75 0 01.75-.75h14.5a.75.75 0 010 1.5H2.75a.75.75 0 01-.75-.75zM2 10a.75.75 0 01.75-.75h7.5a.75.75 0 010 1.5h-7.5A.75.75 0 012 10z\" clipRule=\"evenodd\" />\n          </svg>\n        )}\n        </button>\n      )}\n\n      {isOpen && (\n        <div \n          className=\"absolute right-0 mt-2 w-64 max-w-[calc(100vw-1rem)] bg-white dark:bg-gray-800 rounded-md shadow-lg z-50 border border-gray-300 dark:border-gray-600\"\n          role=\"dialog\"\n          aria-modal=\"true\"\n          aria-labelledby=\"table-column-config-title\"\n        >\n          <div className=\"px-3 py-2.5 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between\">\n            <h3 id=\"table-column-config-title\" className=\"text-sm font-semibold text-gray-900 dark:text-white\">{defaultModalTitle}</h3>\n            <button\n              onClick={handleClose}\n              className=\"inline-flex items-center justify-center p-2 rounded-md bg-transparent text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-300 transition-colors duration-150\"\n              title={t('common.close')}\n            >\n              <XMarkIcon className=\"w-5 h-5\" />\n            </button>\n          </div>\n          <ul className=\"px-2 py-1 max-h-64 overflow-y-auto\">\n            {sortedColumns.map((column, index) => {\n              const isVisible = visibleColumns.includes(column.id);\n              // Prfe ob diese Spalte die Hauptsortierung ist\n              const isMainSort = mainSortConfig?.key === column.id;\n              const sortDirection = isMainSort ? mainSortConfig.direction : undefined;\n              // Sort-Button fr alle Spalten anzeigen (unabhngig von Sichtbarkeit)\n              const showSortButton = showMainSort && onMainSortChange;\n              \n              return (\n                <DraggableColumnItem\n                  key={column.id}\n                  id={column.id}\n                  label={column.label}\n                  index={index}\n                  isVisible={isVisible}\n                  onToggleVisibility={onToggleColumnVisibility}\n                  sortDirection={sortDirection}\n                  onSortDirectionChange={showSortButton ? onMainSortChange : undefined}\n                  showMainSort={showMainSort}\n                  isMainSort={isMainSort}\n                />\n              );\n            })}\n          </ul>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default TableColumnConfig; ","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, UserIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface CertificateCreationModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onCertificateCreated: () => void;\n  userId: number;\n  userName: string;\n}\n\ninterface UserData {\n  firstName: string;\n  lastName: string;\n  identificationNumber: string | null;\n  contractStartDate: string | null;\n  contractEndDate: string | null;\n  contractType: string | null;\n  salary: number | null;\n  position: string | null;\n}\n\nconst CertificateCreationModal: React.FC<CertificateCreationModalProps> = ({\n  isOpen,\n  onClose,\n  onCertificateCreated,\n  userId,\n  userName\n}) => {\n  const { t } = useTranslation();\n  const { user: currentUser } = useAuth();\n  const { isHR, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [activeTab, setActiveTab] = useState<'data' | 'text'>('data');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [userData, setUserData] = useState<UserData | null>(null);\n  const [issueDate, setIssueDate] = useState(new Date().toISOString().split('T')[0]);\n  const [certificateType, setCertificateType] = useState('employment');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [uploading, setUploading] = useState(false);\n  const [availableTemplates, setAvailableTemplates] = useState<Array<{type: string; version: string; path: string}>>([]);\n  const [selectedTemplate, setSelectedTemplate] = useState<string | null>(null);\n  const [useTemplate, setUseTemplate] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR() && !isAdmin()) {\n      showMessage('Nur HR oder Admin knnen Arbeitszeugnisse erstellen', 'error');\n      onClose();\n    }\n  }, [isHR, isAdmin, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      fetchUserData();\n      fetchTemplates();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const fetchTemplates = async () => {\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.DOCUMENT_TEMPLATES);\n      const documentTemplates = response.data.documentTemplates || {};\n      const templates: Array<{type: string; version: string; path: string}> = [];\n      \n      if (documentTemplates.employmentCertificate) {\n        templates.push({\n          type: 'employmentCertificate',\n          version: documentTemplates.employmentCertificate.version,\n          path: documentTemplates.employmentCertificate.path\n        });\n      }\n      \n      setAvailableTemplates(templates);\n      if (templates.length > 0) {\n        setSelectedTemplate(templates[0].type);\n        setUseTemplate(true);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der Templates:', err);\n      // Kein Fehler anzeigen, Templates sind optional\n    }\n  };\n\n  const fetchUserData = async () => {\n    try {\n      const [userResponse, lifecycleResponse] = await Promise.all([\n        axiosInstance.get(API_ENDPOINTS.USERS.BY_ID(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.BY_USER(userId))\n      ]);\n\n      const user = userResponse.data;\n      const lifecycle = lifecycleResponse.data.lifecycle;\n\n      const userDataObj = {\n        firstName: user.firstName || '',\n        lastName: user.lastName || '',\n        identificationNumber: user.identificationNumber || null,\n        contractStartDate: lifecycle?.contractStartDate || null,\n        contractEndDate: lifecycle?.contractEndDate || null,\n        contractType: lifecycle?.contractType || null,\n        salary: user.salary || null,\n        position: null // TODO: Aus Rollen ableiten\n      };\n\n      setUserData(userDataObj);\n\n      // Automatische Vorausfllung: Ausstellungsdatum auf heute setzen (wenn noch nicht gesetzt)\n      if (!issueDate || issueDate === new Date().toISOString().split('T')[0]) {\n        setIssueDate(new Date().toISOString().split('T')[0]);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der User-Daten:', err);\n      setError('Fehler beim Laden der Daten');\n    }\n  };\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) { // 10MB\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      setUseTemplate(false); // Deaktiviere Template wenn PDF hochgeladen wird\n      // Erstelle Preview-URL\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n    }\n  };\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const validateForm = (): string | null => {\n    if (!useTemplate && !pdfFile) {\n      return 'Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch';\n    }\n    if (!issueDate) {\n      return 'Bitte geben Sie ein Ausstellungsdatum an';\n    }\n    const issueDateObj = new Date(issueDate);\n    if (isNaN(issueDateObj.getTime())) {\n      return 'Ungltiges Ausstellungsdatum';\n    }\n    if (issueDateObj > new Date()) {\n      return 'Ausstellungsdatum darf nicht in der Zukunft liegen';\n    }\n    return null;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Client-seitige Validierung\n    const validationError = validateForm();\n    if (validationError) {\n      setError(validationError);\n      showMessage(validationError, 'error');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      let pdfPath: string | undefined = undefined;\n      let templateUsed: string | null = null;\n      let templateVersion: string | null = null;\n\n      // Wenn Template verwendet werden soll und kein PDF hochgeladen wurde\n      if (useTemplate && selectedTemplate && !pdfFile) {\n        const template = availableTemplates.find(t => t.type === selectedTemplate);\n        if (template) {\n          templateUsed = template.type;\n          templateVersion = template.version;\n          // PDF wird vom Backend generiert\n        }\n      } else if (pdfFile) {\n        // PDF wurde hochgeladen - verwende dieses\n        pdfPath = `temp-${Date.now()}-${pdfFile.name}`; // Temporr\n      } else {\n        showMessage('Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch', 'error');\n        setLoading(false);\n        return;\n      }\n\n      const certificateData = {\n        certificateType,\n        issueDate: new Date(issueDate),\n        pdfPath,\n        templateUsed,\n        templateVersion\n      };\n\n      await axiosInstance.post(\n        API_ENDPOINTS.LIFECYCLE.CERTIFICATES(userId),\n        certificateData\n      );\n\n      showMessage('Arbeitszeugnis erfolgreich erstellt', 'success');\n      onCertificateCreated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      setIssueDate(new Date().toISOString().split('T')[0]);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Erstellen des Arbeitszeugnisses:', err);\n      setError(err.response?.data?.message || 'Fehler beim Erstellen des Arbeitszeugnisses');\n      showMessage('Fehler beim Erstellen des Arbeitszeugnisses', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR() && !isAdmin()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {/* Overlay - nur auf Mobile und Desktop (nicht Large Desktop) */}\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n            ${isMobile ? '' : 'sidepane-panel-container'}\n          `}\n          style={{\n            animation: isMobile ? 'none' : 'slideIn 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94)'\n          }}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitszeugnis erstellen\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            <div className=\"mb-4\">\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                Fr: <span className=\"font-medium dark:text-white\">{userName}</span>\n              </p>\n            </div>\n\n            {/* Tabs */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6\">\n              <nav className=\"-mb-px flex space-x-4\">\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('data')}\n                  className={`${\n                    activeTab === 'data'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  Daten\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('text')}\n                  className={`${\n                    activeTab === 'text'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  PDF hochladen\n                </button>\n              </nav>\n            </div>\n\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            {/* Tab Content */}\n            {activeTab === 'data' && (\n              <div className=\"space-y-4\">\n                <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-4\">\n                  <h3 className=\"text-sm font-semibold dark:text-white mb-3\">\n                    Automatisch erkannte Daten\n                  </h3>\n                  <div className=\"space-y-2 text-sm\">\n                    {userData && (\n                      <>\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4 text-gray-400\" />\n                          <span className=\"text-gray-600 dark:text-gray-400\">Name:</span>\n                          <span className=\"dark:text-white\">\n                            {userData.firstName} {userData.lastName}\n                          </span>\n                        </div>\n                        {userData.identificationNumber && (\n                          <div className=\"flex items-center space-x-2\">\n                            <DocumentTextIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Cdula:</span>\n                            <span className=\"dark:text-white\">{userData.identificationNumber}</span>\n                          </div>\n                        )}\n                        {userData.contractStartDate && (\n                          <div className=\"flex items-center space-x-2\">\n                            <CalendarIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Eintrittsdatum:</span>\n                            <span className=\"dark:text-white\">\n                              {new Date(userData.contractStartDate).toLocaleDateString('de-DE')}\n                            </span>\n                          </div>\n                        )}\n                        {userData.contractEndDate && (\n                          <div className=\"flex items-center space-x-2\">\n                            <CalendarIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Austrittsdatum:</span>\n                            <span className=\"dark:text-white\">\n                              {new Date(userData.contractEndDate).toLocaleDateString('de-DE')}\n                            </span>\n                          </div>\n                        )}\n                      </>\n                    )}\n                  </div>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Ausstellungsdatum <span className=\"text-red-500\">*</span>\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={issueDate}\n                    onChange={(e) => {\n                      const value = e.target.value;\n                      setIssueDate(value);\n                      // Validierung: Datum darf nicht in der Zukunft liegen\n                      if (value && new Date(value) > new Date()) {\n                        setError('Ausstellungsdatum darf nicht in der Zukunft liegen');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    max={new Date().toISOString().split('T')[0]}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && issueDate && new Date(issueDate) > new Date()\n                        ? 'border-red-500 dark:border-red-500' \n                        : error && !issueDate\n                        ? 'border-red-500 dark:border-red-500'\n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    required\n                    aria-invalid={(!issueDate || (issueDate && new Date(issueDate) > new Date())) ? true : undefined}\n                    aria-describedby={(!issueDate || (issueDate && new Date(issueDate) > new Date())) ? \"issueDate-error\" : undefined}\n                  />\n                  {error && (!issueDate || (issueDate && new Date(issueDate) > new Date())) && (\n                    <p id=\"issueDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                  {!error && (\n                    <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                      Das Datum darf nicht in der Zukunft liegen\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Zertifikat-Typ <span className=\"text-red-500\">*</span>\n                  </label>\n                  <select\n                    value={certificateType}\n                    onChange={(e) => setCertificateType(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    required\n                  >\n                    <option value=\"employment\">Arbeitszeugnis</option>\n                    <option value=\"salary\">Gehaltsbescheinigung</option>\n                    <option value=\"work_experience\">Arbeitsbescheinigung</option>\n                  </select>\n                </div>\n              </div>\n            )}\n\n            {activeTab === 'text' && (\n              <div className=\"space-y-4\">\n                {/* Template-Auswahl */}\n                {availableTemplates.length > 0 && (\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      Template verwenden\n                    </label>\n                    <div className=\"flex items-center space-x-3 mb-4\">\n                      <input\n                        type=\"checkbox\"\n                        checked={useTemplate}\n                        onChange={(e) => {\n                          setUseTemplate(e.target.checked);\n                          if (e.target.checked && pdfFile) {\n                            // Wenn Template aktiviert wird, entferne PDF\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                          }\n                        }}\n                        className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                      />\n                      <label className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        Template fr automatische PDF-Generierung verwenden\n                      </label>\n                    </div>\n                    {useTemplate && (\n                      <select\n                        value={selectedTemplate || ''}\n                        onChange={(e) => setSelectedTemplate(e.target.value)}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white mb-4\"\n                      >\n                        {availableTemplates.map((template) => (\n                          <option key={template.type} value={template.type}>\n                            Arbeitszeugnis (Version {template.version})\n                          </option>\n                        ))}\n                      </select>\n                    )}\n                  </div>\n                )}\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                    {useTemplate ? 'ODER PDF-Datei hochladen' : 'PDF-Datei hochladen'} {!useTemplate && <span className=\"text-red-500\">*</span>}\n                  </label>\n                  <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                    <input\n                      ref={fileInputRef}\n                      type=\"file\"\n                      accept=\".pdf\"\n                      onChange={handleFileSelect}\n                      className=\"hidden\"\n                    />\n                    {!pdfFile ? (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                        <button\n                          type=\"button\"\n                          onClick={() => fileInputRef.current?.click()}\n                          className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                        >\n                          PDF-Datei auswhlen\n                        </button>\n                        <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                          oder Datei hierher ziehen\n                        </p>\n                        <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                          Max. 10MB\n                        </p>\n                      </div>\n                    ) : (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                        <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                          {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                        </p>\n                        <button\n                          type=\"button\"\n                          onClick={() => {\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                            if (fileInputRef.current) {\n                              fileInputRef.current.value = '';\n                            }\n                          }}\n                          className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                        >\n                          Datei entfernen\n                        </button>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* PDF-Vorschau */}\n                {pdfPreviewUrl && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl}#view=FitH`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n\n              </div>\n            )}\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading || (!pdfFile && !useTemplate)}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird erstellt...' : 'Erstellen'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default CertificateCreationModal;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, UserIcon, CurrencyDollarIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface ContractCreationModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onContractCreated: () => void;\n  userId: number;\n  userName: string;\n}\n\ninterface UserData {\n  firstName: string;\n  lastName: string;\n  identificationNumber: string | null;\n  contractStartDate: string | null;\n  contractEndDate: string | null;\n  contractType: string | null;\n  salary: number | null;\n  position: string | null;\n}\n\nconst ContractCreationModal: React.FC<ContractCreationModalProps> = ({\n  isOpen,\n  onClose,\n  onContractCreated,\n  userId,\n  userName\n}) => {\n  const { t } = useTranslation();\n  const { user: currentUser } = useAuth();\n  const { isHR, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [activeTab, setActiveTab] = useState<'data' | 'text'>('data');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [userData, setUserData] = useState<UserData | null>(null);\n  const [contractType, setContractType] = useState('employment');\n  const [startDate, setStartDate] = useState(new Date().toISOString().split('T')[0]);\n  const [endDate, setEndDate] = useState<string>('');\n  const [salary, setSalary] = useState<string>('');\n  const [workingHours, setWorkingHours] = useState<string>('');\n  const [position, setPosition] = useState<string>('');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [availableTemplates, setAvailableTemplates] = useState<Array<{type: string; version: string; path: string}>>([]);\n  const [selectedTemplate, setSelectedTemplate] = useState<string | null>(null);\n  const [useTemplate, setUseTemplate] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR() && !isAdmin()) {\n      showMessage('Nur HR oder Admin knnen Arbeitsvertrge erstellen', 'error');\n      onClose();\n    }\n  }, [isHR, isAdmin, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      fetchUserData();\n      fetchTemplates();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const fetchTemplates = async () => {\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.DOCUMENT_TEMPLATES);\n      const documentTemplates = response.data.documentTemplates || {};\n      const templates: Array<{type: string; version: string; path: string}> = [];\n      \n      if (documentTemplates.employmentContract) {\n        templates.push({\n          type: 'employmentContract',\n          version: documentTemplates.employmentContract.version,\n          path: documentTemplates.employmentContract.path\n        });\n      }\n      \n      setAvailableTemplates(templates);\n      if (templates.length > 0) {\n        setSelectedTemplate(templates[0].type);\n        setUseTemplate(true);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der Templates:', err);\n      // Kein Fehler anzeigen, Templates sind optional\n    }\n  };\n\n  const fetchUserData = async () => {\n    try {\n      const [userResponse, lifecycleResponse] = await Promise.all([\n        axiosInstance.get(API_ENDPOINTS.USERS.BY_ID(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.BY_USER(userId))\n      ]);\n\n      const user = userResponse.data;\n      const lifecycle = lifecycleResponse.data.lifecycle;\n\n      const data: UserData = {\n        firstName: user.firstName || '',\n        lastName: user.lastName || '',\n        identificationNumber: user.identificationNumber || null,\n        contractStartDate: lifecycle?.contractStartDate || null,\n        contractEndDate: lifecycle?.contractEndDate || null,\n        contractType: lifecycle?.contractType || null,\n        salary: user.salary || null,\n        position: null\n      };\n\n      setUserData(data);\n      \n      // Setze Standard-Werte\n      if (data.contractStartDate) {\n        setStartDate(new Date(data.contractStartDate).toISOString().split('T')[0]);\n      }\n      if (data.contractEndDate) {\n        setEndDate(new Date(data.contractEndDate).toISOString().split('T')[0]);\n      }\n      if (data.salary) {\n        setSalary(data.salary.toString());\n      }\n      if (data.contractType) {\n        setContractType(data.contractType);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der User-Daten:', err);\n      setError('Fehler beim Laden der Daten');\n    }\n  };\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) { // 10MB\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      setUseTemplate(false); // Deaktiviere Template wenn PDF hochgeladen wird\n      // Erstelle Preview-URL\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n    }\n  };\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const validateForm = (): string | null => {\n    if (!useTemplate && !pdfFile) {\n      return 'Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch';\n    }\n    if (!startDate) {\n      return 'Bitte geben Sie ein Startdatum an';\n    }\n    const startDateObj = new Date(startDate);\n    if (isNaN(startDateObj.getTime())) {\n      return 'Ungltiges Startdatum';\n    }\n    if (endDate) {\n      const endDateObj = new Date(endDate);\n      if (isNaN(endDateObj.getTime())) {\n        return 'Ungltiges Enddatum';\n      }\n      if (endDateObj < startDateObj) {\n        return 'Enddatum muss nach dem Startdatum liegen';\n      }\n    }\n    if (salary && parseFloat(salary) < 0) {\n      return 'Gehalt darf nicht negativ sein';\n    }\n    if (workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168)) {\n      return 'Arbeitsstunden mssen zwischen 0 und 168 liegen';\n    }\n    return null;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Client-seitige Validierung\n    const validationError = validateForm();\n    if (validationError) {\n      setError(validationError);\n      showMessage(validationError, 'error');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      let pdfPath: string | undefined = undefined;\n      let templateUsed: string | null = null;\n      let templateVersion: string | null = null;\n\n      // Wenn Template verwendet werden soll und kein PDF hochgeladen wurde\n      if (useTemplate && selectedTemplate && !pdfFile) {\n        const template = availableTemplates.find(t => t.type === selectedTemplate);\n        if (template) {\n          templateUsed = template.type;\n          templateVersion = template.version;\n          // PDF wird vom Backend generiert\n        }\n      } else if (pdfFile) {\n        // PDF wurde hochgeladen - verwende dieses\n        pdfPath = `temp-${Date.now()}-${pdfFile.name}`; // Temporr\n      } else {\n        showMessage('Bitte whlen Sie ein Template oder laden Sie eine PDF-Datei hoch', 'error');\n        setLoading(false);\n        return;\n      }\n\n      const contractData = {\n        contractType,\n        startDate: new Date(startDate),\n        endDate: endDate ? new Date(endDate) : null,\n        salary: salary ? parseFloat(salary) : null,\n        workingHours: workingHours ? parseFloat(workingHours) : null,\n        position: position || null,\n        pdfPath,\n        templateUsed,\n        templateVersion\n      };\n\n      await axiosInstance.post(\n        API_ENDPOINTS.LIFECYCLE.CONTRACTS(userId),\n        contractData\n      );\n\n      showMessage('Arbeitsvertrag erfolgreich erstellt', 'success');\n      onContractCreated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      setStartDate(new Date().toISOString().split('T')[0]);\n      setEndDate('');\n      setSalary('');\n      setWorkingHours('');\n      setPosition('');\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Erstellen des Arbeitsvertrags:', err);\n      setError(err.response?.data?.message || 'Fehler beim Erstellen des Arbeitsvertrags');\n      showMessage('Fehler beim Erstellen des Arbeitsvertrags', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR() && !isAdmin()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {/* Overlay */}\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n            ${isMobile ? '' : 'sidepane-panel-container'}\n          `}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitsvertrag erstellen\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            <div className=\"mb-4\">\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                Fr: <span className=\"font-medium dark:text-white\">{userName}</span>\n              </p>\n            </div>\n\n            {/* Tabs */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6\">\n              <nav className=\"-mb-px flex space-x-4\">\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('data')}\n                  className={`${\n                    activeTab === 'data'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  Vertragsdaten\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={() => setActiveTab('text')}\n                  className={`${\n                    activeTab === 'text'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                >\n                  PDF hochladen\n                </button>\n              </nav>\n            </div>\n\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            {/* Tab Content */}\n            {activeTab === 'data' && (\n              <div className=\"space-y-4\">\n                <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-4\">\n                  <h3 className=\"text-sm font-semibold dark:text-white mb-3\">\n                    Automatisch erkannte Daten\n                  </h3>\n                  <div className=\"space-y-2 text-sm\">\n                    {userData && (\n                      <>\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4 text-gray-400\" />\n                          <span className=\"text-gray-600 dark:text-gray-400\">Name:</span>\n                          <span className=\"dark:text-white\">\n                            {userData.firstName} {userData.lastName}\n                          </span>\n                        </div>\n                        {userData.identificationNumber && (\n                          <div className=\"flex items-center space-x-2\">\n                            <DocumentTextIcon className=\"h-4 w-4 text-gray-400\" />\n                            <span className=\"text-gray-600 dark:text-gray-400\">Cdula:</span>\n                            <span className=\"dark:text-white\">{userData.identificationNumber}</span>\n                          </div>\n                        )}\n                      </>\n                    )}\n                  </div>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Vertragstyp <span className=\"text-red-500\">*</span>\n                  </label>\n                  <select\n                    value={contractType}\n                    onChange={(e) => setContractType(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  >\n                    <option value=\"employment\">Arbeitsvertrag</option>\n                    <option value=\"amendment\">Vertragsnderung</option>\n                    <option value=\"extension\">Vertragsverlngerung</option>\n                  </select>\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Startdatum <span className=\"text-red-500\">*</span>\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={startDate}\n                    onChange={(e) => {\n                      setStartDate(e.target.value);\n                      setError(null); // Clear error when user starts typing\n                    }}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && !startDate \n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    required\n                    aria-invalid={!startDate}\n                    aria-describedby={!startDate ? \"startDate-error\" : undefined}\n                  />\n                  {error && !startDate && (\n                    <p id=\"startDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Enddatum (optional)\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={endDate}\n                    onChange={(e) => {\n                      setEndDate(e.target.value);\n                      // Wenn Enddatum gesetzt wird, prfe ob es nach Startdatum liegt\n                      if (e.target.value && startDate && new Date(e.target.value) < new Date(startDate)) {\n                        setError('Enddatum muss nach dem Startdatum liegen');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    min={startDate || undefined}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && endDate && startDate && new Date(endDate) < new Date(startDate)\n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    aria-invalid={endDate && startDate && new Date(endDate) < new Date(startDate) ? true : undefined}\n                    aria-describedby={endDate && startDate && new Date(endDate) < new Date(startDate) ? \"endDate-error\" : undefined}\n                  />\n                  {error && endDate && startDate && new Date(endDate) < new Date(startDate) && (\n                    <p id=\"endDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Position\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={position}\n                    onChange={(e) => setPosition(e.target.value)}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    placeholder=\"z.B. Frontend-Entwickler\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Gehalt (optional)\n                  </label>\n                  <div className=\"relative\">\n                    <CurrencyDollarIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                    <input\n                      type=\"number\"\n                      value={salary}\n                      onChange={(e) => {\n                        const value = e.target.value;\n                        setSalary(value);\n                        // Validierung: Gehalt darf nicht negativ sein\n                        if (value && parseFloat(value) < 0) {\n                          setError('Gehalt darf nicht negativ sein');\n                        } else {\n                          setError(null); // Clear error when valid\n                        }\n                      }}\n                      className={`w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                        error && salary && parseFloat(salary) < 0\n                          ? 'border-red-500 dark:border-red-500' \n                          : 'border-gray-300 dark:border-gray-600'\n                      }`}\n                      placeholder=\"0.00\"\n                      step=\"0.01\"\n                      min=\"0\"\n                      aria-invalid={salary && parseFloat(salary) < 0 ? true : undefined}\n                      aria-describedby={salary && parseFloat(salary) < 0 ? \"salary-error\" : undefined}\n                    />\n                  </div>\n                  {error && salary && parseFloat(salary) < 0 && (\n                    <p id=\"salary-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Arbeitsstunden/Woche (optional)\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={workingHours}\n                    onChange={(e) => {\n                      const value = e.target.value;\n                      setWorkingHours(value);\n                      // Validierung: Arbeitsstunden mssen zwischen 0 und 168 liegen\n                      if (value && (parseFloat(value) < 0 || parseFloat(value) > 168)) {\n                        setError('Arbeitsstunden mssen zwischen 0 und 168 liegen');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168)\n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    placeholder=\"40\"\n                    step=\"0.1\"\n                    min=\"0\"\n                    max=\"168\"\n                    aria-invalid={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? true : undefined}\n                    aria-describedby={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? \"workingHours-error\" : undefined}\n                  />\n                  {error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) && (\n                    <p id=\"workingHours-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                      {error}\n                    </p>\n                  )}\n                  <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                    Maximal 168 Stunden pro Woche (24h  7 Tage)\n                  </p>\n                </div>\n              </div>\n            )}\n\n            {activeTab === 'text' && (\n              <div className=\"space-y-4\">\n                {/* Template-Auswahl */}\n                {availableTemplates.length > 0 && (\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      Template verwenden\n                    </label>\n                    <div className=\"flex items-center space-x-3 mb-4\">\n                      <input\n                        type=\"checkbox\"\n                        checked={useTemplate}\n                        onChange={(e) => {\n                          setUseTemplate(e.target.checked);\n                          if (e.target.checked && pdfFile) {\n                            // Wenn Template aktiviert wird, entferne PDF\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                          }\n                        }}\n                        className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                      />\n                      <label className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        Template fr automatische PDF-Generierung verwenden\n                      </label>\n                    </div>\n                    {useTemplate && (\n                      <select\n                        value={selectedTemplate || ''}\n                        onChange={(e) => setSelectedTemplate(e.target.value)}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white mb-4\"\n                      >\n                        {availableTemplates.map((template) => (\n                          <option key={template.type} value={template.type}>\n                            Arbeitsvertrag (Version {template.version})\n                          </option>\n                        ))}\n                      </select>\n                    )}\n                  </div>\n                )}\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                    {useTemplate ? 'ODER PDF-Datei hochladen' : 'PDF-Datei hochladen'} {!useTemplate && <span className=\"text-red-500\">*</span>}\n                  </label>\n                  <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                    <input\n                      ref={fileInputRef}\n                      type=\"file\"\n                      accept=\".pdf\"\n                      onChange={handleFileSelect}\n                      className=\"hidden\"\n                    />\n                    {!pdfFile ? (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                        <button\n                          type=\"button\"\n                          onClick={() => fileInputRef.current?.click()}\n                          className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                        >\n                          PDF-Datei auswhlen\n                        </button>\n                        <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                          oder Datei hierher ziehen\n                        </p>\n                        <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                          Max. 10MB\n                        </p>\n                      </div>\n                    ) : (\n                      <div>\n                        <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                        <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                          {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                        </p>\n                        <button\n                          type=\"button\"\n                          onClick={() => {\n                            setPdfFile(null);\n                            if (pdfPreviewUrl) {\n                              URL.revokeObjectURL(pdfPreviewUrl);\n                              setPdfPreviewUrl(null);\n                            }\n                            if (fileInputRef.current) {\n                              fileInputRef.current.value = '';\n                            }\n                          }}\n                          className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                        >\n                          Datei entfernen\n                        </button>\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                {/* PDF-Vorschau */}\n                {pdfPreviewUrl && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl}#view=FitH`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n\n              </div>\n            )}\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading || (!pdfFile && !useTemplate) || !startDate}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird erstellt...' : 'Erstellen'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default ContractCreationModal;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface Certificate {\n  id: number;\n  certificateType: string;\n  issueDate: string;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n}\n\ninterface CertificateEditModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onCertificateUpdated: () => void;\n  userId: number;\n  certificate: Certificate;\n}\n\nconst CertificateEditModal: React.FC<CertificateEditModalProps> = ({\n  isOpen,\n  onClose,\n  onCertificateUpdated,\n  userId,\n  certificate\n}) => {\n  const { t } = useTranslation();\n  const { isHR, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [issueDate, setIssueDate] = useState(\n    certificate.issueDate ? new Date(certificate.issueDate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0]\n  );\n  const [certificateType, setCertificateType] = useState(certificate.certificateType || 'employment');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [existingPdfUrl, setExistingPdfUrl] = useState<string | null>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR() && !isAdmin()) {\n      showMessage('Nur HR oder Admin knnen Arbeitszeugnisse bearbeiten', 'error');\n      onClose();\n    }\n  }, [isHR, isAdmin, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      // Lade bestehende PDF-URL wenn vorhanden\n      if (certificate.id) {\n        setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CERTIFICATE_DOWNLOAD(userId, certificate.id));\n      }\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane, certificate.id, userId]);\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) {\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      // Erstelle Preview-URL fr neue Datei\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n      setExistingPdfUrl(null); // Verstecke bestehende PDF wenn neue hochgeladen wird\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const updateData: any = {\n        issueDate: new Date(issueDate),\n        certificateType\n      };\n\n      // Nur pdfPath aktualisieren, wenn neue Datei hochgeladen wurde\n      if (pdfFile) {\n        updateData.pdfPath = `temp-${Date.now()}-${pdfFile.name}`;\n        updateData.templateVersion = certificate.templateVersion || '1.0';\n      }\n\n      await axiosInstance.put(\n        API_ENDPOINTS.LIFECYCLE.CERTIFICATE(userId, certificate.id),\n        updateData\n      );\n\n      showMessage('Arbeitszeugnis erfolgreich aktualisiert', 'success');\n      onCertificateUpdated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Aktualisieren des Arbeitszeugnisses:', err);\n      setError(err.response?.data?.message || 'Fehler beim Aktualisieren des Arbeitszeugnisses');\n      showMessage('Fehler beim Aktualisieren des Arbeitszeugnisses', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR() && !isAdmin()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n            ${isMobile ? '' : 'sidepane-panel-container'}\n          `}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitszeugnis bearbeiten\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Ausstellungsdatum\n                </label>\n                <input\n                  type=\"date\"\n                  value={issueDate}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setIssueDate(value);\n                    // Validierung: Datum darf nicht in der Zukunft liegen\n                    if (value && new Date(value) > new Date()) {\n                      setError('Ausstellungsdatum darf nicht in der Zukunft liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  max={new Date().toISOString().split('T')[0]}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && issueDate && new Date(issueDate) > new Date()\n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  aria-invalid={issueDate && new Date(issueDate) > new Date() ? true : undefined}\n                  aria-describedby={issueDate && new Date(issueDate) > new Date() ? \"issueDate-error\" : undefined}\n                />\n                {error && issueDate && new Date(issueDate) > new Date() && (\n                  <p id=\"issueDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n                {!error && (\n                  <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                    Das Datum darf nicht in der Zukunft liegen\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Zertifikat-Typ\n                </label>\n                <select\n                  value={certificateType}\n                  onChange={(e) => setCertificateType(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                >\n                  <option value=\"employment\">Arbeitszeugnis</option>\n                  <option value=\"salary\">Gehaltsbescheinigung</option>\n                  <option value=\"work_experience\">Arbeitsbescheinigung</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  PDF-Datei aktualisieren (optional)\n                </label>\n                <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept=\".pdf\"\n                    onChange={handleFileSelect}\n                    className=\"hidden\"\n                  />\n                  {!pdfFile ? (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                      <button\n                        type=\"button\"\n                        onClick={() => fileInputRef.current?.click()}\n                        className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                      >\n                        Neue PDF-Datei auswhlen\n                      </button>\n                      <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                        oder Datei hierher ziehen\n                      </p>\n                      <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                        Max. 10MB\n                      </p>\n                    </div>\n                  ) : (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                      <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                      <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                        {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                      </p>\n                      <button\n                        type=\"button\"\n                        onClick={() => {\n                          setPdfFile(null);\n                          if (pdfPreviewUrl) {\n                            URL.revokeObjectURL(pdfPreviewUrl);\n                            setPdfPreviewUrl(null);\n                          }\n                          setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CERTIFICATE_DOWNLOAD(userId, certificate.id));\n                          if (fileInputRef.current) {\n                            fileInputRef.current.value = '';\n                          }\n                        }}\n                        className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                      >\n                        Datei entfernen\n                      </button>\n                    </div>\n                  )}\n                </div>\n\n                {/* PDF-Vorschau */}\n                {(pdfPreviewUrl || existingPdfUrl) && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl || existingPdfUrl}${pdfPreviewUrl ? '#view=FitH' : '?preview=true#view=FitH'}`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 p-4\">\n                <p className=\"text-sm text-yellow-700 dark:text-yellow-300\">\n                  <strong>Hinweis:</strong> Wenn Sie eine neue PDF-Datei hochladen, wird die alte Version ersetzt.\n                  Eine neue Version wird erstellt (isLatest = true).\n                </p>\n              </div>\n            </form>\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird aktualisiert...' : 'Aktualisieren'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default CertificateEditModal;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, DocumentTextIcon, CalendarIcon, CurrencyDollarIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface Contract {\n  id: number;\n  contractType: string;\n  startDate: string;\n  endDate: string | null;\n  salary: number | null;\n  workingHours: number | null;\n  position: string | null;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n}\n\ninterface ContractEditModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onContractUpdated: () => void;\n  userId: number;\n  contract: Contract;\n}\n\nconst ContractEditModal: React.FC<ContractEditModalProps> = ({\n  isOpen,\n  onClose,\n  onContractUpdated,\n  userId,\n  contract\n}) => {\n  const { t } = useTranslation();\n  const { isHR, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [contractType, setContractType] = useState(contract.contractType || 'employment');\n  const [startDate, setStartDate] = useState(\n    contract.startDate ? new Date(contract.startDate).toISOString().split('T')[0] : new Date().toISOString().split('T')[0]\n  );\n  const [endDate, setEndDate] = useState(\n    contract.endDate ? new Date(contract.endDate).toISOString().split('T')[0] : ''\n  );\n  const [salary, setSalary] = useState(contract.salary ? contract.salary.toString() : '');\n  const [workingHours, setWorkingHours] = useState(contract.workingHours ? contract.workingHours.toString() : '');\n  const [position, setPosition] = useState(contract.position || '');\n  const [pdfFile, setPdfFile] = useState<File | null>(null);\n  const [pdfPreviewUrl, setPdfPreviewUrl] = useState<string | null>(null);\n  const [existingPdfUrl, setExistingPdfUrl] = useState<string | null>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  // Prfe Berechtigung (nur wenn Berechtigungen geladen sind)\n  useEffect(() => {\n    if (permissionsLoading) {\n      return; // Warte bis Berechtigungen geladen sind\n    }\n    \n    if (!isHR() && !isAdmin()) {\n      showMessage('Nur HR oder Admin knnen Arbeitsvertrge bearbeiten', 'error');\n      onClose();\n    }\n  }, [isHR, isAdmin, permissionsLoading, onClose, showMessage]);\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      // Lade bestehende PDF-URL wenn vorhanden\n      if (contract.id) {\n        setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CONTRACT_DOWNLOAD(userId, contract.id));\n      }\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane, contract.id, userId]);\n\n  // Cleanup: Revoke Object URL beim Unmount oder wenn Datei entfernt wird\n  useEffect(() => {\n    return () => {\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n      }\n    };\n  }, [pdfPreviewUrl]);\n\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      if (file.type !== 'application/pdf') {\n        showMessage('Nur PDF-Dateien sind erlaubt', 'error');\n        return;\n      }\n      if (file.size > 10 * 1024 * 1024) {\n        showMessage('Datei ist zu gro (max. 10MB)', 'error');\n        return;\n      }\n      setPdfFile(file);\n      // Erstelle Preview-URL fr neue Datei\n      const url = URL.createObjectURL(file);\n      setPdfPreviewUrl(url);\n      setExistingPdfUrl(null); // Verstecke bestehende PDF wenn neue hochgeladen wird\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!startDate) {\n      showMessage('Bitte geben Sie ein Startdatum an', 'error');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const updateData: any = {\n        contractType,\n        startDate: new Date(startDate),\n        endDate: endDate ? new Date(endDate) : null,\n        salary: salary ? parseFloat(salary) : null,\n        workingHours: workingHours ? parseFloat(workingHours) : null,\n        position: position || null\n      };\n\n      // Nur pdfPath aktualisieren, wenn neue Datei hochgeladen wurde\n      if (pdfFile) {\n        updateData.pdfPath = `temp-${Date.now()}-${pdfFile.name}`;\n        updateData.templateVersion = contract.templateVersion || '1.0';\n      }\n\n      await axiosInstance.put(\n        API_ENDPOINTS.LIFECYCLE.CONTRACT(userId, contract.id),\n        updateData\n      );\n\n      showMessage('Arbeitsvertrag erfolgreich aktualisiert', 'success');\n      onContractUpdated();\n      onClose();\n      \n      // Reset form\n      if (pdfPreviewUrl) {\n        URL.revokeObjectURL(pdfPreviewUrl);\n        setPdfPreviewUrl(null);\n      }\n      setPdfFile(null);\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Aktualisieren des Arbeitsvertrags:', err);\n      setError(err.response?.data?.message || 'Fehler beim Aktualisieren des Arbeitsvertrags');\n      showMessage('Fehler beim Aktualisieren des Arbeitsvertrags', 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isHR() && !isAdmin()) {\n    return null;\n  }\n\n  return (\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n      {(!isLargeScreen || isMobile) && (\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n      )}\n\n      <div className=\"fixed inset-0 flex items-start justify-end p-0 sm:p-0\">\n        <Dialog.Panel\n          className={`\n            ${isMobile ? 'w-full h-full' : isLargeScreen ? 'w-[600px]' : 'w-[600px]'}\n            ${isMobile ? '' : 'top-16'}\n            bg-white dark:bg-gray-800 shadow-xl\n            transform transition-transform duration-350 ease-out\n            ${isMobile ? 'rounded-none' : 'rounded-l-lg'}\n            flex flex-col\n            max-h-[calc(100vh-4rem)]\n            ${isMobile ? '' : 'sidepane-panel-container'}\n          `}\n        >\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <div className=\"flex items-center space-x-3\">\n              <DocumentTextIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n              <Dialog.Title className=\"text-xl font-semibold dark:text-white\">\n                Arbeitsvertrag bearbeiten\n              </Dialog.Title>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n            >\n              <XMarkIcon className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          {/* Content */}\n          <div className=\"flex-1 overflow-y-auto p-6\">\n            {error && (\n              <div className=\"mb-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n                <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n              </div>\n            )}\n\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Vertragstyp <span className=\"text-red-500\">*</span>\n                </label>\n                <select\n                  value={contractType}\n                  onChange={(e) => setContractType(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                >\n                  <option value=\"employment\">Arbeitsvertrag</option>\n                  <option value=\"amendment\">Vertragsnderung</option>\n                  <option value=\"extension\">Vertragsverlngerung</option>\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Startdatum <span className=\"text-red-500\">*</span>\n                </label>\n                <input\n                  type=\"date\"\n                  value={startDate}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setStartDate(value);\n                    // Wenn Enddatum gesetzt ist, prfe ob es nach Startdatum liegt\n                    if (endDate && value && new Date(endDate) < new Date(value)) {\n                      setError('Enddatum muss nach dem Startdatum liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && !startDate \n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  required\n                  aria-invalid={!startDate ? true : undefined}\n                  aria-describedby={!startDate ? \"startDate-error\" : undefined}\n                />\n                {error && !startDate && (\n                  <p id=\"startDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Enddatum (optional)\n                </label>\n                <input\n                  type=\"date\"\n                  value={endDate}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setEndDate(value);\n                    // Wenn Enddatum gesetzt wird, prfe ob es nach Startdatum liegt\n                    if (value && startDate && new Date(value) < new Date(startDate)) {\n                      setError('Enddatum muss nach dem Startdatum liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  min={startDate || undefined}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && endDate && startDate && new Date(endDate) < new Date(startDate)\n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  aria-invalid={endDate && startDate && new Date(endDate) < new Date(startDate) ? true : undefined}\n                  aria-describedby={endDate && startDate && new Date(endDate) < new Date(startDate) ? \"endDate-error\" : undefined}\n                />\n                {error && endDate && startDate && new Date(endDate) < new Date(startDate) && (\n                  <p id=\"endDate-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Position\n                </label>\n                <input\n                  type=\"text\"\n                  value={position}\n                  onChange={(e) => setPosition(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  placeholder=\"z.B. Frontend-Entwickler\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Gehalt (optional)\n                </label>\n                <div className=\"relative\">\n                  <CurrencyDollarIcon className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                  <input\n                    type=\"number\"\n                    value={salary}\n                    onChange={(e) => {\n                      const value = e.target.value;\n                      setSalary(value);\n                      // Validierung: Gehalt darf nicht negativ sein\n                      if (value && parseFloat(value) < 0) {\n                        setError('Gehalt darf nicht negativ sein');\n                      } else {\n                        setError(null); // Clear error when valid\n                      }\n                    }}\n                    className={`w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                      error && salary && parseFloat(salary) < 0\n                        ? 'border-red-500 dark:border-red-500' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                    placeholder=\"0.00\"\n                    step=\"0.01\"\n                    min=\"0\"\n                    aria-invalid={salary && parseFloat(salary) < 0 ? true : undefined}\n                    aria-describedby={salary && parseFloat(salary) < 0 ? \"salary-error\" : undefined}\n                  />\n                </div>\n                {error && salary && parseFloat(salary) < 0 && (\n                  <p id=\"salary-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Arbeitsstunden/Woche (optional)\n                </label>\n                <input\n                  type=\"number\"\n                  value={workingHours}\n                  onChange={(e) => {\n                    const value = e.target.value;\n                    setWorkingHours(value);\n                    // Validierung: Arbeitsstunden mssen zwischen 0 und 168 liegen\n                    if (value && (parseFloat(value) < 0 || parseFloat(value) > 168)) {\n                      setError('Arbeitsstunden mssen zwischen 0 und 168 liegen');\n                    } else {\n                      setError(null); // Clear error when valid\n                    }\n                  }}\n                  className={`w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n                    error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168)\n                      ? 'border-red-500 dark:border-red-500' \n                      : 'border-gray-300 dark:border-gray-600'\n                  }`}\n                  placeholder=\"40\"\n                  step=\"0.1\"\n                  min=\"0\"\n                  max=\"168\"\n                  aria-invalid={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? true : undefined}\n                  aria-describedby={workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) ? \"workingHours-error\" : undefined}\n                />\n                {error && workingHours && (parseFloat(workingHours) < 0 || parseFloat(workingHours) > 168) && (\n                  <p id=\"workingHours-error\" className=\"mt-1 text-xs text-red-600 dark:text-red-400\">\n                    {error}\n                  </p>\n                )}\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                  Maximal 168 Stunden pro Woche (24h  7 Tage)\n                </p>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  PDF-Datei aktualisieren (optional)\n                </label>\n                <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center\">\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept=\".pdf\"\n                    onChange={handleFileSelect}\n                    className=\"hidden\"\n                  />\n                  {!pdfFile ? (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n                      <button\n                        type=\"button\"\n                        onClick={() => fileInputRef.current?.click()}\n                        className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 font-medium\"\n                      >\n                        Neue PDF-Datei auswhlen\n                      </button>\n                      <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\n                        oder Datei hierher ziehen\n                      </p>\n                      <p className=\"mt-1 text-xs text-gray-400 dark:text-gray-500\">\n                        Max. 10MB\n                      </p>\n                    </div>\n                  ) : (\n                    <div>\n                      <DocumentTextIcon className=\"mx-auto h-12 w-12 text-green-500 mb-4\" />\n                      <p className=\"text-sm font-medium dark:text-white\">{pdfFile.name}</p>\n                      <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                        {(pdfFile.size / 1024 / 1024).toFixed(2)} MB\n                      </p>\n                      <button\n                        type=\"button\"\n                        onClick={() => {\n                          setPdfFile(null);\n                          if (pdfPreviewUrl) {\n                            URL.revokeObjectURL(pdfPreviewUrl);\n                            setPdfPreviewUrl(null);\n                          }\n                          setExistingPdfUrl(API_ENDPOINTS.LIFECYCLE.CONTRACT_DOWNLOAD(userId, contract.id));\n                          if (fileInputRef.current) {\n                            fileInputRef.current.value = '';\n                          }\n                        }}\n                        className=\"mt-2 text-sm text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300\"\n                      >\n                        Datei entfernen\n                      </button>\n                    </div>\n                  )}\n                </div>\n\n                {/* PDF-Vorschau */}\n                {(pdfPreviewUrl || existingPdfUrl) && (\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      PDF-Vorschau\n                    </label>\n                    <div className=\"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50\">\n                      <iframe \n                        src={`${pdfPreviewUrl || existingPdfUrl}${pdfPreviewUrl ? '#view=FitH' : '?preview=true#view=FitH'}`}\n                        className=\"w-full rounded border dark:border-gray-600\"\n                        style={{ height: '400px' }}\n                        title=\"PDF-Vorschau\"\n                      />\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              <div className=\"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 p-4\">\n                <p className=\"text-sm text-yellow-700 dark:text-yellow-300\">\n                  <strong>Hinweis:</strong> Wenn Sie eine neue PDF-Datei hochladen, wird die alte Version ersetzt.\n                  Eine neue Version wird erstellt (isLatest = true).\n                </p>\n              </div>\n            </form>\n          </div>\n\n          {/* Footer */}\n          <div className=\"flex items-center justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700 flex-shrink-0\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n              title=\"Abbrechen\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSubmit}\n              disabled={loading || !startDate}\n              className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? 'Wird aktualisiert...' : 'Aktualisieren'}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : (\n                <CheckIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </Dialog.Panel>\n      </div>\n    </Dialog>\n  );\n};\n\nexport default ContractEditModal;\n\n","import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport {\n  CheckCircleIcon,\n  ClockIcon,\n  XCircleIcon,\n  PencilIcon,\n  EnvelopeIcon,\n  DocumentTextIcon,\n  XMarkIcon,\n  ArrowPathIcon\n} from '@heroicons/react/24/outline';\n// Social Security Editor Component\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface SocialSecurityRegistration {\n  id: number;\n  registrationType: string;\n  registrationNumber: string | null;\n  provider: string | null;\n  registrationDate: string | null;\n  status: string;\n  notes: string | null;\n  completedAt: string | null;\n}\n\ninterface SocialSecurityEditorProps {\n  userId: number;\n  lifecycleId: number;\n  onUpdate?: () => void;\n}\n\ntype SocialSecurityType = 'arl' | 'eps' | 'pension' | 'caja';\n\nconst SocialSecurityEditor: React.FC<SocialSecurityEditorProps> = ({\n  userId,\n  lifecycleId,\n  onUpdate\n}) => {\n  const { t } = useTranslation();\n  const { isLegal, isAdmin, loading: permissionsLoading } = usePermissions();\n  const { showMessage } = useMessage();\n  \n  const [registrations, setRegistrations] = useState<Record<SocialSecurityType, SocialSecurityRegistration | null>>({\n    arl: null,\n    eps: null,\n    pension: null,\n    caja: null\n  });\n  const [loading, setLoading] = useState(true);\n  const [editingType, setEditingType] = useState<SocialSecurityType | null>(null);\n  const [formData, setFormData] = useState({\n    status: 'pending' as string,\n    registrationNumber: '',\n    provider: '',\n    registrationDate: '',\n    notes: ''\n  });\n  const [saving, setSaving] = useState(false);\n  const loadingRef = useRef(false);\n  const abortControllerRef = useRef<AbortController | null>(null);\n\n  // loadRegistrations auerhalb von useEffect definieren, damit es von handleSave aufgerufen werden kann\n  const loadRegistrations = useCallback(async () => {\n    // Erstelle neuen AbortController\n    if (abortControllerRef.current) {\n      abortControllerRef.current.abort();\n    }\n    const abortController = new AbortController();\n    abortControllerRef.current = abortController;\n\n    loadingRef.current = true;\n    setLoading(true);\n    try {\n      const types: SocialSecurityType[] = ['arl', 'eps', 'pension', 'caja'];\n      const registrationPromises = types.map(async (type) => {\n        // Prfe ob Request abgebrochen wurde\n        if (abortController.signal.aborted) {\n          return { type, registration: null };\n        }\n\n        try {\n          const response = await axiosInstance.get(\n            API_ENDPOINTS.LIFECYCLE.SOCIAL_SECURITY(userId, type),\n            {\n              timeout: 5000, // 5 Sekunden Timeout\n              signal: abortController.signal\n            }\n          );\n          return { type, registration: response.data };\n        } catch (error: any) {\n          // Ignoriere Abort-Errors (AbortError oder CanceledError von Axios)\n          if (error.name === 'AbortError' || error.name === 'CanceledError' || abortController.signal.aborted) {\n            return { type, registration: null };\n          }\n          // Behandle 404 als \"nicht vorhanden\" (normal)\n          if (error.response?.status === 404) {\n            return { type, registration: null };\n          }\n          // Behandle Network Errors und Timeouts\n          if (error.code === 'ERR_NETWORK' || error.code === 'ECONNABORTED' || error.message?.includes('ERR_INSUFFICIENT_RESOURCES')) {\n            console.warn(`Network error loading ${type}, treating as not found`);\n            return { type, registration: null };\n          }\n          console.error(`Error loading ${type}:`, error);\n          return { type, registration: null };\n        }\n      });\n\n      const results = await Promise.all(registrationPromises);\n      \n      // Prfe erneut ob Request abgebrochen wurde\n      if (abortController.signal.aborted) {\n        return;\n      }\n\n      const newRegistrations: Record<SocialSecurityType, SocialSecurityRegistration | null> = {\n        arl: null,\n        eps: null,\n        pension: null,\n        caja: null\n      };\n\n      results.forEach(({ type, registration }) => {\n        if (registration) {\n          // Backend gibt zurck: { id, type, status, number, provider, registeredAt, notes, completedAt }\n          // Mappe auf Frontend-Format: { id, registrationType, registrationNumber, provider, registrationDate, status, notes, completedAt }\n          newRegistrations[type as SocialSecurityType] = {\n            id: registration.id || 0,\n            registrationType: type,\n            registrationNumber: registration.number || registration.registrationNumber || null,\n            provider: registration.provider || null,\n            registrationDate: registration.registeredAt || registration.registrationDate || null,\n            status: registration.status || 'pending',\n            notes: registration.notes || null,\n            completedAt: registration.completedAt || null\n          };\n        }\n      });\n\n      setRegistrations(newRegistrations);\n    } catch (error: any) {\n      // Ignoriere Abort-Errors (AbortError oder CanceledError von Axios)\n      if (error.name === 'AbortError' || error.name === 'CanceledError' || abortController.signal.aborted) {\n        return;\n      }\n      console.error('Error loading registrations:', error);\n      showMessage(t('socialSecurity.loadError'), 'error');\n    } finally {\n      // Setze loading immer auf false, auch bei Abbruch\n      setLoading(false);\n      loadingRef.current = false;\n    }\n  }, [userId, t, showMessage]);\n\n  useEffect(() => {\n    // Warte bis Berechtigungen geladen sind\n    if (permissionsLoading) {\n      return;\n    }\n    \n    // Prfe Berechtigung und lade nur einmal pro userId/lifecycleId\n    const hasPermission = isLegal() || isAdmin();\n    if (!hasPermission || !userId || !lifecycleId) {\n      setLoading(false);\n      return;\n    }\n\n    // Verhindere mehrfaches gleichzeitiges Laden\n    if (loadingRef.current) {\n      return;\n    }\n\n    loadRegistrations();\n\n    // Cleanup: Breche Request ab wenn Component unmountet oder Dependencies sich ndern\n    return () => {\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort();\n      }\n      loadingRef.current = false;\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [userId, lifecycleId, permissionsLoading]); // permissionsLoading als Dependency hinzugefgt\n\n  const handleEdit = (type: SocialSecurityType) => {\n    const registration = registrations[type];\n    if (registration) {\n      setFormData({\n        status: registration.status,\n        registrationNumber: registration.registrationNumber || '',\n        provider: registration.provider || '',\n        registrationDate: registration.registrationDate \n          ? new Date(registration.registrationDate).toISOString().split('T')[0]\n          : '',\n        notes: registration.notes || ''\n      });\n    } else {\n      setFormData({\n        status: 'pending',\n        registrationNumber: '',\n        provider: '',\n        registrationDate: '',\n        notes: ''\n      });\n    }\n    setEditingType(type);\n  };\n\n  const handleCancel = () => {\n    setEditingType(null);\n    setFormData({\n      status: 'pending',\n      registrationNumber: '',\n      provider: '',\n      registrationDate: '',\n      notes: ''\n    });\n  };\n\n  const handleSave = async () => {\n    if (!editingType) return;\n    \n    // Prfe Berechtigung nochmal vor dem Speichern\n    if (permissionsLoading) {\n      showMessage(t('common.loading', { defaultValue: 'Berechtigungen werden geladen...' }), 'warning');\n      return;\n    }\n    \n    if (!isLegal() && !isAdmin()) {\n      showMessage(t('lifecycle.noPermission', { defaultValue: 'Keine Berechtigung - nur Legal oder Admin' }), 'error');\n      return;\n    }\n\n    setSaving(true);\n    try {\n      await axiosInstance.put(\n        API_ENDPOINTS.LIFECYCLE.SOCIAL_SECURITY(userId, editingType),\n        {\n          status: formData.status,\n          number: formData.registrationNumber || undefined,\n          provider: formData.provider || undefined,\n          registrationDate: formData.registrationDate \n            ? new Date(formData.registrationDate).toISOString()\n            : undefined,\n          notes: formData.notes || undefined\n        }\n      );\n\n      showMessage('Sozialversicherung erfolgreich aktualisiert', 'success');\n      setEditingType(null);\n      \n      // Warte kurz, damit Backend die Daten aktualisiert hat\n      await new Promise(resolve => setTimeout(resolve, 200));\n      \n      // Lade Registrierungen neu nach Update\n      await loadRegistrations();\n      \n      // onUpdate nur aufrufen, wenn es eine Funktion ist (verhindert Re-Render-Loops)\n      if (onUpdate && typeof onUpdate === 'function') {\n        // Rufe onUpdate auf, um LifecycleView zu aktualisieren\n        onUpdate();\n      }\n    } catch (error: any) {\n      console.error('Error updating social security:', error);\n      showMessage(\n        error.response?.data?.message || t('socialSecurity.updateError'),\n        'error'\n      );\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case 'registered':\n        return <CheckCircleIcon className=\"h-5 w-5 text-green-500\" />;\n      case 'pending':\n        return <ClockIcon className=\"h-5 w-5 text-yellow-500\" />;\n      case 'failed':\n        return <XCircleIcon className=\"h-5 w-5 text-red-500\" />;\n      case 'not_required':\n        return <CheckCircleIcon className=\"h-5 w-5 text-gray-400\" />;\n      case 'deregistered':\n        return <XCircleIcon className=\"h-5 w-5 text-gray-400\" />;\n      default:\n        return <ClockIcon className=\"h-5 w-5 text-gray-400\" />;\n    }\n  };\n\n  const getStatusLabel = (status: string) => {\n    const labelKey = `lifecycle.socialSecurityStatus.${status}`;\n    return t(labelKey) || status;\n  };\n\n  const getTypeLabel = (type: SocialSecurityType) => {\n    const labels: Record<SocialSecurityType, string> = {\n      arl: 'ARL (Risiko-Arbeit)',\n      eps: 'EPS (Gesundheit)',\n      pension: 'Pension',\n      caja: 'Caja de Compensacin'\n    };\n    return labels[type];\n  };\n\n  // Warte bis Berechtigungen geladen sind\n  if (permissionsLoading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex justify-center items-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!isLegal() && !isAdmin()) {\n    return null;\n  }\n\n  if (loading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex justify-center items-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  const types: SocialSecurityType[] = ['arl', 'eps', 'pension', 'caja'];\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n          <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n          {t('lifecycle.socialSecurity', { defaultValue: 'Sozialversicherungen' })}\n        </h3>\n      </div>\n\n      <div className=\"space-y-4\">\n        {types.map((type) => {\n          const registration = registrations[type];\n          const isEditing = editingType === type;\n\n          return (\n            <div\n              key={type}\n              className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\"\n            >\n              {!isEditing ? (\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex items-start space-x-3 flex-1\">\n                    {getStatusIcon(registration?.status || 'pending')}\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center space-x-2 mb-2\">\n                        <h4 className=\"font-medium dark:text-white uppercase\">\n                          {getTypeLabel(type)}\n                        </h4>\n                        <span className=\"text-sm font-medium dark:text-white\">\n                          {getStatusLabel(registration?.status || 'pending')}\n                        </span>\n                      </div>\n                      {registration && (\n                        <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                          {registration.provider && (\n                            <div>\n                              <span className=\"font-medium\">{t('socialSecurity.provider')}:</span> {registration.provider}\n                            </div>\n                          )}\n                          {registration.registrationNumber && (\n                            <div>\n                              <span className=\"font-medium\">{t('socialSecurity.number')}:</span> {registration.registrationNumber}\n                            </div>\n                          )}\n                          {registration.registrationDate && (\n                            <div>\n                              <span className=\"font-medium\">{t('socialSecurity.registrationDate')}:</span>{' '}\n                              {new Date(registration.registrationDate).toLocaleDateString('de-DE')}\n                            </div>\n                          )}\n                          {registration.notes && (\n                            <div className=\"mt-2\">\n                              <span className=\"font-medium\">{t('socialSecurity.notes')}:</span>\n                              <p className=\"text-gray-500 dark:text-gray-400 mt-1\">\n                                {registration.notes}\n                              </p>\n                            </div>\n                          )}\n                          {registration.completedAt && (\n                            <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-2\">\n                              {t('socialSecurity.completedAt')}{' '}\n                              {new Date(registration.completedAt).toLocaleDateString('de-DE')}\n                            </div>\n                          )}\n                        </div>\n                      )}\n                      {!registration && (\n                        <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                          {t('socialSecurity.notRegistered')}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                  <button\n                    onClick={() => handleEdit(type)}\n                    className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition ml-4\"\n                    title={t('lifecycle.edit', { defaultValue: 'Bearbeiten' })}\n                  >\n                    <PencilIcon className=\"h-5 w-5\" />\n                  </button>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  <h4 className=\"font-medium dark:text-white uppercase mb-3\">\n                    {t('socialSecurity.editType', { type: getTypeLabel(type) })}\n                  </h4>\n                  \n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('socialSecurity.status')} <span className=\"text-red-500\">*</span>\n                    </label>\n                    <select\n                      value={formData.status}\n                      onChange={(e) => setFormData({ ...formData, status: e.target.value })}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    >\n                      <option value=\"not_required\">Nicht erforderlich</option>\n                      <option value=\"pending\">Ausstehend</option>\n                      <option value=\"registered\">Registriert</option>\n                      <option value=\"failed\">Fehlgeschlagen</option>\n                      <option value=\"deregistered\">Abgemeldet</option>\n                    </select>\n                  </div>\n\n                  {formData.status === 'registered' && (\n                    <>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('socialSecurity.registrationNumber')}\n                        </label>\n                        <input\n                          type=\"text\"\n                          value={formData.registrationNumber}\n                          onChange={(e) => setFormData({ ...formData, registrationNumber: e.target.value })}\n                          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                          placeholder=\"z.B. 123456789\"\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('socialSecurity.provider')}\n                        </label>\n                        <input\n                          type=\"text\"\n                          value={formData.provider}\n                          onChange={(e) => setFormData({ ...formData, provider: e.target.value })}\n                          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                          placeholder=\"z.B. ARL Sura, EPS Sanitas\"\n                        />\n                      </div>\n\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('socialSecurity.registrationDate')}\n                        </label>\n                        <input\n                          type=\"date\"\n                          value={formData.registrationDate}\n                          onChange={(e) => setFormData({ ...formData, registrationDate: e.target.value })}\n                          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                        />\n                      </div>\n                    </>\n                  )}\n\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('socialSecurity.notes')}\n                    </label>\n                    <textarea\n                      value={formData.notes}\n                      onChange={(e) => setFormData({ ...formData, notes: e.target.value })}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                      rows={3}\n                      placeholder={t('socialSecurity.additionalInfo')}\n                    />\n                  </div>\n\n                  <div className=\"flex items-center justify-end space-x-3\">\n                    <button\n                      onClick={handleCancel}\n                      disabled={saving}\n                      className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed\"\n                      title={t('common.cancel')}\n                    >\n                      <XMarkIcon className=\"h-5 w-5\" />\n                    </button>\n                    <button\n                      onClick={handleSave}\n                      disabled={saving}\n                      className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                      title={saving ? t('common.saving') : t('common.save')}\n                    >\n                      {saving ? (\n                        <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                      ) : (\n                        <CheckCircleIcon className=\"h-5 w-5\" />\n                      )}\n                    </button>\n                  </div>\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport default SocialSecurityEditor;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, ExclamationTriangleIcon, CalendarIcon, ArrowPathIcon, ArrowRightIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface OffboardingStartModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onOffboardingStarted: () => void;\n  userId: number;\n  userName: string;\n}\n\nconst OffboardingStartModal: React.FC<OffboardingStartModalProps> = ({\n  isOpen,\n  onClose,\n  onOffboardingStarted,\n  userId,\n  userName\n}) => {\n  const { t } = useTranslation();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  \n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Form-Daten\n  const [exitDate, setExitDate] = useState('');\n  const [exitReason, setExitReason] = useState('');\n  \n  // Validierung\n  const [validationErrors, setValidationErrors] = useState<{\n    exitDate?: string;\n    exitReason?: string;\n  }>({});\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n      // Setze Standard-Datum auf heute\n      const today = new Date().toISOString().split('T')[0];\n      setExitDate(today);\n      setExitReason('');\n      setError(null);\n      setValidationErrors({});\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const validateForm = (): boolean => {\n    const errors: { exitDate?: string; exitReason?: string } = {};\n\n    // Validierung: exitDate\n    if (!exitDate) {\n      errors.exitDate = t('lifecycle.offboarding.exitDateRequired', { defaultValue: 'Austrittsdatum ist erforderlich' });\n    } else {\n      const selectedDate = new Date(exitDate);\n      const today = new Date();\n      today.setHours(0, 0, 0, 0);\n      \n      // exitDate darf in der Vergangenheit liegen (rckwirkende Erfassung erlaubt)\n      // Aber nicht zu weit in der Zukunft (max. 1 Jahr)\n      const maxDate = new Date();\n      maxDate.setFullYear(maxDate.getFullYear() + 1);\n      \n      if (selectedDate > maxDate) {\n        errors.exitDate = t('lifecycle.offboarding.exitDateTooFar', { defaultValue: 'Austrittsdatum darf nicht mehr als 1 Jahr in der Zukunft liegen' });\n      }\n    }\n\n    // Validierung: exitReason\n    if (!exitReason || exitReason.trim().length === 0) {\n      errors.exitReason = t('lifecycle.offboarding.exitReasonRequired', { defaultValue: 'Austrittsgrund ist erforderlich' });\n    } else if (exitReason.trim().length < 10) {\n      errors.exitReason = t('lifecycle.offboarding.exitReasonTooShort', { defaultValue: 'Austrittsgrund muss mindestens 10 Zeichen lang sein' });\n    }\n\n    setValidationErrors(errors);\n    return Object.keys(errors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      await axiosInstance.put(API_ENDPOINTS.LIFECYCLE.STATUS(userId), {\n        status: 'offboarding',\n        exitDate: exitDate,\n        exitReason: exitReason.trim()\n      });\n\n      showMessage(\n        t('lifecycle.offboarding.started', { defaultValue: 'Offboarding erfolgreich gestartet' }),\n        'success'\n      );\n      \n      onOffboardingStarted();\n      onClose();\n    } catch (err: any) {\n      console.error('Fehler beim Starten des Offboarding:', err);\n      const errorMessage = err.response?.data?.message || \n        t('lifecycle.offboarding.startError', { defaultValue: 'Fehler beim Starten des Offboarding' });\n      setError(errorMessage);\n      showMessage(errorMessage, 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const renderForm = () => (\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\n      {/* Warnung */}\n      <div className=\"bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg p-4\">\n        <div className=\"flex items-start\">\n          <ExclamationTriangleIcon className=\"h-5 w-5 text-orange-600 dark:text-orange-400 mt-0.5 mr-3 flex-shrink-0\" />\n          <div className=\"text-sm text-orange-800 dark:text-orange-200\">\n            <p className=\"font-medium mb-1\">\n              {t('lifecycle.offboarding.warningTitle', { defaultValue: 'Wichtiger Hinweis' })}\n            </p>\n            <p>\n              {t('lifecycle.offboarding.warningText', { defaultValue: 'Durch das Starten des Offboarding-Prozesses werden automatisch Tasks erstellt. Dieser Vorgang kann nicht rckgngig gemacht werden.' })}\n            </p>\n          </div>\n        </div>\n      </div>\n\n      {/* User-Info */}\n      <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4\">\n        <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-1\">\n          {t('lifecycle.offboarding.user', { defaultValue: 'Mitarbeiter' })}\n        </p>\n        <p className=\"font-medium dark:text-white\">{userName}</p>\n      </div>\n\n      {/* exitDate */}\n      <div>\n        <label htmlFor=\"exitDate\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n          {t('lifecycle.offboarding.exitDate', { defaultValue: 'Austrittsdatum' })} *\n        </label>\n        <div className=\"relative\">\n          <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n            <CalendarIcon className=\"h-5 w-5 text-gray-400\" />\n          </div>\n          <input\n            type=\"date\"\n            id=\"exitDate\"\n            value={exitDate}\n            onChange={(e) => {\n              setExitDate(e.target.value);\n              if (validationErrors.exitDate) {\n                setValidationErrors(prev => ({ ...prev, exitDate: undefined }));\n              }\n            }}\n            className={`block w-full pl-10 pr-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n              validationErrors.exitDate\n                ? 'border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500'\n                : 'border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500'\n            }`}\n            required\n          />\n        </div>\n        {validationErrors.exitDate && (\n          <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{validationErrors.exitDate}</p>\n        )}\n        <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n          {t('lifecycle.offboarding.exitDateHint', { defaultValue: 'Das Datum, an dem der Mitarbeiter die Organisation verlsst' })}\n        </p>\n      </div>\n\n      {/* exitReason */}\n      <div>\n        <label htmlFor=\"exitReason\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n          {t('lifecycle.offboarding.exitReason', { defaultValue: 'Austrittsgrund' })} *\n        </label>\n        <textarea\n          id=\"exitReason\"\n          value={exitReason}\n          onChange={(e) => {\n            setExitReason(e.target.value);\n            if (validationErrors.exitReason) {\n              setValidationErrors(prev => ({ ...prev, exitReason: undefined }));\n            }\n          }}\n          rows={4}\n          className={`block w-full px-3 py-2 border rounded-md dark:bg-gray-700 dark:text-white ${\n            validationErrors.exitReason\n              ? 'border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500'\n              : 'border-gray-300 dark:border-gray-600 focus:ring-blue-500 focus:border-blue-500'\n          }`}\n          placeholder={t('lifecycle.offboarding.exitReasonPlaceholder', { defaultValue: 'z.B. Kndigung, Vertragsende, etc.' })}\n          required\n        />\n        {validationErrors.exitReason && (\n          <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{validationErrors.exitReason}</p>\n        )}\n        <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n          {t('lifecycle.offboarding.exitReasonHint', { defaultValue: 'Mindestens 10 Zeichen. Beschreiben Sie den Grund fr den Austritt.' })}\n        </p>\n      </div>\n\n      {/* Error-Message */}\n      {error && (\n        <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n          <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n        </div>\n      )}\n\n      {/* Buttons */}\n      <div className=\"flex items-center justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n        <button\n          type=\"button\"\n          onClick={onClose}\n          disabled={loading}\n          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed\"\n          title={t('common.cancel', { defaultValue: 'Abbrechen' })}\n        >\n          <XMarkIcon className=\"h-5 w-5\" />\n        </button>\n        <button\n          type=\"submit\"\n          disabled={loading}\n          className=\"p-2 bg-orange-600 dark:bg-orange-700 text-white rounded-md hover:bg-orange-700 dark:hover:bg-orange-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n          title={loading ? t('common.saving', { defaultValue: 'Speichern...' }) : t('lifecycle.offboarding.startButton', { defaultValue: 'Offboarding starten' })}\n        >\n          {loading ? (\n            <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n          ) : (\n            <ArrowRightIcon className=\"h-5 w-5\" />\n          )}\n        </button>\n      </div>\n    </form>\n  );\n\n  if (!isOpen) return null;\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('lifecycle.offboarding.startTitle', { defaultValue: 'Offboarding starten' })}\n              </Dialog.Title>\n              <button\n                onClick={onClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <div className=\"p-4\">\n              {renderForm()}\n            </div>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={onClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('lifecycle.offboarding.startTitle', { defaultValue: 'Offboarding starten' })}\n          </h2>\n          <button\n            onClick={onClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {renderForm()}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default OffboardingStartModal;\n\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, ExclamationTriangleIcon, CheckCircleIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\r\nimport axiosInstance from '../config/axios.ts';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\r\nimport useMessage from '../hooks/useMessage.ts';\r\n\r\ninterface Task {\r\n  id: number;\r\n  title: string;\r\n  description: string | null;\r\n  status: string;\r\n  dueDate: string | null;\r\n  createdAt: string;\r\n}\r\n\r\ninterface OffboardingCompleteModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onOffboardingCompleted: () => void;\r\n  userId: number;\r\n  userName: string;\r\n  offboardingTasks: Task[];\r\n}\r\n\r\nconst OffboardingCompleteModal: React.FC<OffboardingCompleteModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  onOffboardingCompleted,\r\n  userId,\r\n  userName,\r\n  offboardingTasks\r\n}) => {\r\n  const { t } = useTranslation();\r\n  const { openSidepane, closeSidepane } = useSidepane();\r\n  const { showMessage } = useMessage();\r\n  \r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\r\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [confirmText, setConfirmText] = useState('');\r\n  \r\n  // Prfe, ob alle Tasks abgeschlossen sind\r\n  const completedTasks = offboardingTasks.filter(task => task.status === 'done');\r\n  const allTasksCompleted = offboardingTasks.length > 0 && completedTasks.length === offboardingTasks.length;\r\n  const requiredConfirmText = userName.trim().toLowerCase();\r\n  \r\n  // Responsive Erkennung\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      setIsMobile(window.innerWidth < 640);\r\n      setIsLargeScreen(window.innerWidth > 1070);\r\n    };\r\n    \r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n  \r\n  // Sidepane-Status verwalten\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      openSidepane();\r\n      // Reset form on open\r\n      setConfirmText('');\r\n      setError(null);\r\n    } else {\r\n      closeSidepane();\r\n    }\r\n    \r\n    return () => {\r\n      closeSidepane();\r\n    };\r\n  }, [isOpen, openSidepane, closeSidepane]);\r\n  \r\n  const validateForm = () => {\r\n    if (confirmText.trim().toLowerCase() !== requiredConfirmText) {\r\n      setError(t('lifecycle.offboarding.complete.confirmTextMismatch', { defaultValue: 'Besttigungstext stimmt nicht berein' }));\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n  \r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    if (!validateForm()) {\r\n      return;\r\n    }\r\n    \r\n    setLoading(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      await axiosInstance.put(API_ENDPOINTS.LIFECYCLE.STATUS(userId), {\r\n        status: 'archived'\r\n      });\r\n      \r\n      showMessage(\r\n        t('lifecycle.offboarding.complete.success', { defaultValue: 'Offboarding erfolgreich abgeschlossen' }),\r\n        'success'\r\n      );\r\n      \r\n      onOffboardingCompleted();\r\n      onClose();\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Abschlieen des Offboarding:', err);\r\n      const errorMessage = err.response?.data?.message || \r\n        t('lifecycle.offboarding.complete.error', { defaultValue: 'Fehler beim Abschlieen des Offboarding' });\r\n      setError(errorMessage);\r\n      showMessage(errorMessage, 'error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n  \r\n  const renderForm = () => (\r\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n      {/* User Info */}\r\n      <div className=\"bg-gray-50 dark:bg-gray-700 p-3 rounded-md flex items-center space-x-3\">\r\n        <CheckCircleIcon className=\"h-5 w-5 text-gray-500 dark:text-gray-400\" />\r\n        <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n          {t('lifecycle.offboarding.complete.user', { defaultValue: 'Mitarbeiter' })}: {userName}\r\n        </span>\r\n      </div>\r\n      \r\n      {/* Tasks Status */}\r\n      {offboardingTasks.length > 0 && (\r\n        <div className=\"bg-gray-50 dark:bg-gray-700 p-4 rounded-md\">\r\n          <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n            {t('lifecycle.offboarding.complete.tasksStatus', { defaultValue: 'Status der Offboarding-Aufgaben' })}\r\n          </h4>\r\n          <div className=\"space-y-2\">\r\n            {offboardingTasks.map((task) => {\r\n                  const isCompleted = task.status === 'done';\r\n              return (\r\n                <div\r\n                  key={task.id}\r\n                  className={`flex items-center space-x-2 text-sm ${\r\n                    isCompleted\r\n                      ? 'text-green-700 dark:text-green-300'\r\n                      : 'text-orange-700 dark:text-orange-300'\r\n                  }`}\r\n                >\r\n                  {isCompleted ? (\r\n                    <CheckCircleIcon className=\"h-4 w-4 flex-shrink-0\" />\r\n                  ) : (\r\n                    <ExclamationTriangleIcon className=\"h-4 w-4 flex-shrink-0\" />\r\n                  )}\r\n                  <span>{task.title}</span>\r\n                  <span className=\"ml-auto text-xs\">\r\n                    {isCompleted\r\n                      ? `(${t('common.done', { defaultValue: 'Abgeschlossen' })})`\r\n                      : `(${t('common.open', { defaultValue: 'Offen' })})`}\r\n                  </span>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Warning wenn nicht alle Tasks abgeschlossen */}\r\n      {!allTasksCompleted && offboardingTasks.length > 0 && (\r\n        <div className=\"bg-orange-50 dark:bg-orange-900/20 border-l-4 border-orange-400 p-4\">\r\n          <div className=\"flex\">\r\n            <div className=\"flex-shrink-0\">\r\n              <ExclamationTriangleIcon className=\"h-5 w-5 text-orange-400\" aria-hidden=\"true\" />\r\n            </div>\r\n            <div className=\"ml-3\">\r\n              <h3 className=\"text-sm font-medium text-orange-800 dark:text-orange-300\">\r\n                {t('lifecycle.offboarding.complete.warningTitle', { defaultValue: 'Nicht alle Aufgaben abgeschlossen' })}\r\n              </h3>\r\n              <div className=\"mt-2 text-sm text-orange-700 dark:text-orange-200\">\r\n                <p>\r\n                  {t('lifecycle.offboarding.complete.warningText', { \r\n                    defaultValue: 'Es sind noch nicht alle Offboarding-Aufgaben abgeschlossen. Sie knnen das Offboarding trotzdem abschlieen, aber es wird empfohlen, alle Aufgaben zuerst zu erledigen.'\r\n                  })}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Info wenn alle Tasks abgeschlossen */}\r\n      {allTasksCompleted && (\r\n        <div className=\"bg-green-50 dark:bg-green-900/20 border-l-4 border-green-400 p-4\">\r\n          <div className=\"flex\">\r\n            <div className=\"flex-shrink-0\">\r\n              <CheckCircleIcon className=\"h-5 w-5 text-green-400\" aria-hidden=\"true\" />\r\n            </div>\r\n            <div className=\"ml-3\">\r\n              <h3 className=\"text-sm font-medium text-green-800 dark:text-green-300\">\r\n                {t('lifecycle.offboarding.complete.allTasksCompleted', { defaultValue: 'Alle Aufgaben abgeschlossen' })}\r\n              </h3>\r\n              <div className=\"mt-2 text-sm text-green-700 dark:text-green-200\">\r\n                <p>\r\n                  {t('lifecycle.offboarding.complete.allTasksCompletedText', { \r\n                    defaultValue: 'Alle Offboarding-Aufgaben sind abgeschlossen. Sie knnen das Offboarding jetzt abschlieen.'\r\n                  })}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Confirm Text Input */}\r\n      <div>\r\n        <label htmlFor=\"confirmText\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('lifecycle.offboarding.complete.confirmLabel', { userName }) || \r\n            `Besttigen Sie durch Eingabe des Namens: \"${userName}\"`} *\r\n        </label>\r\n        <input\r\n          type=\"text\"\r\n          id=\"confirmText\"\r\n          value={confirmText}\r\n          onChange={(e) => {\r\n            setConfirmText(e.target.value);\r\n            setError(null);\r\n          }}\r\n          className={`w-full px-3 py-2 border ${\r\n            error && error.includes('Besttigung') ? 'border-red-500' : 'border-gray-300'\r\n          } dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500`}\r\n          placeholder={userName}\r\n          required\r\n        />\r\n        <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n          {t('lifecycle.offboarding.complete.confirmHint', { \r\n            defaultValue: 'Geben Sie den vollstndigen Namen des Mitarbeiters ein, um das Offboarding abzuschlieen'\r\n          })}\r\n        </p>\r\n      </div>\r\n      \r\n      {/* Final Warning */}\r\n      <div className=\"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\r\n        <div className=\"flex\">\r\n          <div className=\"flex-shrink-0\">\r\n            <ExclamationTriangleIcon className=\"h-5 w-5 text-red-400\" aria-hidden=\"true\" />\r\n          </div>\r\n          <div className=\"ml-3\">\r\n            <h3 className=\"text-sm font-medium text-red-800 dark:text-red-300\">\r\n              {t('lifecycle.offboarding.complete.finalWarningTitle', { defaultValue: 'Wichtiger Hinweis' })}\r\n            </h3>\r\n            <div className=\"mt-2 text-sm text-red-700 dark:text-red-200\">\r\n              <p>\r\n                {t('lifecycle.offboarding.complete.finalWarningText', { \r\n                  defaultValue: 'Durch das Abschlieen des Offboarding wird der Mitarbeiter archiviert. Dieser Vorgang kann nicht rckgngig gemacht werden.'\r\n                })}\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      \r\n      {/* Submit Button */}\r\n      <div className=\"flex justify-end space-x-3\">\r\n        <button\r\n          type=\"button\"\r\n          onClick={onClose}\r\n          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          disabled={loading}\r\n          title={t('common.cancel', { defaultValue: 'Abbrechen' })}\r\n        >\r\n          <XMarkIcon className=\"h-5 w-5\" />\r\n        </button>\r\n        <button\r\n          type=\"submit\"\r\n          className=\"p-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n          disabled={loading || confirmText.trim().toLowerCase() !== requiredConfirmText}\r\n          title={loading ? t('common.saving', { defaultValue: 'Speichern...' }) : t('lifecycle.offboarding.complete.button', { defaultValue: 'Offboarding abschlieen' })}\r\n        >\r\n          {loading ? (\r\n            <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\r\n          ) : (\r\n            <CheckCircleIcon className=\"h-5 w-5\" />\r\n          )}\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n  \r\n  if (!isOpen) return null;\r\n  \r\n  // Fr Mobile (unter 640px) - klassisches Modal\r\n  if (isMobile) {\r\n    return (\r\n      <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n        \r\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n          <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n            {/* Header */}\r\n            <div className=\"px-6 py-4 border-b dark:border-gray-700\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\r\n                  {t('lifecycle.offboarding.complete.title', { defaultValue: 'Offboarding abschlieen' })}\r\n                </Dialog.Title>\r\n                <button\r\n                  onClick={onClose}\r\n                  className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n                >\r\n                  <XMarkIcon className=\"h-6 w-6\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Form */}\r\n            <div className=\"p-6\">\r\n              {error && (\r\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\r\n                  {error}\r\n                </div>\r\n              )}\r\n              {renderForm()}\r\n            </div>\r\n          </Dialog.Panel>\r\n        </div>\r\n      </Dialog>\r\n    );\r\n  }\r\n  \r\n  // Fr Desktop (ab 640px) - Sidepane\r\n  return (\r\n    <>\r\n      {/* Backdrop - nur wenn offen und <= 1070px */}\r\n      {isOpen && !isLargeScreen && (\r\n        <div\r\n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\"\r\n          aria-hidden=\"true\"\r\n          onClick={onClose}\r\n          style={{\r\n            opacity: isOpen ? 1 : 0,\r\n            transition: 'opacity 300ms ease-out'\r\n          }}\r\n        />\r\n      )}\r\n      \r\n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\r\n      <div\r\n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${\r\n          isOpen ? 'translate-x-0' : 'translate-x-full'\r\n        }`}\r\n        style={{\r\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n          pointerEvents: isOpen ? 'auto' : 'none'\r\n        }}\r\n        aria-hidden={!isOpen}\r\n        role=\"dialog\"\r\n        aria-modal={isOpen}\r\n      >\r\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n          <h2 className=\"text-lg font-semibold dark:text-white\">\r\n            {t('lifecycle.offboarding.complete.title', { defaultValue: 'Offboarding abschlieen' })}\r\n          </h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n          >\r\n            <XMarkIcon className=\"h-6 w-6\" />\r\n          </button>\r\n        </div>\r\n        \r\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\r\n          {error && (\r\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\r\n              {error}\r\n            </div>\r\n          )}\r\n          {renderForm()}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default OffboardingCompleteModal;\r\n\r\n","import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { \n  CheckCircleIcon, \n  ClockIcon, \n  XCircleIcon,\n  DocumentTextIcon,\n  BuildingOfficeIcon,\n  PlusIcon,\n  PencilIcon,\n  ArrowDownTrayIcon,\n  CalendarIcon,\n  UserIcon,\n  ArrowRightIcon\n} from '@heroicons/react/24/outline';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport useMessage from '../hooks/useMessage.ts';\nimport CertificateCreationModal from './CertificateCreationModal.tsx';\nimport ContractCreationModal from './ContractCreationModal.tsx';\nimport CertificateEditModal from './CertificateEditModal.tsx';\nimport ContractEditModal from './ContractEditModal.tsx';\nimport SocialSecurityEditor from './SocialSecurityEditor.tsx';\nimport OffboardingStartModal from './OffboardingStartModal.tsx';\nimport OffboardingCompleteModal from './OffboardingCompleteModal.tsx';\n\ninterface LifecycleViewProps {\n  userId: number;\n  userName: string;\n}\n\ninterface LifecycleData {\n  lifecycle: {\n    id: number;\n    status: string;\n    onboardingStartedAt: string | null;\n    onboardingCompletedAt: string | null;\n    contractStartDate: string | null;\n    contractEndDate: string | null;\n    exitDate: string | null;\n    exitReason: string | null;\n    offboardingStartedAt: string | null;\n    offboardingCompletedAt: string | null;\n  };\n  progress: {\n    completed: number;\n    total: number;\n    percent: number;\n  };\n  socialSecurityRegistrations?: Array<{\n    id: number;\n    registrationType: string;\n    status: string;\n    registrationNumber: string | null;\n    provider: string | null;\n    registrationDate: string | null;\n  }>;\n}\n\ninterface Task {\n  id: number;\n  title: string;\n  description: string | null;\n  status: string;\n  dueDate: string | null;\n  createdAt: string;\n}\n\ninterface Certificate {\n  id: number;\n  certificateType: string;\n  issueDate: string;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n  generatedBy: number | null;\n  generatedByUser: {\n    id: number;\n    firstName: string;\n    lastName: string;\n  } | null;\n  createdAt: string;\n}\n\ninterface Contract {\n  id: number;\n  contractType: string;\n  startDate: string;\n  endDate: string | null;\n  salary: number | null;\n  workingHours: number | null;\n  position: string | null;\n  templateUsed: string | null;\n  templateVersion: string | null;\n  isLatest: boolean;\n  generatedBy: number | null;\n  generatedByUser: {\n    id: number;\n    firstName: string;\n    lastName: string;\n  } | null;\n  createdAt: string;\n}\n\nconst LifecycleView: React.FC<LifecycleViewProps> = ({ userId, userName }) => {\n  const { t } = useTranslation();\n  const { isHR, isAdmin } = usePermissions();\n  const { showMessage } = useMessage();\n  \n  const [lifecycleData, setLifecycleData] = useState<LifecycleData | null>(null);\n  const [certificates, setCertificates] = useState<Certificate[]>([]);\n  const [contracts, setContracts] = useState<Contract[]>([]);\n  const [offboardingTasks, setOffboardingTasks] = useState<Task[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  \n  // Modal States\n  const [isCertificateCreateModalOpen, setIsCertificateCreateModalOpen] = useState(false);\n  const [isContractCreateModalOpen, setIsContractCreateModalOpen] = useState(false);\n  const [editingCertificate, setEditingCertificate] = useState<Certificate | null>(null);\n  const [editingContract, setEditingContract] = useState<Contract | null>(null);\n  \n  const [downloadingCertId, setDownloadingCertId] = useState<number | null>(null);\n  const [downloadingContractId, setDownloadingContractId] = useState<number | null>(null);\n  const [isOffboardingStartModalOpen, setIsOffboardingStartModalOpen] = useState(false);\n  const [isOffboardingCompleteModalOpen, setIsOffboardingCompleteModalOpen] = useState(false);\n  const [isEditContractDatesModalOpen, setIsEditContractDatesModalOpen] = useState(false);\n  const [editingContractStartDate, setEditingContractStartDate] = useState<string>('');\n  const [editingContractEndDate, setEditingContractEndDate] = useState<string>('');\n\n  const fetchDataRef = useRef(false);\n  //  MEMORY FIX: Ref fr Mounted-Status und Timer-Cleanup\n  const isMountedRef = useRef(true);\n  const retryTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n  const statusChangeTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\n\n  const fetchData = useCallback(async (force: boolean = false) => {\n    // Verhindere mehrfaches gleichzeitiges Laden (auer wenn force=true)\n    if (fetchDataRef.current && !force) {\n      // Wenn bereits geladen wird, warte kurz und versuche es erneut\n      retryTimeoutRef.current = setTimeout(() => {\n        if (!fetchDataRef.current && isMountedRef.current) {\n          fetchData(true);\n        }\n      }, 500);\n      return;\n    }\n    \n    try {\n      fetchDataRef.current = true;\n      setLoading(true);\n      const [lifecycleResponse, certsResponse, contractsResponse, tasksResponse] = await Promise.all([\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.BY_USER(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.CERTIFICATES(userId)),\n        axiosInstance.get(API_ENDPOINTS.LIFECYCLE.CONTRACTS(userId)),\n        axiosInstance.get(API_ENDPOINTS.TASKS.BY_USER(userId)).catch(() => ({ data: [] })) // Optional, falls fehlschlgt\n      ]);\n      \n      //  MEMORY FIX: Nur State setzen wenn noch gemounted\n      if (!isMountedRef.current) return;\n      \n      setLifecycleData(lifecycleResponse.data);\n      setCertificates(certsResponse.data?.certificates || []);\n      setContracts(contractsResponse.data?.contracts || []);\n      \n      // Filtere Offboarding-Tasks (die 3 spezifischen Tasks)\n      const allTasks = tasksResponse.data || [];\n      const offboardingTaskTitles = [\n        'Crear certificado laboral',\n        'Realizar liquidacin final',\n        'Desafiliar de seguridad social'\n      ];\n      const filteredTasks = allTasks.filter((task: Task) => \n        offboardingTaskTitles.includes(task.title)\n      );\n      setOffboardingTasks(filteredTasks);\n      \n      // Prfe ob automatische Status-nderung ntig ist (wird im Backend gemacht, aber hier prfen wir fr UI-Feedback)\n      if (lifecycleResponse.data?.lifecycle?.status === 'onboarding' && lifecycleResponse.data?.progress?.percent === 100) {\n        // Status wird automatisch im Backend gendert, lade Daten nach kurzer Verzgerung neu\n        statusChangeTimeoutRef.current = setTimeout(() => {\n          if (isMountedRef.current) {\n            fetchData();\n          }\n        }, 1000);\n      }\n      \n      setError(null);\n    } catch (err: any) {\n      if (!isMountedRef.current) return;\n      console.error('Fehler beim Laden der Lebenszyklus-Daten:', err);\n      setError(err.response?.data?.message || 'Fehler beim Laden der Daten');\n      showMessage('Fehler beim Laden der Daten', 'error');\n    } finally {\n      setLoading(false);\n      fetchDataRef.current = false;\n    }\n  }, [userId]); // showMessage entfernt, da es sich ndern kann\n\n  useEffect(() => {\n    isMountedRef.current = true;\n    fetchDataRef.current = false; // Reset beim userId-Wechsel\n    fetchData();\n    \n    //  MEMORY FIX: Cleanup Timer bei Unmount\n    return () => {\n      isMountedRef.current = false;\n      if (retryTimeoutRef.current) clearTimeout(retryTimeoutRef.current);\n      if (statusChangeTimeoutRef.current) clearTimeout(statusChangeTimeoutRef.current);\n    };\n  }, [fetchData]);\n\n  const handleDownloadCertificate = async (certId: number) => {\n    setDownloadingCertId(certId);\n    try {\n      const response = await axiosInstance.get(\n        API_ENDPOINTS.LIFECYCLE.CERTIFICATE_DOWNLOAD(userId, certId),\n        { responseType: 'blob' }\n      );\n      \n      const blob = new Blob([response.data], { type: 'application/pdf' });\n      const downloadUrl = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = downloadUrl;\n      link.download = `arbeitszeugnis-${certId}.pdf`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      window.URL.revokeObjectURL(downloadUrl);\n      \n      showMessage('Arbeitszeugnis erfolgreich heruntergeladen', 'success');\n    } catch (err: any) {\n      console.error('Fehler beim Herunterladen:', err);\n      showMessage('Fehler beim Herunterladen des Arbeitszeugnisses', 'error');\n    } finally {\n      setDownloadingCertId(null);\n    }\n  };\n\n  const handleEditContractDates = () => {\n    if (!lifecycleData?.lifecycle) return;\n    \n    setEditingContractStartDate(\n      lifecycleData.lifecycle.contractStartDate \n        ? new Date(lifecycleData.lifecycle.contractStartDate).toISOString().split('T')[0]\n        : ''\n    );\n    setEditingContractEndDate(\n      lifecycleData.lifecycle.contractEndDate \n        ? new Date(lifecycleData.lifecycle.contractEndDate).toISOString().split('T')[0]\n        : ''\n    );\n    setIsEditContractDatesModalOpen(true);\n  };\n\n  const handleSaveContractDates = async () => {\n    try {\n      await axiosInstance.put(API_ENDPOINTS.LIFECYCLE.STATUS(userId), {\n        status: lifecycleData?.lifecycle.status || 'active',\n        contractStartDate: editingContractStartDate || null,\n        contractEndDate: editingContractEndDate || null\n      });\n      \n      showMessage('Vertragsdaten erfolgreich aktualisiert', 'success');\n      setIsEditContractDatesModalOpen(false);\n      fetchData();\n    } catch (err: any) {\n      console.error('Fehler beim Speichern der Vertragsdaten:', err);\n      showMessage('Fehler beim Speichern der Vertragsdaten', 'error');\n    }\n  };\n\n\n  const handleDownloadContract = async (contractId: number) => {\n    setDownloadingContractId(contractId);\n    try {\n      const response = await axiosInstance.get(\n        API_ENDPOINTS.LIFECYCLE.CONTRACT_DOWNLOAD(userId, contractId),\n        { responseType: 'blob' }\n      );\n      \n      const blob = new Blob([response.data], { type: 'application/pdf' });\n      const downloadUrl = window.URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = downloadUrl;\n      link.download = `arbeitsvertrag-${contractId}.pdf`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      window.URL.revokeObjectURL(downloadUrl);\n      \n      showMessage('Arbeitsvertrag erfolgreich heruntergeladen', 'success');\n    } catch (err: any) {\n      console.error('Fehler beim Herunterladen:', err);\n      showMessage('Fehler beim Herunterladen des Arbeitsvertrags', 'error');\n    } finally {\n      setDownloadingContractId(null);\n    }\n  };\n\n  const getStatusBadge = (status: string, clickable: boolean = false) => {\n    const statusConfig: Record<string, { color: string; labelKey: string }> = {\n      onboarding: { color: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300', labelKey: 'lifecycle.status.onboarding' },\n      active: { color: 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300', labelKey: 'lifecycle.status.active' },\n      contract_change: { color: 'bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300', labelKey: 'lifecycle.status.contract_change' },\n      offboarding: { color: 'bg-orange-100 text-orange-800 dark:bg-orange-900/20 dark:text-orange-300', labelKey: 'lifecycle.status.offboarding' },\n      archived: { color: 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300', labelKey: 'lifecycle.status.archived' }\n    };\n\n    const config = statusConfig[status] || { color: 'bg-gray-100 text-gray-800', labelKey: status };\n    \n    return (\n      <span className={`px-3 py-1 rounded-full text-sm font-medium ${config.color} ${clickable ? 'cursor-pointer hover:opacity-80' : ''}`}>\n        {t(config.labelKey) || status}\n      </span>\n    );\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('de-DE', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric'\n    });\n  };\n\n  if (loading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex justify-center items-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"bg-red-50 dark:bg-red-900/20 border-l-4 border-red-400 p-4\">\n          <p className=\"text-sm text-red-700 dark:text-red-300\">{error}</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!lifecycleData) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <p className=\"text-gray-500 dark:text-gray-400\">{t('lifecycle.noData', { defaultValue: 'Keine Lebenszyklus-Daten verfgbar' })}</p>\n      </div>\n    );\n  }\n\n  // Extrahiere socialSecurityRegistrations aus lifecycle (falls direkt vorhanden) oder aus lifecycleData\n  const socialSecurityRegistrations = lifecycleData.lifecycle?.socialSecurityRegistrations || lifecycleData.socialSecurityRegistrations || [];\n  const { lifecycle, progress } = lifecycleData;\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Status-Box */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n            <BuildingOfficeIcon className=\"h-5 w-5 mr-2\" />\n            {t('lifecycle.statusTitle')}\n          </h3>\n          <div className=\"flex items-center space-x-3\">\n          {/* Status-Badge (nur Anzeige, keine nderung mglich) */}\n          {getStatusBadge(lifecycle.status)}\n            {/* Offboarding-Start-Button (nur fr HR/Admin, nur wenn Status = \"active\") */}\n            {(isHR() || isAdmin()) && lifecycle.status === 'active' && (\n              <div className=\"relative group\">\n                <button\n                  onClick={() => setIsOffboardingStartModalOpen(true)}\n                  className=\"p-2 bg-orange-600 dark:bg-orange-700 text-white rounded-md hover:bg-orange-700 dark:hover:bg-orange-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500\"\n                >\n                  <ArrowRightIcon className=\"h-5 w-5\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {t('lifecycle.offboarding.startButton', { defaultValue: 'Offboarding starten' })}\n                </div>\n              </div>\n            )}\n            {/* Offboarding-Abschluss-Button (nur fr HR/Admin, nur wenn Status = \"offboarding\") */}\n            {(isHR() || isAdmin()) && lifecycle.status === 'offboarding' && (\n              <div className=\"relative group\">\n                <button\n                  onClick={() => setIsOffboardingCompleteModalOpen(true)}\n                  className=\"p-2 bg-red-600 dark:bg-red-700 text-white rounded-md hover:bg-red-700 dark:hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\"\n                >\n                  <CheckCircleIcon className=\"h-5 w-5\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {t('lifecycle.offboarding.complete.button', { defaultValue: 'Offboarding abschlieen' })}\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n\n        <div className=\"space-y-2 text-sm\">\n          {lifecycle.onboardingStartedAt && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.onboardingStarted')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.onboardingStartedAt).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          {lifecycle.onboardingCompletedAt && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.onboardingCompleted')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.onboardingCompletedAt).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          <div className=\"flex justify-between items-center\">\n            <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.contractStart')}</span>\n            <div className=\"flex items-center space-x-2\">\n              {lifecycle.contractStartDate ? (\n                <span className=\"dark:text-white\">\n                  {new Date(lifecycle.contractStartDate).toLocaleDateString('de-DE')}\n                </span>\n              ) : (\n                <span className=\"text-gray-400 italic text-sm\">{t('lifecycle.notSet', { defaultValue: 'Nicht gesetzt' })}</span>\n              )}\n              {(isHR() || isAdmin()) && (\n                <div className=\"relative group\">\n                  <button\n                    onClick={() => handleEditContractDates()}\n                    className=\"p-1 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition\"\n                  >\n                    <PencilIcon className=\"h-4 w-4\" />\n                  </button>\n                  <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                    {t('lifecycle.edit', { defaultValue: 'Bearbeiten' })}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n          <div className=\"flex justify-between items-center\">\n            <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.contractEnd')}</span>\n            <div className=\"flex items-center space-x-2\">\n              {lifecycle.contractEndDate ? (\n                <span className=\"dark:text-white\">\n                  {new Date(lifecycle.contractEndDate).toLocaleDateString('de-DE')}\n                </span>\n              ) : (\n                <span className=\"text-gray-400 italic text-sm\">{t('lifecycle.notSet', { defaultValue: 'Nicht gesetzt' })}</span>\n              )}\n              {(isHR() || isAdmin()) && (\n                <div className=\"relative group\">\n                  <button\n                    onClick={() => handleEditContractDates()}\n                    className=\"p-1 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition\"\n                  >\n                    <PencilIcon className=\"h-4 w-4\" />\n                  </button>\n                  <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                    {t('lifecycle.edit', { defaultValue: 'Bearbeiten' })}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n          {lifecycle.offboardingStartedAt && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.offboardingStarted')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.offboardingStartedAt).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          {lifecycle.exitDate && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.exitDate')}</span>\n              <span className=\"dark:text-white\">\n                {new Date(lifecycle.exitDate).toLocaleDateString('de-DE')}\n              </span>\n            </div>\n          )}\n          {lifecycle.exitReason && (\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600 dark:text-gray-400\">{t('lifecycle.exitReason')}</span>\n              <span className=\"dark:text-white\">{lifecycle.exitReason}</span>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Progress-Bar - Onboarding */}\n      {lifecycle.status === 'onboarding' && (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n          <h3 className=\"text-lg font-semibold dark:text-white mb-4\">{t('lifecycle.progressTitle')}</h3>\n          <div className=\"space-y-2\">\n            <div className=\"flex justify-between text-sm mb-2\">\n              <span className=\"text-gray-600 dark:text-gray-400\">\n                {t('lifecycle.progressSteps', { completed: progress.completed, total: progress.total })}\n              </span>\n              <span className=\"font-medium dark:text-white\">{progress.percent}%</span>\n            </div>\n            <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3\">\n              <div\n                className=\"bg-blue-600 h-3 rounded-full transition-all duration-300\"\n                style={{ width: `${progress.percent}%` }}\n              ></div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Progress-Bar - Offboarding */}\n      {lifecycle.status === 'offboarding' && (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n          <h3 className=\"text-lg font-semibold dark:text-white mb-4\">{t('lifecycle.offboarding.progressTitle', { defaultValue: 'Offboarding-Fortschritt' })}</h3>\n          <div className=\"space-y-4\">\n            {/* Progress-Bar */}\n            {(() => {\n              const completedTasks = offboardingTasks.filter(task => task.status === 'done').length;\n              const totalTasks = offboardingTasks.length || 3; // Fallback: 3 Tasks\n              const percent = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;\n              \n              return (\n                <>\n                  <div className=\"flex justify-between text-sm mb-2\">\n                    <span className=\"text-gray-600 dark:text-gray-400\">\n                      {t('lifecycle.offboarding.progressSteps', { completed: completedTasks, total: totalTasks }) || `${completedTasks} von ${totalTasks} Schritten abgeschlossen`}\n                    </span>\n                    <span className=\"font-medium dark:text-white\">{percent}%</span>\n                  </div>\n                  <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3\">\n                    <div\n                      className=\"bg-orange-600 h-3 rounded-full transition-all duration-300\"\n                      style={{ width: `${percent}%` }}\n                    ></div>\n                  </div>\n                </>\n              );\n            })()}\n            \n            {/* Offboarding-Tasks Liste */}\n            {offboardingTasks.length > 0 && (\n              <div className=\"mt-4 space-y-2\">\n                <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  {t('lifecycle.offboarding.tasksTitle', { defaultValue: 'Offboarding-Aufgaben' })}\n                </h4>\n                {offboardingTasks.map((task) => {\n                  const isCompleted = task.status === 'done';\n                  return (\n                    <div\n                      key={task.id}\n                      className={`flex items-center justify-between p-3 rounded-lg border ${\n                        isCompleted\n                          ? 'bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800'\n                          : 'bg-gray-50 dark:bg-gray-700/50 border-gray-200 dark:border-gray-600'\n                      }`}\n                    >\n                      <div className=\"flex items-center space-x-3 flex-1\">\n                        {isCompleted ? (\n                          <CheckCircleIcon className=\"h-5 w-5 text-green-600 dark:text-green-400 flex-shrink-0\" />\n                        ) : (\n                          <ClockIcon className=\"h-5 w-5 text-orange-600 dark:text-orange-400 flex-shrink-0\" />\n                        )}\n                        <div className=\"flex-1 min-w-0\">\n                          <p className={`text-sm font-medium ${isCompleted ? 'text-green-800 dark:text-green-200' : 'text-gray-800 dark:text-gray-200'}`}>\n                            {task.title}\n                          </p>\n                          {task.description && (\n                            <p className=\"text-xs text-gray-600 dark:text-gray-400 mt-1 truncate\">\n                              {task.description}\n                            </p>\n                          )}\n                        </div>\n                      </div>\n                      <span className={`text-xs px-2 py-1 rounded ${\n                        isCompleted\n                          ? 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200'\n                          : 'bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200'\n                      }`}>\n                        {isCompleted\n                          ? t('common.done', { defaultValue: 'Abgeschlossen' })\n                          : t('common.open', { defaultValue: 'Offen' })}\n                      </span>\n                    </div>\n                  );\n                })}\n              </div>\n            )}\n          </div>\n        </div>\n      )}\n\n      {/* Dokumente - Arbeitszeugnisse */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n            <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n            {t('lifecycle.certificates')}\n          </h3>\n          {(isHR() || isAdmin()) && (\n            <div className=\"relative group\">\n              <button\n                onClick={() => setIsCertificateCreateModalOpen(true)}\n                className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n                style={{ width: '30.19px', height: '30.19px' }}\n                aria-label={t('lifecycle.createCertificate')}\n              >\n                <PlusIcon className=\"h-4 w-4\" />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('lifecycle.createCertificate')}\n              </div>\n            </div>\n          )}\n        </div>\n\n        {certificates.length === 0 ? (\n          <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n            <DocumentTextIcon className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\n            <p>{t('lifecycle.noCertificates')}</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {certificates.map((cert) => (\n              <div\n                key={cert.id}\n                className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition\"\n              >\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center space-x-2 mb-2\">\n                      <h4 className=\"font-medium dark:text-white\">\n                        {t('lifecycle.certificate')}\n                        {cert.certificateType !== 'employment' && ` (${cert.certificateType})`}\n                      </h4>\n                      {cert.isLatest && (\n                        <span className=\"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 flex items-center\">\n                          <CheckCircleIcon className=\"h-3 w-3 mr-1\" />\n                          {t('lifecycle.current')}\n                        </span>\n                      )}\n                    </div>\n                    <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                      <div className=\"flex items-center space-x-2\">\n                        <CalendarIcon className=\"h-4 w-4\" />\n                        <span>{t('lifecycle.issuedOn')} {formatDate(cert.issueDate)}</span>\n                      </div>\n                      {cert.generatedByUser && (\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4\" />\n                          <span>\n                            {t('lifecycle.createdBy')} {cert.generatedByUser.firstName} {cert.generatedByUser.lastName}\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"flex items-center space-x-2 ml-4\">\n                    {(isHR() || isAdmin()) && (\n                      <div className=\"relative group\">\n                        <button\n                          onClick={() => setEditingCertificate(cert)}\n                          className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition\"\n                        >\n                          <PencilIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('lifecycle.edit')}\n                        </div>\n                      </div>\n                    )}\n                    <div className=\"relative group\">\n                      <button\n                        onClick={() => handleDownloadCertificate(cert.id)}\n                        disabled={downloadingCertId === cert.id}\n                        className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition disabled:opacity-50 disabled:cursor-not-allowed\"\n                      >\n                        {downloadingCertId === cert.id ? (\n                          <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"></div>\n                        ) : (\n                          <ArrowDownTrayIcon className=\"h-5 w-5\" />\n                        )}\n                      </button>\n                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('lifecycle.download')}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Dokumente - Arbeitsvertrge */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center mb-4\">\n          {(isHR() || isAdmin()) && (\n            <div className=\"relative group mr-3\">\n              <button\n                onClick={() => setIsContractCreateModalOpen(true)}\n                className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n                style={{ width: '30.19px', height: '30.19px' }}\n                aria-label={t('lifecycle.createContract')}\n              >\n                <PlusIcon className=\"h-4 w-4\" />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('lifecycle.createContract')}\n              </div>\n            </div>\n          )}\n          <h3 className=\"text-lg font-semibold dark:text-white flex items-center\">\n            <DocumentTextIcon className=\"h-5 w-5 mr-2\" />\n            {t('lifecycle.contracts')}\n          </h3>\n        </div>\n\n        {contracts.length === 0 ? (\n          <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n            <DocumentTextIcon className=\"h-12 w-12 mx-auto mb-4 text-gray-400\" />\n            <p>{t('lifecycle.noContracts')}</p>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {contracts.map((contract) => (\n              <div\n                key={contract.id}\n                className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition\"\n              >\n                <div className=\"flex items-start justify-between\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center space-x-2 mb-2\">\n                      <h4 className=\"font-medium dark:text-white\">\n                        {t('lifecycle.contract')}\n                        {contract.contractType !== 'employment' && ` (${contract.contractType})`}\n                      </h4>\n                      {contract.isLatest && (\n                        <span className=\"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 flex items-center\">\n                          <CheckCircleIcon className=\"h-3 w-3 mr-1\" />\n                          {t('lifecycle.current')}\n                        </span>\n                      )}\n                    </div>\n                    <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                      <div className=\"flex items-center space-x-2\">\n                        <CalendarIcon className=\"h-4 w-4\" />\n                        <span>\n                          {formatDate(contract.startDate)}\n                          {contract.endDate && ` - ${formatDate(contract.endDate)}`}\n                        </span>\n                      </div>\n                      {contract.position && (\n                        <div>{t('lifecycle.position')} {contract.position}</div>\n                      )}\n                      {contract.salary && (\n                        <div>{t('lifecycle.salary')} {contract.salary.toLocaleString('de-DE', { style: 'currency', currency: 'EUR' })}</div>\n                      )}\n                      {contract.workingHours && (\n                        <div>{t('lifecycle.workingHours')} {contract.workingHours}h/Woche</div>\n                      )}\n                      {contract.generatedByUser && (\n                        <div className=\"flex items-center space-x-2\">\n                          <UserIcon className=\"h-4 w-4\" />\n                          <span>\n                            {t('lifecycle.createdBy')} {contract.generatedByUser.firstName} {contract.generatedByUser.lastName}\n                          </span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                  <div className=\"flex items-center space-x-2 ml-4\">\n                    {(isHR() || isAdmin()) && (\n                      <div className=\"relative group\">\n                        <button\n                          onClick={() => setEditingContract(contract)}\n                          className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition\"\n                        >\n                          <PencilIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('lifecycle.edit')}\n                        </div>\n                      </div>\n                    )}\n                    <div className=\"relative group\">\n                      <button\n                        onClick={() => handleDownloadContract(contract.id)}\n                        disabled={downloadingContractId === contract.id}\n                        className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-md transition disabled:opacity-50 disabled:cursor-not-allowed\"\n                      >\n                        {downloadingContractId === contract.id ? (\n                          <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600\"></div>\n                        ) : (\n                          <ArrowDownTrayIcon className=\"h-5 w-5\" />\n                        )}\n                      </button>\n                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('lifecycle.download')}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Social Security Editor - Nur fr Legal/Admin */}\n      {lifecycleData?.lifecycle && (\n        <SocialSecurityEditor\n          userId={userId}\n          lifecycleId={lifecycleData.lifecycle.id}\n          onUpdate={() => fetchData(true)}\n        />\n      )}\n\n      {/* Modals */}\n      <CertificateCreationModal\n        isOpen={isCertificateCreateModalOpen}\n        onClose={() => setIsCertificateCreateModalOpen(false)}\n        onCertificateCreated={() => {\n          fetchData();\n          setIsCertificateCreateModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n      />\n\n      <ContractCreationModal\n        isOpen={isContractCreateModalOpen}\n        onClose={() => setIsContractCreateModalOpen(false)}\n        onContractCreated={() => {\n          fetchData();\n          setIsContractCreateModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n      />\n\n      {editingCertificate && (\n        <CertificateEditModal\n          isOpen={!!editingCertificate}\n          onClose={() => setEditingCertificate(null)}\n          onCertificateUpdated={() => {\n            fetchData();\n            setEditingCertificate(null);\n          }}\n          userId={userId}\n          certificate={editingCertificate}\n        />\n      )}\n\n      {editingContract && (\n        <ContractEditModal\n          isOpen={!!editingContract}\n          onClose={() => setEditingContract(null)}\n          onContractUpdated={() => {\n            fetchData();\n            setEditingContract(null);\n          }}\n          userId={userId}\n          contract={editingContract}\n        />\n      )}\n\n      {/* Offboarding-Start-Modal */}\n      <OffboardingStartModal\n        isOpen={isOffboardingStartModalOpen}\n        onClose={() => setIsOffboardingStartModalOpen(false)}\n        onOffboardingStarted={() => {\n          fetchData();\n          setIsOffboardingStartModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n      />\n      \n      {/* Offboarding-Abschluss-Modal */}\n      <OffboardingCompleteModal\n        isOpen={isOffboardingCompleteModalOpen}\n        onClose={() => setIsOffboardingCompleteModalOpen(false)}\n        onOffboardingCompleted={() => {\n          fetchData();\n          setIsOffboardingCompleteModalOpen(false);\n        }}\n        userId={userId}\n        userName={userName}\n        offboardingTasks={offboardingTasks}\n      />\n\n      {/* Modal zum Bearbeiten der Vertragsdaten */}\n      {isEditContractDatesModalOpen && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md mx-4\">\n            <h2 className=\"text-xl font-semibold dark:text-white mb-4\">\n              {t('lifecycle.editContractDates', { defaultValue: 'Vertragsdaten bearbeiten' })}\n            </h2>\n            \n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('lifecycle.contractStart', { defaultValue: 'Vertragsbeginn' })} *\n                </label>\n                <input\n                  type=\"date\"\n                  value={editingContractStartDate}\n                  onChange={(e) => setEditingContractStartDate(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  required\n                />\n              </div>\n              \n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('lifecycle.contractEnd', { defaultValue: 'Vertragsende' })} (optional)\n                </label>\n                <input\n                  type=\"date\"\n                  value={editingContractEndDate}\n                  onChange={(e) => setEditingContractEndDate(e.target.value)}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                />\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                  {t('lifecycle.contractEndHint', { defaultValue: 'Nur bei befristeten Vertrgen ausfllen' })}\n                </p>\n              </div>\n            </div>\n            \n            <div className=\"flex justify-end space-x-3 mt-6\">\n              <button\n                onClick={() => setIsEditContractDatesModalOpen(false)}\n                className=\"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition\"\n              >\n                {t('common.cancel', { defaultValue: 'Abbrechen' })}\n              </button>\n              <button\n                onClick={handleSaveContractDates}\n                disabled={!editingContractStartDate}\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                {t('common.save', { defaultValue: 'Speichern' })}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default LifecycleView;\n\n","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { userApi, roleApi, branchApi } from '../api/apiClient.ts';\nimport { User, Role } from '../types/interfaces.ts';\nimport { CheckIcon, PlusIcon, PencilIcon, DocumentTextIcon, UserCircleIcon, ShieldCheckIcon, XMarkIcon, ArrowPathIcon, BuildingOfficeIcon, MapPinIcon } from '@heroicons/react/24/outline';\nimport useMessage from '../hooks/useMessage.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport IdentificationDocumentList from './IdentificationDocumentList.tsx';\nimport LifecycleView from './LifecycleView.tsx';\nimport { handleDirectDocumentUpload } from '../utils/documentUploadHandler.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport { useError } from '../contexts/ErrorContext.tsx';\nimport { logger } from '../utils/logger.ts';\n\ninterface UserManagementTabProps {\n}\n\n// Lnder und Sprachen werden dynamisch aus bersetzungen geladen\n\n// Definiere Rollen, die immer vorhanden sein sollten (z.B. Admin-Rolle)\nconst fixedRoles = [1, 2, 999]; // Admin (1), User (2) und Hamburger (999) sind fixe Rollen\n\n// Vertragstypen fr Kolumbien (CO)\nconst CONTRACT_TYPES = [\n  { code: 'tiempo_completo', name: 'Tiempo Completo (>21 Tage/Monat)' },\n  { code: 'tiempo_parcial_7', name: 'Tiempo Parcial (7 Tage/Monat)' },\n  { code: 'tiempo_parcial_14', name: 'Tiempo Parcial (14 Tage/Monat)' },\n  { code: 'tiempo_parcial_21', name: 'Tiempo Parcial (21 Tage/Monat)' },\n  { code: 'prestacion_de_servicios', name: 'Prestacin de Servicios' },\n  { code: 'externo', name: 'Externo' }\n];\n\n// Gemeinsame Debug-Komponente hinzufgen\nconst RoleDebugInfo = ({ title, data }: { title: string, data: any }) => (\n  <div className=\"mb-2 p-2 border border-gray-300 rounded bg-gray-50\">\n    <h5 className=\"font-bold text-sm\">{title}</h5>\n    <pre className=\"text-xs overflow-auto max-h-24\">\n      {JSON.stringify(data, null, 2)}\n    </pre>\n  </div>\n);\n\nconst UserManagementTab = (): JSX.Element => {\n  const { t } = useTranslation();\n  const { handleError: handleErrorContext } = useError();\n  \n  // Lnder fr die Auswahl (dynamisch aus bersetzungen)\n  const COUNTRIES = [\n    { code: 'CO', name: t('countries.CO') },\n    { code: 'CH', name: t('countries.CH') },\n    { code: 'DE', name: t('countries.DE') },\n    { code: 'AT', name: t('countries.AT') }\n  ];\n\n  // Lnder fr die Payroll-Auswahl (dynamisch aus bersetzungen)\n  const PAYROLL_COUNTRIES = [\n    { code: 'CH', name: t('countries.CH') },\n    { code: 'CO', name: t('countries.CO') }\n  ];\n\n  // Sprachen fr die Auswahl (dynamisch aus bersetzungen)\n  const LANGUAGES = [\n    { code: 'es', name: t('languages.es') },\n    { code: 'de', name: t('languages.de') },\n    { code: 'en', name: t('languages.en') }\n  ];\n  \n  // Benutzer-States\n  const [users, setUsers] = useState<User[]>([]);\n  const [selectedUser, setSelectedUser] = useState<User | null>(null);\n  const [userFormData, setUserFormData] = useState<Partial<User>>({});\n  const [isEditingUser, setIsEditingUser] = useState(false);\n  const [selectedRoles, setSelectedRoles] = useState<number[]>([]);\n  const [lifecycleRefreshKey, setLifecycleRefreshKey] = useState(0);\n  const [isDebugMode, setIsDebugMode] = useState(false);\n  const [roleWarning, setRoleWarning] = useState<string | null>(null);\n  const { showMessage } = useMessage();\n  const { isAdmin } = usePermissions();\n  \n  // Neuer State fr Rollen\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loadingRoles, setLoadingRoles] = useState(false);\n  \n  // State fr Branches\n  const [branches, setBranches] = useState<Array<{ id: number; name: string }>>([]);\n  const [loadingBranches, setLoadingBranches] = useState(false);\n  const [selectedBranches, setSelectedBranches] = useState<number[]>([]);\n  \n  // Neuer State fr die aktive Unterseite\n  const [activeUserTab, setActiveUserTab] = useState<'details' | 'documents' | 'roles' | 'branches' | 'lifecycle'>('details');\n  \n  // State fr Active/Inactive Filter\n  const [userFilterTab, setUserFilterTab] = useState<'active' | 'inactive'>('active');\n  \n  // State fr Dokument-Upload\n  const [isUploading, setIsUploading] = useState(false);\n  const documentListRef = useRef<{ loadDocuments: () => void }>(null);\n  \n  // State fr Benutzererstellung\n  const [isCreateModalOpen, setIsCreateModalOpen] = useState(false);\n  const [isMobile, setIsMobile] = useState<boolean>(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [newUserFormData, setNewUserFormData] = useState({\n    email: '',\n    password: '',\n    firstName: '',\n    lastName: ''\n  });\n\n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isCreateModalOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isCreateModalOpen, openSidepane, closeSidepane]);\n\n  // Alle Benutzer (fr Filterung)\n  const [allUsers, setAllUsers] = useState<User[]>([]);\n\n  // Initialisierung - Laden von Benutzern\n  useEffect(() => {\n    fetchAllUsers();\n  }, []);\n\n  // Benutzerdaten laden - Verwende gefilterten Endpoint, damit nur Benutzer der eigenen Organisation angezeigt werden\n  const fetchAllUsers = async () => {\n    try {\n      const response = await userApi.getAll();\n      setAllUsers(response.data);\n      // Initial: Nur aktive Benutzer anzeigen\n      filterUsersByActiveStatus('active', response.data);\n    } catch (err) {\n      handleError(err);\n    }\n  };\n\n  // Benutzer nach Active/Inactive filtern und alphabetisch sortieren\n  const filterUsersByActiveStatus = (status: 'active' | 'inactive', usersToFilter: User[] = allUsers) => {\n    const filtered = usersToFilter.filter(user => {\n      const isActive = user.active !== undefined ? user.active : true; // Default: true\n      return status === 'active' ? isActive : !isActive;\n    });\n    \n    // Alphabetisch sortieren nach username, dann firstName\n    const sorted = filtered.sort((a, b) => {\n      const aUsername = (a.username || '').toLowerCase();\n      const bUsername = (b.username || '').toLowerCase();\n      const aFirstName = (a.firstName || '').toLowerCase();\n      const bFirstName = (b.firstName || '').toLowerCase();\n      \n      // Zuerst nach username sortieren\n      if (aUsername !== bUsername) {\n        return aUsername.localeCompare(bUsername);\n      }\n      // Wenn username gleich, nach Vorname sortieren\n      return aFirstName.localeCompare(bFirstName);\n    });\n    \n    setUsers(sorted);\n  };\n\n  // Wenn Filter-Tab wechselt, Benutzerliste neu filtern\n  useEffect(() => {\n    if (allUsers.length > 0) {\n      filterUsersByActiveStatus(userFilterTab, allUsers);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [userFilterTab]);\n  \n  // Rollen laden - Wird erst aufgerufen, wenn ein Benutzer ausgewhlt wurde\n  const fetchRoles = async () => {\n    try {\n      setLoadingRoles(true);\n      \n      // Fallback-Rollen fr den Notfall bereithalten\n      const fallbackRoles = [\n        { id: 1, name: 'admin', description: 'Administrator mit allen Rechten', permissions: [] },\n        { id: 2, name: 'user', description: 'Standardbenutzer', permissions: [] },\n        { id: 999, name: 'hamburger', description: 'Hamburger-Rolle fr neue Benutzer', permissions: [] }\n      ];\n      \n      try {\n        const response = await roleApi.getAll();\n        if (response.data && Array.isArray(response.data) && response.data.length > 0) {\n          setRoles(response.data);\n          logger.log(`${response.data.length} Rollen erfolgreich geladen`);\n        } else {\n          console.warn('Keine Rollen vom Server erhalten, verwende Fallback');\n          setRoles(fallbackRoles);\n        }\n      } catch (error) {\n        console.warn('Fehler beim Laden der Rollen, verwende Fallback:', error);\n        setRoles(fallbackRoles);\n      }\n    } finally {\n      setLoadingRoles(false);\n    }\n  };\n\n  // Branches laden - Wird erst aufgerufen, wenn ein Benutzer ausgewhlt wurde\n  const fetchBranches = async () => {\n    try {\n      setLoadingBranches(true);\n      \n      try {\n        const response = await branchApi.getAll();\n        if (response.data && Array.isArray(response.data) && response.data.length > 0) {\n          setBranches(response.data);\n          logger.log(`${response.data.length} Branches erfolgreich geladen`);\n        } else {\n          console.warn('Keine Branches vom Server erhalten');\n          setBranches([]);\n        }\n      } catch (error) {\n        console.warn('Fehler beim Laden der Branches:', error);\n        setBranches([]);\n      }\n    } finally {\n      setLoadingBranches(false);\n    }\n  };\n\n  const handleDirectDocumentUploadWrapper = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (!e.target.files || e.target.files.length === 0) return;\n    if (!selectedUser) return;\n    \n    setIsUploading(true);\n    \n    const result = await handleDirectDocumentUpload(\n      e.target.files[0],\n      selectedUser.id,\n      async () => {\n        await fetchUserDetails(selectedUser.id);\n        // Warte kurz, damit Backend verarbeitet\n        await new Promise(resolve => setTimeout(resolve, 500));\n        // Lade Dokumente neu, wenn die Komponente gemountet ist\n        documentListRef.current?.loadDocuments();\n        showMessage(t('profile.documentUploadSuccess', { defaultValue: 'Dokument erfolgreich hochgeladen. Felder werden automatisch ausgefllt.' }), 'success');\n      },\n      (error) => {\n        showMessage(error, 'error');\n      }\n    );\n    \n    setIsUploading(false);\n    e.target.value = '';\n  };\n\n  // Detaillierte Benutzerdaten laden\n  const fetchUserDetails = async (userId: number) => {\n    try {\n      if (!userId || isNaN(userId)) {\n        setSelectedUser(null);\n        return;\n      }\n      \n      logger.log('Lade Benutzerdetails fr ID:', userId);\n      const response = await userApi.getById(userId);\n      \n      const userData = {\n        ...response.data,\n        active: response.data.active !== undefined ? response.data.active : true,\n        birthday: response.data.birthday ? new Date(response.data.birthday).toISOString().split('T')[0] : null\n      };\n      \n      // Extrahiere Rollen-IDs aus der verschachtelten Struktur\n      let roleIds: number[] = [];\n      \n      if (response.data.roles && Array.isArray(response.data.roles)) {\n        logger.log('Rollenstruktur (Typ):', typeof response.data.roles, 'Lnge:', response.data.roles.length);\n        \n        // Struktur: roles: [{ role: { id, name, ... } }]\n        if (response.data.roles.length > 0 && response.data.roles[0].role) {\n          roleIds = response.data.roles.map(userRole => userRole.role.id);\n          logger.log('Extrahierte Rollen-IDs aus verschachtelter Struktur:', roleIds);\n        }\n        // Fallback fr andere Formate\n        else if (response.data.roles.length > 0) {\n          if (typeof response.data.roles[0] === 'number') {\n            roleIds = response.data.roles;\n          } else if (response.data.roles[0].roleId) {\n            roleIds = response.data.roles.map(role => role.roleId);\n          } else if (response.data.roles[0].id) {\n            roleIds = response.data.roles.map(role => role.id);\n          }\n        }\n      } else {\n        console.warn('Rollen fehlen oder sind kein Array:', response.data.roles);\n      }\n      \n      // Wenn keine Rollen gefunden wurden, probieren wir, diese aus roles in der Response direkt zu extrahieren\n      if (roleIds.length === 0 && response.data.role) {\n        logger.log('Versuche Rollen aus role-Eigenschaft zu extrahieren:', response.data.role);\n        if (Array.isArray(response.data.role)) {\n          roleIds = response.data.role.map((r: any) => r.id);\n        } else if (typeof response.data.role === 'object' && response.data.role !== null) {\n          roleIds = [response.data.role.id];\n        }\n      }\n      \n      logger.log('Endgltige extrahierte Rollen-IDs:', roleIds);\n      \n      // Extrahiere Branch-IDs aus der verschachtelten Struktur\n      let branchIds: number[] = [];\n      \n      if (response.data.branches && Array.isArray(response.data.branches)) {\n        logger.log('Branches-Struktur (Typ):', typeof response.data.branches, 'Lnge:', response.data.branches.length);\n        \n        // Struktur: branches: [{ branch: { id, name, ... } }]\n        if (response.data.branches.length > 0 && response.data.branches[0].branch) {\n          branchIds = response.data.branches.map(userBranch => userBranch.branch.id);\n          logger.log('Extrahierte Branch-IDs aus verschachtelter Struktur:', branchIds);\n        }\n        // Fallback fr andere Formate\n        else if (response.data.branches.length > 0) {\n          if (typeof response.data.branches[0] === 'number') {\n            branchIds = response.data.branches;\n          } else if (response.data.branches[0].branchId) {\n            branchIds = response.data.branches.map(branch => branch.branchId);\n          } else if (response.data.branches[0].id) {\n            branchIds = response.data.branches.map(branch => branch.id);\n          }\n        }\n      } else {\n        console.warn('Branches fehlen oder sind kein Array:', response.data.branches);\n      }\n      \n      logger.log('Endgltige extrahierte Branch-IDs:', branchIds);\n      \n      setSelectedUser(userData);\n      setUserFormData(userData);\n      setSelectedRoles(roleIds);\n      setSelectedBranches(branchIds);\n      \n      // Rollen nur einmal laden, wenn sie noch nicht geladen wurden\n      if (roles.length === 0) {\n        await fetchRoles();\n      }\n      \n      // Branches nur einmal laden, wenn sie noch nicht geladen wurden\n      if (branches.length === 0) {\n        await fetchBranches();\n      }\n    } catch (err) {\n      console.error('Fehler beim Laden der Benutzerdetails:', err);\n      handleError(err);\n    }\n  };\n\n  // Fehlerbehandlung\n  const handleError = (err: any) => {\n    let message = 'Ein Fehler ist aufgetreten';\n    if (err.response?.data?.message) {\n      message = err.response.data.message;\n    } else if (err instanceof Error) {\n      message = err.message;\n    }\n    \n    // Fehler \"Ungltige Rollen-ID\" nicht weitergeben, wenn kein Benutzer ausgewhlt ist\n    if (message.includes('Ungltige Rollen-ID') && !selectedUser) {\n      console.warn('Fehler unterdrckt, da kein Benutzer ausgewhlt ist:', message);\n      return;\n    }\n    \n    handleErrorContext({ message });\n  };\n\n  // Handler fr Auswahl eines Benutzers\n  const handleUserSelect = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    const userId = parseInt(event.target.value, 10);\n    if (userId && !isNaN(userId)) {\n      fetchUserDetails(userId);\n    } else {\n      setSelectedUser(null);\n      setUserFormData({});\n      setSelectedRoles([]);\n    }\n  };\n\n  // Erweitere den handleUserInputChange\n  const handleUserInputChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    const { name, value, type } = e.target;\n    let finalValue: string | number | null = value;\n    \n    // Korrekte Typenkonvertierung fr numerische Felder\n    if (type === 'number') {\n      // Wenn das Feld leer ist, setzen wir null statt NaN\n      finalValue = value === '' ? null : Number(value);\n    }\n    \n    setUserFormData({ ...userFormData, [name]: finalValue });\n    setIsEditingUser(true); // Aktiviere Edit-Modus sobald etwas gendert wird\n  };\n\n  // Abbrechen der Bearbeitung\n  const handleCancelEdit = () => {\n    if (selectedUser) {\n      setUserFormData({\n        ...selectedUser,\n        birthday: selectedUser.birthday ? new Date(selectedUser.birthday).toISOString().split('T')[0] : null\n      });\n    }\n    setIsEditingUser(false);\n  };\n\n  // Speichern der Benutzerdaten\n  const handleUserSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!selectedUser || !selectedUser.id) {\n      handleErrorContext({ message: 'Kein Benutzer ausgewhlt' });\n      showMessage('Kein Benutzer ausgewhlt', 'error');\n      return;\n    }\n\n    try {\n      // Validierung\n      if (!userFormData.username?.trim()) throw new Error('Benutzername ist erforderlich');\n      if (!userFormData.email?.trim()) throw new Error('E-Mail ist erforderlich');\n      // firstName, lastName, birthday werden nur von KI aus Dokument gesetzt, nicht manuell validiert\n\n      // Bereite die Daten korrekt vor\n      // Contract, Salary, Normal Working Hours werden zu Lifecycle verschoben\n      // firstName, lastName, birthday werden nur von KI aus Dokument gesetzt, nicht manuell editierbar\n      const dataToSend = {\n        username: userFormData.username,\n        email: userFormData.email,\n        bankDetails: userFormData.bankDetails || null,\n        gender: userFormData.gender || null,\n        phoneNumber: userFormData.phoneNumber || null,\n        language: userFormData.language || null,\n        // Payroll-Felder bleiben (sind separate Sektion)\n        hourlyRate: userFormData.hourlyRate === null || userFormData.hourlyRate === undefined || userFormData.hourlyRate === '' as any\n          ? null \n          : typeof userFormData.hourlyRate === 'string' \n            ? userFormData.hourlyRate  // Keine Konvertierung fr Decimal-Werte, da sie als Strings bergeben werden sollten\n            : userFormData.hourlyRate.toString(),  // Konvertierung zu String fr Decimal-Werte\n        monthlySalary: userFormData.monthlySalary === null || userFormData.monthlySalary === undefined || userFormData.monthlySalary === '' as any\n          ? null \n          : typeof userFormData.monthlySalary === 'string' \n            ? parseFloat(userFormData.monthlySalary) \n            : userFormData.monthlySalary,\n        payrollCountry: userFormData.payrollCountry || null,\n        contractType: userFormData.contractType || null,\n      };\n\n      logger.log('Sende Daten zum Server:', dataToSend);\n\n      // Update Benutzerdaten\n      const response = await userApi.update(selectedUser.id, dataToSend);\n\n      if (response.data) {\n        const updatedData = {\n          ...response.data,\n          birthday: response.data.birthday ? new Date(response.data.birthday).toISOString().split('T')[0] : null\n        };\n        setSelectedUser(updatedData);\n        setUserFormData({\n          ...updatedData,\n          birthday: updatedData.birthday ? new Date(updatedData.birthday).toISOString().split('T')[0] : null\n        });\n        \n        // Optimistisches Update: User in allUsers und users aktualisieren\n        setAllUsers(prevUsers => \n          prevUsers.map(user => \n            user.id === updatedData.id ? updatedData : user\n          )\n        );\n        \n        // Benutzerliste neu filtern basierend auf aktuellem Tab\n        filterUsersByActiveStatus(userFilterTab, allUsers.map(user => \n          user.id === updatedData.id ? updatedData : user\n        ));\n        \n        showMessage('Benutzerprofil erfolgreich aktualisiert', 'success');\n        setIsEditingUser(false);\n      }\n    } catch (err) {\n      console.error('Fehler beim Speichern der Benutzerdaten:', err);\n      // Bei Fehler: Rollback durch vollstndiges Reload\n      await fetchAllUsers();\n      if (err.response?.status === 400) {\n        const errorMsg = `Validierungsfehler: ${err.response?.data?.message || 'Bitte berprfe die eingegebenen Daten'}`;\n        handleErrorContext({ message: errorMsg });\n        showMessage(errorMsg, 'error');\n      } else if (err.response?.status === 404) {\n        handleErrorContext({ message: 'Benutzer wurde nicht gefunden' });\n        showMessage('Benutzer wurde nicht gefunden', 'error');\n      } else {\n        handleError(err);\n      }\n    }\n  };\n\n  // Benutzer aktivieren/deaktivieren\n  const handleToggleActive = async () => {\n    if (!selectedUser || !selectedUser.id) {\n      showMessage('Kein Benutzer ausgewhlt', 'error');\n      return;\n    }\n\n    // Verhindere, dass der Admin-Benutzer sich selbst deaktiviert\n    const currentUserId = parseInt(localStorage.getItem('userId') || '0', 10);\n    if (selectedUser.id === currentUserId) {\n      showMessage('Du kannst dich nicht selbst deaktivieren', 'warning');\n      return;\n    }\n\n    try {\n      // Aktueller Status: wenn undefined, dann true (Default)\n      const currentActiveStatus = selectedUser.active !== undefined ? selectedUser.active : true;\n      const newActiveStatus = !currentActiveStatus;\n      \n      logger.log('Toggle active:', { \n        currentActiveStatus, \n        newActiveStatus, \n        selectedUser,\n        selectedUserActive: selectedUser.active,\n        userId: selectedUser.id\n      });\n      \n      const updatePayload = { active: newActiveStatus };\n      logger.log('Sending update payload:', updatePayload, 'Type of active:', typeof newActiveStatus);\n      \n      // Update Benutzer\n      const response = await userApi.update(selectedUser.id, updatePayload);\n      \n      logger.log('Update response:', response.data);\n\n      if (response.data) {\n        const updatedData = {\n          ...response.data,\n          active: response.data.active !== undefined ? response.data.active : true,\n          birthday: response.data.birthday ? new Date(response.data.birthday).toISOString().split('T')[0] : null\n        };\n        \n        logger.log('Updated user data:', updatedData);\n        \n        setSelectedUser(updatedData);\n        setUserFormData({\n          ...updatedData,\n          birthday: updatedData.birthday ? new Date(updatedData.birthday).toISOString().split('T')[0] : null\n        });\n        \n        // Optimistisches Update: Berechne den aktualisierten Array direkt (vor State-Update)\n        // Dies verhindert Race Conditions bei schnellen, aufeinanderfolgenden Updates\n        const updatedAllUsers = allUsers.map(user => \n          user.id === updatedData.id ? updatedData : user\n        );\n        \n        // Update State mit dem berechneten Array\n        setAllUsers(updatedAllUsers);\n        \n        // Filtere mit dem aktualisierten Array (nicht mit allUsers, da State-Update asynchron ist)\n        filterUsersByActiveStatus(userFilterTab, updatedAllUsers);\n        \n        // fetchAllUsers() entfernt - optimistisches Update reicht aus\n        // Backend speichert korrekt, State ist bereits aktualisiert\n        // Nur bei Fehler wird fetchAllUsers() aufgerufen (siehe catch-Block)\n        \n        showMessage(\n          newActiveStatus \n            ? 'Benutzer erfolgreich aktiviert' \n            : 'Benutzer erfolgreich deaktiviert',\n          'success'\n        );\n      }\n    } catch (err) {\n      console.error('Fehler beim Aktivieren/Deaktivieren des Benutzers:', err);\n      handleError(err);\n      // Bei Fehler: Benutzerliste neu laden\n      await fetchAllUsers();\n    }\n  };\n\n  // Toggle Rolle fr einen Benutzer (hinzufgen/entfernen)\n  const toggleRole = async (roleId: number) => {\n    if (!roleId || !selectedUser) return;\n    \n    // Prfe, ob es sich um eine fixe Rolle handelt - Nur fr Admin-Benutzer (ID: 1) sind Admin-Rollen (ID: 1) nicht entfernbar\n    if (roleId === 1 && selectedUser.id === 1 && selectedRoles.includes(roleId)) {\n      showMessage('Die Admin-Rolle kann vom Admin-Benutzer nicht entfernt werden', 'warning');\n      return;\n    }\n    \n    try {\n      logger.log('Toggle Rolle:', roleId, 'fr Benutzer:', selectedUser.id);\n      logger.log('Aktuelle ausgewhlte Rollen:', selectedRoles);\n      \n      // berprfen, ob die Rolle bereits zugewiesen ist\n      const isRoleSelected = selectedRoles.includes(roleId);\n      \n      const newSelectedRoles = isRoleSelected\n        ? selectedRoles.filter(id => id !== roleId)\n        : [...selectedRoles, roleId];\n      \n      logger.log('Neue ausgewhlte Rollen:', newSelectedRoles);\n      \n      // Optimistisches UI-Update\n      setSelectedRoles(newSelectedRoles);\n      \n      // API-Aufruf zur Aktualisierung der Rollen\n      logger.log('Sende Rollenaktualisierung an API:', { userId: selectedUser.id, roleIds: newSelectedRoles });\n      const response = await userApi.updateRoles(selectedUser.id, newSelectedRoles);\n      logger.log('API-Antwort bei Rollenaktualisierung:', response.data);\n      \n      // Benutzer nach dem Update neu laden\n      await fetchUserDetails(selectedUser.id);\n      \n      // Erfolgsmeldung anzeigen mit showMessage statt setUserSuccess\n      showMessage(\n        isRoleSelected\n          ? `Rolle erfolgreich entfernt`\n          : `Rolle erfolgreich zugewiesen`,\n        'success'\n      );\n    } catch (error) {\n      // Bei Fehler auf vorherigen Zustand zurcksetzen\n      console.error('Fehler beim Aktualisieren der Rollen:', error);\n      fetchUserDetails(selectedUser.id);\n      handleError(error);\n      showMessage('Fehler beim Aktualisieren der Rollen', 'error');\n    }\n  };\n\n  // Toggle Branch fr einen Benutzer (hinzufgen/entfernen)\n  const toggleBranch = async (branchId: number) => {\n    if (!branchId || !selectedUser) return;\n    \n    try {\n      logger.log('Toggle Branch:', branchId, 'fr Benutzer:', selectedUser.id);\n      logger.log('Aktuelle ausgewhlte Branches:', selectedBranches);\n      \n      // berprfen, ob die Branch bereits zugewiesen ist\n      const isBranchSelected = selectedBranches.includes(branchId);\n      \n      const newSelectedBranches = isBranchSelected\n        ? selectedBranches.filter(id => id !== branchId)\n        : [...selectedBranches, branchId];\n      \n      logger.log('Neue ausgewhlte Branches:', newSelectedBranches);\n      \n      // Optimistisches UI-Update\n      setSelectedBranches(newSelectedBranches);\n      \n      // API-Aufruf zur Aktualisierung der Branches\n      logger.log('Sende Branch-Aktualisierung an API:', { userId: selectedUser.id, branchIds: newSelectedBranches });\n      const response = await userApi.updateBranches(selectedUser.id, newSelectedBranches);\n      logger.log('API-Antwort bei Branch-Aktualisierung:', response.data);\n      \n      // Benutzer nach dem Update neu laden\n      await fetchUserDetails(selectedUser.id);\n      \n      // Erfolgsmeldung anzeigen\n      showMessage(\n        isBranchSelected\n          ? `Branch erfolgreich entfernt`\n          : `Branch erfolgreich zugewiesen`,\n        'success'\n      );\n    } catch (error) {\n      // Bei Fehler auf vorherigen Zustand zurcksetzen\n      console.error('Fehler beim Aktualisieren der Branches:', error);\n      fetchUserDetails(selectedUser.id);\n      handleError(error);\n      showMessage('Fehler beim Aktualisieren der Branches', 'error');\n    }\n  };\n\n  // Initialisiere FormData wenn Benutzer ausgewhlt wird\n  useEffect(() => {\n    if (selectedUser) {\n      setUserFormData({\n        ...selectedUser,\n        birthday: selectedUser.birthday ? new Date(selectedUser.birthday).toISOString().split('T')[0] : null\n      });\n      setIsEditingUser(false); // Starte im Read-Only Modus\n    }\n  }, [selectedUser]);\n\n  // Handler fr neue Benutzer-Formular\n  const handleNewUserInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = e.target;\n    setNewUserFormData({ ...newUserFormData, [name]: value });\n  };\n\n  // Neuen Benutzer erstellen\n  const handleCreateUser = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Validierung\n    if (!newUserFormData.email || !newUserFormData.password || !newUserFormData.firstName || !newUserFormData.lastName) {\n      showMessage('Bitte fllen Sie alle Felder aus', 'error');\n      return;\n    }\n\n    // E-Mail-Format validieren\n    if (!newUserFormData.email.match(/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/)) {\n      showMessage('Ungltiges E-Mail-Format', 'error');\n      return;\n    }\n\n    try {\n      const response = await userApi.create(newUserFormData);\n      \n      // Optimistisches Update: User zu allUsers hinzufgen\n      if (response.data) {\n        const newUser = {\n          ...response.data,\n          active: response.data.active !== undefined ? response.data.active : true\n        };\n        setAllUsers(prevUsers => [newUser, ...prevUsers]);\n        \n        // Wenn aktueller Tab \"active\" ist und neuer User aktiv ist, auch zu users hinzufgen\n        if (userFilterTab === 'active' && newUser.active) {\n          setUsers(prevUsers => [newUser, ...prevUsers]);\n        }\n      }\n      \n      showMessage('Benutzer erfolgreich erstellt', 'success');\n      setIsCreateModalOpen(false);\n      setNewUserFormData({\n        email: '',\n        password: '',\n        firstName: '',\n        lastName: ''\n      });\n    } catch (err: any) {\n      // Bei Fehler: Rollback durch vollstndiges Reload\n      await fetchAllUsers();\n      const errorMessage = err.response?.data?.message || 'Fehler beim Erstellen des Benutzers';\n      showMessage(errorMessage, 'error');\n      handleErrorContext({ message: errorMessage });\n    }\n  };\n\n  return (\n    <div className=\"container mx-auto px-4 pb-6\">\n      {/* Die lokale Erfolgsmeldungs-Anzeige wird entfernt, da wir jetzt HeaderMessage verwenden */}\n      {/* {userSuccess && (\n        <div className=\"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4\">\n          {userSuccess}\n        </div>\n      )} */}\n\n      {/* Titelzeile: Button links, Dropdown rechts */}\n      <div className=\"mb-6\">\n        <div className=\"flex items-start gap-4\">\n          {/* Linke Seite: \"Neuer Benutzer\"-Button */}\n          <div className=\"flex items-center pt-8\">\n            {isAdmin() && (\n              <div className=\"relative group\">\n                <button\n                  onClick={() => setIsCreateModalOpen(true)}\n                  className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                  style={{ width: '30.19px', height: '30.19px' }}\n                  aria-label={t('users.create')}\n                >\n                  <PlusIcon className=\"h-4 w-4\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {t('users.create')}\n                </div>\n              </div>\n            )}\n          </div>\n          \n          {/* Rechts: Benutzer-Dropdown mit Active/Inactive Tabs */}\n          <div className=\"flex-1\">\n            {/* Active/Inactive Tabs */}\n            <div className=\"flex gap-2 mb-2\">\n              <button\n                type=\"button\"\n                onClick={() => setUserFilterTab('active')}\n                className={`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${\n                  userFilterTab === 'active'\n                    ? 'bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400'\n                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600'\n                }`}\n              >\n                {t('users.active')}\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setUserFilterTab('inactive')}\n                className={`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${\n                  userFilterTab === 'inactive'\n                    ? 'bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400'\n                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600'\n                }`}\n              >\n                {t('users.inactive')}\n              </button>\n            </div>\n            \n            <select\n              id=\"userSelect\"\n              onChange={handleUserSelect}\n              className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n            >\n              <option value=\"\">-- {t('common.select')} --</option>\n              {users.map(user => (\n                <option key={user.id} value={user.id}>\n                  {user.firstName} {user.lastName} ({user.username})\n                </option>\n              ))}\n            </select>\n          </div>\n        </div>\n      </div>\n\n      {selectedUser && (\n        <div>\n          {/* Tabs fr Benutzerdetails, Dokumente und Rollen - zusammenhngende Box ohne Shadow/Border */}\n          <div className=\"bg-white dark:bg-gray-800 mb-6\">\n            {/* Tab-Navigation */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700\">\n              <nav className=\"flex -mb-px\">\n                <button\n                  onClick={() => setActiveUserTab('details')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'details'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <UserCircleIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('users.title')}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('documents')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'documents'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <DocumentTextIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('profile.documents')}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('roles')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'roles'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <ShieldCheckIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('roles.title')}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('branches')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'branches'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <MapPinIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('branches.title') || 'Niederlassungen'}\n                </button>\n                <button\n                  onClick={() => setActiveUserTab('lifecycle')}\n                  className={`py-4 px-6 text-center border-b-2 font-medium text-sm ${\n                    activeUserTab === 'lifecycle'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  <BuildingOfficeIcon className=\"h-5 w-5 inline mr-2\" />\n                  {t('lifecycle.tabTitle')}\n                </button>\n              </nav>\n          </div>\n\n            {/* Tab-Inhalte */}\n          {/* Benutzerdetails Formular */}\n          {activeUserTab === 'details' && (\n              <form onSubmit={handleUserSubmit} className=\"p-6\">\n              {/* Benutzerdetails - gleiche Reihenfolge wie Profile.tsx */}\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-6\">\n                {/* 1. Username, Email (nebeneinander - 2 Spalten) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('users.form.username')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    name=\"username\"\n                    value={userFormData.username || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('users.form.email')}\n                  </label>\n                  <input\n                    type=\"email\"\n                    name=\"email\"\n                    value={userFormData.email || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* 2. Language (allein - 1 Spalte) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.language')} <span className=\"text-red-500\">*</span>\n                  </label>\n                  <select\n                    name=\"language\"\n                    value={userFormData.language || 'es'}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    required\n                  >\n                    {LANGUAGES.map((language) => (\n                      <option key={language.code} value={language.code}>\n                        {language.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n\n                {/* 3. Dokumenten-Upload (prominent - volle Breite) */}\n                {selectedUser && (\n                  <div className=\"sm:col-span-2\">\n                    <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\n                      <div className=\"flex items-center justify-between\">\n                        <div>\n                          <h3 className=\"text-sm font-medium text-blue-900 dark:text-blue-200 mb-1\">\n                            {t('profile.identificationDocument', { defaultValue: 'Identifikationsdokument' })}\n                          </h3>\n                          <p className=\"text-xs text-blue-700 dark:text-blue-300\">\n                            {t('profile.uploadDocumentHint', { defaultValue: 'Bitte laden Sie das Identifikationsdokument (Cdula oder Pasaporte) hoch. Die Felder werden automatisch ausgefllt.' })}\n                          </p>\n                        </div>\n                        <input\n                          type=\"file\"\n                          id=\"documentUploadUserManagement\"\n                          accept=\"image/*\"\n                          className=\"hidden\"\n                          onChange={handleDirectDocumentUploadWrapper}\n                          disabled={isUploading}\n                        />\n                        <label\n                          htmlFor=\"documentUploadUserManagement\"\n                          className={`p-2 text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer ${isUploading ? 'opacity-50 cursor-not-allowed' : ''}`}\n                          title={t('profile.uploadDocument', { defaultValue: 'Dokument hochladen' })}\n                        >\n                          <DocumentTextIcon className=\"h-5 w-5\" />\n                        </label>\n                      </div>\n                    </div>\n                  </div>\n                )}\n\n                {/* 4. ID-Dokument-Daten (readonly, alle Felder - korrekte Reihenfolge) */}\n                {/* Zeige Felder an, wenn User-Daten vorhanden sind (werden beim Upload extrahiert) */}\n                {(selectedUser.firstName || selectedUser.lastName || selectedUser.birthday || selectedUser.identificationNumber) && (\n                  <>\n                    {(() => {\n                      const latestDoc = selectedUser.identificationDocuments && selectedUser.identificationDocuments.length > 0 ? selectedUser.identificationDocuments[0] : null;\n                      return (\n                        <>\n                          {/* 1. Vorname */}\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('users.form.firstName')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={selectedUser.firstName || ''}\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n\n                          {/* 2. Nachname */}\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('users.form.lastName')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={selectedUser.lastName || ''}\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n\n                          {/* 3. Geburtsdatum */}\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('profile.birthday')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={selectedUser.birthday ? new Date(selectedUser.birthday).toISOString().split('T')[0] : ''}\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n\n                          {/* 4. Land */}\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('profile.country')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={selectedUser.country ? COUNTRIES.find(c => c.code === selectedUser.country)?.name || selectedUser.country : ''}\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n\n                          {/* 5. Geschlecht (editierbar, falls KI nicht richtig erkannt hat) */}\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('profile.gender')}\n                            </label>\n                            <select\n                              name=\"gender\"\n                              value={userFormData.gender || ''}\n                              onChange={handleUserInputChange}\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                            >\n                              <option value=\"\">{t('profile.selectGender')}</option>\n                              <option value=\"male\">{t('profile.genderMale')}</option>\n                              <option value=\"female\">{t('profile.genderFemale')}</option>\n                              <option value=\"other\">{t('profile.genderOther')}</option>\n                            </select>\n                          </div>\n\n                          {/* 6. Dokument-Typ */}\n                          {latestDoc && (\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('profile.identificationType')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={\n                                latestDoc.documentType\n                                  ? (() => {\n                                      const typeMap: Record<string, string> = {\n                                        passport: t('identificationDocuments.types.passport'),\n                                        national_id: t('identificationDocuments.types.national_id'),\n                                        driving_license: t('identificationDocuments.types.driving_license'),\n                                        residence_permit: t('identificationDocuments.types.residence_permit'),\n                                        work_permit: t('identificationDocuments.types.work_permit'),\n                                        tax_id: t('identificationDocuments.types.tax_id'),\n                                        social_security: t('identificationDocuments.types.social_security'),\n                                      };\n                                      return typeMap[latestDoc.documentType] || latestDoc.documentType;\n                                    })()\n                                  : ''\n                              }\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n                          )}\n\n                          {/* 7. Dokument-Nummer */}\n                          {(selectedUser.identificationNumber || latestDoc?.documentNumber) && (\n                          <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                              {t('profile.identificationNumber')}\n                            </label>\n                            <input\n                              type=\"text\"\n                              value={selectedUser.identificationNumber || latestDoc?.documentNumber || ''}\n                              disabled\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                              readOnly\n                            />\n                          </div>\n                          )}\n\n                          {/* 8. Ausstellungsdatum */}\n                          {latestDoc?.issueDate && (\n                            <div>\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('profile.identificationIssueDate') || 'Ausstellungsdatum'}\n                              </label>\n                              <input\n                                type=\"text\"\n                                value={new Date(latestDoc.issueDate).toISOString().split('T')[0]}\n                                disabled\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                                readOnly\n                              />\n                            </div>\n                          )}\n\n                          {/* 9. Ablaufdatum */}\n                          {latestDoc?.expiryDate && (\n                            <div>\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('profile.identificationExpiryDate')}\n                              </label>\n                              <input\n                                type=\"text\"\n                                value={new Date(latestDoc.expiryDate).toISOString().split('T')[0]}\n                                disabled\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                                readOnly\n                              />\n                            </div>\n                          )}\n\n                          {/* 10. Ausstellungsland */}\n                          {latestDoc?.issuingCountry && (\n                            <div>\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('profile.issuingCountry')}\n                              </label>\n                              <input\n                                type=\"text\"\n                                value={latestDoc.issuingCountry}\n                                disabled\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                                readOnly\n                              />\n                            </div>\n                          )}\n\n                          {/* 11. Ausstellungsbehrde */}\n                          {latestDoc?.issuingAuthority && (\n                            <div>\n                              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('profile.issuingAuthority')}\n                              </label>\n                              <input\n                                type=\"text\"\n                                value={latestDoc.issuingAuthority}\n                                disabled\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white bg-gray-100 dark:bg-gray-800\"\n                                readOnly\n                              />\n                            </div>\n                          )}\n                        </>\n                      );\n                    })()}\n                  </>\n                )}\n\n                {/* 5. Phone Number (allein - 1 Spalte, da Geschlecht jetzt in ID-Dokument-Daten) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.phoneNumber')}\n                  </label>\n                  <input\n                    type=\"tel\"\n                    name=\"phoneNumber\"\n                    value={userFormData.phoneNumber || ''}\n                    onChange={handleUserInputChange}\n                    placeholder=\"+573001234567\"\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                    {t('profile.phoneNumberHint')}\n                  </p>\n                </div>\n\n                {/* 6. Finanzdaten (Bank Details - 1 Spalte) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('profile.bankDetails')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    name=\"bankDetails\"\n                    value={userFormData.bankDetails || ''}\n                    onChange={handleUserInputChange}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* Contract, Salary, Normal Working Hours ENTFERNEN - werden zu Lifecycle verschoben */}\n              </div>\n\n              {/* Lohnabrechnung-Einstellungen */}\n              <div className=\"mt-4 border-t pt-4\">\n                <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('users.form.payrollSettings')}</h3>\n                \n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('users.form.payrollCountry')}\n                    </label>\n                    <select\n                      name=\"payrollCountry\"\n                      value={userFormData.payrollCountry || selectedUser.payrollCountry || 'CH'}\n                      onChange={handleUserInputChange}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                    >\n                      {PAYROLL_COUNTRIES.map(country => (\n                        <option key={country.code} value={country.code}>\n                          {country.name}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                  \n                  {(userFormData.payrollCountry === 'CO' || \n                    (selectedUser.payrollCountry === 'CO' && !userFormData.payrollCountry)) && (\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('users.form.contractType')}\n                      </label>\n                      <select\n                        name=\"contractType\"\n                        value={userFormData.contractType || ''}\n                        onChange={handleUserInputChange}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                      >\n                        <option value=\"\">Bitte auswhlen</option>\n                        {CONTRACT_TYPES.map(type => (\n                          <option key={type.code} value={type.code}>\n                            {type.name}\n                          </option>\n                        ))}\n                      </select>\n                    </div>\n                  )}\n                </div>\n                \n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('users.form.hourlyRate')} ({(userFormData.payrollCountry || selectedUser.payrollCountry) === 'CH' ? 'CHF' : 'COP'})\n                    </label>\n                    <input\n                      type=\"number\"\n                      name=\"hourlyRate\"\n                      min=\"0\"\n                      step={(userFormData.payrollCountry || selectedUser.payrollCountry) === 'CH' ? '0.05' : '1'}\n                      value={userFormData.hourlyRate === null || userFormData.hourlyRate === undefined ? '' : userFormData.hourlyRate}\n                      onChange={handleUserInputChange}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                      placeholder={(userFormData.payrollCountry || selectedUser.payrollCountry) === 'CH' ? 'z.B. 45.00' : 'z.B. 50000'}\n                    />\n                  </div>\n                  \n                  {((userFormData.payrollCountry === 'CO' || selectedUser.payrollCountry === 'CO') && \n                    (userFormData.contractType !== 'servicios_externos' && selectedUser.contractType !== 'servicios_externos') &&\n                    (userFormData.contractType || selectedUser.contractType)) && (\n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('users.form.monthlySalary')} (COP)\n                      </label>\n                      <input\n                        type=\"number\"\n                        name=\"monthlySalary\"\n                        min=\"0\"\n                        step=\"1000\"\n                        value={userFormData.monthlySalary === null || userFormData.monthlySalary === undefined ? '' : userFormData.monthlySalary}\n                        onChange={handleUserInputChange}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white\"\n                        placeholder=\"z.B. 3500000\"\n                      />\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              {isEditingUser && (\n                <div className=\"mt-4 flex justify-end gap-3\">\n                  <div className=\"relative group\">\n                    <button\n                      type=\"button\"\n                      onClick={handleCancelEdit}\n                      className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                    >\n                      <XMarkIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                      {t('common.cancel')}\n                    </div>\n                  </div>\n                  <div className=\"relative group\">\n                    <button\n                      type=\"submit\"\n                      className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                    >\n                      <CheckIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                      {t('common.save')}\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* Status-Badge und Activate/Deactivate Button unter den Profil-Feldern */}\n              <div className=\"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700 flex justify-between items-center\">\n                {selectedUser.active !== undefined && (\n                  <span className={`px-2 py-1 rounded-full text-xs font-medium ${\n                    selectedUser.active \n                      ? 'bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300' \n                      : 'bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300'\n                  }`}>\n                    {selectedUser.active ? t('users.active') : t('users.inactive')}\n                  </span>\n                )}\n                {isAdmin() && (\n                  <button\n                    onClick={handleToggleActive}\n                    className={`relative group flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors ${\n                      selectedUser.active\n                        ? 'bg-red-100 text-red-700 hover:bg-red-200 dark:bg-red-900/20 dark:text-red-400 dark:hover:bg-red-900/30'\n                        : 'bg-green-100 text-green-700 hover:bg-green-200 dark:bg-green-900/20 dark:text-green-400 dark:hover:bg-green-900/30'\n                    }`}\n                  >\n                    {selectedUser.active ? (\n                      <>\n                        <XMarkIcon className=\"h-5 w-5\" />\n                        {t('users.deactivate')}\n                      </>\n                    ) : (\n                      <>\n                        <CheckIcon className=\"h-5 w-5\" />\n                        {t('users.activate')}\n                      </>\n                    )}\n                  </button>\n                )}\n              </div>\n            </form>\n          )}\n\n          {/* Identifikationsdokumente Tab */}\n          {activeUserTab === 'documents' && (\n              <div className=\"p-6\">\n            <IdentificationDocumentList userId={selectedUser.id} isAdmin={true} ref={documentListRef} />\n              </div>\n          )}\n\n          {/* Rollen Tab */}\n          {activeUserTab === 'roles' && (\n              <div className=\"p-6\">\n              {/* Rollenzuweisung - nur anzeigen, wenn Rollen geladen wurden */}\n              {loadingRoles ? (\n                <div className=\"mt-4 mb-4\">\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('roleAssignment.title')}</h3>\n                  <p className=\"dark:text-gray-300\">{t('roleAssignment.loading')}</p>\n                </div>\n              ) : roles.length > 0 && (\n                <div>\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('roleAssignment.title')}</h3>\n                  \n                  {/* berprfung auf unbekannte Rollen */}\n                  {selectedRoles.some(roleId => !roles.some(role => role.id === roleId)) && (\n                    <div className=\"bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-400 dark:border-yellow-700 text-yellow-700 dark:text-yellow-300 px-4 py-3 rounded mb-4\">\n                      <p className=\"font-bold\">{t('roleAssignment.unknownRolesWarning')}</p>\n                      <p>{t('roleAssignment.unknownRolesMessage', { ids: selectedRoles.filter(roleId => !roles.some(role => role.id === roleId)).join(', ') })}</p>\n                      <p className=\"mt-2 text-sm\">{t('roleAssignment.availableRoleIds', { ids: roles.map(r => r.id).join(', ') })}</p>\n                    </div>\n                  )}\n                  \n                  {/* Aktuell zugewiesene Rollen */}\n                  <div className=\"mb-4\">\n                    <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('roleAssignment.currentRoles')}</h4>\n                    {selectedRoles.length === 0 ? (\n                      <p className=\"text-gray-500 dark:text-gray-400 italic\">{t('roleAssignment.noRolesAssigned')}</p>\n                    ) : (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        {/* Bekannte zugewiesene Rollen */}\n                        {roles\n                          .filter(role => selectedRoles.includes(role.id))\n                          .map(role => {\n                            // Eine Rolle ist nur dann nicht entfernbar, wenn es sich um die Admin-Rolle (ID: 1) fr den Admin-Benutzer (ID: 1) handelt\n                            const isFixedRole = role.id === 1 && selectedUser && selectedUser.id === 1;\n                            return (\n                              <div \n                                key={role.id} \n                                className={`border rounded-lg p-4 ${isFixedRole ? 'border-green-500 bg-green-50 dark:bg-green-900/20 dark:border-green-700 cursor-not-allowed' : 'border-blue-500 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-700 cursor-pointer'}`}\n                                onClick={() => !isFixedRole && toggleRole(role.id)}\n                              >\n                                <div className=\"flex justify-between items-center\">\n                                  <div>\n                                    <h4 className=\"font-medium flex items-center dark:text-white\">\n                                      {role.name}\n                                      {isFixedRole && (\n                                        <span className=\"ml-2 text-xs bg-green-600 text-white px-2 py-0.5 rounded-full\">\n                                          {t('roleAssignment.fixed')}\n                                        </span>\n                                      )}\n                                    </h4>\n                                    <p className=\"text-sm text-gray-600 dark:text-gray-400\">{role.description}</p>\n                                  </div>\n                                  <div className={`flex items-center ${isFixedRole ? 'text-gray-400 dark:text-gray-500' : 'text-blue-600 dark:text-blue-400'}`}>\n                                    <span className=\"mr-2 text-sm\">{isFixedRole ? t('roleAssignment.fixedAssigned') : t('roleAssignment.remove')}</span>\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z\" clipRule=\"evenodd\" />\n                                    </svg>\n                                  </div>\n                                </div>\n                              </div>\n                            );\n                          })}\n                        \n                        {/* Unbekannte zugewiesene Rollen */}\n                        {selectedRoles\n                          .filter(roleId => !roles.some(role => role.id === roleId))\n                          .map(roleId => (\n                            <div \n                              key={`unknown-${roleId}`} \n                              className=\"border border-orange-500 bg-orange-50 rounded-lg p-4\"\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium\">{t('roleAssignment.unknownRole', { id: roleId })}</h4>\n                                  <p className=\"text-sm text-orange-600\">{t('roleAssignment.unknownRoleDescription')}</p>\n                                </div>\n                                <div className=\"flex items-center text-orange-600\">\n                                  <span className=\"mr-2 text-sm\">{t('roleAssignment.remove')}</span>\n                                  <button \n                                    onClick={() => toggleRole(roleId)}\n                                    className=\"focus:outline-none\">\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z\" clipRule=\"evenodd\" />\n                                    </svg>\n                                  </button>\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    )}\n                  </div>\n                  \n                  {/* Verfgbare Rollen */}\n                  <div>\n                    <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('roleAssignment.availableRoles')}</h4>\n                    {roles.filter(role => !selectedRoles.includes(role.id)).length === 0 ? (\n                      <p className=\"text-gray-500 dark:text-gray-400 italic\">{t('roleAssignment.noRolesAvailable')}</p>\n                    ) : (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        {roles\n                          .filter(role => !selectedRoles.includes(role.id))\n                          .map(role => (\n                            <div \n                              key={role.id} \n                              className=\"border border-gray-300 rounded-lg p-4 cursor-pointer hover:border-blue-300 hover:bg-blue-50\"\n                              onClick={() => toggleRole(role.id)}\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium\">{role.name}</h4>\n                                  <p className=\"text-sm text-gray-600\">{role.description}</p>\n                                </div>\n                                <div className=\"flex items-center text-gray-500 hover:text-blue-600\">\n                                  <span className=\"mr-2 text-sm\">{t('roleAssignment.add')}</span>\n                                  <PlusIcon className=\"h-5 w-5\" />\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Branches Tab */}\n          {activeUserTab === 'branches' && (\n              <div className=\"p-6\">\n              {/* Branch-Zuweisung - nur anzeigen, wenn Branches geladen wurden */}\n              {loadingBranches ? (\n                <div className=\"mt-4 mb-4\">\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('branchAssignment.title') || 'Niederlassungszuweisung'}</h3>\n                  <p className=\"dark:text-gray-300\">{t('branchAssignment.loading') || 'Lade Niederlassungen...'}</p>\n                </div>\n              ) : branches.length > 0 && (\n                <div>\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('branchAssignment.title') || 'Niederlassungszuweisung'}</h3>\n                  \n                  {/* berprfung auf unbekannte Branches */}\n                  {selectedBranches.some(branchId => !branches.some(branch => branch.id === branchId)) && (\n                    <div className=\"bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-400 dark:border-yellow-700 text-yellow-700 dark:text-yellow-300 px-4 py-3 rounded mb-4\">\n                      <p className=\"font-bold\">{t('branchAssignment.unknownBranchesWarning') || 'Unbekannte Niederlassungen zugewiesen'}</p>\n                      <p>{t('branchAssignment.unknownBranchesMessage', { ids: selectedBranches.filter(branchId => !branches.some(branch => branch.id === branchId)).join(', ') }) || `Die folgenden Niederlassungs-IDs sind zugewiesen, aber nicht verfgbar: ${selectedBranches.filter(branchId => !branches.some(branch => branch.id === branchId)).join(', ')}`}</p>\n                      <p className=\"mt-2 text-sm\">{t('branchAssignment.availableBranchIds', { ids: branches.map(b => b.id).join(', ') }) || `Verfgbare Niederlassungs-IDs: ${branches.map(b => b.id).join(', ')}`}</p>\n                    </div>\n                  )}\n                  \n                  {/* Aktuell zugewiesene Branches */}\n                  <div className=\"mb-4\">\n                    <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('branchAssignment.currentBranches') || 'Aktuell zugewiesene Niederlassungen'}</h4>\n                    {selectedBranches.length === 0 ? (\n                      <p className=\"text-gray-500 dark:text-gray-400 italic\">{t('branchAssignment.noBranchesAssigned') || 'Keine Niederlassungen zugewiesen'}</p>\n                    ) : (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        {/* Bekannte zugewiesene Branches */}\n                        {branches\n                          .filter(branch => selectedBranches.includes(branch.id))\n                          .map(branch => (\n                            <div \n                              key={branch.id} \n                              className=\"border border-blue-500 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-700 rounded-lg p-4 cursor-pointer\"\n                              onClick={() => toggleBranch(branch.id)}\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium dark:text-white\">\n                                    {branch.name}\n                                  </h4>\n                                </div>\n                                <div className=\"flex items-center text-blue-600 dark:text-blue-400\">\n                                  <span className=\"mr-2 text-sm\">{t('branchAssignment.remove') || 'Entfernen'}</span>\n                                  <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                    <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z\" clipRule=\"evenodd\" />\n                                  </svg>\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                        \n                        {/* Unbekannte zugewiesene Branches */}\n                        {selectedBranches\n                          .filter(branchId => !branches.some(branch => branch.id === branchId))\n                          .map(branchId => (\n                            <div \n                              key={`unknown-${branchId}`} \n                              className=\"border border-orange-500 bg-orange-50 rounded-lg p-4\"\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium\">{t('branchAssignment.unknownBranch', { id: branchId }) || `Unbekannte Niederlassung (ID: ${branchId})`}</h4>\n                                  <p className=\"text-sm text-orange-600\">{t('branchAssignment.unknownBranchDescription') || 'Diese Niederlassung existiert nicht mehr oder ist nicht verfgbar.'}</p>\n                                </div>\n                                <div className=\"flex items-center text-orange-600\">\n                                  <span className=\"mr-2 text-sm\">{t('branchAssignment.remove') || 'Entfernen'}</span>\n                                  <button \n                                    onClick={() => toggleBranch(branchId)}\n                                    className=\"focus:outline-none\">\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                                      <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM7 9a1 1 0 000 2h6a1 1 0 100-2H7z\" clipRule=\"evenodd\" />\n                                    </svg>\n                                  </button>\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    )}\n                  </div>\n                  \n                  {/* Verfgbare Branches */}\n                  <div>\n                    <h4 className=\"font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('branchAssignment.availableBranches') || 'Verfgbare Niederlassungen'}</h4>\n                    {branches.filter(branch => !selectedBranches.includes(branch.id)).length === 0 ? (\n                      <p className=\"text-gray-500 dark:text-gray-400 italic\">{t('branchAssignment.noBranchesAvailable') || 'Keine weiteren Niederlassungen verfgbar'}</p>\n                    ) : (\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        {branches\n                          .filter(branch => !selectedBranches.includes(branch.id))\n                          .map(branch => (\n                            <div \n                              key={branch.id} \n                              className=\"border border-gray-300 dark:border-gray-600 rounded-lg p-4 cursor-pointer hover:border-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/20\"\n                              onClick={() => toggleBranch(branch.id)}\n                            >\n                              <div className=\"flex justify-between items-center\">\n                                <div>\n                                  <h4 className=\"font-medium dark:text-white\">{branch.name}</h4>\n                                </div>\n                                <div className=\"flex items-center text-gray-500 hover:text-blue-600 dark:hover:text-blue-400\">\n                                  <span className=\"mr-2 text-sm\">{t('branchAssignment.add') || 'Hinzufgen'}</span>\n                                  <PlusIcon className=\"h-5 w-5\" />\n                                </div>\n                              </div>\n                            </div>\n                          ))}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n              {!loadingBranches && branches.length === 0 && (\n                <div className=\"mt-4 mb-4\">\n                  <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">{t('branchAssignment.title') || 'Niederlassungszuweisung'}</h3>\n                  <p className=\"text-gray-500 dark:text-gray-400\">{t('branchAssignment.noBranchesFound') || 'Keine Niederlassungen gefunden'}</p>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Lebenszyklus Tab */}\n          {activeUserTab === 'lifecycle' && selectedUser && (\n              <div className=\"p-6\">\n            <LifecycleView \n              key={`lifecycle-${selectedUser.id}-${lifecycleRefreshKey}`}\n              userId={selectedUser.id} \n              userName={`${selectedUser.firstName} ${selectedUser.lastName}`}\n            />\n              </div>\n          )}\n          </div>\n        </div>\n      )}\n\n      {/* Sidepane/Modal fr Benutzererstellung */}\n      {isCreateModalOpen && (\n        <>\n          {/* Fr Mobile (unter 640px) - klassisches Modal */}\n          {isMobile ? (\n            <Dialog open={isCreateModalOpen} onClose={() => setIsCreateModalOpen(false)} className=\"relative z-50\">\n              <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n              \n              <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                  {/* Header */}\n                  <div className=\"px-6 py-4 border-b dark:border-gray-700\">\n                    <div className=\"flex items-center justify-between\">\n                      <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                        {t('organisation.createUser.title')}\n                      </Dialog.Title>\n                      <button\n                        onClick={() => setIsCreateModalOpen(false)}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                      >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                      </button>\n                    </div>\n                  </div>\n                  \n                  {/* Form */}\n                  <form onSubmit={handleCreateUser} className=\"p-6\">\n                    <div className=\"space-y-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.email')} *\n                        </label>\n                        <input\n                          type=\"email\"\n                          name=\"email\"\n                          value={newUserFormData.email}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      \n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.password')} *\n                        </label>\n                        <input\n                          type=\"password\"\n                          name=\"password\"\n                          value={newUserFormData.password}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      \n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.firstName')} *\n                        </label>\n                        <input\n                          type=\"text\"\n                          name=\"firstName\"\n                          value={newUserFormData.firstName}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      \n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.lastName')} *\n                        </label>\n                        <input\n                          type=\"text\"\n                          name=\"lastName\"\n                          value={newUserFormData.lastName}\n                          onChange={handleNewUserInputChange}\n                          className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                    </div>\n                    \n                    {/* Footer */}\n                    <div className=\"mt-6 flex justify-end gap-3\">\n                      <div className=\"relative group\">\n                        <button\n                          type=\"button\"\n                          onClick={() => setIsCreateModalOpen(false)}\n                          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                        >\n                          <XMarkIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('common.cancel')}\n                        </div>\n                      </div>\n                      <div className=\"relative group\">\n                        <button\n                          type=\"submit\"\n                          className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                        >\n                          <CheckIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('organisation.createUser.create')}\n                        </div>\n                      </div>\n                    </div>\n                  </form>\n                </Dialog.Panel>\n              </div>\n            </Dialog>\n          ) : (\n            // Fr Desktop (ab 640px) - Sidepane\n            // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n            <>\n              {/* Backdrop - nur wenn offen und <= 1070px */}\n              {/* Hinweis: onClick entfernt, da Backdrop pointer-events: none hat, damit Hauptinhalt interaktiv bleibt */}\n              {isCreateModalOpen && !isLargeScreen && (\n                <div \n                  className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                  aria-hidden=\"true\" \n                  style={{\n                    opacity: isCreateModalOpen ? 1 : 0,\n                    transition: 'opacity 300ms ease-out'\n                  }}\n                />\n              )}\n              \n              {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n              <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isCreateModalOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                  transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                  pointerEvents: isCreateModalOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isCreateModalOpen}\n                role=\"dialog\"\n                aria-modal={isCreateModalOpen}\n              >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                  <h2 className=\"text-lg font-semibold dark:text-white\">\n                    {t('organisation.createUser.title')}\n                  </h2>\n                  <button\n                    onClick={() => setIsCreateModalOpen(false)}\n                    className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                  >\n                    <XMarkIcon className=\"h-6 w-6\" />\n                  </button>\n                </div>\n\n                <div className=\"flex flex-col flex-1 min-h-0\">\n                  <form onSubmit={handleCreateUser} className=\"flex flex-col flex-1 min-h-0\">\n                    <div className=\"p-4 overflow-y-auto flex-1 min-h-0 space-y-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                          {t('organisation.createUser.email')} *\n                        </label>\n                      <input\n                        type=\"email\"\n                        name=\"email\"\n                        value={newUserFormData.email}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('organisation.createUser.password')} *\n                      </label>\n                      <input\n                        type=\"password\"\n                        name=\"password\"\n                        value={newUserFormData.password}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('organisation.createUser.firstName')} *\n                      </label>\n                      <input\n                        type=\"text\"\n                        name=\"firstName\"\n                        value={newUserFormData.firstName}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                    </div>\n                    \n                    <div>\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {t('organisation.createUser.lastName')} *\n                      </label>\n                      <input\n                        type=\"text\"\n                        name=\"lastName\"\n                        value={newUserFormData.lastName}\n                        onChange={handleNewUserInputChange}\n                        className=\"w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 dark:bg-gray-700 dark:text-white\"\n                        required\n                      />\n                      </div>\n                    </div>\n                    \n                    {/* Footer */}\n                    <div className=\"flex justify-end gap-3 border-t dark:border-gray-700 pt-4 px-4 flex-shrink-0\">\n                      <div className=\"relative group\">\n                        <button\n                          type=\"button\"\n                          onClick={() => setIsCreateModalOpen(false)}\n                          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                        >\n                          <XMarkIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('common.cancel')}\n                        </div>\n                      </div>\n                      <div className=\"relative group\">\n                        <button\n                          type=\"submit\"\n                          className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                        >\n                          <CheckIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('organisation.createUser.create')}\n                        </div>\n                      </div>\n                    </div>\n                  </form>\n                </div>\n              </div>\n            </>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default UserManagementTab; ","import React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { roleApi, branchApi } from '../api/apiClient.ts';\nimport { Role, AccessLevel } from '../types/interfaces.ts';\nimport { PencilIcon, TrashIcon, PlusIcon, FunnelIcon, XMarkIcon, CheckIcon, ArrowPathIcon, DocumentDuplicateIcon, ChevronDownIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport FilterPane from '../components/FilterPane.tsx';\nimport SavedFilterTags from '../components/SavedFilterTags.tsx';\nimport { useFilterContext } from '../contexts/FilterContext.tsx';\nimport { FilterCondition } from '../components/FilterRow.tsx';\nimport { useError } from '../contexts/ErrorContext.tsx';\nimport { ErrorCategory } from '../services/ErrorHandler.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport { logger } from '../utils/logger.ts';\n\ninterface RoleManagementTabProps {\n  onRolesChange?: () => void;\n  onError?: (error: string) => void;\n  readOnly?: boolean;\n}\n\n// Definiere Seiten, die immer sichtbar sein sollen (ohne Berechtigungsprfung)\nconst alwaysVisiblePages = ['dashboard', 'worktracker', 'cerebro', 'settings', 'profile'];\n\n// ALLE SEITEN IM SYSTEM (synchron mit Backend)\nconst defaultPages = [\n  'dashboard',\n  'worktracker',\n  'consultations',\n  'team_worktime_control', // = workcenter\n  'payroll', // = lohnabrechnung\n  'organization_management', // = organisation (Hauptseite)\n  'cerebro',\n  'settings',\n  'profile',\n  'tour_management', // NEU: Touren-Verwaltung\n  'password_manager', // NEU: Passwort-Manager\n  'price_analysis' // NEU: Preisanalyse\n];\n\n// ALLE TABELLEN IM SYSTEM (synchron mit Backend)\nconst defaultTables = [\n  'requests',           // auf dashboard\n  'tasks',             // auf worktracker\n  'reservations',      // auf worktracker (in To Do's Box)\n  'users',             // auf organization_management\n  'roles',             // auf organization_management\n  'organization',      // auf organization_management\n  'organization_join_requests', // auf organization_management\n  'organization_users',  // auf organization_management\n  'team_worktime',     // auf team_worktime_control\n  'worktime',          // auf worktracker\n  'clients',           // auf consultations\n  'consultation_invoices', // auf consultations\n  'branches',          // auf settings/system\n  'notifications',     // allgemein\n  'settings',          // auf settings\n  'monthly_reports',    // auf consultations/reports\n  'tours',             // NEU: auf tour_management\n  'tour_bookings',     // NEU: auf tour_management\n  'ota_listings',      // NEU: auf price_analysis\n  'price_analyses',    // NEU: auf price_analysis\n  'price_recommendations', // NEU: auf price_analysis\n  'pricing_rules',     // NEU: auf price_analysis\n  'rate_shopping_jobs' // NEU: auf price_analysis\n];\n\n// ALLE BUTTONS IM SYSTEM (synchron mit Backend)\nconst defaultButtons = [\n  // Database Management Buttons (Settings/System)\n  'database_reset_table',\n  'database_logs',\n  \n  // Invoice Functions Buttons\n  'invoice_create',\n  'invoice_download', \n  'invoice_mark_paid',\n  'invoice_settings',\n  \n  // Todo/Task Buttons (Worktracker)\n  'todo_create',\n  'todo_edit',\n  'todo_delete',\n  'task_create',\n  'task_edit', \n  'task_delete',\n  \n  // User Management Buttons\n  'user_create',\n  'user_edit',\n  'user_delete',\n  'role_assign',\n  'role_create',\n  'role_edit',\n  'role_delete',\n  \n  // Organization Management Buttons\n  'organization_create',\n  'organization_edit',\n  'organization_delete',\n  \n  // Worktime Buttons\n  'worktime_start',\n  'worktime_stop', \n  'worktime_edit',\n  'worktime_delete',\n  \n  // General Cerebro Button\n  'cerebro',\n  \n  // Consultation Buttons\n  'consultation_start',\n  'consultation_stop',\n  'consultation_edit',\n  \n  // Client Management Buttons\n  'client_create',\n  'client_edit',\n  'client_delete',\n  \n  // Settings Buttons\n  'settings_system',\n  'settings_notifications',\n  'settings_profile',\n  \n  // Payroll Buttons\n  'payroll_generate',\n  'payroll_export',\n  'payroll_edit',\n  \n  // Tour Management Buttons\n  'tour_create',\n  'tour_edit',\n  'tour_delete',\n  'tour_view',\n  'tour_booking_create',\n  'tour_booking_edit',\n  'tour_booking_cancel',\n  'tour_provider_create',\n  'tour_provider_edit',\n  'tour_provider_delete',\n  \n  // Password Manager Buttons\n  'password_entry_create',\n  'password_entry_edit',\n  'password_entry_delete',\n  \n  // Price Analysis Buttons\n  'price_analysis_create_rule',\n  'price_analysis_edit_rule',\n  'price_analysis_delete_rule',\n  'price_analysis_apply_recommendation',\n  'price_analysis_reject_recommendation',\n  'price_analysis_run_rate_shopping'\n];\n\n// Definiert die Zuordnung von Tabellen zu ihren bergeordneten Seiten\nconst tableToPageMapping = {\n  'requests': 'dashboard',\n  'tasks': 'worktracker',\n  'reservations': 'worktracker',\n  'users': 'organization_management',\n  'roles': 'organization_management',\n  'organization': 'organization_management',\n  'organization_join_requests': 'organization_management',\n  'organization_users': 'organization_management',\n  'team_worktime': 'team_worktime_control',\n  'worktime': 'worktracker',\n  'clients': 'consultations',\n  'consultation_invoices': 'consultations',\n  'branches': 'settings',\n  'notifications': 'general',\n  'settings': 'settings',\n  'monthly_reports': 'consultations',\n  'tours': 'tour_management',\n  'tour_bookings': 'tour_management',\n  'ota_listings': 'price_analysis',\n  'price_analyses': 'price_analysis',\n  'price_recommendations': 'price_analysis',\n  'pricing_rules': 'price_analysis',\n  'rate_shopping_jobs': 'price_analysis'\n};\n\n// Definiert die Zuordnung von Buttons zu ihren bergeordneten Seiten/Bereichen\nconst buttonToPageMapping = {\n  'database_reset_table': 'settings',\n  'database_logs': 'settings',\n  'invoice_create': 'consultations',\n  'invoice_download': 'consultations',\n  'invoice_mark_paid': 'consultations',\n  'invoice_settings': 'consultations',\n  'todo_create': 'worktracker',\n  'todo_edit': 'worktracker',\n  'todo_delete': 'worktracker',\n  'task_create': 'worktracker',\n  'task_edit': 'worktracker',\n  'task_delete': 'worktracker',\n  'user_create': 'organization_management',\n  'user_edit': 'organization_management',\n  'user_delete': 'organization_management',\n  'role_assign': 'organization_management',\n  'role_create': 'organization_management',\n  'role_edit': 'organization_management',\n  'role_delete': 'organization_management',\n  'organization_create': 'organization_management',\n  'organization_edit': 'organization_management',\n  'organization_delete': 'organization_management',\n  'worktime_start': 'worktracker',\n  'worktime_stop': 'worktracker',\n  'worktime_edit': 'worktracker',\n  'worktime_delete': 'worktracker',\n  'cerebro': 'cerebro',\n  'consultation_start': 'consultations',\n  'consultation_stop': 'consultations',\n  'consultation_edit': 'consultations',\n  'client_create': 'consultations',\n  'client_edit': 'consultations',\n  'client_delete': 'consultations',\n  'settings_system': 'settings',\n  'settings_notifications': 'settings',\n  'settings_profile': 'settings',\n  'payroll_generate': 'payroll',\n  'payroll_export': 'payroll',\n  'payroll_edit': 'payroll',\n  'tour_create': 'tour_management',\n  'tour_edit': 'tour_management',\n  'tour_delete': 'tour_management',\n  'tour_view': 'tour_management',\n  'tour_booking_create': 'tour_management',\n  'tour_booking_edit': 'tour_management',\n  'tour_booking_cancel': 'tour_management',\n  'tour_provider_create': 'tour_management',\n  'tour_provider_edit': 'tour_management',\n  'tour_provider_delete': 'tour_management',\n  'password_entry_create': 'password_manager',\n  'password_entry_edit': 'password_manager',\n  'password_entry_delete': 'password_manager',\n  'price_analysis_create_rule': 'price_analysis',\n  'price_analysis_edit_rule': 'price_analysis',\n  'price_analysis_delete_rule': 'price_analysis',\n  'price_analysis_apply_recommendation': 'price_analysis',\n  'price_analysis_reject_recommendation': 'price_analysis',\n  'price_analysis_run_rate_shopping': 'price_analysis'\n};\n\n// Definiert die Zuordnung von Buttons zu ihren zugehrigen Tabellen\nconst buttonToTableMapping: Record<string, string | null> = {\n  // Worktime Buttons  worktime Tabelle\n  'worktime_start': 'worktime',\n  'worktime_stop': 'worktime',\n  'worktime_edit': 'worktime',\n  'worktime_delete': 'worktime',\n  // Task/Todo Buttons  tasks Tabelle\n  'task_create': 'tasks',\n  'task_edit': 'tasks',\n  'task_delete': 'tasks',\n  'todo_create': 'tasks',\n  'todo_edit': 'tasks',\n  'todo_delete': 'tasks',\n  // Client Buttons  clients Tabelle\n  'client_create': 'clients',\n  'client_edit': 'clients',\n  'client_delete': 'clients',\n  'consultation_start': 'clients',\n  'consultation_stop': 'clients',\n  'consultation_edit': 'clients',\n  // Invoice Buttons  consultation_invoices Tabelle\n  'invoice_create': 'consultation_invoices',\n  'invoice_download': 'consultation_invoices',\n  'invoice_mark_paid': 'consultation_invoices',\n  'invoice_settings': 'consultation_invoices',\n  // User Management Buttons  users/roles Tabellen\n  'user_create': 'users',\n  'user_edit': 'users',\n  'user_delete': 'users',\n  'role_assign': 'roles',\n  'role_create': 'roles',\n  'role_edit': 'roles',\n  'role_delete': 'roles',\n  // Organization Management Buttons  organization Tabelle\n  'organization_create': 'organization',\n  'organization_edit': 'organization',\n  'organization_delete': 'organization',\n  // Settings Buttons  settings Tabelle\n  'settings_system': 'settings',\n  'settings_notifications': 'settings',\n  'settings_profile': 'settings',\n  // Tour Management Buttons  tours/tour_bookings Tabellen\n  'tour_create': 'tours',\n  'tour_edit': 'tours',\n  'tour_delete': 'tours',\n  'tour_view': 'tours',\n  'tour_booking_create': 'tour_bookings',\n  'tour_booking_edit': 'tour_bookings',\n  'tour_booking_cancel': 'tour_bookings',\n  'tour_provider_create': null, // Keine direkte Tabelle\n  'tour_provider_edit': null,\n  'tour_provider_delete': null,\n  // Password Manager Buttons  keine direkte Tabelle (entry-level permissions)\n  'password_entry_create': null,\n  'password_entry_edit': null,\n  'password_entry_delete': null,\n  // Price Analysis Buttons  entsprechende Tabellen\n  'price_analysis_create_rule': 'pricing_rules',\n  'price_analysis_edit_rule': 'pricing_rules',\n  'price_analysis_delete_rule': 'pricing_rules',\n  'price_analysis_apply_recommendation': 'price_recommendations',\n  'price_analysis_reject_recommendation': 'price_recommendations',\n  'price_analysis_run_rate_shopping': 'rate_shopping_jobs',\n  // Buttons ohne direkte Tabelle-Zuordnung\n  'database_reset_table': null,\n  'database_logs': null,\n  'cerebro': null,\n  'payroll_generate': null,\n  'payroll_export': null,\n  'payroll_edit': null\n};\n\n// Display-Name-Mapping fr Seiten (DB-Interne Bezeichnung  Frontend-Bezeichnung)\n// Wird dynamisch aus bersetzungen geladen\n\n// Display-Name-Mapping fr Tabellen (DB-Interne Bezeichnung  Frontend-Bezeichnung)\n// Wird dynamisch aus bersetzungen geladen\n\n// Display-Name-Mapping fr Buttons wird dynamisch in der Komponente geladen\n\n// TableID fr gespeicherte Filter\nconst ROLES_TABLE_ID = 'roles-table';\n\n// Standardrollen-IDs (fr Rollen ohne Organisation)\nconst STANDARD_ROLE_IDS = [1, 2, 999]; // Admin (1), User (2), Hamburger (999)\n\n// Standardrollen-Namen (drfen nicht bearbeitet/gelscht werden, egal von welcher Organisation)\nconst STANDARD_ROLE_NAMES = ['Admin', 'User', 'Hamburger'];\n\n// Helper-Funktion zur Prfung ob es sich um eine Standardrolle handelt\nconst isStandardRole = (roleId: number, roleName?: string): boolean => {\n  // Prfe zuerst auf Standard-IDs (fr Rollen ohne Organisation)\n  if (STANDARD_ROLE_IDS.includes(roleId)) {\n    return true;\n  }\n  // Prfe auf Standard-Namen (fr Rollen in Organisationen)\n  if (roleName && STANDARD_ROLE_NAMES.includes(roleName)) {\n    return true;\n  }\n  return false;\n};\n\ninterface RoleFormData {\n  name: string;\n  description: string;\n  permissions: {\n    entity: string;\n    entityType: string;\n    accessLevel: AccessLevel;\n  }[];\n}\n\n\n// RoleCard-Komponente fr mobile Ansicht\nconst RoleCard: React.FC<{\n  role: Role;\n  onEdit: (role: Role) => void;\n  onDelete: (roleId: number) => void;\n  onCopy: (role: Role) => void;\n  canEdit: boolean;\n  canDelete: boolean;\n  canCopy: boolean;\n}> = ({ role, onEdit, onDelete, onCopy, canEdit, canDelete, canCopy }) => {\n  const { t } = useTranslation();\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-4 mb-4\">\n      {/* Header mit Rollenname und Aktionen */}\n      <div className=\"flex justify-between items-start mb-2\">\n        <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">{role.name}</h3>\n        \n        <div className=\"flex space-x-2\">\n          {canCopy && (\n            <div className=\"relative group\">\n              <button\n                onClick={() => onCopy(role)}\n                className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n              >\n                <DocumentDuplicateIcon className=\"h-5 w-5\" />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('roles.actions.copy')}\n              </div>\n            </div>\n          )}\n          \n          {canEdit && (\n            <div className=\"relative group\">\n              <button\n                onClick={() => onEdit(role)}\n                className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n              >\n                <PencilIcon className=\"h-5 w-5\" />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('roles.actions.edit')}\n              </div>\n            </div>\n          )}\n          \n          {canDelete && (\n            <div className=\"relative group\">\n              <button\n                onClick={() => onDelete(role.id)}\n                className=\"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-1\"\n              >\n                <TrashIcon className=\"h-5 w-5\" />\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('roles.actions.delete')}\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n      \n      {/* Beschreibung */}\n      <p className=\"text-sm text-gray-600 dark:text-gray-400\">{role.description || t('roles.noDescription')}</p>\n      \n      {/* Branch-Zuweisungen */}\n      <div className=\"mt-2\">\n        <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n          {role.allBranches ? (\n            <span className=\"inline-flex items-center px-2 py-0.5 rounded bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300\">\n              {t('roles.form.allBranches') || 'Alle Branches'}\n            </span>\n          ) : role.branches && role.branches.length > 0 ? (\n            <span className=\"inline-flex items-center px-2 py-0.5 rounded bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300\">\n              {role.branches.length} {t('roles.form.specificBranches') || 'Branches'}\n            </span>\n          ) : (\n            <span className=\"inline-flex items-center px-2 py-0.5 rounded bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400\">\n              {t('roles.form.noBranches') || 'Keine Branches'}\n            </span>\n          )}\n        </span>\n      </div>\n      \n      {/* Berechtigungen - kompakt */}\n      <div className=\"mt-2\">\n        <h4 className=\"text-sm font-medium text-gray-900 dark:text-white mb-1\">{t('roles.permissions')}:</h4>\n        <div className=\"flex flex-wrap gap-1\">\n          {role.permissions\n            .filter(perm => perm.accessLevel !== 'none') // Nur relevante Berechtigungen anzeigen\n            .slice(0, 8) // Begrenze die Anzahl der angezeigten Berechtigungen\n            .map(permission => (\n              <span \n                key={`${permission.entity}-${permission.entityType}`}\n                className=\"text-xs bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-300 px-2 py-1 rounded\"\n              >\n                {permission.entity}: {permission.accessLevel}\n              </span>\n            ))}\n          {role.permissions.filter(perm => perm.accessLevel !== 'none').length > 8 && (\n            <span className=\"text-xs bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-300 px-2 py-1 rounded\">\n                +{role.permissions.filter(perm => perm.accessLevel !== 'none').length - 8} {t('common.showMore')}\n            </span>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nconst RoleManagementTab: React.FC<RoleManagementTabProps> = ({ onRolesChange, onError, readOnly = false }) => {\n  const { t } = useTranslation();\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [editingRole, setEditingRole] = useState<Role | null>(null);\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loading, setLoading] = useState(true);\n  \n  // Display-Name-Mapping fr Seiten (dynamisch aus bersetzungen)\n  const pageDisplayNames = useMemo(() => ({\n    'dashboard': t('roles.pages.dashboard'),\n    'worktracker': t('roles.pages.worktracker'),\n    'consultations': t('roles.pages.consultations'),\n    'team_worktime_control': t('roles.pages.team_worktime_control'),\n    'payroll': t('roles.pages.payroll'),\n    'organization_management': t('roles.pages.organization_management'), // Organisation-Seite (Hauptseite)\n    'cerebro': t('roles.pages.cerebro'),\n    'settings': t('roles.pages.settings'),\n    'profile': t('roles.pages.profile'),\n    'tour_management': t('roles.pages.tour_management', 'Touren-Verwaltung'),\n    'password_manager': t('roles.pages.password_manager', 'Passwort-Manager')\n  }), [t]);\n\n  // Display-Name-Mapping fr Tabellen (dynamisch aus bersetzungen)\n  const tableDisplayNames = useMemo(() => ({\n    'tasks': t('roles.tables.tasks'),\n    'reservations': t('roles.tables.reservations'),\n    'worktime': t('roles.tables.worktime'),\n    'users': t('roles.tables.users'),\n    'roles': t('roles.tables.roles'),\n    'organization': t('roles.tables.organization'),\n    'organization_join_requests': t('roles.tables.organization_join_requests'),\n    'organization_users': t('roles.tables.organization_users'),\n    'clients': t('roles.tables.clients'),\n    'consultation_invoices': t('roles.tables.consultation_invoices'),\n    'requests': t('roles.tables.requests'),\n    'team_worktime': t('roles.tables.team_worktime'),\n    'settings': t('roles.tables.settings'),\n    'notifications': t('roles.tables.notifications'),\n    'branches': t('roles.tables.branches'),\n    'monthly_reports': t('roles.tables.monthly_reports'),\n    'tours': t('roles.tables.tours', 'Touren'),\n    'tour_bookings': t('roles.tables.tour_bookings', 'Tour-Buchungen')\n  }), [t]);\n\n  // Display-Name-Mapping fr Buttons (dynamisch aus bersetzungen)\n  const buttonDisplayNames = useMemo(() => ({\n    'worktime_start': t('roles.buttons.worktime_start'),\n    'worktime_stop': t('roles.buttons.worktime_stop'),\n    'worktime_edit': t('roles.buttons.worktime_edit'),\n    'worktime_delete': t('roles.buttons.worktime_delete'),\n    'task_create': t('roles.buttons.task_create'),\n    'task_edit': t('roles.buttons.task_edit'),\n    'task_delete': t('roles.buttons.task_delete'),\n    'todo_create': t('roles.buttons.todo_create'),\n    'todo_edit': t('roles.buttons.todo_edit'),\n    'todo_delete': t('roles.buttons.todo_delete'),\n    'client_create': t('roles.buttons.client_create'),\n    'client_edit': t('roles.buttons.client_edit'),\n    'client_delete': t('roles.buttons.client_delete'),\n    'consultation_start': t('roles.buttons.consultation_start'),\n    'consultation_stop': t('roles.buttons.consultation_stop'),\n    'consultation_edit': t('roles.buttons.consultation_edit'),\n    'invoice_create': t('roles.buttons.invoice_create'),\n    'invoice_download': t('roles.buttons.invoice_download'),\n    'invoice_mark_paid': t('roles.buttons.invoice_mark_paid'),\n    'invoice_settings': t('roles.buttons.invoice_settings'),\n    'user_create': t('roles.buttons.user_create'),\n    'user_edit': t('roles.buttons.user_edit'),\n    'user_delete': t('roles.buttons.user_delete'),\n    'role_assign': t('roles.buttons.role_assign'),\n    'role_create': t('roles.buttons.role_create'),\n    'role_edit': t('roles.buttons.role_edit'),\n    'role_delete': t('roles.buttons.role_delete'),\n    'organization_create': t('roles.buttons.organization_create'),\n    'organization_edit': t('roles.buttons.organization_edit'),\n    'organization_delete': t('roles.buttons.organization_delete'),\n    'settings_system': t('roles.buttons.settings_system'),\n    'settings_notifications': t('roles.buttons.settings_notifications'),\n    'settings_profile': t('roles.buttons.settings_profile'),\n    'database_reset_table': t('roles.buttons.database_reset_table'),\n    'database_logs': t('roles.buttons.database_logs'),\n    'payroll_generate': t('roles.buttons.payroll_generate'),\n    'payroll_export': t('roles.buttons.payroll_export'),\n    'payroll_edit': t('roles.buttons.payroll_edit'),\n    'cerebro': t('roles.buttons.cerebro')\n  }), [t]);\n  const [formData, setFormData] = useState<RoleFormData>({\n    name: '',\n    description: '',\n    permissions: [\n      // Seiten-Berechtigungen\n      ...defaultPages.map(page => ({\n        entity: page,\n        entityType: 'page',\n        accessLevel: 'none' as AccessLevel\n      })),\n      // Tabellen-Berechtigungen\n      ...defaultTables.map(table => ({\n        entity: table,\n        entityType: 'table',\n        accessLevel: 'none' as AccessLevel\n      })),\n      // Button-Berechtigungen\n      ...defaultButtons.map(button => ({\n        entity: button,\n        entityType: 'button',\n        accessLevel: 'none' as AccessLevel\n      }))\n    ]\n  });\n  const [error, setError] = useState<string | null>(null);\n  const { hasPermission } = usePermissions();\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const [isFilterModalOpen, setIsFilterModalOpen] = useState(false);\n  \n  // States fr Branch-Zuweisungen\n  const [allBranches, setAllBranches] = useState<boolean>(true);\n  const [selectedBranchIds, setSelectedBranchIds] = useState<number[]>([]);\n  const [branches, setBranches] = useState<Array<{ id: number; name: string }>>([]);\n  const [loadingBranches, setLoadingBranches] = useState(false);\n  \n  // Neue State-Variablen fr erweiterte Filterbedingungen\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  \n  // Filter State Management (Controlled Mode)\n  const [activeFilterName, setActiveFilterName] = useState<string>('Alle');\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n  \n  // Responsiveness Hook (640px wie Standard)\n  const [isMobile, setIsMobile] = useState<boolean>(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  \n  // Fehlerbehandlung mit Fallback - useRef fr stabile onError-Referenz\n  const onErrorRef = useRef(onError);\n  useEffect(() => {\n    onErrorRef.current = onError;\n  }, [onError]);\n\n  const errorContext = useError();\n  const handleError = useCallback((err: any, context?: Record<string, any>) => {\n    if (errorContext?.handleError) {\n      errorContext.handleError(err, context);\n    } else {\n      console.error('Fehler:', err, context);\n      if (onErrorRef.current) {\n        onErrorRef.current(err?.message || 'Ein Fehler ist aufgetreten');\n      }\n    }\n  }, [errorContext]);\n\n  const handleValidationError = useCallback((message: string, fieldErrors?: Record<string, string>) => {\n    if (errorContext?.handleValidationError) {\n      errorContext.handleValidationError(message, fieldErrors);\n    } else {\n      console.error('Validierungsfehler:', message, fieldErrors);\n      if (onErrorRef.current) {\n        onErrorRef.current(message);\n      }\n    }\n  }, [errorContext]);\n  \n  // Neue State-Variablen fr die Berechtigungen\n  const [isAddPermissionModalOpen, setIsAddPermissionModalOpen] = useState(false);\n  const [selectedPermission, setSelectedPermission] = useState<string | null>(null);\n  const [displayLimit, setDisplayLimit] = useState<number>(10);\n  \n  // berwache Bildschirmgre\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isModalOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isModalOpen, openSidepane, closeSidepane]);\n\n  // Funktion zum Laden der Branches\n  const fetchBranches = useCallback(async () => {\n    setLoadingBranches(true);\n    try {\n      const response = await branchApi.getAll();\n      setBranches(response.data);\n    } catch (error) {\n      console.error('Fehler beim Laden der Branches:', error);\n    } finally {\n      setLoadingBranches(false);\n    }\n  }, []);\n\n  // Aktualisiere die fetchRoles-Funktion, um den neuen ErrorHandler zu nutzen\n  const fetchRoles = useCallback(async () => {\n    setLoading(true);\n    logger.log('DEBUGAUSGABE: Hole Rollen vom Server...');\n    \n    try {\n      const response = await roleApi.getAll();\n      logger.log('DEBUGAUSGABE: Rollen erfolgreich geholt:', response.data);\n      setRoles(response.data);\n      setError(null);\n    } catch (error) {\n      console.error('DEBUGAUSGABE: Fehler beim Abrufen der Rollen:', error);\n      // Nutze den neuen ErrorHandler\n      handleError(error, { \n        component: 'RoleManagementTab', \n        action: 'fetchRoles' \n      });\n      // Rufe auch den bergebenen onError auf, falls vorhanden\n      if (onError) {\n        onError('Fehler beim Laden der Rollen');\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, [handleError]);\n\n  //  ENTFERNT: Direkt Rollen laden - wird jetzt durch Standard-Pattern gemacht (nach Default-Filter-Anwendung)\n\n  // Branches beim ffnen des Modals laden\n  useEffect(() => {\n    if (isModalOpen) {\n      fetchBranches();\n    }\n  }, [isModalOpen, fetchBranches]);\n\n  // Speichern einer Rolle\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n\n    // Validierung: Wenn allBranches = false, mssen Branches ausgewhlt sein\n    if (!allBranches && selectedBranchIds.length === 0) {\n      handleError(t('roles.form.branchSelectionRequired') || 'Bitte whlen Sie mindestens eine Branch aus oder aktivieren Sie \"Fr alle Branches gltig\"', {\n        component: 'RoleManagementTab'\n      });\n      return;\n    }\n    \n    if (!formData.name) {\n      handleValidationError('Rollenname darf nicht leer sein', { name: 'Rollenname ist erforderlich' });\n      return;\n    }\n    \n    if (editingRole) {\n      // Stelle sicher, dass die immer sichtbaren Seiten auch tatschlich auf 'both' gesetzt sind\n      const updatedPermissions = formData.permissions.map(permission => {\n        if (permission.entityType === 'page' && alwaysVisiblePages.includes(permission.entity)) {\n          return { ...permission, accessLevel: 'both' };\n        }\n        return permission;\n      });\n      \n      // Filtere nur die relevanten Berechtigungen (nicht 'none')\n      const filteredPermissions = updatedPermissions\n        .filter(permission => permission.accessLevel !== 'none')\n        .map(permission => ({\n          entity: permission.entity,\n          entityType: permission.entityType,\n          accessLevel: permission.accessLevel\n        }));\n      \n      if (!editingRole.id || isNaN(editingRole.id)) {\n        console.warn('DEBUGAUSGABE: Ungltige Rollen-ID erkannt, Bearbeitung abgebrochen');\n        handleError('Ungltige Rollen-ID, Bearbeitung abgebrochen', { \n          component: 'RoleManagementTab',\n          roleId: editingRole.id\n        });\n        return;\n      }\n      \n      // berprfen, ob es sich um eine geschtzte Rolle handelt\n      if (isStandardRole(editingRole.id, editingRole.name)) {\n        console.warn(`DEBUGAUSGABE: Versuch, geschtzte Rolle mit ID ${editingRole.id} zu bearbeiten`);\n        handleError({\n          message: 'Geschtzte Systemrollen knnen nicht bearbeitet werden',\n          name: 'PermissionError'\n        }, {\n          component: 'RoleManagementTab',\n          roleId: editingRole.id,\n          category: ErrorCategory.PERMISSION\n        });\n        setIsModalOpen(false);\n        return;\n      }\n      \n      // berprfen, ob die Rolle noch in der aktuellen Liste existiert\n      const roleExists = roles.some(r => r.id === editingRole.id);\n      if (!roleExists) {\n        console.error(`DEBUGAUSGABE: Rolle mit ID ${editingRole.id} existiert nicht in der aktuellen Liste`);\n        handleError(`Rolle mit ID ${editingRole.id} existiert nicht mehr. Bitte aktualisieren Sie die Seite.`, {\n          component: 'RoleManagementTab',\n          roleId: editingRole.id\n        });\n        setIsModalOpen(false);\n        // Rollen neu laden, um die Anzeige zu aktualisieren\n        await fetchRoles();\n        return;\n      }\n      \n      logger.log(`DEBUGAUSGABE: Bearbeite Rolle mit ID ${editingRole.id}`);\n      \n      try {\n        logger.log('DEBUGAUSGABE: Sende Aktualisierung an API:', {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions\n        });\n        \n        const dataToSend = {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions,\n          allBranches: allBranches,\n          branchIds: allBranches ? [] : selectedBranchIds\n        };\n        \n        logger.log('DEBUGAUSGABE: Vor dem API-Aufruf roleApi.update');\n        const response = await roleApi.update(editingRole.id, dataToSend);\n        logger.log('DEBUGAUSGABE: Nach dem API-Aufruf roleApi.update');\n        logger.log('DEBUGAUSGABE: API-Antwort bei Rollenaktualisierung:', response);\n        await fetchRoles();\n      } catch (updateError) {\n        console.error('DEBUGAUSGABE: Fehler bei Rollenaktualisierung:', updateError);\n        if (updateError.response) {\n          // Spezifischere Fehlerbehandlung\n          if (updateError.response.data.meta && updateError.response.data.meta.cause === \"Record to update not found.\") {\n            handleError('Diese Rolle existiert nicht mehr in der Datenbank. Die Anzeige wird aktualisiert.', {\n              component: 'RoleManagementTab',\n              roleId: editingRole.id\n            });\n            setIsModalOpen(false);\n            // Rollenliste aktualisieren, um Frontend zu synchronisieren\n            await fetchRoles();\n          } else {\n            handleError(updateError.response.data.message || 'Fehler beim Aktualisieren der Rolle', {\n              component: 'RoleManagementTab',\n              roleId: editingRole.id\n            });\n          }\n        } else {\n          handleError('Fehler beim Aktualisieren der Rolle', {\n            component: 'RoleManagementTab',\n            roleId: editingRole.id\n          });\n        }\n        return;\n      }\n    } else {\n      // Erstellen einer neuen Rolle\n      try {\n        // Stelle sicher, dass die immer sichtbaren Seiten auch tatschlich auf 'both' gesetzt sind\n        const updatedPermissions = formData.permissions.map(permission => {\n          if (permission.entityType === 'page' && alwaysVisiblePages.includes(permission.entity)) {\n            return { ...permission, accessLevel: 'both' };\n          }\n          return permission;\n        });\n        \n        // Filtere nur die relevanten Berechtigungen (nicht 'none')\n        const filteredPermissions = updatedPermissions\n          .filter(permission => permission.accessLevel !== 'none')\n          .map(permission => ({\n            entity: permission.entity,\n            entityType: permission.entityType,\n            accessLevel: permission.accessLevel\n          }));\n        \n        logger.log('DEBUGAUSGABE: Sende Daten an API fr neue Rolle:', {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions\n        });\n        \n        const dataToSend = {\n          name: formData.name,\n          description: formData.description,\n          permissions: filteredPermissions,\n          allBranches: allBranches,\n          branchIds: allBranches ? [] : selectedBranchIds\n        };\n        \n        logger.log('DEBUGAUSGABE: Vor dem API-Aufruf roleApi.create');\n        const response = await roleApi.create(dataToSend);\n        logger.log('DEBUGAUSGABE: Nach dem API-Aufruf roleApi.create');\n        logger.log('DEBUGAUSGABE: API-Antwort beim Erstellen der Rolle:', response);\n        await fetchRoles();\n      } catch (createError) {\n        console.error('DEBUGAUSGABE: Fehler bei API-Anfrage zum Erstellen der Rolle:', createError);\n        if (createError.response) {\n          handleError(createError.response.data.message || 'Fehler beim Erstellen der Rolle', {\n            component: 'RoleManagementTab'\n          });\n        } else {\n          handleError('Fehler beim Erstellen der Rolle', {\n            component: 'RoleManagementTab'\n          });\n        }\n        return;\n      }\n    }\n    \n    if (onRolesChange) onRolesChange();\n    \n    setIsModalOpen(false);\n    resetForm();\n  };\n\n  // Lschen einer Rolle\n  const handleDelete = async (roleId: number) => {\n    if (!roleId || isNaN(roleId)) {\n      console.warn('Ungltige Rollen-ID erkannt, Lschvorgang abgebrochen');\n      handleError('Ungltige Rollen-ID, Lschvorgang abgebrochen', {\n        component: 'RoleManagementTab',\n        roleId: roleId\n      });\n      return;\n    }\n    \n    // Finde die Rolle in der Liste, um den Namen zu prfen\n    const role = roles.find(r => r.id === roleId);\n    \n    // berprfen, ob es sich um eine geschtzte Rolle handelt\n    if (role && isStandardRole(roleId, role.name)) {\n      console.warn(`Versuch, geschtzte Rolle mit ID ${roleId} (${role.name}) zu lschen`);\n      handleError('Geschtzte Systemrollen knnen nicht gelscht werden', {\n        component: 'RoleManagementTab',\n        roleId: roleId\n      });\n      return;\n    }\n    \n    if (!window.confirm('Mchten Sie diese Rolle wirklich lschen?')) return;\n    \n    try {\n      logger.log(`Starte Lschvorgang fr Rolle mit ID ${roleId}`);\n      \n      // berprfen, ob die Rolle in der aktuellen Liste existiert\n      const roleExists = roles.some(r => r.id === roleId);\n      if (!roleExists) {\n        console.error(`Rolle mit ID ${roleId} existiert nicht in der aktuellen Liste`);\n        handleError(`Rolle mit ID ${roleId} existiert nicht mehr. Bitte aktualisieren Sie die Seite.`, {\n          component: 'RoleManagementTab',\n          roleId: roleId\n        });\n        // Rollen neu laden, um die Anzeige zu aktualisieren\n        await fetchRoles();\n        return;\n      }\n      \n      // Bei Mock-Daten lokales Lschen (wird nicht verwendet)\n      if (false) {\n        logger.log('Lsche Mock-Rolle');\n        const updatedRoles = roles.filter(role => role.id !== roleId);\n        setRoles(updatedRoles);\n      } else {\n        logger.log('Sende Lschanfrage an API');\n        \n        try {\n          const response = await roleApi.delete(roleId);\n          logger.log('API-Antwort beim Lschen der Rolle:', response);\n          \n          // Nach erfolgreichem Lschen die Rollenliste aktualisieren\n          await fetchRoles();\n          logger.log('Rollenliste nach Lschen aktualisiert');\n        } catch (deleteError) {\n          console.error('API-Fehler beim Lschen der Rolle:', deleteError);\n          \n          if (deleteError.response) {\n            console.error('API-Fehlerdaten:', deleteError.response.data);\n            \n            // Spezifischere Fehlerbehandlung\n            if (deleteError.response.data.meta && deleteError.response.data.meta.cause === \"Record to delete does not exist.\") {\n              handleError('Diese Rolle existiert nicht mehr in der Datenbank. Die Anzeige wird aktualisiert.', {\n                component: 'RoleManagementTab',\n                roleId: roleId\n              });\n              // Rollenliste aktualisieren, um Frontend zu synchronisieren\n              await fetchRoles();\n            } else {\n              handleError(deleteError.response.data.message || t('roleManagement.deleteError'), {\n                component: 'RoleManagementTab',\n                roleId: roleId\n              });\n            }\n          } else {\n            handleError(t('roleManagement.networkError'), {\n              component: 'RoleManagementTab',\n              roleId: roleId\n            });\n          }\n          return;\n        }\n      }\n      \n      logger.log('Rolle erfolgreich gelscht');\n      if (onRolesChange) onRolesChange();\n    } catch (err) {\n      console.error(t('roleManagement.unhandledError'), err);\n      handleError(err);\n      \n      // Bei einem unbehandelten Fehler trotzdem versuchen, die Rollenliste zu aktualisieren\n      try {\n        await fetchRoles();\n      } catch (refreshError) {\n        console.error('Fehler beim Aktualisieren der Rollenliste nach fehlgeschlagenem Lschvorgang:', refreshError);\n      }\n    }\n  };\n\n  // Kopieren einer Rolle (fr Standardrollen)\n  const handleCopyRole = async (role: Role) => {\n    try {\n      if (!role || !role.id) {\n        handleError('Ungltige Rolle zum Kopieren', {\n          component: 'RoleManagementTab'\n        });\n        return;\n      }\n\n      // Kopie der Rolle erstellen mit angepasstem Namen\n      const copiedRoleData = {\n        name: `${role.name}-Kopie`,\n        description: role.description || '',\n        permissions: role.permissions\n          .filter(permission => permission.accessLevel !== 'none')\n          .map(permission => ({\n            entity: permission.entity,\n            entityType: permission.entityType,\n            accessLevel: permission.accessLevel\n          }))\n      };\n\n      logger.log('DEBUGAUSGABE: Kopiere Rolle:', role.name, 'mit Daten:', copiedRoleData);\n\n      // Rolle erstellen\n      const response = await roleApi.create(copiedRoleData);\n      logger.log('DEBUGAUSGABE: Rolle erfolgreich kopiert:', response.data);\n\n      // Optimistisches Update: Neue Rolle zur Liste hinzufgen\n      setRoles(prevRoles => [response.data, ...prevRoles]);\n      \n      // Bearbeitungsmodal fr die kopierte Rolle ffnen\n      prepareRoleForEditing(response.data);\n      \n      if (onRolesChange) onRolesChange();\n    } catch (err) {\n      console.error('DEBUGAUSGABE: Fehler beim Kopieren der Rolle:', err);\n      handleError(err, {\n        component: 'RoleManagementTab',\n        roleId: role.id\n      });\n    }\n  };\n\n  // Rolle zum Bearbeiten vorbereiten\n  const prepareRoleForEditing = async (role: Role) => {\n    // Verhindere das Bearbeiten von geschtzten Rollen\n    if (isStandardRole(role.id, role.name)) {\n      handleError('Geschtzte Systemrollen knnen nicht bearbeitet werden', {\n        component: 'RoleManagementTab',\n        roleId: role.id\n      });\n      return;\n    }\n    \n    // Alle mglichen Berechtigungen erstellen (Seiten, Tabellen und Buttons)\n    const allPermissions = [\n      ...defaultPages.map(page => ({\n        entity: page,\n        entityType: 'page',\n        // Fr die immer sichtbaren Seiten 'both' als Standard setzen\n        accessLevel: alwaysVisiblePages.includes(page) ? 'both' as AccessLevel : 'none' as AccessLevel\n      })),\n      ...defaultTables.map(table => ({\n        entity: table,\n        entityType: 'table',\n        accessLevel: 'none' as AccessLevel\n      })),\n      ...defaultButtons.map(button => ({\n        entity: button,\n        entityType: 'button',\n        accessLevel: 'none' as AccessLevel\n      }))\n    ];\n\n    // Vorhandene Berechtigungen bernehmen\n    role.permissions.forEach(permission => {\n      const existingPermIndex = allPermissions.findIndex(\n        p => p.entity === permission.entity && p.entityType === permission.entityType\n      );\n      \n      if (existingPermIndex !== -1) {\n        // Stelle sicher, dass alwaysVisiblePages immer 'both' als AccessLevel haben\n        if (permission.entityType === 'page' && alwaysVisiblePages.includes(permission.entity)) {\n          allPermissions[existingPermIndex].accessLevel = 'both';\n        } else {\n          allPermissions[existingPermIndex].accessLevel = permission.accessLevel;\n        }\n      }\n    });\n\n    setFormData({\n      name: role.name,\n      description: role.description || '',\n      permissions: allPermissions\n    });\n    \n    // Lade Branch-Zuweisungen der Rolle\n    if (role.id) {\n      try {\n        const branchResponse = await roleApi.getRoleBranches(role.id);\n        const branchData = branchResponse.data;\n        setAllBranches(branchData.allBranches || false);\n        setSelectedBranchIds(branchData.branches?.map((b: any) => b.id) || []);\n      } catch (error) {\n        console.error('Fehler beim Laden der Branch-Zuweisungen:', error);\n        setAllBranches(true);\n        setSelectedBranchIds([]);\n      }\n    }\n    \n    setEditingRole(role);\n    setIsModalOpen(true);\n  };\n\n  // Formular fr neue Rolle zurcksetzen\n  const resetForm = () => {\n    setEditingRole(null);\n    setAllBranches(true);\n    setSelectedBranchIds([]);\n    setFormData({\n      name: '',\n      description: '',\n      permissions: [\n        // Seiten-Berechtigungen\n        ...defaultPages.map(page => ({\n          entity: page,\n          entityType: 'page',\n          // Fr die immer sichtbaren Seiten 'both' als Standard setzen\n          accessLevel: alwaysVisiblePages.includes(page) ? 'both' as AccessLevel : 'none' as AccessLevel\n        })),\n        // Tabellen-Berechtigungen\n        ...defaultTables.map(table => ({\n          entity: table,\n          entityType: 'table',\n          accessLevel: 'none' as AccessLevel\n        })),\n        // Button-Berechtigungen\n        ...defaultButtons.map(button => ({\n          entity: button,\n          entityType: 'button',\n          accessLevel: 'none' as AccessLevel\n        }))\n      ]\n    });\n  };\n\n  // Setzt alle Seitenberechtigungen (auer die immer sichtbaren) auf den gleichen Wert\n  const setAllPagePermissions = (accessLevel: AccessLevel) => {\n    const newPermissions = [...formData.permissions];\n    \n    formData.permissions\n      .filter(p => p.entityType === 'page' && !alwaysVisiblePages.includes(p.entity))\n      .forEach(permission => {\n        const permIndex = formData.permissions.indexOf(permission);\n        newPermissions[permIndex] = {\n          ...permission,\n          accessLevel\n        };\n      });\n    \n    setFormData({ ...formData, permissions: newPermissions });\n  };\n\n  // Setzt alle Tabellen-Berechtigungen auf den gleichen Wert\n  const setAllTablePermissions = (accessLevel: AccessLevel) => {\n    const newPermissions = [...formData.permissions];\n    \n    formData.permissions\n      .filter(p => p.entityType === 'table')\n      .forEach(permission => {\n        const permIndex = formData.permissions.indexOf(permission);\n        newPermissions[permIndex] = {\n          ...permission,\n          accessLevel\n        };\n      });\n    \n    setFormData({ ...formData, permissions: newPermissions });\n  };\n\n  // Setzt alle Button-Berechtigungen auf den gleichen Wert\n  const setAllButtonPermissions = (accessLevel: AccessLevel) => {\n    const newPermissions = [...formData.permissions];\n    \n    formData.permissions\n      .filter(p => p.entityType === 'button')\n      .forEach(permission => {\n        const permIndex = formData.permissions.indexOf(permission);\n        newPermissions[permIndex] = {\n          ...permission,\n          accessLevel\n        };\n      });\n    \n    setFormData({ ...formData, permissions: newPermissions });\n  };\n\n  // Funktion zum Zhlen der aktiven Filter\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  // Filtern und sortieren der Rollen\n  const filteredAndSortedRoles = useMemo(() => {\n    return roles\n      .filter(role => {\n        // Globale Suche\n        if (searchTerm) {\n          const searchLower = searchTerm.toLowerCase();\n          \n          //  OPTIMIERUNG: Frhes Beenden bei Match\n          if (role.name.toLowerCase().includes(searchLower)) return true;\n          if (role.description && role.description.toLowerCase().includes(searchLower)) return true;\n          \n          return false; // Kein Match gefunden\n        }\n        \n        // Prfe erweiterte Filterbedingungen, wenn vorhanden\n        if (filterConditions.length > 0) {\n          // Implementiere die logische Verknpfung der Bedingungen (UND/ODER)\n          let result = filterConditions.length > 0;\n          \n          for (let i = 0; i < filterConditions.length; i++) {\n            const condition = filterConditions[i];\n            let conditionMet = false;\n            \n            switch (condition.column) {\n              case 'name':\n                //  OPTIMIERUNG: toLowerCase() nur einmal pro Wert\n                const roleNameLower = role.name.toLowerCase();\n                const nameConditionValueLower = (condition.value as string || '').toLowerCase();\n                if (condition.operator === 'equals') {\n                  conditionMet = roleNameLower === nameConditionValueLower;\n                } else if (condition.operator === 'contains') {\n                  conditionMet = roleNameLower.includes(nameConditionValueLower);\n                } else if (condition.operator === 'startsWith') {\n                  conditionMet = roleNameLower.startsWith(nameConditionValueLower);\n                }\n                break;\n\n              case 'description':\n                if (!role.description) {\n                  conditionMet = false;\n                  break;\n                }\n\n                //  OPTIMIERUNG: toLowerCase() nur einmal pro Wert\n                const roleDescLower = role.description.toLowerCase();\n                const descConditionValueLower = (condition.value as string || '').toLowerCase();\n                if (condition.operator === 'equals') {\n                  conditionMet = roleDescLower === descConditionValueLower;\n                } else if (condition.operator === 'contains') {\n                  conditionMet = roleDescLower.includes(descConditionValueLower);\n                } else if (condition.operator === 'startsWith') {\n                  conditionMet = roleDescLower.startsWith(descConditionValueLower);\n                }\n                break;\n              \n              case 'permissions':\n                // Vereinfachter Filter fr Berechtigungen - zhle die Anzahl der Berechtigungen mit dem angegebenen Level\n                const accessLevel = condition.value as AccessLevel;\n                const count = role.permissions.filter(p => p.accessLevel === accessLevel).length;\n                \n                if (condition.operator === 'greaterThan') {\n                  conditionMet = count > 0;\n                } else if (condition.operator === 'equals') {\n                  conditionMet = count > 0;\n                }\n                break;\n            }\n            \n            // Verknpfe das Ergebnis dieser Bedingung mit dem Gesamtergebnis\n            if (i === 0) {\n              result = conditionMet;\n            } else {\n              const operator = filterLogicalOperators[i - 1];\n              result = operator === 'AND' ? (result && conditionMet) : (result || conditionMet);\n            }\n          }\n          \n          if (!result) return false;\n        }\n        \n        return true;\n      })\n      .sort((a, b) => {\n        //  OPTIMIERUNG: toLowerCase() fr konsistente Sortierung\n        return a.name.toLowerCase().localeCompare(b.name.toLowerCase());\n      });\n  }, [roles, searchTerm, filterConditions, filterLogicalOperators]);\n\n  // Mobile Ansicht renderRoles-Funktion\n  const renderRoles = () => {\n    if (roles.length === 0) {\n      return (\n        <div className=\"p-4 bg-gray-50 rounded text-center\">\n          <p>Keine Rollen gefunden. Erstellen Sie eine neue Rolle mit dem Button oben.</p>\n        </div>\n      );\n    }\n    \n    if (isMobile) {\n      // Mobile Ansicht mit Karten\n      return (\n        <>\n          <div className=\"space-y-4\">\n            {filteredAndSortedRoles.slice(0, displayLimit).map((role) => (\n              <RoleCard \n                key={role.id} \n                role={role} \n                onEdit={prepareRoleForEditing}\n                onDelete={handleDelete}\n                onCopy={handleCopyRole}\n                canEdit={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canDelete={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canCopy={!readOnly && hasPermission('roles', 'write', 'table') && isStandardRole(role.id, role.name)}\n              />\n            ))}\n          </div>\n          \n          {/* \"Mehr anzeigen\" Button - Mobil */}\n          {filteredAndSortedRoles.length > displayLimit && (\n            <div className=\"mt-4 flex justify-center\">\n              <div className=\"relative group\">\n                <button\n                  className=\"p-2 text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700\"\n                  onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                >\n                  <ChevronDownIcon className=\"h-5 w-5\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {`Mehr anzeigen (${filteredAndSortedRoles.length - displayLimit} verbleibend)`}\n                </div>\n              </div>\n            </div>\n          )}\n        </>\n      );\n    } else {\n      // Card-Ansicht fr grere Bildschirme\n      return (\n        <>\n          <div className=\"space-y-4\">\n            {filteredAndSortedRoles.slice(0, displayLimit).map((role) => (\n              <RoleCard \n                key={role.id} \n                role={role} \n                onEdit={prepareRoleForEditing}\n                onDelete={handleDelete}\n                onCopy={handleCopyRole}\n                canEdit={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canDelete={!readOnly && hasPermission('roles', 'write', 'table') && !isStandardRole(role.id, role.name)}\n                canCopy={!readOnly && hasPermission('roles', 'write', 'table') && isStandardRole(role.id, role.name)}\n              />\n            ))}\n          </div>\n          \n          {/* \"Mehr anzeigen\" Button - Desktop */}\n          {filteredAndSortedRoles.length > displayLimit && (\n            <div className=\"mt-4 flex justify-center\">\n              <div className=\"relative group\">\n                <button\n                  className=\"p-2 text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700\"\n                  onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                >\n                  <ChevronDownIcon className=\"h-5 w-5\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {`Mehr anzeigen (${filteredAndSortedRoles.length - displayLimit} verbleibend)`}\n                </div>\n              </div>\n            </div>\n          )}\n        </>\n      );\n    }\n  };\n\n  // Standard-Filter erstellen und speichern\n  useEffect(() => {\n    const createStandardFilters = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        \n        if (!token) {\n          console.error('Nicht authentifiziert');\n          return;\n        }\n\n        // Prfen, ob die Standard-Filter bereits existieren\n        const existingFiltersResponse = await axiosInstance.get(\n          API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(ROLES_TABLE_ID)\n        );\n\n        const existingFilters = existingFiltersResponse.data || [];\n        const alleFilterExists = existingFilters.some(filter => filter.name === 'Alle');\n\n        // Erstelle \"Alle\"-Filter, wenn er noch nicht existiert\n        if (!alleFilterExists) {\n          const alleFilter = {\n            tableId: ROLES_TABLE_ID,\n            name: 'Alle',\n            conditions: [],\n            operators: []\n          };\n\n          await axiosInstance.post(\n            API_ENDPOINTS.SAVED_FILTERS.BASE,\n            alleFilter\n          );\n          logger.log('Alle-Filter fr Rollen erstellt');\n        }\n      } catch (error) {\n        console.error('Fehler beim Erstellen der Standard-Filter:', error);\n      }\n    };\n\n    createStandardFilters();\n  }, []);\n\n  //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n  const filterContext = useFilterContext();\n  const { loadFilters } = filterContext;\n  \n  // Funktion zum Anwenden von Filterbedingungen\n  const applyFilterConditions = useCallback((conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  }, []);\n  \n  // Funktion zum Zurcksetzen der Filter\n  const resetFilterConditions = useCallback(() => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n    setActiveFilterName('');\n    setSelectedFilterId(null);\n  }, []);\n  \n  // Filter Change Handler (Controlled Mode) - VOR useEffect definiert\n  const handleFilterChange = useCallback(async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  }, [applyFilterConditions]);\n  \n  useEffect(() => {\n    const initialize = async () => {\n      // 1. Filter laden (wartet auf State-Update)\n      const filters = await loadFilters(ROLES_TABLE_ID);\n      \n      // 2. Default-Filter anwenden (IMMER vorhanden!)\n      const defaultFilter = filters.find(f => f.name === 'Alle');\n      if (defaultFilter) {\n        await handleFilterChange(\n          defaultFilter.name,\n          defaultFilter.id,\n          defaultFilter.conditions,\n          defaultFilter.operators\n        );\n        }\n      \n      // 3. Rollen laden (immer, auch mit Default-Filter)\n      await fetchRoles();\n    };\n    \n    initialize();\n  }, [loadFilters, handleFilterChange, fetchRoles]);\n\n  return (\n    <div>\n      {/* Spaltenanzeige und Suche */}\n      <div className=\"space-y-4\">\n        <div className=\"flex items-center justify-between mb-4\">\n          {/* Linke Seite: \"Neue Rolle erstellen\"-Button */}\n          <div className=\"flex items-center\">\n            {!readOnly && hasPermission('roles', 'write', 'table') && (\n              <div className=\"relative group\">\n                <button\n                  onClick={() => setIsModalOpen(true)}\n                  className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n                  style={{ width: '30.19px', height: '30.19px' }}\n                  aria-label={t('roles.createRole')}\n                >\n                  <PlusIcon className=\"h-4 w-4\" />\n                </button>\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                  {t('roles.createRole')}\n                </div>\n              </div>\n            )}\n          </div>\n          \n          {/* Mitte: Titel - Kein Titel in der Mitte notwendig bei dieser Komponente, da der Tab-Header bereits den Titel zeigt */}\n          <div></div>\n          \n          {/* Rechte Seite: Suchfeld, Filter-Button, Spalten-Konfiguration */}\n          <div className=\"flex items-center gap-1.5\">\n            <input\n              type=\"text\"\n              placeholder=\"Suchen...\"\n              className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n            />\n            <div className=\"relative group ml-1\">\n              <button\n                className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 text-blue-600' : 'hover:bg-gray-100'}`}\n                onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\n              >\n                <FunnelIcon className=\"w-5 h-5\" />\n                {getActiveFilterCount() > 0 && (\n                  <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\n                    {getActiveFilterCount()}\n                  </span>\n                )}\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                Filter\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Filter-Modal */}\n        {isFilterModalOpen && (\n          <FilterPane\n            columns={[\n              { id: 'name', label: 'Name' },\n              { id: 'description', label: 'Beschreibung' },\n              { id: 'permissions', label: 'Berechtigungen' }\n            ]}\n            onApply={applyFilterConditions}\n            onReset={resetFilterConditions}\n            savedConditions={filterConditions}\n            savedOperators={filterLogicalOperators}\n            tableId={ROLES_TABLE_ID}\n          />\n        )}\n        \n        {/* Gespeicherte Filter als Tags anzeigen */}\n        <SavedFilterTags\n          tableId={ROLES_TABLE_ID}\n          onSelectFilter={applyFilterConditions}\n          onReset={resetFilterConditions}\n          activeFilterName={activeFilterName}\n          selectedFilterId={selectedFilterId}\n          onFilterChange={handleFilterChange}\n          defaultFilterName=\"Alle\"\n        />\n\n        {loading ? (\n          <div className=\"flex justify-center items-center py-8\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\n          </div>\n        ) : (\n          renderRoles()\n        )}\n      </div>\n\n      {/* Modal/Sidepane fr Rollenerstellung/Bearbeitung */}\n      {isModalOpen && (\n        <>\n          {/* Mobile (unter 640px) - Modal */}\n          {isMobile ? (\n            <Dialog open={isModalOpen} onClose={() => setIsModalOpen(false)} className=\"relative z-50\">\n              <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n              \n              <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden\">\n                  {/* Header */}\n                  <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <div className=\"flex items-center justify-between\">\n                      <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                        {editingRole ? t('roles.editRole') : t('roles.createRole')}\n                      </Dialog.Title>\n                      <button\n                        onClick={() => setIsModalOpen(false)}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                      >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                      </button>\n                    </div>\n                  </div>\n                  \n                  {/* Form */}\n                  <form onSubmit={handleSubmit} className=\"flex flex-col flex-1 min-h-0\">\n                    {/* Content - scrollbarer Bereich */}\n                    <div className=\"flex-1 overflow-y-auto min-h-0\">\n                      <div className=\"p-6 space-y-5\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Name</label>\n                  <input\n                    type=\"text\"\n                    value={formData.name}\n                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                    className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                    required\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Beschreibung</label>\n                  <input\n                    type=\"text\"\n                    value={formData.description}\n                    onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                    className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n                  </div>\n                  \n                  {/* Branch-Zuweisungen */}\n                  <div className=\"mt-4\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      {t('roles.form.branchAssignment') || 'Branch-Zuweisung'}\n                    </label>\n                    <div className=\"space-y-3\">\n                      <label className=\"flex items-center\">\n                        <input\n                          type=\"checkbox\"\n                          checked={allBranches}\n                          onChange={(e) => {\n                            setAllBranches(e.target.checked);\n                            if (e.target.checked) {\n                              setSelectedBranchIds([]);\n                            }\n                          }}\n                          className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                        />\n                        <span className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">\n                          {t('roles.form.allBranches') || 'Fr alle Branches gltig'}\n                        </span>\n                      </label>\n                      \n                      {!allBranches && (\n                        <div className=\"ml-6\">\n                          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                            {t('roles.form.specificBranches') || 'Spezifische Branches:'}\n                          </label>\n                          {loadingBranches ? (\n                            <div className=\"text-sm text-gray-500\">Lade Branches...</div>\n                          ) : branches.length === 0 ? (\n                            <div className=\"text-sm text-gray-500\">Keine Branches verfgbar</div>\n                          ) : (\n                            <div className=\"space-y-2 max-h-40 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-2\">\n                              {branches.map((branch) => (\n                                <label key={branch.id} className=\"flex items-center\">\n                                  <input\n                                    type=\"checkbox\"\n                                    checked={selectedBranchIds.includes(branch.id)}\n                                    onChange={(e) => {\n                                      if (e.target.checked) {\n                                        setSelectedBranchIds([...selectedBranchIds, branch.id]);\n                                      } else {\n                                        setSelectedBranchIds(selectedBranchIds.filter(id => id !== branch.id));\n                                      }\n                                    }}\n                                    className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                                  />\n                                  <span className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">\n                                    {branch.name}\n                                  </span>\n                                </label>\n                              ))}\n                            </div>\n                          )}\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                  \n                  <div className=\"mt-2\">\n                    <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-2\">\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">{t('roles.form.detailedPermissions')}</label>\n                        {/* Bulk Actions - kompakt integriert */}\n                        <div className=\"flex flex-wrap items-center gap-1.5\">\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllPagePermissions('both')}\n                              className=\"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800\"\n                            >\n                              {t('roles.form.pagesChecked')}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {t('roles.form.activateAllPages')}\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllPagePermissions('none')}\n                              className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            >\n                              {t('roles.form.pagesUnchecked')}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {t('roles.form.deactivateAllPages')}\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllTablePermissions('both')}\n                              className=\"px-2 py-1 text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-800\"\n                            >\n                              {t('roles.form.tablesChecked')}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {t('roles.form.activateAllTables')}\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllTablePermissions('none')}\n                              className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            >\n                              {t('roles.form.tablesUnchecked')}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {t('roles.form.deactivateAllTables')}\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllButtonPermissions('both')}\n                              className=\"px-2 py-1 text-xs bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 rounded hover:bg-purple-200 dark:hover:bg-purple-800\"\n                            >\n                              {t('roles.form.buttonsChecked')}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {t('roles.form.activateAllButtons')}\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllButtonPermissions('none')}\n                              className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            >\n                              {t('roles.form.buttonsUnchecked')}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {t('roles.form.deactivateAllButtons')}\n                            </div>\n                          </div>\n                        </div>\n                    </div>\n                    \n                    <div className=\"grid grid-cols-1 gap-4 overflow-y-auto border rounded-lg p-4 dark:border-gray-600\">\n                    {formData.permissions\n                      .filter(permission => \n                        permission.entityType === 'page'\n                      )\n                      .map((permission, index) => {\n                        const permIndex = formData.permissions.indexOf(permission);\n                        const isActive = permission.accessLevel === 'both';\n                        return (\n                          <div key={`permission-page-${permission.entity}-${index}`}>\n                            <div className=\"flex items-center justify-between\">\n                              <span className=\"text-sm font-medium text-gray-900 dark:text-gray-100\">{pageDisplayNames[permission.entity] || permission.entity}</span>\n                              <label className={`inline-flex items-center ${alwaysVisiblePages.includes(permission.entity) ? 'cursor-not-allowed opacity-80' : 'cursor-pointer'}`}>\n                                <input\n                                  type=\"checkbox\"\n                                  className=\"sr-only peer\"\n                                  checked={isActive}\n                                  disabled={alwaysVisiblePages.includes(permission.entity)}\n                                  onChange={() => {\n                                    const newPermissions = [...formData.permissions];\n                                    newPermissions[permIndex] = {\n                                      ...permission,\n                                      accessLevel: isActive ? 'none' : 'both'\n                                    };\n                                    setFormData({ ...formData, permissions: newPermissions });\n                                  }}\n                                />\n                                <div className={`relative w-11 h-6 ${alwaysVisiblePages.includes(permission.entity) ? 'bg-blue-600 dark:bg-blue-700' : 'bg-gray-200 dark:bg-gray-700'} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700`}>\n                                  {alwaysVisiblePages.includes(permission.entity) && (\n                                    <span className=\"absolute inset-0 flex items-center justify-center text-xs text-white font-medium\">\n                                      Fix\n                                    </span>\n                                  )}\n                                </div>\n                              </label>\n                            </div>\n                            \n                            {/* Tabellen-Berechtigungen mit zugehrigen Buttons gruppiert */}\n                            {formData.permissions\n                              .filter(tablePerm => \n                                tablePerm.entityType === 'table' && \n                                tableToPageMapping[tablePerm.entity] === permission.entity\n                              )\n                              .sort((a, b) => {\n                                const aName = tableDisplayNames[a.entity] || a.entity;\n                                const bName = tableDisplayNames[b.entity] || b.entity;\n                                // Sortierung: users, roles, organization zuerst (in dieser Reihenfolge)\n                                const priorityOrder = ['users', 'roles', 'organization'];\n                                const aIndex = priorityOrder.indexOf(a.entity);\n                                const bIndex = priorityOrder.indexOf(b.entity);\n                                if (aIndex !== -1 && bIndex !== -1) return aIndex - bIndex;\n                                if (aIndex !== -1) return -1;\n                                if (bIndex !== -1) return 1;\n                                return aName.localeCompare(bName);\n                              })\n                              .map((tablePerm, tableIndex) => {\n                                const tablePermIndex = formData.permissions.indexOf(tablePerm);\n                                const isTableActive = tablePerm.accessLevel === 'both';\n                                const tableEntity = tablePerm.entity;\n                                const tableDisplayName = tableDisplayNames[tableEntity] || tableEntity;\n                                \n                                // Finde alle Buttons, die zu dieser Tabelle gehren\n                                // Filtere Duplikate: task_* und todo_* sind dasselbe, nur task_* behalten\n                                const relatedButtons = formData.permissions\n                                  .filter(buttonPerm => \n                                    buttonPerm.entityType === 'button' && \n                                    buttonToPageMapping[buttonPerm.entity] === permission.entity &&\n                                    buttonToTableMapping[buttonPerm.entity] === tableEntity &&\n                                    // Entferne todo_* Buttons wenn task_* existiert (sind dasselbe)\n                                    !(tableEntity === 'tasks' && buttonPerm.entity.startsWith('todo_'))\n                                  )\n                                  .sort((a, b) => {\n                                    const aName = buttonDisplayNames[a.entity] || a.entity;\n                                    const bName = buttonDisplayNames[b.entity] || b.entity;\n                                    // Logische Reihenfolge: Start, Stop, Erstellen, Bearbeiten, Lschen, dann alphabetisch\n                                    const order = [\n                                      t('roleManagement.buttonOrder.start'),\n                                      t('roleManagement.buttonOrder.stop'),\n                                      t('roleManagement.buttonOrder.create'),\n                                      t('roleManagement.buttonOrder.edit'),\n                                      t('roleManagement.buttonOrder.delete')\n                                    ];\n                                    const aIndex = order.indexOf(aName);\n                                    const bIndex = order.indexOf(bName);\n                                    if (aIndex !== -1 && bIndex !== -1) return aIndex - bIndex;\n                                    if (aIndex !== -1) return -1;\n                                    if (bIndex !== -1) return 1;\n                                    return aName.localeCompare(bName);\n                                  });\n                                \n                                return (\n                                  <div key={`table-permission-${tableEntity}-${tableIndex}`} className=\"mt-3\">\n                                    {/* Tabelle selbst */}\n                                    <div className=\"flex items-center justify-between pl-6 border-l-2 border-blue-300 dark:border-blue-600\">\n                                      <span className=\"text-sm font-semibold text-gray-800 dark:text-gray-200\"> {tableDisplayName}</span>\n                                      <label className=\"inline-flex items-center cursor-pointer\">\n                                        <input\n                                          type=\"checkbox\"\n                                          className=\"sr-only peer\"\n                                          checked={isTableActive}\n                                          onChange={() => {\n                                            const newPermissions = [...formData.permissions];\n                                            newPermissions[tablePermIndex] = {\n                                              ...tablePerm,\n                                              accessLevel: isTableActive ? 'none' : 'both'\n                                            };\n                                            setFormData({ ...formData, permissions: newPermissions });\n                                          }}\n                                        />\n                                        <div className=\"relative w-11 h-6 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                        </div>\n                                      </label>\n                                    </div>\n                                    \n                                    {/* Zu dieser Tabelle gehrige Buttons */}\n                                    {relatedButtons.map((buttonPerm, buttonIndex) => {\n                                      const buttonPermIndex = formData.permissions.indexOf(buttonPerm);\n                                      const isButtonActive = buttonPerm.accessLevel === 'both';\n                                      const buttonDisplayName = buttonDisplayNames[buttonPerm.entity] || buttonPerm.entity;\n                                      return (\n                                        <div key={`button-permission-${buttonPerm.entity}-${buttonIndex}`} \n                                          className=\"flex items-center justify-between mt-2 pl-12 border-l-2 border-gray-300 dark:border-gray-600\">\n                                          <span className=\"text-xs text-gray-600 dark:text-gray-400\"> {buttonDisplayName}</span>\n                                          <label className=\"inline-flex items-center cursor-pointer\">\n                                            <input\n                                              type=\"checkbox\"\n                                              className=\"sr-only peer\"\n                                              checked={isButtonActive}\n                                              onChange={() => {\n                                                const newPermissions = [...formData.permissions];\n                                                newPermissions[buttonPermIndex] = {\n                                                  ...buttonPerm,\n                                                  accessLevel: isButtonActive ? 'none' : 'both'\n                                                };\n                                                setFormData({ ...formData, permissions: newPermissions });\n                                              }}\n                                            />\n                                            <div className=\"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                            </div>\n                                          </label>\n                                        </div>\n                                      );\n                                    })}\n                                  </div>\n                                );\n                              })\n                            }\n                              \n                              {/* Button-Berechtigungen ohne Tabelle-Zuordnung (am Ende) */}\n                              {formData.permissions\n                                .filter(buttonPerm => \n                                  buttonPerm.entityType === 'button' && \n                                  buttonToPageMapping[buttonPerm.entity] === permission.entity &&\n                                  !buttonToTableMapping[buttonPerm.entity]\n                                )\n                                .sort((a, b) => {\n                                  const aName = buttonDisplayNames[a.entity] || a.entity;\n                                  const bName = buttonDisplayNames[b.entity] || b.entity;\n                                  return aName.localeCompare(bName);\n                                })\n                                .map((buttonPerm, buttonIndex) => {\n                                  const buttonPermIndex = formData.permissions.indexOf(buttonPerm);\n                                  const isButtonActive = buttonPerm.accessLevel === 'both';\n                                  const buttonDisplayName = buttonDisplayNames[buttonPerm.entity] || buttonPerm.entity;\n                                  return (\n                                    <div key={`button-permission-${buttonPerm.entity}-${buttonIndex}`} \n                                      className=\"flex items-center justify-between mt-2 pl-6 border-l-2 border-gray-300 dark:border-gray-600\">\n                                      <span className=\"text-xs text-gray-600 dark:text-gray-400\"> {buttonDisplayName}</span>\n                                      <label className=\"inline-flex items-center cursor-pointer\">\n                                        <input\n                                          type=\"checkbox\"\n                                          className=\"sr-only peer\"\n                                          checked={isButtonActive}\n                                          onChange={() => {\n                                            const newPermissions = [...formData.permissions];\n                                            newPermissions[buttonPermIndex] = {\n                                              ...buttonPerm,\n                                              accessLevel: isButtonActive ? 'none' : 'both'\n                                            };\n                                            setFormData({ ...formData, permissions: newPermissions });\n                                          }}\n                                        />\n                                        <div className=\"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                        </div>\n                                      </label>\n                          </div>\n                        );\n                      })\n                    }\n                            </div>\n                          );\n                        })\n                      }\n                    </div>\n                  </div>\n                    </div>\n                  </div>\n                  \n                  {/* Footer */}\n                  <div className=\"px-6 py-4 bg-gray-50 dark:bg-gray-700 flex justify-end gap-2 border-t dark:border-gray-600 flex-shrink-0\">\n                    <div className=\"relative group\">\n                      <button\n                        type=\"button\"\n                        onClick={() => setIsModalOpen(false)}\n                        className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                      >\n                        <XMarkIcon className=\"h-5 w-5\" />\n                      </button>\n                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        Abbrechen\n                      </div>\n                    </div>\n                    <div className=\"relative group\">\n                      <button\n                        type=\"submit\"\n                        className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800\"\n                      >\n                        <CheckIcon className=\"h-5 w-5\" />\n                      </button>\n                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {editingRole ? 'Aktualisieren' : 'Erstellen'}\n                      </div>\n                    </div>\n                  </div>\n                </form>\n              </Dialog.Panel>\n            </div>\n          </Dialog>\n          ) : (\n            /* Desktop (ab 640px) - Sidepane */\n            /* WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition */\n            <>\n              {/* Backdrop - nur wenn offen und <= 1070px */}\n              {/* Hinweis: onClick entfernt, da Backdrop pointer-events: none hat, damit Hauptinhalt interaktiv bleibt */}\n              {isModalOpen && !isLargeScreen && (\n                <div \n                  className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                  aria-hidden=\"true\" \n                  style={{\n                    opacity: isModalOpen ? 1 : 0,\n                    transition: 'opacity 300ms ease-out'\n                  }}\n                />\n              )}\n              \n              {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n              <div \n                className={`fixed top-16 bottom-0 right-0 max-w-2xl w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isModalOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                  transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                  pointerEvents: isModalOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isModalOpen}\n                role=\"dialog\"\n                aria-modal={isModalOpen}\n              >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                  <h2 className=\"text-lg font-semibold dark:text-white\">\n                    {editingRole ? 'Rolle bearbeiten' : 'Neue Rolle erstellen'}\n                  </h2>\n                  <button\n                    onClick={() => setIsModalOpen(false)}\n                    className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                  >\n                    <XMarkIcon className=\"h-6 w-6\" />\n                  </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                  <form onSubmit={handleSubmit} className=\"space-y-5\">\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">{t('roles.form.name')}</label>\n                        <input\n                          type=\"text\"\n                          value={formData.name}\n                          onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                          className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                          required\n                        />\n                      </div>\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">{t('roles.form.description')}</label>\n                        <input\n                          type=\"text\"\n                          value={formData.description}\n                          onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                          className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                        />\n                      </div>\n                    </div>\n                    \n                    <div className=\"mt-2\">\n                      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-2\">\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">Detaillierte Berechtigungen</label>\n                        {/* Bulk Actions */}\n                        <div className=\"flex flex-wrap items-center gap-1.5\">\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllPagePermissions('both')}\n                              className=\"px-2 py-1 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-200 dark:hover:bg-blue-800\"\n                            >\n                              Seiten \n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              Alle Seiten aktivieren\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllPagePermissions('none')}\n                              className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            >\n                              Seiten \n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              Alle Seiten deaktivieren\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllTablePermissions('both')}\n                              className=\"px-2 py-1 text-xs bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300 rounded hover:bg-green-200 dark:hover:bg-green-800\"\n                            >\n                              Tabellen \n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              Alle Tabellen aktivieren\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllTablePermissions('none')}\n                              className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            >\n                              Tabellen \n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              Alle Tabellen deaktivieren\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllButtonPermissions('both')}\n                              className=\"px-2 py-1 text-xs bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 rounded hover:bg-purple-200 dark:hover:bg-purple-800\"\n                            >\n                              Buttons \n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              Alle Buttons aktivieren\n                            </div>\n                          </div>\n                          <div className=\"relative group\">\n                            <button\n                              type=\"button\"\n                              onClick={() => setAllButtonPermissions('none')}\n                              className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded hover:bg-gray-200 dark:hover:bg-gray-600\"\n                            >\n                              Buttons \n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              Alle Buttons deaktivieren\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                      \n                      <div className=\"grid grid-cols-1 gap-4 overflow-y-auto border rounded-lg p-4 dark:border-gray-600 max-h-[60vh]\">\n                        {formData.permissions\n                          .filter(permission => \n                            permission.entityType === 'page'\n                          )\n                          .map((permission, index) => {\n                            const permIndex = formData.permissions.indexOf(permission);\n                            const isActive = permission.accessLevel === 'both';\n                            return (\n                              <div key={`permission-page-desktop-${permission.entity}-${index}`}>\n                                <div className=\"flex items-center justify-between\">\n                                  <span className=\"text-sm font-medium text-gray-900 dark:text-gray-100\">{pageDisplayNames[permission.entity] || permission.entity}</span>\n                                  <label className={`inline-flex items-center ${alwaysVisiblePages.includes(permission.entity) ? 'cursor-not-allowed opacity-80' : 'cursor-pointer'}`}>\n                                    <input\n                                      type=\"checkbox\"\n                                      className=\"sr-only peer\"\n                                      checked={isActive}\n                                      disabled={alwaysVisiblePages.includes(permission.entity)}\n                                      onChange={() => {\n                                        const newPermissions = [...formData.permissions];\n                                        newPermissions[permIndex] = {\n                                          ...permission,\n                                          accessLevel: isActive ? 'none' : 'both'\n                                        };\n                                        setFormData({ ...formData, permissions: newPermissions });\n                                      }}\n                                    />\n                                    <div className={`relative w-11 h-6 ${alwaysVisiblePages.includes(permission.entity) ? 'bg-blue-600 dark:bg-blue-700' : 'bg-gray-200 dark:bg-gray-700'} peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700`}>\n                                      {alwaysVisiblePages.includes(permission.entity) && (\n                                        <span className=\"absolute inset-0 flex items-center justify-center text-xs text-white font-medium\">\n                                          Fix\n                                        </span>\n                                      )}\n                                    </div>\n                                  </label>\n                                </div>\n                                \n                                {/* Tabellen-Berechtigungen mit zugehrigen Buttons gruppiert */}\n                                {formData.permissions\n                                  .filter(tablePerm => \n                                    tablePerm.entityType === 'table' && \n                                    tableToPageMapping[tablePerm.entity] === permission.entity\n                                  )\n                                  .sort((a, b) => {\n                                    const aName = tableDisplayNames[a.entity] || a.entity;\n                                    const bName = tableDisplayNames[b.entity] || b.entity;\n                                    return aName.localeCompare(bName);\n                                  })\n                                  .map((tablePerm, tableIndex) => {\n                                    const tablePermIndex = formData.permissions.indexOf(tablePerm);\n                                    const isTableActive = tablePerm.accessLevel === 'both';\n                                    const tableEntity = tablePerm.entity;\n                                    const tableDisplayName = tableDisplayNames[tableEntity] || tableEntity;\n                                    \n                                    // Finde alle Buttons, die zu dieser Tabelle gehren\n                                    const relatedButtons = formData.permissions\n                                      .filter(buttonPerm => \n                                        buttonPerm.entityType === 'button' && \n                                        buttonToPageMapping[buttonPerm.entity] === permission.entity &&\n                                        buttonToTableMapping[buttonPerm.entity] === tableEntity &&\n                                        !(tableEntity === 'tasks' && buttonPerm.entity.startsWith('todo_'))\n                                      )\n                                      .sort((a, b) => {\n                                        const aName = buttonDisplayNames[a.entity] || a.entity;\n                                        const bName = buttonDisplayNames[b.entity] || b.entity;\n                                        const order = [\n                                      t('roleManagement.buttonOrder.start'),\n                                      t('roleManagement.buttonOrder.stop'),\n                                      t('roleManagement.buttonOrder.create'),\n                                      t('roleManagement.buttonOrder.edit'),\n                                      t('roleManagement.buttonOrder.delete')\n                                    ];\n                                        const aIndex = order.indexOf(aName);\n                                        const bIndex = order.indexOf(bName);\n                                        if (aIndex !== -1 && bIndex !== -1) return aIndex - bIndex;\n                                        if (aIndex !== -1) return -1;\n                                        if (bIndex !== -1) return 1;\n                                        return aName.localeCompare(bName);\n                                      });\n                                    \n                                    return (\n                                      <div key={`table-permission-desktop-${tableEntity}-${tableIndex}`} className=\"mt-3\">\n                                        {/* Tabelle selbst */}\n                                        <div className=\"flex items-center justify-between pl-6 border-l-2 border-blue-300 dark:border-blue-600\">\n                                          <span className=\"text-sm font-semibold text-gray-800 dark:text-gray-200\"> {tableDisplayName}</span>\n                                          <label className=\"inline-flex items-center cursor-pointer\">\n                                            <input\n                                              type=\"checkbox\"\n                                              className=\"sr-only peer\"\n                                              checked={isTableActive}\n                                              onChange={() => {\n                                                const newPermissions = [...formData.permissions];\n                                                newPermissions[tablePermIndex] = {\n                                                  ...tablePerm,\n                                                  accessLevel: isTableActive ? 'none' : 'both'\n                                                };\n                                                setFormData({ ...formData, permissions: newPermissions });\n                                              }}\n                                            />\n                                            <div className=\"relative w-11 h-6 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                            </div>\n                                          </label>\n                                        </div>\n                                        \n                                        {/* Zu dieser Tabelle gehrige Buttons */}\n                                        {relatedButtons.map((buttonPerm, buttonIndex) => {\n                                          const buttonPermIndex = formData.permissions.indexOf(buttonPerm);\n                                          const isButtonActive = buttonPerm.accessLevel === 'both';\n                                          const buttonDisplayName = buttonDisplayNames[buttonPerm.entity] || buttonPerm.entity;\n                                          return (\n                                            <div key={`button-permission-desktop-${buttonPerm.entity}-${buttonIndex}`} \n                                              className=\"flex items-center justify-between mt-2 pl-12 border-l-2 border-gray-300 dark:border-gray-600\">\n                                              <span className=\"text-xs text-gray-600 dark:text-gray-400\"> {buttonDisplayName}</span>\n                                              <label className=\"inline-flex items-center cursor-pointer\">\n                                                <input\n                                                  type=\"checkbox\"\n                                                  className=\"sr-only peer\"\n                                                  checked={isButtonActive}\n                                                  onChange={() => {\n                                                    const newPermissions = [...formData.permissions];\n                                                    newPermissions[buttonPermIndex] = {\n                                                      ...buttonPerm,\n                                                      accessLevel: isButtonActive ? 'none' : 'both'\n                                                    };\n                                                    setFormData({ ...formData, permissions: newPermissions });\n                                                  }}\n                                                />\n                                                <div className=\"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                                </div>\n                                              </label>\n                                            </div>\n                                          );\n                                        })}\n                                      </div>\n                                    );\n                                  })\n                                }\n                                  \n                                {/* Button-Berechtigungen ohne Tabelle-Zuordnung (am Ende) */}\n                                {formData.permissions\n                                  .filter(buttonPerm => \n                                    buttonPerm.entityType === 'button' && \n                                    buttonToPageMapping[buttonPerm.entity] === permission.entity &&\n                                    !buttonToTableMapping[buttonPerm.entity]\n                                  )\n                                  .sort((a, b) => {\n                                    const aName = buttonDisplayNames[a.entity] || a.entity;\n                                    const bName = buttonDisplayNames[b.entity] || b.entity;\n                                    return aName.localeCompare(bName);\n                                  })\n                                  .map((buttonPerm, buttonIndex) => {\n                                    const buttonPermIndex = formData.permissions.indexOf(buttonPerm);\n                                    const isButtonActive = buttonPerm.accessLevel === 'both';\n                                    const buttonDisplayName = buttonDisplayNames[buttonPerm.entity] || buttonPerm.entity;\n                                    return (\n                                      <div key={`button-permission-desktop-${buttonPerm.entity}-${buttonIndex}`} \n                                        className=\"flex items-center justify-between mt-2 pl-6 border-l-2 border-gray-300 dark:border-gray-600\">\n                                        <span className=\"text-xs text-gray-600 dark:text-gray-400\"> {buttonDisplayName}</span>\n                                        <label className=\"inline-flex items-center cursor-pointer\">\n                                          <input\n                                            type=\"checkbox\"\n                                            className=\"sr-only peer\"\n                                            checked={isButtonActive}\n                                            onChange={() => {\n                                              const newPermissions = [...formData.permissions];\n                                              newPermissions[buttonPermIndex] = {\n                                                ...buttonPerm,\n                                                accessLevel: isButtonActive ? 'none' : 'both'\n                                              };\n                                              setFormData({ ...formData, permissions: newPermissions });\n                                            }}\n                                          />\n                                          <div className=\"relative w-9 h-5 bg-gray-200 dark:bg-gray-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[1px] after:start-[1px] after:bg-white after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600 dark:peer-checked:bg-blue-700\">\n                                          </div>\n                                        </label>\n                                      </div>\n                                    );\n                                  })\n                                }\n                              </div>\n                            );\n                          })\n                        }\n                      </div>\n                    </div>\n\n                    {/* Buttons */}\n                    <div className=\"flex justify-end pt-4 gap-2\">\n                      <div className=\"relative group\">\n                        <button\n                          type=\"button\"\n                          onClick={() => setIsModalOpen(false)}\n                          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                        >\n                          <XMarkIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          Abbrechen\n                        </div>\n                      </div>\n                      <div className=\"relative group\">\n                        <button\n                          type=\"submit\"\n                          className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors\"\n                        >\n                          <CheckIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {editingRole ? 'Aktualisieren' : 'Erstellen'}\n                        </div>\n                      </div>\n                    </div>\n                  </form>\n                </div>\n              </div>\n            </>\n          )}\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default RoleManagementTab; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { PencilIcon, CheckIcon, XMarkIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport axiosInstance from '../../config/axios.ts';\n\ninterface RoomDescription {\n  text?: string;\n  imageUrl?: string;\n  videoUrl?: string;\n}\n\ninterface RoomDescriptionsSectionProps {\n  branchId: number;\n}\n\nconst RoomDescriptionsSection: React.FC<RoomDescriptionsSectionProps> = ({ branchId }) => {\n  const { t } = useTranslation();\n  const [roomDescriptions, setRoomDescriptions] = useState<Record<number, RoomDescription>>({});\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [editingCategoryId, setEditingCategoryId] = useState<number | null>(null);\n  const [editForm, setEditForm] = useState<RoomDescription>({ text: '', imageUrl: '', videoUrl: '' });\n  const [rooms, setRooms] = useState<Array<{ categoryId: number; roomName: string; roomType: 'compartida' | 'privada' }>>([]);\n  const [loadingRooms, setLoadingRooms] = useState(false);\n\n  // Lade Zimmer-Beschreibungen\n  const loadRoomDescriptions = async () => {\n    try {\n      setLoading(true);\n      const response = await axiosInstance.get(API_ENDPOINTS.BRANCHES.ROOM_DESCRIPTIONS(branchId));\n      setRoomDescriptions(response.data || {});\n    } catch (error: any) {\n      console.error('Fehler beim Laden der Zimmer-Beschreibungen:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Lade Zimmer-Liste aus Reservierungen\n  const loadRooms = async () => {\n    try {\n      setLoadingRooms(true);\n      // Lade Reservierungen mit categoryId\n      const response = await axiosInstance.get(API_ENDPOINTS.RESERVATION.BASE, {\n        params: {\n          branchId: branchId,\n          limit: 1000 // Lade viele Reservierungen, um alle Zimmer zu finden\n        }\n      });\n      \n      // Extrahiere eindeutige categoryIds\n      const categoryMap = new Map<number, { roomName: string; roomType: 'compartida' | 'privada' }>();\n      \n      // Backend gibt data.data zurck (nicht data.reservations)\n      const reservations = response.data.data || [];\n      \n      reservations.forEach((reservation: any) => {\n        if (reservation.categoryId && reservation.roomNumber) {\n          // Bestimme roomType basierend auf roomNumber (Dorms enthalten \"(\")\n          const isDorm = reservation.roomNumber.includes('(');\n          const roomType = isDorm ? 'compartida' : 'privada';\n          \n          // Extrahiere Zimmername (fr Dorms: vor \"(\")\n          const roomName = isDorm \n            ? reservation.roomNumber.split('(')[0].trim()\n            : reservation.roomNumber;\n          \n          if (!categoryMap.has(reservation.categoryId)) {\n            categoryMap.set(reservation.categoryId, { roomName, roomType });\n          }\n        }\n      });\n      \n      // Konvertiere Map zu Array\n      const roomsArray = Array.from(categoryMap.entries()).map(([categoryId, data]) => ({\n        categoryId,\n        ...data\n      }));\n      \n      setRooms(roomsArray.sort((a, b) => a.roomName.localeCompare(b.roomName)));\n    } catch (error: any) {\n      console.error('Fehler beim Laden der Zimmer:', error);\n    } finally {\n      setLoadingRooms(false);\n    }\n  };\n\n  useEffect(() => {\n    if (branchId) {\n      loadRoomDescriptions();\n      loadRooms();\n    }\n  }, [branchId]);\n\n  // Starte Bearbeitung\n  const handleEdit = (categoryId: number) => {\n    const description = roomDescriptions[categoryId] || { text: '', imageUrl: '', videoUrl: '' };\n    setEditForm(description);\n    setEditingCategoryId(categoryId);\n  };\n\n  // Speichere Beschreibung\n  const handleSave = async () => {\n    if (editingCategoryId === null) return;\n    \n    try {\n      setSaving(true);\n      const updatedDescriptions = {\n        ...roomDescriptions,\n        [editingCategoryId]: editForm\n      };\n      \n      await axiosInstance.put(\n        API_ENDPOINTS.BRANCHES.ROOM_DESCRIPTIONS(branchId),\n        { roomDescriptions: updatedDescriptions }\n      );\n      \n      // Lade Daten neu vom Backend, um sicherzustellen, dass sie korrekt gespeichert wurden\n      await loadRoomDescriptions();\n      \n      setEditingCategoryId(null);\n      setEditForm({ text: '', imageUrl: '', videoUrl: '' });\n    } catch (error: any) {\n      console.error('Fehler beim Speichern der Zimmer-Beschreibung:', error);\n      alert(t('branches.roomDescriptions.saveError', { defaultValue: 'Fehler beim Speichern der Beschreibung' }));\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  // Abbrechen\n  const handleCancel = () => {\n    setEditingCategoryId(null);\n    setEditForm({ text: '', imageUrl: '', videoUrl: '' });\n  };\n\n  if (loading || loadingRooms) {\n    return (\n      <div className=\"mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded\">\n        <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n          {t('common.loading', { defaultValue: 'Lade...' })}\n        </p>\n      </div>\n    );\n  }\n\n  if (rooms.length === 0) {\n    return (\n      <div className=\"mt-6 p-4 bg-gray-50 dark:bg-gray-700 rounded\">\n        <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n          {t('branches.roomDescriptions.noRooms', { \n            defaultValue: 'Keine Zimmer gefunden. Importieren Sie zuerst Reservierungen aus LobbyPMS.' \n          })}\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"mt-6 border-t border-gray-200 dark:border-gray-700 pt-6\">\n      <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n        {t('branches.roomDescriptions.title', { defaultValue: 'Zimmer-Beschreibungen' })}\n      </h5>\n      <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-4\">\n        {t('branches.roomDescriptions.description', { \n          defaultValue: 'Beschreibungen, wie man zu den Zimmern kommt. Diese werden in den Check-in-Nachrichten verwendet.' \n        })}\n      </p>\n      \n      <div className=\"space-y-4\">\n        {rooms.map((room) => {\n          const isEditing = editingCategoryId === room.categoryId;\n          const description = roomDescriptions[room.categoryId] || null;\n          \n          return (\n            <div\n              key={room.categoryId}\n              className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4 bg-white dark:bg-gray-800\"\n            >\n              <div className=\"flex items-start justify-between mb-2\">\n                <div>\n                  <h6 className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                    {room.roomName}\n                  </h6>\n                  <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n                    {room.roomType === 'compartida' \n                      ? t('branches.roomDescriptions.dorm', { defaultValue: 'Dorm' })\n                      : t('branches.roomDescriptions.private', { defaultValue: 'Privatzimmer' })}\n                    {'  '}\n                    {t('branches.roomDescriptions.categoryId', { defaultValue: 'Category ID' })}: {room.categoryId}\n                  </span>\n                </div>\n                {!isEditing && (\n                  <button\n                    onClick={() => handleEdit(room.categoryId)}\n                    className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n                    title={t('common.edit', { defaultValue: 'Bearbeiten' })}\n                  >\n                    <PencilIcon className=\"h-4 w-4\" />\n                  </button>\n                )}\n              </div>\n              \n              {isEditing ? (\n                <div className=\"space-y-3 mt-3\">\n                  <div>\n                    <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('branches.roomDescriptions.text', { defaultValue: 'Text' })}\n                    </label>\n                    <textarea\n                      value={editForm.text || ''}\n                      onChange={(e) => setEditForm({ ...editForm, text: e.target.value })}\n                      rows={3}\n                      placeholder={t('branches.roomDescriptions.textPlaceholder', { \n                        defaultValue: 'Beschreibung, wie man zum Zimmer kommt...' \n                      })}\n                      className=\"w-full text-sm rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white px-3 py-2\"\n                    />\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('branches.roomDescriptions.imageUrl', { defaultValue: 'Bild-URL' })}\n                    </label>\n                    <input\n                      type=\"text\"\n                      value={editForm.imageUrl || ''}\n                      onChange={(e) => setEditForm({ ...editForm, imageUrl: e.target.value })}\n                      placeholder=\"https://example.com/image.jpg\"\n                      className=\"w-full text-sm rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white px-3 py-2\"\n                    />\n                  </div>\n                  \n                  <div>\n                    <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('branches.roomDescriptions.videoUrl', { defaultValue: 'Video-URL' })}\n                    </label>\n                    <input\n                      type=\"text\"\n                      value={editForm.videoUrl || ''}\n                      onChange={(e) => setEditForm({ ...editForm, videoUrl: e.target.value })}\n                      placeholder=\"https://example.com/video.mp4\"\n                      className=\"w-full text-sm rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white px-3 py-2\"\n                    />\n                  </div>\n                  \n                  <div className=\"flex justify-end space-x-2\">\n                    <button\n                      onClick={handleCancel}\n                      disabled={saving}\n                      className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50\"\n                      title={t('common.cancel', { defaultValue: 'Abbrechen' })}\n                    >\n                      <XMarkIcon className=\"h-5 w-5\" />\n                    </button>\n                    <button\n                      onClick={handleSave}\n                      disabled={saving}\n                      className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 dark:bg-blue-500 dark:hover:bg-blue-600\"\n                      title={saving ? t('common.saving', { defaultValue: 'Speichere...' }) : t('common.save', { defaultValue: 'Speichern' })}\n                    >\n                      <CheckIcon className=\"h-5 w-5\" />\n                    </button>\n                  </div>\n                </div>\n              ) : (\n                <div className=\"mt-2 text-sm text-gray-600 dark:text-gray-400\">\n                  {description ? (\n                    <div className=\"space-y-1\">\n                      {description.text && (\n                        <p>{description.text}</p>\n                      )}\n                      {description.imageUrl && (\n                        <p>\n                          <span className=\"font-medium\">{t('branches.roomDescriptions.image', { defaultValue: 'Bild' })}:</span>{' '}\n                          <a href={description.imageUrl} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-600 dark:text-blue-400 hover:underline\">\n                            {description.imageUrl}\n                          </a>\n                        </p>\n                      )}\n                      {description.videoUrl && (\n                        <p>\n                          <span className=\"font-medium\">{t('branches.roomDescriptions.video', { defaultValue: 'Video' })}:</span>{' '}\n                          <a href={description.videoUrl} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-600 dark:text-blue-400 hover:underline\">\n                            {description.videoUrl}\n                          </a>\n                        </p>\n                      )}\n                    </div>\n                  ) : (\n                    <p className=\"text-gray-400 dark:text-gray-500 italic\">\n                      {t('branches.roomDescriptions.noDescription', { defaultValue: 'Keine Beschreibung vorhanden' })}\n                    </p>\n                  )}\n                </div>\n              )}\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n};\n\nexport default RoomDescriptionsSection;\n\n","import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { PencilIcon, TrashIcon, PlusIcon, XMarkIcon, CheckIcon, FunnelIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport FilterPane from '../components/FilterPane.tsx';\nimport SavedFilterTags from '../components/SavedFilterTags.tsx';\nimport { useFilterContext } from '../contexts/FilterContext.tsx';\nimport { FilterCondition } from '../components/FilterRow.tsx';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport RoomDescriptionsSection from './branches/RoomDescriptionsSection.tsx';\nimport { useError } from '../contexts/ErrorContext.tsx';\nimport { logger } from '../utils/logger.ts';\n\ninterface Branch {\n    id: number;\n    name: string;\n    whatsappSettings?: any;\n    lobbyPmsSettings?: any;\n    boldPaymentSettings?: any;\n    doorSystemSettings?: any;\n    emailSettings?: any;\n}\n\ninterface BranchManagementTabProps {\n}\n\n// BranchCard-Komponente fr mobile und Desktop-Ansicht\nconst BranchCard: React.FC<{\n    branch: Branch;\n    onEdit: (branch: Branch) => void;\n    onDelete: (branchId: number) => void;\n    canEdit: boolean;\n    canDelete: boolean;\n}> = ({ branch, onEdit, onDelete, canEdit, canDelete }) => {\n    const { t } = useTranslation();\n    return (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-4\">\n            {/* Header mit Branchname und Aktionen */}\n            <div className=\"flex justify-between items-start mb-2\">\n                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">{branch.name}</h3>\n                \n                <div className=\"flex space-x-2\">\n                    {canEdit && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => onEdit(branch)}\n                                className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n                            >\n                                <PencilIcon className=\"h-5 w-5\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('common.edit', { defaultValue: 'Bearbeiten' })}\n                            </div>\n                        </div>\n                    )}\n                    \n                    {canDelete && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => onDelete(branch.id)}\n                                className=\"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-1\"\n                            >\n                                <TrashIcon className=\"h-5 w-5\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('common.delete', { defaultValue: 'Lschen' })}\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    );\n};\n\n// TableID fr gespeicherte Filter\nconst BRANCHES_TABLE_ID = 'branches-table';\n\nconst BranchManagementTab: React.FC<BranchManagementTabProps> = () => {\n    const { t } = useTranslation();\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    const [editingBranch, setEditingBranch] = useState<Branch | null>(null);\n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [formData, setFormData] = useState({ \n        name: '',\n        address: '',\n        city: '',\n        country: '',\n        whatsappSettings: {\n            provider: 'whatsapp-business-api' as 'twilio' | 'whatsapp-business-api',\n            apiKey: '',\n            apiSecret: '',\n            phoneNumberId: '',\n            ai: {\n                enabled: false,\n                model: 'gpt-4o',\n                systemPrompt: '',\n                rules: [] as string[],\n                sources: [] as string[],\n                temperature: 0.7,\n                maxTokens: 500\n            }\n        },\n        lobbyPmsSettings: {\n            apiUrl: '',\n            apiKey: '',\n            propertyId: '',\n            syncEnabled: true,\n            autoCreateTasks: false,\n            lateCheckInThreshold: '22:00',\n            notificationChannels: ['email'] as string[],\n            autoSendInvitation: false\n        },\n        boldPaymentSettings: {\n            apiKey: '',\n            merchantId: '',\n            environment: 'sandbox' as 'sandbox' | 'production'\n        },\n        doorSystemSettings: {\n            clientId: '',\n            clientSecret: '',\n            username: '',\n            password: '',\n            apiUrl: 'https://euopen.ttlock.com',\n            lockIds: [] as string[],\n            appName: 'TTLock'\n        },\n        emailSettings: {\n            smtpHost: '',\n            smtpPort: 587,\n            smtpUser: '',\n            smtpPass: '',\n            smtpFromEmail: '',\n            smtpFromName: '',\n            imap: {\n                enabled: false,\n                host: '',\n                port: 993,\n                secure: true,\n                user: '',\n                password: '',\n                folder: 'INBOX',\n                processedFolder: ''\n            }\n        },\n        messageTemplates: {\n            checkInInvitation: {\n                en: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                },\n                es: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                },\n                de: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                }\n            },\n            checkInConfirmation: {\n                en: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                },\n                es: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                },\n                de: {\n                    whatsappTemplateName: '',\n                    whatsappTemplateParams: [] as string[],\n                    emailSubject: '',\n                    emailContent: ''\n                }\n            }\n        },\n        autoSendReservationInvitation: false\n    });\n    const [activeSettingsTab, setActiveSettingsTab] = useState<'whatsapp' | 'lobbypms' | 'boldpayment' | 'doorsystem' | 'email' | 'messages'>('whatsapp');\n    const [showSecrets, setShowSecrets] = useState<Record<string, boolean>>({});\n    const [selectedTemplateType, setSelectedTemplateType] = useState<'checkInInvitation' | 'checkInConfirmation'>('checkInInvitation');\n    const [selectedLanguage, setSelectedLanguage] = useState<'en' | 'es' | 'de'>('en');\n    const [searchTerm, setSearchTerm] = useState('');\n    const [isFilterModalOpen, setIsFilterModalOpen] = useState(false);\n    const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n    const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n    const [activeFilterName, setActiveFilterName] = useState<string>('');\n    const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n    const [displayLimit, setDisplayLimit] = useState(10);\n    const { hasPermission } = usePermissions();\n    const { openSidepane, closeSidepane } = useSidepane();\n    const { handleError: handleErrorContext } = useError();\n\n    // Berechtigungen prfen\n    const canCreate = hasPermission('branches', 'write', 'table');\n    const canEdit = hasPermission('branches', 'write', 'table');\n    const canDelete = hasPermission('branches', 'write', 'table');\n\n    // Branches laden\n    const fetchBranches = useCallback(async () => {\n        setLoading(true);\n        try {\n            const response = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\n            setBranches(response.data);\n        } catch (error: any) {\n            console.error('Fehler beim Laden der Niederlassungen:', error);\n            handleErrorContext(error);\n        } finally {\n            setLoading(false);\n        }\n    }, [handleErrorContext]);\n\n    useEffect(() => {\n        fetchBranches();\n    }, [fetchBranches]);\n\n    // Sidepane ffnen/schlieen basierend auf Modal-Status\n    useEffect(() => {\n        if (isModalOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isModalOpen, openSidepane, closeSidepane]);\n\n    // Formular zurcksetzen\n    const resetForm = () => {\n        setFormData({ \n            name: '',\n            address: '',\n            city: '',\n            country: '',\n            whatsappSettings: {\n                provider: 'whatsapp-business-api' as 'twilio' | 'whatsapp-business-api',\n                apiKey: '',\n                apiSecret: '',\n                phoneNumberId: '',\n                ai: {\n                    enabled: false,\n                    model: 'gpt-4o',\n                    systemPrompt: '',\n                    rules: [] as string[],\n                    sources: [] as string[],\n                    temperature: 0.7,\n                    maxTokens: 500\n                }\n            },\n            lobbyPmsSettings: {\n                apiUrl: '',\n                apiKey: '',\n                propertyId: '',\n                syncEnabled: true,\n                autoCreateTasks: false,\n                lateCheckInThreshold: '22:00',\n                notificationChannels: ['email'] as string[],\n                autoSendInvitation: false\n            },\n            boldPaymentSettings: {\n                apiKey: '',\n                merchantId: '',\n                environment: 'sandbox' as 'sandbox' | 'production'\n            },\n            doorSystemSettings: {\n                clientId: '',\n                clientSecret: '',\n                username: '',\n                password: '',\n                apiUrl: 'https://euopen.ttlock.com',\n                lockIds: [] as string[],\n                appName: 'TTLock'\n            },\n            sireSettings: {\n                enabled: false,\n                autoRegisterOnCheckIn: false,\n                apiUrl: '',\n                apiKey: '',\n                apiSecret: '',\n                propertyCode: ''\n            },\n            emailSettings: {\n                smtpHost: '',\n                smtpPort: 587,\n                smtpUser: '',\n                smtpPass: '',\n                smtpFromEmail: '',\n                smtpFromName: '',\n                imap: {\n                    enabled: false,\n                    host: '',\n                    port: 993,\n                    secure: true,\n                    user: '',\n                    password: '',\n                    folder: 'INBOX',\n                    processedFolder: ''\n                }\n            },\n            messageTemplates: {\n                checkInInvitation: {\n                    en: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    },\n                    es: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    },\n                    de: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    }\n                },\n                checkInConfirmation: {\n                    en: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    },\n                    es: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    },\n                    de: {\n                        whatsappTemplateName: '',\n                        whatsappTemplateParams: [] as string[],\n                        emailSubject: '',\n                        emailContent: ''\n                    }\n                }\n            },\n            autoSendReservationInvitation: false\n        });\n        setActiveSettingsTab('whatsapp');\n        setEditingBranch(null);\n    };\n\n    // Modal ffnen fr neue Branch\n    const handleCreate = () => {\n        resetForm();\n        setIsModalOpen(true);\n    };\n\n    // Modal ffnen fr Bearbeitung\n    const handleEdit = async (branch: Branch) => {\n        setEditingBranch(branch);\n        const existingWhatsapp = branch.whatsappSettings || {};\n        const existingLobbyPms = branch.lobbyPmsSettings || {};\n        // Bold Payment Settings: Prfe ob es ein String ist (JSON) oder bereits ein Objekt\n        let existingBoldPayment: any = branch.boldPaymentSettings;\n        if (!existingBoldPayment) {\n            existingBoldPayment = {};\n        } else if (typeof existingBoldPayment === 'string') {\n            try {\n                existingBoldPayment = JSON.parse(existingBoldPayment);\n            } catch (e) {\n                console.error('Fehler beim Parsen von boldPaymentSettings:', e);\n                existingBoldPayment = {};\n            }\n        }\n        // Stelle sicher, dass verschlsselte Werte (mit ':') auch angezeigt werden\n        // Wenn Entschlsselung fehlgeschlagen ist, bleiben die verschlsselten Strings erhalten\n        const existingDoorSystem = branch.doorSystemSettings || {};\n        const existingEmail = branch.emailSettings || {};\n        const existingMessageTemplates = (branch as any).messageTemplates || {};\n        const existingAutoSend = (branch as any).autoSendReservationInvitation || false;\n        \n        setFormData({ \n            name: branch.name,\n            address: (branch as any).address || '',\n            city: (branch as any).city || '',\n            country: (branch as any).country || '',\n            whatsappSettings: {\n                provider: existingWhatsapp.provider || 'whatsapp-business-api',\n                apiKey: existingWhatsapp.apiKey || '',\n                apiSecret: existingWhatsapp.apiSecret || '',\n                phoneNumberId: existingWhatsapp.phoneNumberId || '',\n                ai: existingWhatsapp.ai || {\n                    enabled: false,\n                    model: 'gpt-4o',\n                    systemPrompt: '',\n                    rules: [],\n                    sources: [],\n                    temperature: 0.7,\n                    maxTokens: 500\n                }\n            },\n            lobbyPmsSettings: {\n                apiUrl: existingLobbyPms.apiUrl || '',\n                apiKey: existingLobbyPms.apiKey || '',\n                propertyId: existingLobbyPms.propertyId || '',\n                syncEnabled: existingLobbyPms.syncEnabled !== undefined ? existingLobbyPms.syncEnabled : true,\n                autoCreateTasks: existingLobbyPms.autoCreateTasks || false,\n                lateCheckInThreshold: existingLobbyPms.lateCheckInThreshold || '22:00',\n                notificationChannels: existingLobbyPms.notificationChannels || ['email'],\n                autoSendInvitation: existingLobbyPms.autoSendInvitation || false\n            },\n            boldPaymentSettings: {\n                // Wenn Entschlsselung fehlgeschlagen ist, sind die Werte verschlsselt (Format: \"iv:authTag:encrypted\")\n                // Diese sollten NICHT im Frontend angezeigt werden (Sicherheit)\n                // ABER: Wir speichern einen Flag, dass verschlsselte Werte vorhanden sind\n                // Die verschlsselten Werte bleiben in der DB, damit Payment-Links weiter funktionieren\n                apiKey: (existingBoldPayment.apiKey && !existingBoldPayment.apiKey.includes(':')) \n                    ? existingBoldPayment.apiKey \n                    : '',\n                merchantId: (existingBoldPayment.merchantId && !existingBoldPayment.merchantId.includes(':')) \n                    ? existingBoldPayment.merchantId \n                    : '',\n                environment: existingBoldPayment.environment || 'sandbox',\n                // Flag: Gibt an, ob verschlsselte Werte vorhanden sind (aber nicht entschlsselbar)\n                _hasEncryptedValues: (existingBoldPayment.apiKey && existingBoldPayment.apiKey.includes(':')) ||\n                                     (existingBoldPayment.merchantId && existingBoldPayment.merchantId.includes(':'))\n            },\n            doorSystemSettings: {\n                clientId: existingDoorSystem.clientId || '',\n                clientSecret: existingDoorSystem.clientSecret || '',\n                username: existingDoorSystem.username || '',\n                password: existingDoorSystem.password || '',\n                apiUrl: existingDoorSystem.apiUrl || 'https://euopen.ttlock.com',\n                lockIds: existingDoorSystem.lockIds || [],\n                appName: existingDoorSystem.appName || 'TTLock'\n            },\n            emailSettings: {\n                smtpHost: existingEmail.smtpHost || '',\n                smtpPort: existingEmail.smtpPort || 587,\n                smtpUser: existingEmail.smtpUser || '',\n                smtpPass: existingEmail.smtpPass || '',\n                smtpFromEmail: existingEmail.smtpFromEmail || '',\n                smtpFromName: existingEmail.smtpFromName || '',\n                imap: existingEmail.imap || {\n                    enabled: false,\n                    host: '',\n                    port: 993,\n                    secure: true,\n                    user: '',\n                    password: '',\n                    folder: 'INBOX',\n                    processedFolder: ''\n                }\n            },\n            messageTemplates: existingMessageTemplates || {\n                checkInInvitation: {\n                    en: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' },\n                    es: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' },\n                    de: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' }\n                },\n                checkInConfirmation: {\n                    en: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' },\n                    es: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' },\n                    de: { whatsappTemplateName: '', whatsappTemplateParams: [], emailSubject: '', emailContent: '' }\n                }\n            },\n            autoSendReservationInvitation: existingAutoSend\n        });\n        setIsModalOpen(true);\n    };\n\n    // Modal schlieen\n    const handleCloseModal = () => {\n        setIsModalOpen(false);\n        resetForm();\n    };\n\n    // Formular absenden\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        \n        if (!formData.name.trim()) {\n            handleErrorContext({ message: t('branches.nameRequired') });\n            return;\n        }\n\n        try {\n            if (editingBranch) {\n                // Branch aktualisieren\n                await axiosInstance.put(API_ENDPOINTS.BRANCHES.UPDATE(editingBranch.id), {\n                    name: formData.name.trim(),\n                    address: formData.address.trim() || null,\n                    city: formData.city.trim() || null,\n                    country: formData.country.trim() || null,\n                    whatsappSettings: formData.whatsappSettings,\n                    lobbyPmsSettings: formData.lobbyPmsSettings,\n                    boldPaymentSettings: {\n                        apiKey: formData.boldPaymentSettings.apiKey,\n                        merchantId: formData.boldPaymentSettings.merchantId,\n                        environment: formData.boldPaymentSettings.environment\n                    },\n                    doorSystemSettings: formData.doorSystemSettings,\n                    emailSettings: formData.emailSettings,\n                    messageTemplates: formData.messageTemplates,\n                    autoSendReservationInvitation: formData.autoSendReservationInvitation\n                });\n            } else {\n                // Neue Branch erstellen\n                await axiosInstance.post(API_ENDPOINTS.BRANCHES.CREATE, {\n                    name: formData.name.trim()\n                });\n            }\n            \n            await fetchBranches();\n            handleCloseModal();\n        } catch (error: any) {\n            console.error('Fehler beim Speichern der Niederlassung:', error);\n            handleErrorContext(error);\n        }\n    };\n\n    // Branch lschen\n    const handleDelete = async (branchId: number) => {\n        if (!window.confirm(t('branches.deleteConfirm', { defaultValue: 'Mchten Sie diese Niederlassung wirklich lschen?' }))) {\n            return;\n        }\n\n        try {\n            await axiosInstance.delete(API_ENDPOINTS.BRANCHES.DELETE(branchId));\n            await fetchBranches();\n        } catch (error: any) {\n            console.error('Fehler beim Lschen der Niederlassung:', error);\n            handleErrorContext(error);\n        }\n    };\n\n    // Funktion zum Zhlen der aktiven Filter\n    const getActiveFilterCount = () => {\n        return filterConditions.length;\n    };\n\n    // Filtern und sortieren der Branches\n    const filteredAndSortedBranches = useMemo(() => {\n        return branches\n            .filter(branch => {\n                // Globale Suche\n                if (searchTerm) {\n                    const searchLower = searchTerm.toLowerCase();\n                    const matchesSearch = branch.name.toLowerCase().includes(searchLower);\n                    \n                    if (!matchesSearch) return false;\n                }\n                \n                // Prfe erweiterte Filterbedingungen, wenn vorhanden\n                if (filterConditions.length > 0) {\n                    let result = filterConditions.length > 0;\n                    \n                    for (let i = 0; i < filterConditions.length; i++) {\n                        const condition = filterConditions[i];\n                        let conditionMet = false;\n                        \n                        switch (condition.column) {\n                            case 'name':\n                                //  OPTIMIERUNG: toLowerCase() nur einmal pro Wert\n                                const branchNameLower = branch.name.toLowerCase();\n                                const conditionValueLower = (condition.value as string || '').toLowerCase();\n                                if (condition.operator === 'equals') {\n                                    conditionMet = branchNameLower === conditionValueLower;\n                                } else if (condition.operator === 'contains') {\n                                    conditionMet = branchNameLower.includes(conditionValueLower);\n                                } else if (condition.operator === 'startsWith') {\n                                    conditionMet = branchNameLower.startsWith(conditionValueLower);\n                                }\n                                break;\n                        }\n                        \n                        // Verknpfe das Ergebnis dieser Bedingung mit dem Gesamtergebnis\n                        if (i === 0) {\n                            result = conditionMet;\n                        } else {\n                            const operator = filterLogicalOperators[i - 1];\n                            result = operator === 'AND' ? (result && conditionMet) : (result || conditionMet);\n                        }\n                    }\n                    \n                    if (!result) return false;\n                }\n                \n                return true;\n            })\n            .sort((a, b) => {\n                //  OPTIMIERUNG: toLowerCase() fr konsistente Sortierung\n                return a.name.toLowerCase().localeCompare(b.name.toLowerCase());\n            });\n    }, [branches, searchTerm, filterConditions, filterLogicalOperators]);\n\n    // Funktion zum Anwenden von Filterbedingungen\n    const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n        setFilterConditions(conditions);\n        setFilterLogicalOperators(operators);\n    };\n    \n    // Funktion zum Zurcksetzen der Filter\n    const resetFilterConditions = () => {\n        setFilterConditions([]);\n        setFilterLogicalOperators([]);\n        setActiveFilterName('');\n        setSelectedFilterId(null);\n    };\n    \n    // Filter Change Handler (Controlled Mode)\n    const handleFilterChange = async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n        setActiveFilterName(name);\n        setSelectedFilterId(id);\n        applyFilterConditions(conditions, operators);\n    };\n    \n    //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n    const filterContext = useFilterContext();\n    const { loadFilters } = filterContext;\n    \n    useEffect(() => {\n        const initialize = async () => {\n            // 1. Filter laden (wartet auf State-Update)\n            const filters = await loadFilters(BRANCHES_TABLE_ID);\n            \n            // 2. Default-Filter anwenden (IMMER vorhanden!)\n            const defaultFilter = filters.find(f => f.name === 'Alle');\n            if (defaultFilter) {\n                await handleFilterChange(\n                    defaultFilter.name,\n                    defaultFilter.id,\n                    defaultFilter.conditions,\n                    defaultFilter.operators\n                );\n                return; // Filter wird angewendet\n            }\n            \n            // 3. Fallback: Kein Filter (sollte nie passieren)\n            // BranchManagementTab filtert client-seitig, daher keine Daten-Lade-Funktion ntig\n        };\n        \n        initialize();\n    }, [loadFilters, handleFilterChange]);\n\n    // Standard-Filter erstellen und speichern\n    useEffect(() => {\n        const createStandardFilters = async () => {\n            try {\n                const token = localStorage.getItem('token');\n                \n                if (!token) {\n                    console.error(t('common.notAuthenticated'));\n                    return;\n                }\n\n                // Prfen, ob die Standard-Filter bereits existieren\n                const existingFiltersResponse = await axiosInstance.get(\n                    API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(BRANCHES_TABLE_ID)\n                );\n\n                const existingFilters = existingFiltersResponse.data || [];\n                const alleFilterExists = existingFilters.some((filter: any) => filter.name === 'Alle');\n\n                // Erstelle \"Alle\"-Filter, wenn er noch nicht existiert\n                if (!alleFilterExists) {\n                    const alleFilter = {\n                        tableId: BRANCHES_TABLE_ID,\n                        name: 'Alle',\n                        conditions: [],\n                        operators: []\n                    };\n\n                    await axiosInstance.post(\n                        API_ENDPOINTS.SAVED_FILTERS.BASE,\n                        alleFilter\n                    );\n                    if (process.env.NODE_ENV === 'development') {\n                    logger.log(t('branches.filterCreated'));\n                    }\n                }\n            } catch (error) {\n                console.error(t('branches.createStandardFiltersError'), error);\n            }\n        };\n\n        createStandardFilters();\n    }, []);\n\n\n    // Branches rendern\n    const renderBranches = () => {\n        if (filteredAndSortedBranches.length === 0) {\n            return (\n                <div className=\"p-4 bg-gray-50 dark:bg-gray-700 rounded text-center\">\n                    <p className=\"text-gray-600 dark:text-gray-400\">\n                        {t('branches.noBranches', { defaultValue: 'Keine Niederlassungen gefunden. Erstellen Sie eine neue Niederlassung mit dem Button oben.' })}\n                    </p>\n                </div>\n            );\n        }\n        \n        // Card-Ansicht\n        return (\n            <>\n                <div className=\"space-y-4\">\n                    {filteredAndSortedBranches.slice(0, displayLimit).map((branch) => (\n                        <BranchCard \n                            key={branch.id} \n                            branch={branch} \n                            onEdit={handleEdit}\n                            onDelete={handleDelete}\n                            canEdit={canEdit}\n                            canDelete={canDelete}\n                        />\n                    ))}\n                </div>\n                \n                {/* \"Mehr anzeigen\" Button */}\n                {filteredAndSortedBranches.length > displayLimit && (\n                    <div className=\"mt-4 flex justify-center\">\n                        <button\n                            className=\"px-4 py-2 text-sm font-medium text-blue-600 bg-white border border-blue-300 rounded-md hover:bg-blue-50 dark:bg-gray-800 dark:text-blue-400 dark:border-gray-700 dark:hover:bg-gray-700\"\n                            onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                        >\n                            {t('common.showMore', { defaultValue: 'Mehr anzeigen' })} ({filteredAndSortedBranches.length - displayLimit} {t('common.remaining', { defaultValue: 'verbleibend' })})\n                        </button>\n                    </div>\n                )}\n            </>\n        );\n    };\n\n    // Mobile-Erkennung\n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    \n    useEffect(() => {\n        const handleResize = () => {\n            setIsMobile(window.innerWidth < 640);\n        };\n        window.addEventListener('resize', handleResize);\n        return () => window.removeEventListener('resize', handleResize);\n    }, []);\n\n    return (\n        <div>\n            {/* Spaltenanzeige und Suche */}\n            <div className=\"space-y-4\">\n                <div className=\"flex items-center justify-between mb-4\">\n                    {/* Linke Seite: \"Neue Niederlassung erstellen\"-Button */}\n                    <div className=\"flex items-center\">\n                        {canCreate && (\n                            <div className=\"relative group\">\n                                <button\n                                    onClick={handleCreate}\n                                    className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n                                    style={{ width: '30.19px', height: '30.19px' }}\n                                    aria-label={t('branches.create', { defaultValue: 'Neue Niederlassung' })}\n                                >\n                                    <PlusIcon className=\"h-4 w-4\" />\n                                </button>\n                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                    {t('branches.create', { defaultValue: 'Neue Niederlassung' })}\n                                </div>\n                            </div>\n                        )}\n                    </div>\n                    \n                    {/* Mitte: Titel - Kein Titel in der Mitte notwendig bei dieser Komponente, da der Tab-Header bereits den Titel zeigt */}\n                    <div></div>\n                    \n                    {/* Rechte Seite: Suchfeld, Filter-Button */}\n                    <div className=\"flex items-center gap-1.5\">\n                        <input\n                            type=\"text\"\n                            placeholder={t('common.search', { defaultValue: 'Suchen...' })}\n                            className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n                            value={searchTerm}\n                            onChange={(e) => setSearchTerm(e.target.value)}\n                        />\n                        <div className=\"relative group ml-1\">\n                            <button\n                                className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 text-blue-600' : 'hover:bg-gray-100'} relative`}\n                                onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\n                            >\n                                <FunnelIcon className=\"w-5 h-5\" />\n                                {getActiveFilterCount() > 0 && (\n                                    <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\n                                        {getActiveFilterCount()}\n                                    </span>\n                                )}\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('common.filter', { defaultValue: 'Filter' })}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                {/* Filter-Modal */}\n                {isFilterModalOpen && (\n                    <FilterPane\n                        columns={[\n                            { id: 'name', label: t('branches.name', { defaultValue: 'Name' }) }\n                        ]}\n                        onApply={applyFilterConditions}\n                        onReset={resetFilterConditions}\n                        savedConditions={filterConditions}\n                        savedOperators={filterLogicalOperators}\n                        tableId={BRANCHES_TABLE_ID}\n                    />\n                )}\n                \n                {/* Gespeicherte Filter als Tags anzeigen */}\n                <SavedFilterTags\n                    tableId={BRANCHES_TABLE_ID}\n                    onSelectFilter={applyFilterConditions}\n                    onReset={resetFilterConditions}\n                    activeFilterName={activeFilterName}\n                    selectedFilterId={selectedFilterId}\n                    onFilterChange={handleFilterChange}\n                    defaultFilterName=\"Alle\"\n                />\n\n                {loading ? (\n                    <div className=\"flex justify-center items-center py-8\">\n                        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\n                    </div>\n                ) : (\n                    renderBranches()\n                )}\n            </div>\n\n            {/* Modal/Sidepane fr Branch-Erstellung/Bearbeitung */}\n            {isModalOpen && (\n                <>\n                    {/* Mobile (unter 640px) - Modal */}\n                    {isMobile ? (\n                        <Dialog open={isModalOpen} onClose={handleCloseModal} className=\"relative z-50\">\n                            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                            \n                            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                                <Dialog.Panel className=\"mx-auto max-w-sm w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                                    {/* Header */}\n                                    <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\n                                        <div className=\"flex items-center justify-between\">\n                                            <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                                                {editingBranch \n                                                    ? t('branches.edit', { defaultValue: 'Niederlassung bearbeiten' })\n                                                    : t('branches.create', { defaultValue: 'Neue Niederlassung' })\n                                                }\n                                            </Dialog.Title>\n                                            <button\n                                                onClick={handleCloseModal}\n                                                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                            >\n                                                <XMarkIcon className=\"h-6 w-6\" />\n                                            </button>\n                                        </div>\n                                    </div>\n                                    \n                                    {/* Form */}\n                                    <form onSubmit={handleSubmit} className=\"p-6 space-y-4\">\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.name', { defaultValue: 'Name' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.name}\n                                                onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                required\n                                                autoFocus\n                                            />\n                                        </div>\n\n                                        {/* Adress-Felder */}\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.address', { defaultValue: 'Adresse' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.address}\n                                                onChange={(e) => setFormData({ ...formData, address: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.addressPlaceholder', { defaultValue: 'Strae und Hausnummer' })}\n                                            />\n                                        </div>\n\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.city', { defaultValue: 'Stadt' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.city}\n                                                onChange={(e) => setFormData({ ...formData, city: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.cityPlaceholder', { defaultValue: 'z.B. Medelln' })}\n                                            />\n                                        </div>\n\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.country', { defaultValue: 'Land' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.country}\n                                                onChange={(e) => setFormData({ ...formData, country: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.countryPlaceholder', { defaultValue: 'z.B. Kolumbien' })}\n                                            />\n                                        </div>\n\n                                        {/* Settings Tabs - nur beim Bearbeiten */}\n                                        {editingBranch && (\n                                            <>\n                                                {/* Tab Navigation */}\n                                                <div className=\"border-b border-gray-200 dark:border-gray-700 mb-4\">\n                                                    <nav className=\"-mb-px flex space-x-2 overflow-x-auto\">\n                                                        {['whatsapp', 'lobbypms', 'boldpayment', 'doorsystem', 'email', 'messages'].map((tab) => (\n                                                            <button\n                                                                key={tab}\n                                                                type=\"button\"\n                                                                onClick={() => setActiveSettingsTab(tab as any)}\n                                                                className={`py-2 px-2 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap ${\n                                                                    activeSettingsTab === tab\n                                                                        ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                                                }`}\n                                                            >\n                                                                {tab === 'whatsapp' ? 'WhatsApp' : tab === 'lobbypms' ? 'LobbyPMS' : tab === 'boldpayment' ? 'Bold Payment' : tab === 'doorsystem' ? 'TTLock' : tab === 'email' ? 'Email' : t('branches.messagesTab', { defaultValue: 'Nachrichten' })}\n                                                            </button>\n                                                        ))}\n                                                    </nav>\n                                                </div>\n\n                                                {/* Tab Content */}\n                                                <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\">\n                                                    {/* WhatsApp Settings Tab */}\n                                                    {activeSettingsTab === 'whatsapp' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                WhatsApp Settings\n                                                            </h4>\n                                                \n                                                <div className=\"space-y-4\">\n                                                    <div>\n                                                        <label htmlFor=\"whatsappProvider\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            Provider\n                                                        </label>\n                                                        <select\n                                                            id=\"whatsappProvider\"\n                                                            value={formData.whatsappSettings.provider}\n                                                            onChange={(e) => setFormData({\n                                                                ...formData,\n                                                                whatsappSettings: {\n                                                                    ...formData.whatsappSettings,\n                                                                    provider: e.target.value as 'twilio' | 'whatsapp-business-api'\n                                                                }\n                                                            })}\n                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                        >\n                                                            <option value=\"twilio\">Twilio</option>\n                                                            <option value=\"whatsapp-business-api\">WhatsApp Business API</option>\n                                                        </select>\n                                                    </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappApiKey\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            API Key / Access Token\n                                                        </label>\n                                                        <div className=\"relative\">\n                                                            <input\n                                                                type={showSecrets['whatsappApiKey'] ? 'text' : 'password'}\n                                                                id=\"whatsappApiKey\"\n                                                                value={formData.whatsappSettings.apiKey}\n                                                                onChange={(e) => setFormData({\n                                                                    ...formData,\n                                                                    whatsappSettings: {\n                                                                        ...formData.whatsappSettings,\n                                                                        apiKey: e.target.value\n                                                                    }\n                                                                })}\n                                                                placeholder=\"API Key / Access Token\"\n                                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                            />\n                                                            <button\n                                                                type=\"button\"\n                                                                onClick={() => setShowSecrets(prev => ({ ...prev, whatsappApiKey: !prev.whatsappApiKey }))}\n                                                                className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                            >\n                                                                {showSecrets['whatsappApiKey'] ? (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                    </svg>\n                                                                ) : (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                    </svg>\n                                                                )}\n                                                            </button>\n                                                        </div>\n                                                    </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappPhoneNumberId\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            Phone Number ID\n                                                        </label>\n                                                        <input\n                                                            type=\"text\"\n                                                            id=\"whatsappPhoneNumberId\"\n                                                            value={formData.whatsappSettings.phoneNumberId}\n                                                            onChange={(e) => setFormData({\n                                                                ...formData,\n                                                                whatsappSettings: {\n                                                                    ...formData.whatsappSettings,\n                                                                    phoneNumberId: e.target.value\n                                                                }\n                                                            })}\n                                                            placeholder=\"Phone Number ID\"\n                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                        />\n                                                    </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappApiSecret\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            API Secret\n                                                        </label>\n                                                        <div className=\"relative\">\n                                                            <input\n                                                                type={showSecrets['whatsappApiSecret'] ? 'text' : 'password'}\n                                                                id=\"whatsappApiSecret\"\n                                                                value={formData.whatsappSettings.apiSecret}\n                                                                onChange={(e) => setFormData({\n                                                                    ...formData,\n                                                                    whatsappSettings: {\n                                                                        ...formData.whatsappSettings,\n                                                                        apiSecret: e.target.value\n                                                                    }\n                                                                })}\n                                                                placeholder=\"API Secret\"\n                                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                            />\n                                                            <button\n                                                                type=\"button\"\n                                                                onClick={() => setShowSecrets(prev => ({ ...prev, whatsappApiSecret: !prev.whatsappApiSecret }))}\n                                                                className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                            >\n                                                                {showSecrets['whatsappApiSecret'] ? (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                    </svg>\n                                                                ) : (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                    </svg>\n                                                                )}\n                                                            </button>\n                                                        </div>\n                                                    </div>\n\n                                                    {/* AI Configuration */}\n                                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4\">\n                                                        <div className=\"flex items-center justify-between mb-4\">\n                                                            <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                                                                KI-Konfiguration (AI)\n                                                            </h5>\n                                                            <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                <input\n                                                                    type=\"checkbox\"\n                                                                    checked={formData.whatsappSettings.ai.enabled}\n                                                                    onChange={(e) => setFormData({\n                                                                        ...formData,\n                                                                        whatsappSettings: {\n                                                                            ...formData.whatsappSettings,\n                                                                            ai: {\n                                                                                ...formData.whatsappSettings.ai,\n                                                                                enabled: e.target.checked\n                                                                            }\n                                                                        }\n                                                                    })}\n                                                                    className=\"sr-only peer\"\n                                                                />\n                                                                <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                    {formData.whatsappSettings.ai.enabled ? 'Aktiviert' : 'Deaktiviert'}\n                                                                </span>\n                                                            </label>\n                                                        </div>\n\n                                                        {formData.whatsappSettings.ai.enabled && (\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label htmlFor=\"aiModel\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Modell\n                                                                    </label>\n                                                                    <select\n                                                                        id=\"aiModel\"\n                                                                        value={formData.whatsappSettings.ai.model}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    model: e.target.value\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    >\n                                                                        <option value=\"gpt-4o\">GPT-4o</option>\n                                                                        <option value=\"gpt-4\">GPT-4</option>\n                                                                        <option value=\"gpt-3.5-turbo\">GPT-3.5 Turbo</option>\n                                                                    </select>\n                                                                </div>\n\n                                                                <div>\n                                                                    <label htmlFor=\"aiSystemPrompt\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        System Prompt\n                                                                    </label>\n                                                                    <textarea\n                                                                        id=\"aiSystemPrompt\"\n                                                                        value={formData.whatsappSettings.ai.systemPrompt}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    systemPrompt: e.target.value\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={4}\n                                                                        placeholder=\"Du bist ein hilfreicher Assistent fr...\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Regeln (eine pro Zeile)\n                                                                    </label>\n                                                                    <textarea\n                                                                        value={formData.whatsappSettings.ai.rules.join('\\n')}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    rules: e.target.value.split('\\n').filter(r => r.trim())\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={3}\n                                                                        placeholder=\"Antworte immer auf Spanisch&#10;Sei freundlich und professionell\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Quellen/URLs (eine pro Zeile)\n                                                                    </label>\n                                                                    <textarea\n                                                                        value={formData.whatsappSettings.ai.sources.join('\\n')}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    sources: e.target.value.split('\\n').filter(s => s.trim())\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={2}\n                                                                        placeholder=\"https://wiki.example.com/manila-procedures&#10;https://wiki.example.com/faq\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div className=\"grid grid-cols-2 gap-4\">\n                                                                    <div>\n                                                                        <label htmlFor=\"aiTemperature\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                            Temperature ({formData.whatsappSettings.ai.temperature})\n                                                                        </label>\n                                                                        <input\n                                                                            type=\"range\"\n                                                                            id=\"aiTemperature\"\n                                                                            min=\"0\"\n                                                                            max=\"2\"\n                                                                            step=\"0.1\"\n                                                                            value={formData.whatsappSettings.ai.temperature}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                whatsappSettings: {\n                                                                                    ...formData.whatsappSettings,\n                                                                                    ai: {\n                                                                                        ...formData.whatsappSettings.ai,\n                                                                                        temperature: parseFloat(e.target.value)\n                                                                                    }\n                                                                                }\n                                                                            })}\n                                                                            className=\"mt-1 block w-full\"\n                                                                        />\n                                                                    </div>\n\n                                                                    <div>\n                                                                        <label htmlFor=\"aiMaxTokens\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                            Max Tokens\n                                                                        </label>\n                                                                        <input\n                                                                            type=\"number\"\n                                                                            id=\"aiMaxTokens\"\n                                                                            min=\"100\"\n                                                                            max=\"4000\"\n                                                                            step=\"100\"\n                                                                            value={formData.whatsappSettings.ai.maxTokens}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                whatsappSettings: {\n                                                                                    ...formData.whatsappSettings,\n                                                                                    ai: {\n                                                                                        ...formData.whatsappSettings.ai,\n                                                                                        maxTokens: parseInt(e.target.value) || 500\n                                                                                    }\n                                                                                }\n                                                                            })}\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                        />\n                                                                    </div>\n                                                                </div>\n                                                            </div>\n                                                        )}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                                    {/* LobbyPMS Settings Tab */}\n                                                    {activeSettingsTab === 'lobbypms' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                LobbyPMS Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API URL\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.lobbyPmsSettings.apiUrl}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, apiUrl: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"https://api.lobbypms.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API Key\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['lobbyPmsApiKey'] ? 'text' : 'password'}\n                                                                        value={formData.lobbyPmsSettings.apiKey}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, apiKey: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"API Key\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Property ID\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.lobbyPmsSettings.propertyId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, propertyId: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Property ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                            </div>\n                                                            \n                                                            {/* Zimmer-Beschreibungen Sektion */}\n                                                            {editingBranch && (\n                                                                <RoomDescriptionsSection branchId={editingBranch.id} />\n                                                            )}\n                                                        </div>\n                                                    )}\n\n                                                    {/* Bold Payment Settings Tab */}\n                                                    {activeSettingsTab === 'boldpayment' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                Bold Payment Settings\n                                                            </h4>\n                                                            {formData.boldPaymentSettings._hasEncryptedValues && (\n                                                                <div className=\"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md\">\n                                                                    <p className=\"text-sm text-yellow-800 dark:text-yellow-200\">\n                                                                        <strong>Hinweis:</strong> Es sind verschlsselte Werte vorhanden, die mit einem alten Schlssel verschlsselt wurden und nicht mehr entschlsselt werden knnen. \n                                                                        Die Payment-Links funktionieren weiterhin. Um die Werte zu ndern, geben Sie sie neu ein.\n                                                                    </p>\n                                                                </div>\n                                                            )}\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API Key\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['boldPaymentApiKey'] ? 'text' : 'password'}\n                                                                        value={formData.boldPaymentSettings.apiKey}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, apiKey: e.target.value, _hasEncryptedValues: false }\n                                                                        })}\n                                                                        placeholder=\"API Key\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Merchant ID\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['boldPaymentMerchantId'] ? 'text' : 'password'}\n                                                                        value={formData.boldPaymentSettings.merchantId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, merchantId: e.target.value, _hasEncryptedValues: false }\n                                                                        })}\n                                                                        placeholder=\"Merchant ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Environment\n                                                                    </label>\n                                                                    <select\n                                                                        value={formData.boldPaymentSettings.environment}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, environment: e.target.value as 'sandbox' | 'production' }\n                                                                        })}\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    >\n                                                                        <option value=\"sandbox\">Sandbox</option>\n                                                                        <option value=\"production\">Production</option>\n                                                                    </select>\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n\n                                                    {/* TTLock Settings Tab */}\n                                                    {activeSettingsTab === 'doorsystem' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                TTLock Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Client ID\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.doorSystemSettings.clientId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, clientId: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Client ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Client Secret\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['doorSystemClientSecret'] ? 'text' : 'password'}\n                                                                        value={formData.doorSystemSettings.clientSecret}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, clientSecret: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Client Secret\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Username\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.doorSystemSettings.username}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, username: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Username\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Password\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['doorSystemPassword'] ? 'text' : 'password'}\n                                                                        value={formData.doorSystemSettings.password}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, password: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Password\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n\n                                                    {/* Email Settings Tab */}\n                                                    {activeSettingsTab === 'email' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                Email Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Host\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpHost}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpHost: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"smtp.example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Port\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"number\"\n                                                                        value={formData.emailSettings.smtpPort}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpPort: parseInt(e.target.value) || 587 }\n                                                                        })}\n                                                                        placeholder=\"587\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP User\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpUser}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpUser: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"user@example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Password\n                                                                    </label>\n                                                                    <div className=\"relative\">\n                                                                        <input\n                                                                            type={showSecrets['emailSmtpPass'] ? 'text' : 'password'}\n                                                                            value={formData.emailSettings.smtpPass}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                emailSettings: { ...formData.emailSettings, smtpPass: e.target.value }\n                                                                            })}\n                                                                            placeholder=\"Password\"\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                                        />\n                                                                        <button\n                                                                            type=\"button\"\n                                                                            onClick={() => setShowSecrets({ ...showSecrets, emailSmtpPass: !showSecrets['emailSmtpPass'] })}\n                                                                            className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                        >\n                                                                            {showSecrets['emailSmtpPass'] ? (\n                                                                                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                                </svg>\n                                                                            ) : (\n                                                                                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                                </svg>\n                                                                            )}\n                                                                        </button>\n                                                                    </div>\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP From Email\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"email\"\n                                                                        value={formData.emailSettings.smtpFromEmail}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpFromEmail: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"noreply@example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP From Name\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpFromName}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpFromName: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Branch Name\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                {/* IMAP Settings Section */}\n                                                                <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4\">\n                                                                    <div className=\"flex items-center justify-between mb-4\">\n                                                                        <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                                                                            IMAP Settings (Email Reading)\n                                                                        </h5>\n                                                                        <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                            <input\n                                                                                type=\"checkbox\"\n                                                                                checked={formData.emailSettings.imap.enabled}\n                                                                                onChange={(e) => setFormData({\n                                                                                    ...formData,\n                                                                                    emailSettings: {\n                                                                                        ...formData.emailSettings,\n                                                                                        imap: {\n                                                                                            ...formData.emailSettings.imap,\n                                                                                            enabled: e.target.checked\n                                                                                        }\n                                                                                    }\n                                                                                })}\n                                                                                className=\"sr-only peer\"\n                                                                            />\n                                                                            <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                            <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                                {formData.emailSettings.imap.enabled ? 'Enabled' : 'Disabled'}\n                                                                            </span>\n                                                                        </label>\n                                                                    </div>\n\n                                                                    {formData.emailSettings.imap.enabled && (\n                                                                        <div className=\"space-y-4\">\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Host\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.host}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, host: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"imap.example.com\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Port\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"number\"\n                                                                                    value={formData.emailSettings.imap.port}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, port: parseInt(e.target.value) || 993 }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"993\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                                    <input\n                                                                                        type=\"checkbox\"\n                                                                                        checked={formData.emailSettings.imap.secure}\n                                                                                        onChange={(e) => setFormData({\n                                                                                            ...formData,\n                                                                                            emailSettings: {\n                                                                                                ...formData.emailSettings,\n                                                                                                imap: { ...formData.emailSettings.imap, secure: e.target.checked }\n                                                                                            }\n                                                                                        })}\n                                                                                        className=\"sr-only peer\"\n                                                                                    />\n                                                                                    <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                                    <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                                        Secure (SSL/TLS)\n                                                                                    </span>\n                                                                                </label>\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP User\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.user}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, user: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"user@example.com\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Password\n                                                                                </label>\n                                                                                <div className=\"relative\">\n                                                                                    <input\n                                                                                        type={showSecrets['emailImapPass'] ? 'text' : 'password'}\n                                                                                        value={formData.emailSettings.imap.password}\n                                                                                        onChange={(e) => setFormData({\n                                                                                            ...formData,\n                                                                                            emailSettings: {\n                                                                                                ...formData.emailSettings,\n                                                                                                imap: { ...formData.emailSettings.imap, password: e.target.value }\n                                                                                            }\n                                                                                        })}\n                                                                                        placeholder=\"Password\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                                                    />\n                                                                                    <button\n                                                                                        type=\"button\"\n                                                                                        onClick={() => setShowSecrets({ ...showSecrets, emailImapPass: !showSecrets['emailImapPass'] })}\n                                                                                        className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                                    >\n                                                                                        {showSecrets['emailImapPass'] ? (\n                                                                                            <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                                            </svg>\n                                                                                        ) : (\n                                                                                            <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                                            </svg>\n                                                                                        )}\n                                                                                    </button>\n                                                                                </div>\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Folder\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.folder}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, folder: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"INBOX\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    Processed Folder (optional)\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.processedFolder}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, processedFolder: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"Processed\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                        </div>\n                                                                    )}\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n                                                </div>\n                                            </>\n                                        )}\n\n                                        {/* Buttons */}\n                                        <div className=\"flex justify-end pt-4 gap-2\">\n                                            <div className=\"relative group\">\n                                                <button\n                                                    type=\"button\"\n                                                    onClick={handleCloseModal}\n                                                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                                                >\n                                                    <XMarkIcon className=\"h-5 w-5\" />\n                                                </button>\n                                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                    {t('common.cancel', { defaultValue: 'Abbrechen' })}\n                                                </div>\n                                            </div>\n                                            <div className=\"relative group\">\n                                                <button\n                                                    type=\"submit\"\n                                                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors\"\n                                                >\n                                                    <CheckIcon className=\"h-5 w-5\" />\n                                                </button>\n                                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                    {editingBranch ? t('common.update', { defaultValue: 'Aktualisieren' }) : t('common.create', { defaultValue: 'Erstellen' })}\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </form>\n                                </Dialog.Panel>\n                            </div>\n                        </Dialog>\n                    ) : (\n                        // Desktop - Sidepane (dynamische Breite basierend auf Tab-Anzahl)\n                        <div className=\"fixed inset-y-0 right-0 w-full sm:min-w-[500px] sm:max-w-[600px] bg-white dark:bg-gray-800 shadow-xl z-50 flex flex-col\">\n                            {/* Header */}\n                            <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\n                                <div className=\"flex items-center justify-between\">\n                                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                                        {editingBranch \n                                            ? t('branches.edit', { defaultValue: 'Niederlassung bearbeiten' })\n                                            : t('branches.create', { defaultValue: 'Neue Niederlassung' })\n                                        }\n                                    </h2>\n                                    <button\n                                        onClick={handleCloseModal}\n                                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                    >\n                                        <XMarkIcon className=\"h-6 w-6\" />\n                                    </button>\n                                </div>\n                            </div>\n                            \n                            {/* Form */}\n                            <form onSubmit={handleSubmit} className=\"flex flex-col flex-1 min-h-0\">\n                                <div className=\"flex-1 overflow-y-auto min-h-0\">\n                                    <div className=\"p-6 space-y-4\">\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.name', { defaultValue: 'Name' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.name}\n                                                onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                required\n                                                autoFocus\n                                            />\n                                        </div>\n\n                                        {/* Adress-Felder */}\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.address', { defaultValue: 'Adresse' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.address}\n                                                onChange={(e) => setFormData({ ...formData, address: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.addressPlaceholder', { defaultValue: 'Strae und Hausnummer' })}\n                                            />\n                                        </div>\n\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.city', { defaultValue: 'Stadt' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.city}\n                                                onChange={(e) => setFormData({ ...formData, city: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.cityPlaceholder', { defaultValue: 'z.B. Medelln' })}\n                                            />\n                                        </div>\n\n                                        <div>\n                                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                {t('branches.country', { defaultValue: 'Land' })}\n                                            </label>\n                                            <input\n                                                type=\"text\"\n                                                value={formData.country}\n                                                onChange={(e) => setFormData({ ...formData, country: e.target.value })}\n                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                placeholder={t('branches.countryPlaceholder', { defaultValue: 'z.B. Kolumbien' })}\n                                            />\n                                        </div>\n\n                                        {/* Settings Tabs - nur beim Bearbeiten */}\n                                        {editingBranch && (\n                                            <>\n                                                {/* Tab Navigation */}\n                                                <div className=\"border-b border-gray-200 dark:border-gray-700 mb-4\">\n                                                    <nav className=\"-mb-px flex space-x-2 overflow-x-auto\">\n                                                        {['whatsapp', 'lobbypms', 'boldpayment', 'doorsystem', 'email', 'messages'].map((tab) => (\n                                                            <button\n                                                                key={tab}\n                                                                type=\"button\"\n                                                                onClick={() => setActiveSettingsTab(tab as any)}\n                                                                className={`py-2 px-2 border-b-2 font-medium text-xs sm:text-sm whitespace-nowrap ${\n                                                                    activeSettingsTab === tab\n                                                                        ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                                                }`}\n                                                            >\n                                                                {tab === 'whatsapp' ? 'WhatsApp' : tab === 'lobbypms' ? 'LobbyPMS' : tab === 'boldpayment' ? 'Bold Payment' : tab === 'doorsystem' ? 'TTLock' : tab === 'email' ? 'Email' : t('branches.messagesTab', { defaultValue: 'Nachrichten' })}\n                                                            </button>\n                                                        ))}\n                                                    </nav>\n                                                </div>\n\n                                                {/* Tab Content */}\n                                                <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg p-4\">\n                                                    {/* WhatsApp Settings Tab */}\n                                                    {activeSettingsTab === 'whatsapp' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                WhatsApp Settings\n                                                            </h4>\n                                                            \n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label htmlFor=\"whatsappProviderDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Provider\n                                                                    </label>\n                                                                    <select\n                                                                        id=\"whatsappProviderDesktop\"\n                                                                        value={formData.whatsappSettings.provider}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                provider: e.target.value as 'twilio' | 'whatsapp-business-api'\n                                                                            }\n                                                                        })}\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    >\n                                                                        <option value=\"twilio\">Twilio</option>\n                                                                        <option value=\"whatsapp-business-api\">WhatsApp Business API</option>\n                                                                    </select>\n                                                                </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappApiKey\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            API Key / Access Token\n                                                        </label>\n                                                        <div className=\"relative\">\n                                                            <input\n                                                                type={showSecrets['whatsappApiKey'] ? 'text' : 'password'}\n                                                                id=\"whatsappApiKey\"\n                                                                value={formData.whatsappSettings.apiKey}\n                                                                onChange={(e) => setFormData({\n                                                                    ...formData,\n                                                                    whatsappSettings: {\n                                                                        ...formData.whatsappSettings,\n                                                                        apiKey: e.target.value\n                                                                    }\n                                                                })}\n                                                                placeholder=\"API Key / Access Token\"\n                                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                            />\n                                                            <button\n                                                                type=\"button\"\n                                                                onClick={() => setShowSecrets(prev => ({ ...prev, whatsappApiKey: !prev.whatsappApiKey }))}\n                                                                className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                            >\n                                                                {showSecrets['whatsappApiKey'] ? (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                    </svg>\n                                                                ) : (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                    </svg>\n                                                                )}\n                                                            </button>\n                                                        </div>\n                                                    </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappPhoneNumberId\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            Phone Number ID\n                                                        </label>\n                                                        <input\n                                                            type=\"text\"\n                                                            id=\"whatsappPhoneNumberId\"\n                                                            value={formData.whatsappSettings.phoneNumberId}\n                                                            onChange={(e) => setFormData({\n                                                                ...formData,\n                                                                whatsappSettings: {\n                                                                    ...formData.whatsappSettings,\n                                                                    phoneNumberId: e.target.value\n                                                                }\n                                                            })}\n                                                            placeholder=\"Phone Number ID\"\n                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                        />\n                                                    </div>\n\n                                                    <div>\n                                                        <label htmlFor=\"whatsappApiSecretDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                            API Secret\n                                                        </label>\n                                                        <div className=\"relative\">\n                                                            <input\n                                                                type={showSecrets['whatsappApiSecret'] ? 'text' : 'password'}\n                                                                id=\"whatsappApiSecretDesktop\"\n                                                                value={formData.whatsappSettings.apiSecret}\n                                                                onChange={(e) => setFormData({\n                                                                    ...formData,\n                                                                    whatsappSettings: {\n                                                                        ...formData.whatsappSettings,\n                                                                        apiSecret: e.target.value\n                                                                    }\n                                                                })}\n                                                                placeholder=\"API Secret\"\n                                                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                            />\n                                                            <button\n                                                                type=\"button\"\n                                                                onClick={() => setShowSecrets(prev => ({ ...prev, whatsappApiSecret: !prev.whatsappApiSecret }))}\n                                                                className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                            >\n                                                                {showSecrets['whatsappApiSecret'] ? (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                    </svg>\n                                                                ) : (\n                                                                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                    </svg>\n                                                                )}\n                                                            </button>\n                                                        </div>\n                                                    </div>\n\n                                                    {/* AI Configuration */}\n                                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4\">\n                                                        <div className=\"flex items-center justify-between mb-4\">\n                                                            <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                                                                KI-Konfiguration (AI)\n                                                            </h5>\n                                                            <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                <input\n                                                                    type=\"checkbox\"\n                                                                    checked={formData.whatsappSettings.ai.enabled}\n                                                                    onChange={(e) => setFormData({\n                                                                        ...formData,\n                                                                        whatsappSettings: {\n                                                                            ...formData.whatsappSettings,\n                                                                            ai: {\n                                                                                ...formData.whatsappSettings.ai,\n                                                                                enabled: e.target.checked\n                                                                            }\n                                                                        }\n                                                                    })}\n                                                                    className=\"sr-only peer\"\n                                                                />\n                                                                <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                    {formData.whatsappSettings.ai.enabled ? 'Aktiviert' : 'Deaktiviert'}\n                                                                </span>\n                                                            </label>\n                                                        </div>\n\n                                                        {formData.whatsappSettings.ai.enabled && (\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label htmlFor=\"aiModelDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Modell\n                                                                    </label>\n                                                                    <select\n                                                                        id=\"aiModelDesktop\"\n                                                                        value={formData.whatsappSettings.ai.model}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    model: e.target.value\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    >\n                                                                        <option value=\"gpt-4o\">GPT-4o</option>\n                                                                        <option value=\"gpt-4\">GPT-4</option>\n                                                                        <option value=\"gpt-3.5-turbo\">GPT-3.5 Turbo</option>\n                                                                    </select>\n                                                                </div>\n\n                                                                <div>\n                                                                    <label htmlFor=\"aiSystemPromptDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        System Prompt\n                                                                    </label>\n                                                                    <textarea\n                                                                        id=\"aiSystemPromptDesktop\"\n                                                                        value={formData.whatsappSettings.ai.systemPrompt}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    systemPrompt: e.target.value\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={4}\n                                                                        placeholder=\"Du bist ein hilfreicher Assistent fr...\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Regeln (eine pro Zeile)\n                                                                    </label>\n                                                                    <textarea\n                                                                        value={formData.whatsappSettings.ai.rules.join('\\n')}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    rules: e.target.value.split('\\n').filter(r => r.trim())\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={3}\n                                                                        placeholder=\"Antworte immer auf Spanisch&#10;Sei freundlich und professionell\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Quellen/URLs (eine pro Zeile)\n                                                                    </label>\n                                                                    <textarea\n                                                                        value={formData.whatsappSettings.ai.sources.join('\\n')}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            whatsappSettings: {\n                                                                                ...formData.whatsappSettings,\n                                                                                ai: {\n                                                                                    ...formData.whatsappSettings.ai,\n                                                                                    sources: e.target.value.split('\\n').filter(s => s.trim())\n                                                                                }\n                                                                            }\n                                                                        })}\n                                                                        rows={2}\n                                                                        placeholder=\"https://wiki.example.com/manila-procedures&#10;https://wiki.example.com/faq\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                <div className=\"grid grid-cols-2 gap-4\">\n                                                                    <div>\n                                                                        <label htmlFor=\"aiTemperatureDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                            Temperature ({formData.whatsappSettings.ai.temperature})\n                                                                        </label>\n                                                                        <input\n                                                                            type=\"range\"\n                                                                            id=\"aiTemperatureDesktop\"\n                                                                            min=\"0\"\n                                                                            max=\"2\"\n                                                                            step=\"0.1\"\n                                                                            value={formData.whatsappSettings.ai.temperature}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                whatsappSettings: {\n                                                                                    ...formData.whatsappSettings,\n                                                                                    ai: {\n                                                                                        ...formData.whatsappSettings.ai,\n                                                                                        temperature: parseFloat(e.target.value)\n                                                                                    }\n                                                                                }\n                                                                            })}\n                                                                            className=\"mt-1 block w-full\"\n                                                                        />\n                                                                    </div>\n\n                                                                    <div>\n                                                                        <label htmlFor=\"aiMaxTokensDesktop\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                            Max Tokens\n                                                                        </label>\n                                                                        <input\n                                                                            type=\"number\"\n                                                                            id=\"aiMaxTokensDesktop\"\n                                                                            min=\"100\"\n                                                                            max=\"4000\"\n                                                                            step=\"100\"\n                                                                            value={formData.whatsappSettings.ai.maxTokens}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                whatsappSettings: {\n                                                                                    ...formData.whatsappSettings,\n                                                                                    ai: {\n                                                                                        ...formData.whatsappSettings.ai,\n                                                                                        maxTokens: parseInt(e.target.value) || 500\n                                                                                    }\n                                                                                }\n                                                                            })}\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                        />\n                                                                    </div>\n                                                                </div>\n                                                            </div>\n                                                        )}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                                    {/* LobbyPMS Settings Tab */}\n                                                    {activeSettingsTab === 'lobbypms' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                LobbyPMS Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API URL\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.lobbyPmsSettings.apiUrl}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, apiUrl: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"https://api.lobbypms.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API Key\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['lobbyPmsApiKey'] ? 'text' : 'password'}\n                                                                        value={formData.lobbyPmsSettings.apiKey}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, apiKey: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"API Key\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Property ID\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.lobbyPmsSettings.propertyId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            lobbyPmsSettings: { ...formData.lobbyPmsSettings, propertyId: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Property ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                            </div>\n                                                            \n                                                            {/* Zimmer-Beschreibungen Sektion */}\n                                                            {editingBranch && (\n                                                                <RoomDescriptionsSection branchId={editingBranch.id} />\n                                                            )}\n                                                        </div>\n                                                    )}\n\n                                                    {/* Bold Payment Settings Tab */}\n                                                    {activeSettingsTab === 'boldpayment' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                Bold Payment Settings\n                                                            </h4>\n                                                            {formData.boldPaymentSettings._hasEncryptedValues && (\n                                                                <div className=\"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md\">\n                                                                    <p className=\"text-sm text-yellow-800 dark:text-yellow-200\">\n                                                                        <strong>Hinweis:</strong> Es sind verschlsselte Werte vorhanden, die mit einem alten Schlssel verschlsselt wurden und nicht mehr entschlsselt werden knnen. \n                                                                        Die Payment-Links funktionieren weiterhin. Um die Werte zu ndern, geben Sie sie neu ein.\n                                                                    </p>\n                                                                </div>\n                                                            )}\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        API Key\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['boldPaymentApiKey'] ? 'text' : 'password'}\n                                                                        value={formData.boldPaymentSettings.apiKey}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, apiKey: e.target.value, _hasEncryptedValues: false }\n                                                                        })}\n                                                                        placeholder=\"API Key\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Merchant ID\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['boldPaymentMerchantId'] ? 'text' : 'password'}\n                                                                        value={formData.boldPaymentSettings.merchantId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, merchantId: e.target.value, _hasEncryptedValues: false }\n                                                                        })}\n                                                                        placeholder=\"Merchant ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Environment\n                                                                    </label>\n                                                                    <select\n                                                                        value={formData.boldPaymentSettings.environment}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            boldPaymentSettings: { ...formData.boldPaymentSettings, environment: e.target.value as 'sandbox' | 'production' }\n                                                                        })}\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    >\n                                                                        <option value=\"sandbox\">Sandbox</option>\n                                                                        <option value=\"production\">Production</option>\n                                                                    </select>\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n\n                                                    {/* TTLock Settings Tab */}\n                                                    {activeSettingsTab === 'doorsystem' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                TTLock Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Client ID\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.doorSystemSettings.clientId}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, clientId: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Client ID\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Client Secret\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['doorSystemClientSecret'] ? 'text' : 'password'}\n                                                                        value={formData.doorSystemSettings.clientSecret}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, clientSecret: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Client Secret\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Username\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.doorSystemSettings.username}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, username: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Username\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        Password\n                                                                    </label>\n                                                                    <input\n                                                                        type={showSecrets['doorSystemPassword'] ? 'text' : 'password'}\n                                                                        value={formData.doorSystemSettings.password}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            doorSystemSettings: { ...formData.doorSystemSettings, password: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Password\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n\n                                                    {/* Email Settings Tab */}\n                                                    {activeSettingsTab === 'email' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                Email Settings\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Host\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpHost}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpHost: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"smtp.example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Port\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"number\"\n                                                                        value={formData.emailSettings.smtpPort}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpPort: parseInt(e.target.value) || 587 }\n                                                                        })}\n                                                                        placeholder=\"587\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP User\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpUser}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpUser: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"user@example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP Password\n                                                                    </label>\n                                                                    <div className=\"relative\">\n                                                                        <input\n                                                                            type={showSecrets['emailSmtpPass'] ? 'text' : 'password'}\n                                                                            value={formData.emailSettings.smtpPass}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                emailSettings: { ...formData.emailSettings, smtpPass: e.target.value }\n                                                                            })}\n                                                                            placeholder=\"Password\"\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                                        />\n                                                                        <button\n                                                                            type=\"button\"\n                                                                            onClick={() => setShowSecrets({ ...showSecrets, emailSmtpPass: !showSecrets['emailSmtpPass'] })}\n                                                                            className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                        >\n                                                                            {showSecrets['emailSmtpPass'] ? (\n                                                                                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                                </svg>\n                                                                            ) : (\n                                                                                <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                                </svg>\n                                                                            )}\n                                                                        </button>\n                                                                    </div>\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP From Email\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"email\"\n                                                                        value={formData.emailSettings.smtpFromEmail}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpFromEmail: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"noreply@example.com\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n                                                                <div>\n                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                        SMTP From Name\n                                                                    </label>\n                                                                    <input\n                                                                        type=\"text\"\n                                                                        value={formData.emailSettings.smtpFromName}\n                                                                        onChange={(e) => setFormData({\n                                                                            ...formData,\n                                                                            emailSettings: { ...formData.emailSettings, smtpFromName: e.target.value }\n                                                                        })}\n                                                                        placeholder=\"Branch Name\"\n                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                    />\n                                                                </div>\n\n                                                                {/* IMAP Settings Section */}\n                                                                <div className=\"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4\">\n                                                                    <div className=\"flex items-center justify-between mb-4\">\n                                                                        <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                                                                            IMAP Settings (Email Reading)\n                                                                        </h5>\n                                                                        <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                            <input\n                                                                                type=\"checkbox\"\n                                                                                checked={formData.emailSettings.imap.enabled}\n                                                                                onChange={(e) => setFormData({\n                                                                                    ...formData,\n                                                                                    emailSettings: {\n                                                                                        ...formData.emailSettings,\n                                                                                        imap: {\n                                                                                            ...formData.emailSettings.imap,\n                                                                                            enabled: e.target.checked\n                                                                                        }\n                                                                                    }\n                                                                                })}\n                                                                                className=\"sr-only peer\"\n                                                                            />\n                                                                            <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                            <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                                {formData.emailSettings.imap.enabled ? 'Enabled' : 'Disabled'}\n                                                                            </span>\n                                                                        </label>\n                                                                    </div>\n\n                                                                    {formData.emailSettings.imap.enabled && (\n                                                                        <div className=\"space-y-4\">\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Host\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.host}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, host: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"imap.example.com\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Port\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"number\"\n                                                                                    value={formData.emailSettings.imap.port}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, port: parseInt(e.target.value) || 993 }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"993\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"relative inline-flex items-center cursor-pointer\">\n                                                                                    <input\n                                                                                        type=\"checkbox\"\n                                                                                        checked={formData.emailSettings.imap.secure}\n                                                                                        onChange={(e) => setFormData({\n                                                                                            ...formData,\n                                                                                            emailSettings: {\n                                                                                                ...formData.emailSettings,\n                                                                                                imap: { ...formData.emailSettings.imap, secure: e.target.checked }\n                                                                                            }\n                                                                                        })}\n                                                                                        className=\"sr-only peer\"\n                                                                                    />\n                                                                                    <div className=\"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600\"></div>\n                                                                                    <span className=\"ml-3 text-sm text-gray-700 dark:text-gray-300\">\n                                                                                        Secure (SSL/TLS)\n                                                                                    </span>\n                                                                                </label>\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP User\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.user}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, user: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"user@example.com\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Password\n                                                                                </label>\n                                                                                <div className=\"relative\">\n                                                                                    <input\n                                                                                        type={showSecrets['emailImapPass'] ? 'text' : 'password'}\n                                                                                        value={formData.emailSettings.imap.password}\n                                                                                        onChange={(e) => setFormData({\n                                                                                            ...formData,\n                                                                                            emailSettings: {\n                                                                                                ...formData.emailSettings,\n                                                                                                imap: { ...formData.emailSettings.imap, password: e.target.value }\n                                                                                            }\n                                                                                        })}\n                                                                                        placeholder=\"Password\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 pr-10\"\n                                                                                    />\n                                                                                    <button\n                                                                                        type=\"button\"\n                                                                                        onClick={() => setShowSecrets({ ...showSecrets, emailImapPass: !showSecrets['emailImapPass'] })}\n                                                                                        className=\"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                                    >\n                                                                                        {showSecrets['emailImapPass'] ? (\n                                                                                            <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m0 0L3 3m3.29 3.29L12 12m-5.71-5.71L12 12\" />\n                                                                                            </svg>\n                                                                                        ) : (\n                                                                                            <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                                                                            </svg>\n                                                                                        )}\n                                                                                    </button>\n                                                                                </div>\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    IMAP Folder\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.folder}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, folder: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"INBOX\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                            <div>\n                                                                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                    Processed Folder (optional)\n                                                                                </label>\n                                                                                <input\n                                                                                    type=\"text\"\n                                                                                    value={formData.emailSettings.imap.processedFolder}\n                                                                                    onChange={(e) => setFormData({\n                                                                                        ...formData,\n                                                                                        emailSettings: {\n                                                                                            ...formData.emailSettings,\n                                                                                            imap: { ...formData.emailSettings.imap, processedFolder: e.target.value }\n                                                                                        }\n                                                                                    })}\n                                                                                    placeholder=\"Processed\"\n                                                                                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                />\n                                                                            </div>\n                                                                        </div>\n                                                                    )}\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n\n                                                    {/* Messages Tab */}\n                                                    {activeSettingsTab === 'messages' && (\n                                                        <div>\n                                                            <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-4\">\n                                                                {t('branches.messagesTab', { defaultValue: 'Nachrichten' })}\n                                                            </h4>\n                                                            <div className=\"space-y-4\">\n                                                                {/* Automatisches Versenden */}\n                                                                <div className=\"border-b border-gray-200 dark:border-gray-700 pb-4\">\n                                                                    <div className=\"flex items-center justify-between\">\n                                                                        <div>\n                                                                            <label className=\"block text-sm font-medium text-gray-900 dark:text-white mb-1\">\n                                                                                {t('branches.autoSendInvitation', { defaultValue: 'Automatisches Versenden aktivieren' })}\n                                                                            </label>\n                                                                            <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                                                                {t('branches.autoSendInvitationDescription', { defaultValue: 'Sendet Check-in-Einladungen automatisch 1 Tag vor Check-in-Date um 08:00 Uhr' })}\n                                                                            </p>\n                                                                        </div>\n                                                                        <input\n                                                                            type=\"checkbox\"\n                                                                            checked={formData.autoSendReservationInvitation}\n                                                                            onChange={(e) => setFormData({\n                                                                                ...formData,\n                                                                                autoSendReservationInvitation: e.target.checked\n                                                                            })}\n                                                                            className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                                                                        />\n                                                                    </div>\n                                                                </div>\n\n                                                                {/* Mitteilungsvorlagen */}\n                                                                <div>\n                                                                    <h5 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-3\">\n                                                                        {t('branches.messageTemplates', { defaultValue: 'Mitteilungsvorlagen' })}\n                                                                    </h5>\n                                                                    \n                                                                    <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-4\">\n                                                                        {t('branches.messageTemplatesDescription', { defaultValue: 'Konfiguriere die Vorlagen fr Check-in-Einladungen und Check-in-Besttigungen' })}\n                                                                    </p>\n\n                                                                    {/* Template Type Selector */}\n                                                                    <div className=\"mb-4\">\n                                                                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                                                                            {t('branches.messageType', { defaultValue: 'Mitteilungstyp' })}\n                                                                        </label>\n                                                                        <select\n                                                                            value={selectedTemplateType}\n                                                                            onChange={(e) => setSelectedTemplateType(e.target.value as 'checkInInvitation' | 'checkInConfirmation')}\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                        >\n                                                                            <option value=\"checkInInvitation\">\n                                                                                {t('branches.messageType.checkInInvitation', { defaultValue: 'Check-in-Einladung' })}\n                                                                            </option>\n                                                                            <option value=\"checkInConfirmation\">\n                                                                                {t('branches.messageType.checkInConfirmation', { defaultValue: 'Check-in-Besttigung' })}\n                                                                            </option>\n                                                                        </select>\n                                                                    </div>\n\n                                                                    {/* Language Selector */}\n                                                                    <div className=\"mb-4\">\n                                                                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                                                                            {t('branches.language', { defaultValue: 'Sprache' })}\n                                                                        </label>\n                                                                        <select\n                                                                            value={selectedLanguage}\n                                                                            onChange={(e) => setSelectedLanguage(e.target.value as 'en' | 'es' | 'de')}\n                                                                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                        >\n                                                                            <option value=\"en\">{t('branches.language.en', { defaultValue: 'Englisch' })}</option>\n                                                                            <option value=\"es\">{t('branches.language.es', { defaultValue: 'Spanisch' })}</option>\n                                                                            <option value=\"de\">{t('branches.language.de', { defaultValue: 'Deutsch' })}</option>\n                                                                        </select>\n                                                                    </div>\n\n                                                                    {/* Template Fields */}\n                                                                    {(() => {\n                                                                        const currentTemplate = formData.messageTemplates?.[selectedTemplateType]?.[selectedLanguage] || {\n                                                                            whatsappTemplateName: '',\n                                                                            whatsappTemplateParams: [] as string[],\n                                                                            emailSubject: '',\n                                                                            emailContent: ''\n                                                                        };\n                                                                        \n                                                                        return (\n                                                                            <div className=\"space-y-4\">\n                                                                                <div>\n                                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                        {t('branches.whatsappTemplateName', { defaultValue: 'WhatsApp Template Name' })}\n                                                                                    </label>\n                                                                                    <input\n                                                                                        type=\"text\"\n                                                                                        value={currentTemplate.whatsappTemplateName || ''}\n                                                                                        onChange={(e) => {\n                                                                                            setFormData({\n                                                                                                ...formData,\n                                                                                                messageTemplates: {\n                                                                                                    ...formData.messageTemplates,\n                                                                                                    [selectedTemplateType]: {\n                                                                                                        ...formData.messageTemplates?.[selectedTemplateType],\n                                                                                                        [selectedLanguage]: {\n                                                                                                            ...currentTemplate,\n                                                                                                            whatsappTemplateName: e.target.value\n                                                                                                        }\n                                                                                                    }\n                                                                                                }\n                                                                                            });\n                                                                                        }}\n                                                                                        placeholder=\"reservation_checkin_invitation_en\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                    />\n                                                                                </div>\n\n                                                                                <div>\n                                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                        {t('branches.whatsappTemplateParams', { defaultValue: 'WhatsApp Template Parameter' })}\n                                                                                    </label>\n                                                                                    <input\n                                                                                        type=\"text\"\n                                                                                        value={Array.isArray(currentTemplate.whatsappTemplateParams) ? currentTemplate.whatsappTemplateParams.join(', ') : (currentTemplate.whatsappTemplateParams || '')}\n                                                                                        onChange={(e) => {\n                                                                                            const params = e.target.value.split(',').map(p => p.trim()).filter(p => p);\n                                                                                            setFormData({\n                                                                                                ...formData,\n                                                                                                messageTemplates: {\n                                                                                                    ...formData.messageTemplates,\n                                                                                                    [selectedTemplateType]: {\n                                                                                                        ...formData.messageTemplates?.[selectedTemplateType],\n                                                                                                        [selectedLanguage]: {\n                                                                                                            ...currentTemplate,\n                                                                                                            whatsappTemplateParams: params\n                                                                                                        }\n                                                                                                    }\n                                                                                                }\n                                                                                            });\n                                                                                        }}\n                                                                                        placeholder=\"{{1}}, {{2}}, {{3}}\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                    />\n                                                                                    <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                                                                                        {t('branches.whatsappTemplateParamsHint', { defaultValue: 'Komma-separiert, z.B. {{1}}, {{2}}, {{3}}' })}\n                                                                                    </p>\n                                                                                </div>\n\n                                                                                <div>\n                                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                        {t('branches.emailSubject', { defaultValue: 'Email Betreff' })}\n                                                                                    </label>\n                                                                                    <input\n                                                                                        type=\"text\"\n                                                                                        value={currentTemplate.emailSubject || ''}\n                                                                                        onChange={(e) => {\n                                                                                            setFormData({\n                                                                                                ...formData,\n                                                                                                messageTemplates: {\n                                                                                                    ...formData.messageTemplates,\n                                                                                                    [selectedTemplateType]: {\n                                                                                                        ...formData.messageTemplates?.[selectedTemplateType],\n                                                                                                        [selectedLanguage]: {\n                                                                                                            ...currentTemplate,\n                                                                                                            emailSubject: e.target.value\n                                                                                                        }\n                                                                                                    }\n                                                                                                }\n                                                                                            });\n                                                                                        }}\n                                                                                        placeholder=\"Welcome to La Familia Hostel - Online Check-in\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                    />\n                                                                                </div>\n\n                                                                                <div>\n                                                                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                                                                        {t('branches.emailContent', { defaultValue: 'Email Inhalt' })}\n                                                                                    </label>\n                                                                                    <textarea\n                                                                                        rows={10}\n                                                                                        value={currentTemplate.emailContent || ''}\n                                                                                        onChange={(e) => {\n                                                                                            setFormData({\n                                                                                                ...formData,\n                                                                                                messageTemplates: {\n                                                                                                    ...formData.messageTemplates,\n                                                                                                    [selectedTemplateType]: {\n                                                                                                        ...formData.messageTemplates?.[selectedTemplateType],\n                                                                                                        [selectedLanguage]: {\n                                                                                                            ...currentTemplate,\n                                                                                                            emailContent: e.target.value\n                                                                                                        }\n                                                                                                    }\n                                                                                                }\n                                                                                            });\n                                                                                        }}\n                                                                                        placeholder=\"Hello {{guestName}}, ...\"\n                                                                                        className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                                                                                    />\n                                                                                    <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                                                                                        {t('branches.templateVariables', { defaultValue: 'Verfgbare Variablen' })}: \n                                                                                        <span className=\"font-mono\">\n                                                                                            {selectedTemplateType === 'checkInInvitation' \n                                                                                                ? t('branches.templateVariables.checkInInvitation', { defaultValue: '{{guestName}}, {{checkInLink}}, {{paymentLink}}' })\n                                                                                                : t('branches.templateVariables.checkInConfirmation', { defaultValue: '{{guestName}}, {{roomDisplay}}, {{doorPin}}, {{doorAppName}}' })\n                                                                                            }\n                                                                                        </span>\n                                                                                    </p>\n                                                                                </div>\n                                                                            </div>\n                                                                        );\n                                                                    })()}\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                    )}\n                                                </div>\n                                            </>\n                                        )}\n                                    </div>\n                                </div>\n\n                                {/* Buttons */}\n                                <div className=\"flex justify-end pt-4 gap-2 px-6 pb-6 border-t dark:border-gray-700\">\n                                    <div className=\"relative group\">\n                                        <button\n                                            type=\"button\"\n                                            onClick={handleCloseModal}\n                                            className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                                        >\n                                            <XMarkIcon className=\"h-5 w-5\" />\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {t('common.cancel', { defaultValue: 'Abbrechen' })}\n                                        </div>\n                                    </div>\n                                    <div className=\"relative group\">\n                                        <button\n                                            type=\"submit\"\n                                            className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 transition-colors\"\n                                        >\n                                            <CheckIcon className=\"h-5 w-5\" />\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {editingBranch ? t('common.update', { defaultValue: 'Aktualisieren' }) : t('common.create', { defaultValue: 'Erstellen' })}\n                                        </div>\n                                    </div>\n                                </div>\n                            </form>\n                        </div>\n                    )}\n                </>\n            )}\n        </div>\n    );\n};\n\nexport default BranchManagementTab;\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { TourProvider } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface CreateTourProviderModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onProviderCreated: (newProvider: TourProvider) => void;\n}\n\nconst CreateTourProviderModal = ({ isOpen, onClose, onProviderCreated }: CreateTourProviderModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    const { openSidepane, closeSidepane } = useSidepane();\n    \n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    const [name, setName] = useState('');\n    const [phone, setPhone] = useState('');\n    const [email, setEmail] = useState('');\n    const [contactPerson, setContactPerson] = useState('');\n    const [notes, setNotes] = useState('');\n    const [branchId, setBranchId] = useState<number | ''>('');\n    \n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Branches\n    useEffect(() => {\n        const loadData = async () => {\n            try {\n                setLoadingData(true);\n                const branchesRes = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\n                setBranches(branchesRes.data?.data || branchesRes.data || []);\n            } catch (err: unknown) {\n                console.error('Error loading data:', err);\n                showMessage(t('errors.loadError'), 'error');\n            } finally {\n                setLoadingData(false);\n            }\n        };\n        \n        if (isOpen) {\n            loadData();\n        }\n    }, [isOpen, t, showMessage]);\n\n    // Responsive-Erkennung\n    useEffect(() => {\n        const checkScreenSize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        \n        checkScreenSize();\n        window.addEventListener('resize', checkScreenSize);\n        \n        return () => {\n            window.removeEventListener('resize', checkScreenSize);\n        };\n    }, []);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    // Reset form when modal opens/closes\n    useEffect(() => {\n        if (!isOpen) {\n            setName('');\n            setPhone('');\n            setEmail('');\n            setContactPerson('');\n            setNotes('');\n            setBranchId('');\n            setError(null);\n        }\n    }, [isOpen]);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n\n        // Validierung\n        if (!name.trim()) {\n            setError(t('tours.providers.validation.nameRequired', { defaultValue: 'Name ist erforderlich' }));\n            return;\n        }\n\n        setLoading(true);\n        try {\n            const response = await axiosInstance.post(API_ENDPOINTS.TOUR_PROVIDERS.BASE, {\n                name: name.trim(),\n                phone: phone.trim() || null,\n                email: email.trim() || null,\n                contactPerson: contactPerson.trim() || null,\n                notes: notes.trim() || null,\n                branchId: branchId ? Number(branchId) : null\n            });\n\n            if (response.data?.success && response.data?.data) {\n                showMessage(\n                    t('tours.providers.created', { defaultValue: 'Tour-Provider erfolgreich erstellt' }),\n                    'success'\n                );\n                onProviderCreated(response.data.data);\n                handleClose();\n            } else {\n                throw new Error(response.data?.message || t('tours.providers.createError', { defaultValue: 'Fehler beim Erstellen des Providers' }));\n            }\n        } catch (err: unknown) {\n            console.error('Error creating provider:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('errors.unknownError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleClose = () => {\n        setName('');\n        setPhone('');\n        setEmail('');\n        setContactPerson('');\n        setNotes('');\n        setBranchId('');\n        setError(null);\n        onClose();\n    };\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                \n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                        <div className=\"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700\">\n                            <Dialog.Title className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                                {t('tours.providers.create', { defaultValue: 'Neuer Tour-Provider' })}\n                            </Dialog.Title>\n                            <button\n                                onClick={handleClose}\n                                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <form onSubmit={handleSubmit} className=\"p-4 space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.name', { defaultValue: 'Name' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={name}\n                                onChange={(e) => setName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.contactPerson', { defaultValue: 'Ansprechpartner' })}\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={contactPerson}\n                                onChange={(e) => setContactPerson(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.phone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={phone}\n                                onChange={(e) => setPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.email', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={email}\n                                onChange={(e) => setEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.branch', { defaultValue: 'Niederlassung' })}\n                            </label>\n                            <select\n                                value={branchId}\n                                onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            >\n                                <option value=\"\">{t('common.all', { defaultValue: 'Alle' })}</option>\n                                {branches.map(branch => (\n                                    <option key={branch.id} value={branch.id}>\n                                        {branch.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.notes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={notes}\n                                onChange={(e) => setNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                            <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                                <button\n                                    type=\"button\"\n                                    onClick={handleClose}\n                                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                    title={t('common.cancel', 'Abbrechen')}\n                                >\n                                    <XMarkIcon className=\"h-5 w-5\" />\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    disabled={loading || loadingData}\n                                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                    title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                                >\n                                    <CheckIcon className=\"h-5 w-5\" />\n                                </button>\n                            </div>\n                        </form>\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n    \n    // Fr Desktop (ab 640px) - Sidepane\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                        {t('tours.providers.create', { defaultValue: 'Neuer Tour-Provider' })}\n                    </h2>\n                    <button\n                        onClick={handleClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    <form onSubmit={handleSubmit} className=\"space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.name', { defaultValue: 'Name' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={name}\n                                onChange={(e) => setName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.contactPerson', { defaultValue: 'Ansprechpartner' })}\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={contactPerson}\n                                onChange={(e) => setContactPerson(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.phone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={phone}\n                                onChange={(e) => setPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.email', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={email}\n                                onChange={(e) => setEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.branch', { defaultValue: 'Niederlassung' })}\n                            </label>\n                            <select\n                                value={branchId}\n                                onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            >\n                                <option value=\"\">{t('common.all', { defaultValue: 'Alle' })}</option>\n                                {branches.map(branch => (\n                                    <option key={branch.id} value={branch.id}>\n                                        {branch.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.notes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={notes}\n                                onChange={(e) => setNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={handleClose}\n                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                title={t('common.cancel', 'Abbrechen')}\n                            >\n                                <XMarkIcon className=\"h-5 w-5\" />\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData}\n                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            >\n                                <CheckIcon className=\"h-5 w-5\" />\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport default CreateTourProviderModal;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { TourProvider } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface EditTourProviderModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    provider: TourProvider | null;\n    onProviderUpdated: (updatedProvider: TourProvider) => void;\n}\n\nconst EditTourProviderModal = ({ isOpen, onClose, provider, onProviderUpdated }: EditTourProviderModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    const { openSidepane, closeSidepane } = useSidepane();\n    \n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    const [name, setName] = useState('');\n    const [phone, setPhone] = useState('');\n    const [email, setEmail] = useState('');\n    const [contactPerson, setContactPerson] = useState('');\n    const [notes, setNotes] = useState('');\n    const [branchId, setBranchId] = useState<number | ''>('');\n    \n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Branches und setze Form-Daten\n    useEffect(() => {\n        const loadData = async () => {\n            try {\n                setLoadingData(true);\n                const branchesRes = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\n                setBranches(branchesRes.data?.data || branchesRes.data || []);\n            } catch (err: unknown) {\n                console.error('Error loading data:', err);\n                showMessage(t('errors.loadError'), 'error');\n            } finally {\n                setLoadingData(false);\n            }\n        };\n        \n        if (isOpen) {\n            loadData();\n        }\n    }, [isOpen, t, showMessage]);\n\n    // Responsive-Erkennung\n    useEffect(() => {\n        const checkScreenSize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        \n        checkScreenSize();\n        window.addEventListener('resize', checkScreenSize);\n        \n        return () => {\n            window.removeEventListener('resize', checkScreenSize);\n        };\n    }, []);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    // Setze Form-Daten wenn Provider geladen wird\n    useEffect(() => {\n        if (provider) {\n            setName(provider.name || '');\n            setPhone(provider.phone || '');\n            setEmail(provider.email || '');\n            setContactPerson(provider.contactPerson || '');\n            setNotes(provider.notes || '');\n            setBranchId(provider.branchId || '');\n        } else {\n            setName('');\n            setPhone('');\n            setEmail('');\n            setContactPerson('');\n            setNotes('');\n            setBranchId('');\n        }\n        setError(null);\n    }, [provider, isOpen]);\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!provider) return;\n        setError(null);\n\n        // Validierung\n        if (!name.trim()) {\n            setError(t('tours.providers.validation.nameRequired', { defaultValue: 'Name ist erforderlich' }));\n            return;\n        }\n\n        setLoading(true);\n        try {\n            const response = await axiosInstance.put(API_ENDPOINTS.TOUR_PROVIDERS.BY_ID(provider.id), {\n                name: name.trim(),\n                phone: phone.trim() || null,\n                email: email.trim() || null,\n                contactPerson: contactPerson.trim() || null,\n                notes: notes.trim() || null,\n                branchId: branchId ? Number(branchId) : null\n            });\n\n            if (response.data?.success && response.data?.data) {\n                showMessage(\n                    t('tours.providers.updated', { defaultValue: 'Tour-Provider erfolgreich aktualisiert' }),\n                    'success'\n                );\n                onProviderUpdated(response.data.data);\n                handleClose();\n            } else {\n                throw new Error(response.data?.message || t('tours.providers.updateError', { defaultValue: 'Fehler beim Aktualisieren des Providers' }));\n            }\n        } catch (err: unknown) {\n            console.error('Error updating provider:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('errors.unknownError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleClose = () => {\n        onClose();\n    };\n\n    if (!provider) return null;\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                        <div className=\"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700\">\n                            <Dialog.Title className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                                {t('tours.providers.edit', { defaultValue: 'Tour-Provider bearbeiten' })}\n                            </Dialog.Title>\n                            <button\n                                onClick={handleClose}\n                                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <form onSubmit={handleSubmit} className=\"p-4 space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.name', { defaultValue: 'Name' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={name}\n                                onChange={(e) => setName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.contactPerson', { defaultValue: 'Ansprechpartner' })}\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={contactPerson}\n                                onChange={(e) => setContactPerson(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.phone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={phone}\n                                onChange={(e) => setPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.email', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={email}\n                                onChange={(e) => setEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.branch', { defaultValue: 'Niederlassung' })}\n                            </label>\n                            <select\n                                value={branchId}\n                                onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            >\n                                <option value=\"\">{t('common.all', { defaultValue: 'Alle' })}</option>\n                                {branches.map(branch => (\n                                    <option key={branch.id} value={branch.id}>\n                                        {branch.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.notes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={notes}\n                                onChange={(e) => setNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                            <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                                <button\n                                    type=\"button\"\n                                    onClick={handleClose}\n                                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                    title={t('common.cancel', 'Abbrechen')}\n                                >\n                                    <XMarkIcon className=\"h-5 w-5\" />\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    disabled={loading || loadingData}\n                                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                    title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                                >\n                                    <CheckIcon className=\"h-5 w-5\" />\n                                </button>\n                            </div>\n                        </form>\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n    \n    // Fr Desktop (ab 640px) - Sidepane\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                        {t('tours.providers.edit', { defaultValue: 'Tour-Provider bearbeiten' })}\n                    </h2>\n                    <button\n                        onClick={handleClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    <form onSubmit={handleSubmit} className=\"space-y-4\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3\">\n                                <p className=\"text-sm text-red-800 dark:text-red-200\">{error}</p>\n                            </div>\n                        )}\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.name', { defaultValue: 'Name' })} *\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={name}\n                                onChange={(e) => setName(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                required\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.contactPerson', { defaultValue: 'Ansprechpartner' })}\n                            </label>\n                            <input\n                                type=\"text\"\n                                value={contactPerson}\n                                onChange={(e) => setContactPerson(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.phone', { defaultValue: 'Telefon' })}\n                            </label>\n                            <input\n                                type=\"tel\"\n                                value={phone}\n                                onChange={(e) => setPhone(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.email', { defaultValue: 'E-Mail' })}\n                            </label>\n                            <input\n                                type=\"email\"\n                                value={email}\n                                onChange={(e) => setEmail(e.target.value)}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.branch', { defaultValue: 'Niederlassung' })}\n                            </label>\n                            <select\n                                value={branchId}\n                                onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            >\n                                <option value=\"\">{t('common.all', { defaultValue: 'Alle' })}</option>\n                                {branches.map(branch => (\n                                    <option key={branch.id} value={branch.id}>\n                                        {branch.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                {t('tours.providers.notes', { defaultValue: 'Notizen' })}\n                            </label>\n                            <textarea\n                                value={notes}\n                                onChange={(e) => setNotes(e.target.value)}\n                                rows={3}\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                                disabled={loading || loadingData}\n                            />\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={handleClose}\n                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                title={t('common.cancel', 'Abbrechen')}\n                            >\n                                <XMarkIcon className=\"h-5 w-5\" />\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData}\n                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            >\n                                <CheckIcon className=\"h-5 w-5\" />\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport default EditTourProviderModal;\n\n","import React, { useState, useEffect, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { PencilIcon, TrashIcon, PlusIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport axiosInstance from '../../config/axios.ts';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport { TourProvider } from '../../types/tour.ts';\nimport CreateTourProviderModal from './CreateTourProviderModal.tsx';\nimport EditTourProviderModal from './EditTourProviderModal.tsx';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useError } from '../../contexts/ErrorContext.tsx';\n\ninterface TourProvidersTabProps {\n}\n\n// ProviderCard-Komponente fr mobile und Desktop-Ansicht\nconst ProviderCard: React.FC<{\n    provider: TourProvider;\n    onEdit: (provider: TourProvider) => void;\n    onDelete: (providerId: number) => void;\n    canEdit: boolean;\n    canDelete: boolean;\n}> = ({ provider, onEdit, onDelete, canEdit, canDelete }) => {\n    const { t } = useTranslation();\n    return (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 p-4\">\n            {/* Header mit Provider-Name und Aktionen */}\n            <div className=\"flex justify-between items-start mb-2\">\n                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">{provider.name}</h3>\n                \n                <div className=\"flex space-x-2\">\n                    {canEdit && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => onEdit(provider)}\n                                className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n                                title={t('common.edit', { defaultValue: 'Bearbeiten' })}\n                            >\n                                <PencilIcon className=\"h-5 w-5\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('common.edit', { defaultValue: 'Bearbeiten' })}\n                            </div>\n                        </div>\n                    )}\n                    \n                    {canDelete && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => onDelete(provider.id)}\n                                className=\"text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-300 p-1\"\n                                title={t('common.delete', { defaultValue: 'Lschen' })}\n                            >\n                                <TrashIcon className=\"h-5 w-5\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('common.delete', { defaultValue: 'Lschen' })}\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* Details */}\n            <div className=\"space-y-1 text-sm text-gray-600 dark:text-gray-400\">\n                {provider.contactPerson && (\n                    <p>\n                        <span className=\"font-medium\">{t('tours.providers.contactPerson', { defaultValue: 'Ansprechpartner' })}:</span>{' '}\n                        {provider.contactPerson}\n                    </p>\n                )}\n                {provider.phone && (\n                    <p>\n                        <span className=\"font-medium\">{t('tours.providers.phone', { defaultValue: 'Telefon' })}:</span>{' '}\n                        {provider.phone}\n                    </p>\n                )}\n                {provider.email && (\n                    <p>\n                        <span className=\"font-medium\">{t('tours.providers.email', { defaultValue: 'E-Mail' })}:</span>{' '}\n                        {provider.email}\n                    </p>\n                )}\n                {provider.notes && (\n                    <p className=\"mt-2 text-xs\">\n                        <span className=\"font-medium\">{t('tours.providers.notes', { defaultValue: 'Notizen' })}:</span>{' '}\n                        {provider.notes}\n                    </p>\n                )}\n            </div>\n        </div>\n    );\n};\n\nconst TourProvidersTab: React.FC<TourProvidersTabProps> = () => {\n    const { t } = useTranslation();\n    const { showMessage } = useMessage();\n    \n    // Fehlerbehandlung mit Fallback\n    const errorContext = useError();\n    const handleErrorContext = errorContext?.handleError || ((err: unknown, context?: Record<string, unknown>) => {\n        console.error('Error:', err, context);\n        const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                             (err as { message?: string })?.message || \n                             t('errors.unknownError', { defaultValue: 'Ein Fehler ist aufgetreten' });\n        showMessage(errorMessage, 'error');\n    });\n    const [isCreateModalOpen, setIsCreateModalOpen] = useState(false);\n    const [isEditModalOpen, setIsEditModalOpen] = useState(false);\n    const [editingProvider, setEditingProvider] = useState<TourProvider | null>(null);\n    const [providers, setProviders] = useState<TourProvider[]>([]);\n    const [loading, setLoading] = useState(true);\n    const [searchTerm, setSearchTerm] = useState('');\n    const { hasPermission } = usePermissions();\n\n    // Berechtigungen prfen\n    const canCreate = hasPermission('tour_providers', 'write', 'table');\n    const canEdit = hasPermission('tour_providers', 'write', 'table');\n    const canDelete = hasPermission('tour_providers', 'write', 'table');\n\n    // Providers laden\n    const fetchProviders = useCallback(async () => {\n        setLoading(true);\n        try {\n            const response = await axiosInstance.get(API_ENDPOINTS.TOUR_PROVIDERS.BASE);\n            const data = response.data?.data || response.data || [];\n            setProviders(Array.isArray(data) ? data : []);\n        } catch (error: unknown) {\n            console.error('Error loading tour providers:', error);\n            handleErrorContext(error);\n            const errorMessage = error.response?.data?.message || t('tours.providers.loadError', { defaultValue: 'Fehler beim Laden der Provider' });\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    }, [handleErrorContext]);\n\n    useEffect(() => {\n        fetchProviders();\n    }, [fetchProviders]);\n\n    // Gefilterte Provider\n    const filteredProviders = providers.filter(provider => {\n        if (!searchTerm) return true;\n        const search = searchTerm.toLowerCase();\n        return (\n            provider.name.toLowerCase().includes(search) ||\n            provider.contactPerson?.toLowerCase().includes(search) ||\n            provider.phone?.toLowerCase().includes(search) ||\n            provider.email?.toLowerCase().includes(search) ||\n            provider.notes?.toLowerCase().includes(search)\n        );\n    });\n\n    // Handler fr Create\n    const handleCreate = () => {\n        setIsCreateModalOpen(true);\n    };\n\n    // Handler fr Edit\n    const handleEdit = (provider: TourProvider) => {\n        setEditingProvider(provider);\n        setIsEditModalOpen(true);\n    };\n\n    // Handler fr Delete\n    const handleDelete = async (providerId: number) => {\n        if (!window.confirm(t('tours.providers.deleteConfirm', { defaultValue: 'Mchten Sie diesen Provider wirklich lschen?' }))) {\n            return;\n        }\n\n        try {\n            await axiosInstance.delete(API_ENDPOINTS.TOUR_PROVIDERS.BY_ID(providerId));\n            showMessage(\n                t('tours.providers.deleted', { defaultValue: 'Tour-Provider erfolgreich gelscht' }),\n                'success'\n            );\n            fetchProviders();\n        } catch (error: any) {\n            console.error('Error deleting provider:', error);\n            handleErrorContext(error);\n            const errorMessage = error.response?.data?.message || t('errors.unknownError');\n            showMessage(errorMessage, 'error');\n        }\n    };\n\n    // Handler fr Provider erstellt\n    const handleProviderCreated = (newProvider: TourProvider) => {\n        fetchProviders();\n    };\n\n    // Handler fr Provider aktualisiert\n    const handleProviderUpdated = (updatedProvider: TourProvider) => {\n        fetchProviders();\n    };\n\n    if (loading) {\n        return (\n            <div className=\"flex justify-center items-center py-12\">\n                <div className=\"text-gray-500 dark:text-gray-400\">{t('common.loading', { defaultValue: 'Lade...' })}</div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"space-y-4\">\n            {/* Header mit Suche und Create-Button */}\n            <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n                <div className=\"flex-1 w-full sm:max-w-md\">\n                    <input\n                        type=\"text\"\n                        placeholder={t('tours.providers.search', { defaultValue: 'Provider suchen...' })}\n                        value={searchTerm}\n                        onChange={(e) => setSearchTerm(e.target.value)}\n                        className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    />\n                </div>\n                {canCreate && (\n                    <div className=\"relative group\">\n                        <button \n                            onClick={handleCreate}\n                            className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                            style={{ width: '30.19px', height: '30.19px' }}\n                            aria-label={t('tours.providers.create', { defaultValue: 'Neuer Provider' })}\n                        >\n                            <PlusIcon className=\"h-4 w-4\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {t('tours.providers.create', { defaultValue: 'Neuer Provider' })}\n                        </div>\n                    </div>\n                )}\n            </div>\n\n            {/* Provider-Liste */}\n            {filteredProviders.length === 0 ? (\n                <div className=\"text-center py-12 text-gray-500 dark:text-gray-400\">\n                    {searchTerm\n                        ? t('tours.providers.noResults', { defaultValue: 'Keine Provider gefunden' })\n                        : t('tours.providers.empty', { defaultValue: 'Keine Tour-Provider vorhanden' })}\n                </div>\n            ) : (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                    {filteredProviders.map(provider => (\n                        <ProviderCard\n                            key={provider.id}\n                            provider={provider}\n                            onEdit={handleEdit}\n                            onDelete={handleDelete}\n                            canEdit={canEdit}\n                            canDelete={canDelete}\n                        />\n                    ))}\n                </div>\n            )}\n\n            {/* Modals */}\n            <CreateTourProviderModal\n                isOpen={isCreateModalOpen}\n                onClose={() => setIsCreateModalOpen(false)}\n                onProviderCreated={handleProviderCreated}\n            />\n            <EditTourProviderModal\n                isOpen={isEditModalOpen}\n                onClose={() => {\n                    setIsEditModalOpen(false);\n                    setEditingProvider(null);\n                }}\n                provider={editingProvider}\n                onProviderUpdated={handleProviderUpdated}\n            />\n        </div>\n    );\n};\n\nexport default TourProvidersTab;\n\n","export enum TourType {\r\n  OWN = 'own',\r\n  EXTERNAL = 'external'\r\n}\r\n\r\nexport enum TourBookingStatus {\r\n  CONFIRMED = 'confirmed',\r\n  CANCELLED = 'cancelled',\r\n  COMPLETED = 'completed',\r\n  NO_SHOW = 'no_show'\r\n}\r\n\r\nexport enum MessageDirection {\r\n  OUTGOING = 'outgoing',\r\n  INCOMING = 'incoming'\r\n}\r\n\r\nexport enum MessageStatus {\r\n  SENT = 'sent',\r\n  DELIVERED = 'delivered',\r\n  READ = 'read',\r\n  FAILED = 'failed'\r\n}\r\n\r\nexport interface Tour {\r\n  id: number;\r\n  title: string;\r\n  description?: string | null;\r\n  type: TourType;\r\n  isActive: boolean;\r\n  duration?: number | null;\r\n  maxParticipants?: number | null;\r\n  minParticipants?: number | null;\r\n  price?: number | string | null;\r\n  currency?: string | null;\r\n  location?: string | null;\r\n  meetingPoint?: string | null;\r\n  includes?: string | null;\r\n  excludes?: string | null;\r\n  requirements?: string | null;\r\n  totalCommission?: number | string | null;\r\n  totalCommissionPercent?: number | string | null;\r\n  sellerCommissionPercent?: number | string | null;\r\n  sellerCommissionFixed?: number | string | null;\r\n  externalProviderId?: number | null;\r\n  externalProvider?: TourProvider | null;\r\n  externalBookingUrl?: string | null;\r\n  imageUrl?: string | null;\r\n  galleryUrls?: string[] | null;\r\n  availableFrom?: string | null;\r\n  availableTo?: string | null;\r\n  recurringSchedule?: any | null;\r\n  organizationId: number;\r\n  branchId?: number | null;\r\n  branch?: { id: number; name: string } | null;\r\n  createdById?: number | null;\r\n  createdBy?: { id: number; firstName: string; lastName: string } | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface TourProvider {\r\n  id: number;\r\n  name: string;\r\n  phone?: string | null;\r\n  email?: string | null;\r\n  contactPerson?: string | null;\r\n  notes?: string | null;\r\n  organizationId: number;\r\n  branchId?: number | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface TourBooking {\r\n  id: number;\r\n  tourId: number;\r\n  tour?: Tour | null;\r\n  bookingDate: string;\r\n  tourDate: string;\r\n  numberOfParticipants: number;\r\n  totalPrice: number | string;\r\n  currency: string;\r\n  customerName: string;\r\n  customerEmail?: string | null;\r\n  customerPhone?: string | null;\r\n  customerNotes?: string | null;\r\n  paymentStatus: 'pending' | 'paid' | 'partially_paid' | 'refunded';\r\n  amountPaid?: number | string | null;\r\n  amountPending?: number | string | null;\r\n  paymentLink?: string | null;\r\n  paymentDeadline?: string | null;\r\n  autoCancelEnabled?: boolean;\r\n  reservedUntil?: string | null;\r\n  bookedById?: number | null;\r\n  bookedBy?: { id: number; firstName: string; lastName: string } | null;\r\n  commissionAmount?: number | string | null;\r\n  commissionCalculatedAt?: string | null;\r\n  status: TourBookingStatus;\r\n  cancelledBy?: string | null;\r\n  cancelledAt?: string | null;\r\n  cancelledReason?: string | null;\r\n  isExternal: boolean;\r\n  externalBookingId?: string | null;\r\n  externalStatus?: string | null;\r\n  externalMessage?: string | null;\r\n  alternativeTours?: number[] | null;\r\n  organizationId: number;\r\n  branchId?: number | null;\r\n  branch?: { id: number; name: string } | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface TourReservation {\r\n  id: number;\r\n  tourId: number;\r\n  tour?: Tour | null;\r\n  bookingId: number;\r\n  booking?: TourBooking | null;\r\n  reservationId: number;\r\n  reservation?: any | null;\r\n  tourPrice: number | string;\r\n  accommodationPrice: number | string;\r\n  currency: string;\r\n  tourPricePaid?: number | string | null;\r\n  tourPricePending?: number | string | null;\r\n  accommodationPaid?: number | string | null;\r\n  accommodationPending?: number | string | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface TourWhatsAppMessage {\r\n  id: number;\r\n  bookingId: number;\r\n  booking?: TourBooking | null;\r\n  direction: MessageDirection;\r\n  message: string;\r\n  phoneNumber: string;\r\n  sentAt: string;\r\n  status: MessageStatus;\r\n  errorMessage?: string | null;\r\n  processed: boolean;\r\n  processedAt?: string | null;\r\n  action?: string | null;\r\n  extractedData?: any | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\n\r\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { Tour, TourType, TourProvider } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface CreateTourModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onTourCreated: (newTour: Tour) => void;\n}\n\nconst CreateTourModal = ({ isOpen, onClose, onTourCreated }: CreateTourModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    const { openSidepane, closeSidepane } = useSidepane();\n    \n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    const [title, setTitle] = useState('');\n    const [description, setDescription] = useState('');\n    const [type, setType] = useState<TourType>(TourType.OWN);\n    const [isActive, setIsActive] = useState(true);\n    const [duration, setDuration] = useState<number | ''>('');\n    const [maxParticipants, setMaxParticipants] = useState<number | ''>('');\n    const [minParticipants, setMinParticipants] = useState<number | ''>('');\n    const [price, setPrice] = useState<number | ''>('');\n    const [currency, setCurrency] = useState('COP');\n    const [location, setLocation] = useState('');\n    const [meetingPoint, setMeetingPoint] = useState('');\n    const [includes, setIncludes] = useState('');\n    const [excludes, setExcludes] = useState('');\n    const [requirements, setRequirements] = useState('');\n    const [totalCommission, setTotalCommission] = useState<number | ''>('');\n    const [totalCommissionPercent, setTotalCommissionPercent] = useState<number | ''>('');\n    const [sellerCommissionPercent, setSellerCommissionPercent] = useState<number | ''>('');\n    const [sellerCommissionFixed, setSellerCommissionFixed] = useState<number | ''>('');\n    const [externalProviderId, setExternalProviderId] = useState<number | ''>('');\n    const [externalBookingUrl, setExternalBookingUrl] = useState('');\n    const [branchId, setBranchId] = useState<number | ''>('');\n    const [imageFile, setImageFile] = useState<File | null>(null);\n    const [imagePreview, setImagePreview] = useState<string | null>(null);\n    const [galleryFiles, setGalleryFiles] = useState<File[]>([]);\n    const [galleryPreviews, setGalleryPreviews] = useState<string[]>([]);\n    const [uploadingImage, setUploadingImage] = useState(false);\n    \n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [tourProviders, setTourProviders] = useState<TourProvider[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Branches und TourProviders\n    useEffect(() => {\n        const loadData = async () => {\n            try {\n                setLoadingData(true);\n                const [branchesRes, providersRes] = await Promise.all([\n                    axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE),\n                    axiosInstance.get(API_ENDPOINTS.TOUR_PROVIDERS?.BASE || '/api/tour-providers')\n                ]);\n                \n                setBranches(branchesRes.data?.data || branchesRes.data || []);\n                setTourProviders(providersRes.data?.data || providersRes.data || []);\n            } catch (err: unknown) {\n                console.error('Error loading data:', err);\n                showMessage(t('errors.loadError'), 'error');\n            } finally {\n                setLoadingData(false);\n            }\n        };\n        \n        if (isOpen) {\n            loadData();\n        }\n    }, [isOpen, t, showMessage]);\n\n    // Responsive-Erkennung\n    useEffect(() => {\n        const checkScreenSize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        \n        checkScreenSize();\n        window.addEventListener('resize', checkScreenSize);\n        \n        return () => {\n            window.removeEventListener('resize', checkScreenSize);\n        };\n    }, []);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    // Reset form when modal opens/closes\n    useEffect(() => {\n        if (!isOpen) {\n            setTitle('');\n            setDescription('');\n            setType(TourType.OWN);\n            setIsActive(true);\n            setDuration('');\n            setMaxParticipants('');\n            setMinParticipants('');\n            setPrice('');\n            setCurrency('COP');\n            setLocation('');\n            setMeetingPoint('');\n            setIncludes('');\n            setExcludes('');\n            setRequirements('');\n            setTotalCommission('');\n            setTotalCommissionPercent('');\n            setSellerCommissionPercent('');\n            setSellerCommissionFixed('');\n            setExternalProviderId('');\n            setExternalBookingUrl('');\n            setBranchId('');\n            setImageFile(null);\n            setImagePreview(null);\n            setGalleryFiles([]);\n            setGalleryPreviews([]);\n            setError(null);\n        }\n    }, [isOpen]);\n    \n    // Bild-Vorschau erstellen\n    const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const file = e.target.files?.[0];\n        if (file) {\n            setImageFile(file);\n            const reader = new FileReader();\n            reader.onloadend = () => {\n                setImagePreview(reader.result as string);\n            };\n            reader.readAsDataURL(file);\n        }\n    };\n    \n    const handleGalleryChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const files = Array.from(e.target.files || []);\n        if (files.length > 0) {\n            setGalleryFiles(prev => [...prev, ...files]);\n            files.forEach(file => {\n                const reader = new FileReader();\n                reader.onloadend = () => {\n                    setGalleryPreviews(prev => [...prev, reader.result as string]);\n                };\n                reader.readAsDataURL(file);\n            });\n        }\n    };\n    \n    const removeGalleryImage = (index: number) => {\n        setGalleryFiles(prev => prev.filter((_, i) => i !== index));\n        setGalleryPreviews(prev => prev.filter((_, i) => i !== index));\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n\n        // Validierungen\n        if (!title.trim() || title.trim().length < 3) {\n            setError(t('tours.validation.titleMinLength', { defaultValue: 'Titel muss mindestens 3 Zeichen lang sein' }));\n            return;\n        }\n\n        const maxPart = maxParticipants ? Number(maxParticipants) : null;\n        const minPart = minParticipants ? Number(minParticipants) : null;\n        if (maxPart !== null && minPart !== null && maxPart < minPart) {\n            setError(t('tours.validation.maxParticipantsMin', { defaultValue: 'Maximale Teilnehmeranzahl muss >= minimale Teilnehmeranzahl sein' }));\n            return;\n        }\n\n        if (type === TourType.EXTERNAL && !externalProviderId) {\n            setError(t('tours.validation.externalProviderRequired', { defaultValue: 'Externer Anbieter ist bei externen Touren erforderlich' }));\n            return;\n        }\n\n        // availableFrom <= availableTo Validierung (falls beide gesetzt) - wird im Backend validiert\n\n        // Preise >= 0\n        if (price !== '' && Number(price) < 0) {\n            setError(t('tours.validation.priceNonNegative', { defaultValue: 'Preis muss >= 0 sein' }));\n            return;\n        }\n\n        if (totalCommission !== '' && Number(totalCommission) < 0) {\n            setError(t('tours.validation.commissionNonNegative', { defaultValue: 'Kommission muss >= 0 sein' }));\n            return;\n        }\n\n        setLoading(true);\n\n        try {\n            const tourData: {\n                title: string;\n                description: string | null;\n                type: TourType;\n                isActive: boolean;\n                duration: number | null;\n                maxParticipants: number | null;\n                minParticipants: number | null;\n                price: number | null;\n                currency: string;\n                location: string | null;\n                meetingPoint: string | null;\n                includes: string | null;\n                excludes: string | null;\n                requirements: string | null;\n                totalCommission: number | null;\n                totalCommissionPercent: number | null;\n                sellerCommissionPercent: number | null;\n                sellerCommissionFixed: number | null;\n                externalProviderId: number | null;\n                externalBookingUrl: string | null;\n                branchId: number | null;\n            } = {\n                title,\n                description: description || null,\n                type,\n                isActive,\n                duration: duration ? Number(duration) : null,\n                maxParticipants: maxParticipants ? Number(maxParticipants) : null,\n                minParticipants: minParticipants ? Number(minParticipants) : null,\n                price: price ? Number(price) : null,\n                currency: currency || 'COP',\n                location: location || null,\n                meetingPoint: meetingPoint || null,\n                includes: includes || null,\n                excludes: excludes || null,\n                requirements: requirements || null,\n                totalCommission: totalCommission ? Number(totalCommission) : null,\n                totalCommissionPercent: totalCommissionPercent ? Number(totalCommissionPercent) : null,\n                sellerCommissionPercent: sellerCommissionPercent ? Number(sellerCommissionPercent) : null,\n                sellerCommissionFixed: sellerCommissionFixed ? Number(sellerCommissionFixed) : null,\n                externalProviderId: externalProviderId ? Number(externalProviderId) : null,\n                externalBookingUrl: externalBookingUrl || null,\n                branchId: branchId ? Number(branchId) : null\n            };\n\n            const response = await axiosInstance.post(API_ENDPOINTS.TOURS.BASE, tourData);\n            \n            if (response.data.success) {\n                const createdTour = response.data.data;\n                \n                // Hauptbild hochladen (falls vorhanden)\n                if (imageFile && createdTour.id) {\n                    try {\n                        setUploadingImage(true);\n                        const formData = new FormData();\n                        formData.append('image', imageFile);\n                        await axiosInstance.post(API_ENDPOINTS.TOURS.UPLOAD_IMAGE(createdTour.id), formData, {\n                            headers: { 'Content-Type': 'multipart/form-data' }\n                        });\n                    } catch (imgErr: unknown) {\n                        console.error('Error uploading main image:', imgErr);\n                        showMessage(t('tours.imageUploadError', 'Tour erstellt, aber Fehler beim Hochladen des Bildes'), 'warning');\n                    } finally {\n                        setUploadingImage(false);\n                    }\n                }\n                \n                // Galerie-Bilder hochladen (falls vorhanden)\n                if (galleryFiles.length > 0 && createdTour.id) {\n                    try {\n                        setUploadingImage(true);\n                        for (const file of galleryFiles) {\n                            const formData = new FormData();\n                            formData.append('image', file);\n                            await axiosInstance.post(API_ENDPOINTS.TOURS.UPLOAD_GALLERY(createdTour.id), formData, {\n                                headers: { 'Content-Type': 'multipart/form-data' }\n                            });\n                        }\n                    } catch (galleryErr: unknown) {\n                        console.error('Error uploading gallery images:', galleryErr);\n                        showMessage(t('tours.galleryUploadError', 'Tour erstellt, aber Fehler beim Hochladen der Galerie-Bilder'), 'warning');\n                    } finally {\n                        setUploadingImage(false);\n                    }\n                }\n                \n                showMessage(t('tours.createSuccess', 'Tour erfolgreich erstellt'), 'success');\n                // Lade Tour neu, um Bilder zu erhalten\n                const updatedResponse = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(createdTour.id));\n                onTourCreated(updatedResponse.data.data);\n                handleClose();\n            } else {\n                setError(response.data.message || t('errors.saveError'));\n            }\n        } catch (err: unknown) {\n            console.error('Error creating tour:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('errors.saveError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleClose = () => {\n        setTitle('');\n        setDescription('');\n        setType(TourType.OWN);\n        setIsActive(true);\n        setDuration('');\n        setMaxParticipants('');\n        setMinParticipants('');\n        setPrice('');\n        setCurrency('COP');\n        setLocation('');\n        setMeetingPoint('');\n        setIncludes('');\n        setExcludes('');\n        setRequirements('');\n        setTotalCommission('');\n        setTotalCommissionPercent('');\n        setSellerCommissionPercent('');\n        setSellerCommissionFixed('');\n        setExternalProviderId('');\n        setExternalBookingUrl('');\n        setBranchId('');\n        setImageFile(null);\n        setImagePreview(null);\n        setGalleryFiles([]);\n        setGalleryPreviews([]);\n        setError(null);\n        onClose();\n    };\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                \n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] overflow-y-auto\">\n                        <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n                            <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white\">\n                                {t('tours.create', 'Neue Tour erstellen')}\n                            </Dialog.Title>\n                            <button\n                                onClick={handleClose}\n                                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200 px-4 py-3 rounded\">\n                                {error}\n                            </div>\n                        )}\n\n                        {/* Grundinformationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.basicInfo', 'Grundinformationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.name', 'Titel')} *\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={title}\n                                    onChange={(e) => setTitle(e.target.value)}\n                                    required\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.description', 'Beschreibung')}\n                                </label>\n                                <textarea\n                                    value={description}\n                                    onChange={(e) => setDescription(e.target.value)}\n                                    rows={4}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.type', 'Typ')} *\n                                    </label>\n                                    <select\n                                        value={type}\n                                        onChange={(e) => setType(e.target.value as TourType)}\n                                        required\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value={TourType.OWN}>{t('tours.typeOwn', 'Eigene Tour')}</option>\n                                        <option value={TourType.EXTERNAL}>{t('tours.typeExternal', 'Externe Tour')}</option>\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.status', 'Status')}\n                                    </label>\n                                    <select\n                                        value={isActive ? 'true' : 'false'}\n                                        onChange={(e) => setIsActive(e.target.value === 'true')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"true\">{t('tours.statusActive', 'Aktiv')}</option>\n                                        <option value=\"false\">{t('tours.statusInactive', 'Inaktiv')}</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.branch', 'Niederlassung')}\n                                </label>\n                                <select\n                                    value={branchId}\n                                    onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                >\n                                    <option value=\"\">{t('common.all', 'Alle')}</option>\n                                    {branches.map(branch => (\n                                        <option key={branch.id} value={branch.id}>{branch.name}</option>\n                                    ))}\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* Tour-Details */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.details', 'Tour-Details')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-3 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.duration', 'Dauer (Stunden)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={duration}\n                                        onChange={(e) => setDuration(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.minParticipants', 'Min. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={minParticipants}\n                                        onChange={(e) => setMinParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.maxParticipants', 'Max. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={maxParticipants}\n                                        onChange={(e) => setMaxParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.price', 'Preis')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={price}\n                                        onChange={(e) => setPrice(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.currency', 'Whrung')}\n                                    </label>\n                                    <input\n                                        type=\"text\"\n                                        value={currency}\n                                        onChange={(e) => setCurrency(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.location', 'Ort')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={location}\n                                    onChange={(e) => setLocation(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.meetingPoint', 'Treffpunkt')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={meetingPoint}\n                                    onChange={(e) => setMeetingPoint(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Externe Tour-Informationen */}\n                        {type === TourType.EXTERNAL && (\n                            <div className=\"space-y-4\">\n                                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                    {t('tours.externalInfo', 'Externe Tour-Informationen')}\n                                </h3>\n                                \n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalProvider', 'Externer Anbieter')}\n                                    </label>\n                                    <select\n                                        value={externalProviderId}\n                                        onChange={(e) => setExternalProviderId(e.target.value ? Number(e.target.value) : '')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"\">{t('common.select', 'Auswhlen')}</option>\n                                        {tourProviders.map(provider => (\n                                            <option key={provider.id} value={provider.id}>{provider.name}</option>\n                                        ))}\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalBookingUrl', 'Externe Buchungs-URL')}\n                                    </label>\n                                    <input\n                                        type=\"url\"\n                                        value={externalBookingUrl}\n                                        onChange={(e) => setExternalBookingUrl(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        )}\n\n                        {/* Kommissionen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.commissions', 'Kommissionen')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommission', 'Gesamtkommission')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommission}\n                                        onChange={(e) => setTotalCommission(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommissionPercent', 'Gesamtkommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommissionPercent}\n                                        onChange={(e) => setTotalCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionPercent', 'Verkufer-Kommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionPercent}\n                                        onChange={(e) => setSellerCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionFixed', 'Verkufer-Kommission (Fix)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionFixed}\n                                        onChange={(e) => setSellerCommissionFixed(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Zustzliche Informationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.additionalInfo', 'Zustzliche Informationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.includes', 'Enthlt')}\n                                </label>\n                                <textarea\n                                    value={includes}\n                                    onChange={(e) => setIncludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.excludes', 'Nicht enthalten')}\n                                </label>\n                                <textarea\n                                    value={excludes}\n                                    onChange={(e) => setExcludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.requirements', 'Anforderungen')}\n                                </label>\n                                <textarea\n                                    value={requirements}\n                                    onChange={(e) => setRequirements(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                            <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                                <button\n                                    type=\"button\"\n                                    onClick={handleClose}\n                                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                    title={t('common.cancel', 'Abbrechen')}\n                                >\n                                    <XMarkIcon className=\"h-5 w-5\" />\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    disabled={loading || loadingData}\n                                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                    title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                                >\n                                    <CheckIcon className=\"h-5 w-5\" />\n                                </button>\n                            </div>\n                        </form>\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n    \n    // Fr Desktop (ab 640px) - Sidepane\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                        {t('tours.create', 'Neue Tour erstellen')}\n                    </h2>\n                    <button\n                        onClick={handleClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    <form onSubmit={handleSubmit} className=\"space-y-6\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200 px-4 py-3 rounded\">\n                                {error}\n                            </div>\n                        )}\n\n                        {/* Grundinformationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.basicInfo', 'Grundinformationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.name', 'Titel')} *\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={title}\n                                    onChange={(e) => setTitle(e.target.value)}\n                                    required\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.description', 'Beschreibung')}\n                                </label>\n                                <textarea\n                                    value={description}\n                                    onChange={(e) => setDescription(e.target.value)}\n                                    rows={4}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.type', 'Typ')} *\n                                    </label>\n                                    <select\n                                        value={type}\n                                        onChange={(e) => setType(e.target.value as TourType)}\n                                        required\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value={TourType.OWN}>{t('tours.typeOwn', 'Eigene Tour')}</option>\n                                        <option value={TourType.EXTERNAL}>{t('tours.typeExternal', 'Externe Tour')}</option>\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.status', 'Status')}\n                                    </label>\n                                    <select\n                                        value={isActive ? 'true' : 'false'}\n                                        onChange={(e) => setIsActive(e.target.value === 'true')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"true\">{t('tours.statusActive', 'Aktiv')}</option>\n                                        <option value=\"false\">{t('tours.statusInactive', 'Inaktiv')}</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.branch', 'Niederlassung')}\n                                </label>\n                                <select\n                                    value={branchId}\n                                    onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                >\n                                    <option value=\"\">{t('common.all', 'Alle')}</option>\n                                    {branches.map(branch => (\n                                        <option key={branch.id} value={branch.id}>{branch.name}</option>\n                                    ))}\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* Tour-Details */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.details', 'Tour-Details')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-3 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.duration', 'Dauer (Stunden)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={duration}\n                                        onChange={(e) => setDuration(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.minParticipants', 'Min. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={minParticipants}\n                                        onChange={(e) => setMinParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.maxParticipants', 'Max. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={maxParticipants}\n                                        onChange={(e) => setMaxParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.price', 'Preis')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={price}\n                                        onChange={(e) => setPrice(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.currency', 'Whrung')}\n                                    </label>\n                                    <input\n                                        type=\"text\"\n                                        value={currency}\n                                        onChange={(e) => setCurrency(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.location', 'Ort')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={location}\n                                    onChange={(e) => setLocation(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.meetingPoint', 'Treffpunkt')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={meetingPoint}\n                                    onChange={(e) => setMeetingPoint(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Externe Tour-Informationen */}\n                        {type === TourType.EXTERNAL && (\n                            <div className=\"space-y-4\">\n                                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                    {t('tours.externalInfo', 'Externe Tour-Informationen')}\n                                </h3>\n                                \n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalProvider', 'Externer Anbieter')}\n                                    </label>\n                                    <select\n                                        value={externalProviderId}\n                                        onChange={(e) => setExternalProviderId(e.target.value ? Number(e.target.value) : '')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"\">{t('common.select', 'Auswhlen')}</option>\n                                        {tourProviders.map(provider => (\n                                            <option key={provider.id} value={provider.id}>{provider.name}</option>\n                                        ))}\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalBookingUrl', 'Externe Buchungs-URL')}\n                                    </label>\n                                    <input\n                                        type=\"url\"\n                                        value={externalBookingUrl}\n                                        onChange={(e) => setExternalBookingUrl(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        )}\n\n                        {/* Kommissionen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.commissions', 'Kommissionen')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommission', 'Gesamtkommission')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommission}\n                                        onChange={(e) => setTotalCommission(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommissionPercent', 'Gesamtkommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommissionPercent}\n                                        onChange={(e) => setTotalCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionPercent', 'Verkufer-Kommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionPercent}\n                                        onChange={(e) => setSellerCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionFixed', 'Verkufer-Kommission (Fix)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionFixed}\n                                        onChange={(e) => setSellerCommissionFixed(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Zustzliche Informationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.additionalInfo', 'Zustzliche Informationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.includes', 'Enthlt')}\n                                </label>\n                                <textarea\n                                    value={includes}\n                                    onChange={(e) => setIncludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.excludes', 'Nicht enthalten')}\n                                </label>\n                                <textarea\n                                    value={excludes}\n                                    onChange={(e) => setExcludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.requirements', 'Anforderungen')}\n                                </label>\n                                <textarea\n                                    value={requirements}\n                                    onChange={(e) => setRequirements(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Bilder */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.images', 'Bilder')}\n                            </h3>\n                            \n                            {/* Hauptbild */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.mainImage', 'Hauptbild')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    onChange={handleImageChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {imagePreview && (\n                                    <div className=\"mt-2 relative inline-block\">\n                                        <img\n                                            src={imagePreview}\n                                            alt=\"Vorschau\"\n                                            className=\"max-w-xs h-48 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                        />\n                                    </div>\n                                )}\n                            </div>\n                            \n                            {/* Galerie */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.gallery', 'Galerie')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    multiple\n                                    onChange={handleGalleryChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {galleryPreviews.length > 0 && (\n                                    <div className=\"mt-2 grid grid-cols-3 gap-2\">\n                                        {galleryPreviews.map((preview, index) => (\n                                            <div key={index} className=\"relative\">\n                                                <img\n                                                    src={preview}\n                                                    alt={`Galerie ${index + 1}`}\n                                                    className=\"w-full h-24 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                                />\n                                                <button\n                                                    type=\"button\"\n                                                    onClick={() => removeGalleryImage(index)}\n                                                    className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 z-10 shadow-lg\"\n                                                    title={t('tours.deleteImage', 'Bild lschen')}\n                                                >\n                                                    <XMarkIcon className=\"h-4 w-4\" />\n                                                </button>\n                                            </div>\n                                        ))}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={handleClose}\n                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                title={t('common.cancel', 'Abbrechen')}\n                            >\n                                <XMarkIcon className=\"h-5 w-5\" />\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData}\n                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            >\n                                <CheckIcon className=\"h-5 w-5\" />\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport default CreateTourModal;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS, getTourImageUrl, getTourGalleryImageUrl } from '../../config/api.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { Tour, TourType, TourProvider } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface EditTourModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onTourUpdated: (updatedTour: Tour) => void;\n    tour: Tour | null;\n}\n\nconst EditTourModal = ({ isOpen, onClose, onTourUpdated, tour }: EditTourModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { showMessage } = useMessage();\n    const { openSidepane, closeSidepane } = useSidepane();\n    \n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    const [title, setTitle] = useState(tour?.title || '');\n    const [description, setDescription] = useState(tour?.description || '');\n    const [type, setType] = useState<TourType>(tour?.type || TourType.OWN);\n    const [isActive, setIsActive] = useState(tour?.isActive ?? true);\n    const [duration, setDuration] = useState<number | ''>(tour?.duration || '');\n    const [maxParticipants, setMaxParticipants] = useState<number | ''>(tour?.maxParticipants || '');\n    const [minParticipants, setMinParticipants] = useState<number | ''>(tour?.minParticipants || '');\n    const [price, setPrice] = useState<number | ''>(tour?.price ? (typeof tour.price === 'string' ? parseFloat(tour.price) : tour.price) : '');\n    const [currency, setCurrency] = useState(tour?.currency || 'COP');\n    const [location, setLocation] = useState(tour?.location || '');\n    const [meetingPoint, setMeetingPoint] = useState(tour?.meetingPoint || '');\n    const [includes, setIncludes] = useState(tour?.includes || '');\n    const [excludes, setExcludes] = useState(tour?.excludes || '');\n    const [requirements, setRequirements] = useState(tour?.requirements || '');\n    const [totalCommission, setTotalCommission] = useState<number | ''>(tour?.totalCommission ? (typeof tour.totalCommission === 'string' ? parseFloat(tour.totalCommission) : tour.totalCommission) : '');\n    const [totalCommissionPercent, setTotalCommissionPercent] = useState<number | ''>(tour?.totalCommissionPercent ? (typeof tour.totalCommissionPercent === 'string' ? parseFloat(tour.totalCommissionPercent) : tour.totalCommissionPercent) : '');\n    const [sellerCommissionPercent, setSellerCommissionPercent] = useState<number | ''>(tour?.sellerCommissionPercent ? (typeof tour.sellerCommissionPercent === 'string' ? parseFloat(tour.sellerCommissionPercent) : tour.sellerCommissionPercent) : '');\n    const [sellerCommissionFixed, setSellerCommissionFixed] = useState<number | ''>(tour?.sellerCommissionFixed ? (typeof tour.sellerCommissionFixed === 'string' ? parseFloat(tour.sellerCommissionFixed) : tour.sellerCommissionFixed) : '');\n    const [externalProviderId, setExternalProviderId] = useState<number | ''>(tour?.externalProviderId || '');\n    const [externalBookingUrl, setExternalBookingUrl] = useState(tour?.externalBookingUrl || '');\n    const [branchId, setBranchId] = useState<number | ''>(tour?.branchId || '');\n    const [imageFile, setImageFile] = useState<File | null>(null);\n    const [imagePreview, setImagePreview] = useState<string | null>(tour?.imageUrl ? getTourImageUrl(tour.id) : null);\n    const [galleryFiles, setGalleryFiles] = useState<File[]>([]);\n    const [galleryPreviews, setGalleryPreviews] = useState<string[]>(tour?.galleryUrls?.map((url, index) => getTourGalleryImageUrl(tour.id, index)) || []);\n    const [uploadingImage, setUploadingImage] = useState(false);\n    \n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [tourProviders, setTourProviders] = useState<TourProvider[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [loadingData, setLoadingData] = useState(true);\n\n    // Lade Branches und TourProviders\n    useEffect(() => {\n        const loadData = async () => {\n            try {\n                setLoadingData(true);\n                const [branchesRes, providersRes] = await Promise.all([\n                    axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE),\n                    axiosInstance.get(API_ENDPOINTS.TOUR_PROVIDERS?.BASE || '/api/tour-providers')\n                ]);\n                \n                setBranches(branchesRes.data?.data || branchesRes.data || []);\n                setTourProviders(providersRes.data?.data || providersRes.data || []);\n            } catch (err: unknown) {\n                console.error('Error loading data:', err);\n                showMessage(t('errors.loadError'), 'error');\n            } finally {\n                setLoadingData(false);\n            }\n        };\n        \n        if (isOpen) {\n            loadData();\n        }\n    }, [isOpen, t, showMessage]);\n\n    // Responsive-Erkennung\n    useEffect(() => {\n        const checkScreenSize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        \n        checkScreenSize();\n        window.addEventListener('resize', checkScreenSize);\n        \n        return () => {\n            window.removeEventListener('resize', checkScreenSize);\n        };\n    }, []);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    // Update form when tour changes\n    useEffect(() => {\n        if (tour) {\n            setTitle(tour.title || '');\n            setDescription(tour.description || '');\n            setType(tour.type || TourType.OWN);\n            setIsActive(tour.isActive ?? true);\n            setDuration(tour.duration || '');\n            setMaxParticipants(tour.maxParticipants || '');\n            setMinParticipants(tour.minParticipants || '');\n            setPrice(tour.price ? (typeof tour.price === 'string' ? parseFloat(tour.price) : tour.price) : '');\n            setCurrency(tour.currency || 'COP');\n            setLocation(tour.location || '');\n            setMeetingPoint(tour.meetingPoint || '');\n            setIncludes(tour.includes || '');\n            setExcludes(tour.excludes || '');\n            setRequirements(tour.requirements || '');\n            setTotalCommission(tour.totalCommission ? (typeof tour.totalCommission === 'string' ? parseFloat(tour.totalCommission) : tour.totalCommission) : '');\n            setTotalCommissionPercent(tour.totalCommissionPercent ? (typeof tour.totalCommissionPercent === 'string' ? parseFloat(tour.totalCommissionPercent) : tour.totalCommissionPercent) : '');\n            setSellerCommissionPercent(tour.sellerCommissionPercent ? (typeof tour.sellerCommissionPercent === 'string' ? parseFloat(tour.sellerCommissionPercent) : tour.sellerCommissionPercent) : '');\n            setSellerCommissionFixed(tour.sellerCommissionFixed ? (typeof tour.sellerCommissionFixed === 'string' ? parseFloat(tour.sellerCommissionFixed) : tour.sellerCommissionFixed) : '');\n            setExternalProviderId(tour.externalProviderId || '');\n            setExternalBookingUrl(tour.externalBookingUrl || '');\n            setBranchId(tour.branchId || '');\n            setImagePreview(tour.imageUrl ? getTourImageUrl(tour.id) : null);\n            setGalleryPreviews(tour.galleryUrls?.map((url, index) => getTourGalleryImageUrl(tour.id, index)) || []);\n        }\n    }, [tour]);\n    \n    // Bild-Vorschau erstellen\n    const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const file = e.target.files?.[0];\n        if (file) {\n            setImageFile(file);\n            const reader = new FileReader();\n            reader.onloadend = () => {\n                setImagePreview(reader.result as string);\n            };\n            reader.readAsDataURL(file);\n        }\n    };\n    \n    const handleGalleryChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const files = Array.from(e.target.files || []);\n        if (files.length > 0) {\n            setGalleryFiles(prev => [...prev, ...files]);\n            files.forEach(file => {\n                const reader = new FileReader();\n                reader.onloadend = () => {\n                    setGalleryPreviews(prev => [...prev, reader.result as string]);\n                };\n                reader.readAsDataURL(file);\n            });\n        }\n    };\n    \n    const removeMainImage = async () => {\n        if (!tour?.imageUrl) return;\n        \n        try {\n            await axiosInstance.delete(API_ENDPOINTS.TOURS.DELETE_IMAGE(tour.id));\n            // Sofort lokale States aktualisieren (UI-Update)\n            setImagePreview(null);\n            setImageFile(null);\n            // Lade Tour neu fr Datenbank-Sync\n            const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(tour.id));\n            if (response.data.success) {\n                onTourUpdated(response.data.data);\n                showMessage(t('tours.imageDeleted', 'Hauptbild erfolgreich gelscht'), 'success');\n            }\n        } catch (err: unknown) {\n            console.error('Error deleting main image:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } } })?.response?.data?.message || t('errors.deleteError');\n            showMessage(errorMessage, 'error');\n        }\n    };\n    \n    const removeGalleryImage = async (index: number) => {\n        if (!tour) return;\n        // Wenn es ein existierendes Bild ist (aus tour.galleryUrls), lsche es vom Server\n        const currentGallery = tour.galleryUrls || [];\n        if (index < currentGallery.length) {\n            try {\n                await axiosInstance.delete(API_ENDPOINTS.TOURS.DELETE_GALLERY_IMAGE(tour.id, index));\n                // Sofort lokale States aktualisieren (UI-Update)\n                setGalleryPreviews(prev => prev.filter((_, i) => i !== index));\n                // Lade Tour neu fr Datenbank-Sync\n                const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(tour.id));\n                if (response.data.success) {\n                    onTourUpdated(response.data.data);\n                    showMessage(t('tours.galleryImageDeleted', 'Galerie-Bild erfolgreich gelscht'), 'success');\n                }\n            } catch (err: unknown) {\n                console.error('Error deleting gallery image:', err);\n                const errorMessage = (err as { response?: { data?: { message?: string } } })?.response?.data?.message || t('errors.deleteError');\n                showMessage(errorMessage, 'error');\n            }\n        } else {\n            // Wenn es ein neues Bild ist (noch nicht hochgeladen), entferne es nur aus dem State\n            const newIndex = index - currentGallery.length;\n            setGalleryFiles(prev => prev.filter((_, i) => i !== newIndex));\n            setGalleryPreviews(prev => prev.filter((_, i) => i !== index));\n        }\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n\n        // Validierungen\n        if (!title.trim() || title.trim().length < 3) {\n            setError(t('tours.validation.titleMinLength', { defaultValue: 'Titel muss mindestens 3 Zeichen lang sein' }));\n            return;\n        }\n\n        const maxPart = maxParticipants ? Number(maxParticipants) : null;\n        const minPart = minParticipants ? Number(minParticipants) : null;\n        if (maxPart !== null && minPart !== null && maxPart < minPart) {\n            setError(t('tours.validation.maxParticipantsMin', { defaultValue: 'Maximale Teilnehmeranzahl muss >= minimale Teilnehmeranzahl sein' }));\n            return;\n        }\n\n        if (type === TourType.EXTERNAL && !externalProviderId) {\n            setError(t('tours.validation.externalProviderRequired', { defaultValue: 'Externer Anbieter ist bei externen Touren erforderlich' }));\n            return;\n        }\n\n        // Preise >= 0\n        if (price !== '' && Number(price) < 0) {\n            setError(t('tours.validation.priceNonNegative', { defaultValue: 'Preis muss >= 0 sein' }));\n            return;\n        }\n\n        if (totalCommission !== '' && Number(totalCommission) < 0) {\n            setError(t('tours.validation.commissionNonNegative', { defaultValue: 'Kommission muss >= 0 sein' }));\n            return;\n        }\n\n        setLoading(true);\n\n        try {\n            const tourData: Partial<Tour> & {\n                imageFile?: File | null;\n                galleryFiles?: File[];\n            } = {\n                title,\n                description: description || null,\n                type,\n                isActive,\n                duration: duration ? Number(duration) : null,\n                maxParticipants: maxParticipants ? Number(maxParticipants) : null,\n                minParticipants: minParticipants ? Number(minParticipants) : null,\n                price: price ? Number(price) : null,\n                currency: currency || 'COP',\n                location: location || null,\n                meetingPoint: meetingPoint || null,\n                includes: includes || null,\n                excludes: excludes || null,\n                requirements: requirements || null,\n                totalCommission: totalCommission ? Number(totalCommission) : null,\n                totalCommissionPercent: totalCommissionPercent ? Number(totalCommissionPercent) : null,\n                sellerCommissionPercent: sellerCommissionPercent ? Number(sellerCommissionPercent) : null,\n                sellerCommissionFixed: sellerCommissionFixed ? Number(sellerCommissionFixed) : null,\n                externalProviderId: externalProviderId ? Number(externalProviderId) : null,\n                externalBookingUrl: externalBookingUrl || null,\n                branchId: branchId ? Number(branchId) : null\n            };\n\n            const response = await axiosInstance.put(API_ENDPOINTS.TOURS.BY_ID(tour.id), tourData);\n            \n            if (response.data.success) {\n                const updatedTour = response.data.data;\n                \n                // Hauptbild hochladen (falls gendert)\n                if (imageFile) {\n                    try {\n                        setUploadingImage(true);\n                        const formData = new FormData();\n                        formData.append('image', imageFile);\n                        await axiosInstance.post(API_ENDPOINTS.TOURS.UPLOAD_IMAGE(tourId), formData, {\n                            headers: { 'Content-Type': 'multipart/form-data' }\n                        });\n                    } catch (imgErr: unknown) {\n                        console.error('Error uploading main image:', imgErr);\n                        showMessage(t('tours.imageUploadError', 'Tour aktualisiert, aber Fehler beim Hochladen des Bildes'), 'warning');\n                    } finally {\n                        setUploadingImage(false);\n                    }\n                }\n                \n                // Neue Galerie-Bilder hochladen (falls vorhanden)\n                if (galleryFiles.length > 0) {\n                    try {\n                        setUploadingImage(true);\n                        for (const file of galleryFiles) {\n                            const formData = new FormData();\n                            formData.append('image', file);\n                            await axiosInstance.post(API_ENDPOINTS.TOURS.UPLOAD_GALLERY(tourId), formData, {\n                                headers: { 'Content-Type': 'multipart/form-data' }\n                            });\n                        }\n                    } catch (galleryErr: unknown) {\n                        console.error('Error uploading gallery images:', galleryErr);\n                        showMessage(t('tours.galleryUploadError', 'Tour aktualisiert, aber Fehler beim Hochladen der Galerie-Bilder'), 'warning');\n                    } finally {\n                        setUploadingImage(false);\n                    }\n                }\n                \n                showMessage(t('tours.updateSuccess', 'Tour erfolgreich aktualisiert'), 'success');\n                // Lade Tour neu, um aktualisierte Bilder zu erhalten\n                const updatedResponse = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(tourId));\n                onTourUpdated(updatedResponse.data.data);\n                handleClose();\n            } else {\n                setError(response.data.message || t('errors.saveError'));\n            }\n        } catch (err: unknown) {\n            console.error('Error updating tour:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('errors.saveError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleClose = () => {\n        onClose();\n    };\n\n    if (!tour) return null;\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                \n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] overflow-y-auto\">\n                        <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n                            <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white\">\n                                {t('tours.edit', 'Tour bearbeiten')}\n                            </Dialog.Title>\n                            <button\n                                onClick={handleClose}\n                                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200 px-4 py-3 rounded\">\n                                {error}\n                            </div>\n                        )}\n\n                        {/* Grundinformationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.basicInfo', 'Grundinformationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.name', 'Titel')} *\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={title}\n                                    onChange={(e) => setTitle(e.target.value)}\n                                    required\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.description', 'Beschreibung')}\n                                </label>\n                                <textarea\n                                    value={description}\n                                    onChange={(e) => setDescription(e.target.value)}\n                                    rows={4}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.type', 'Typ')} *\n                                    </label>\n                                    <select\n                                        value={type}\n                                        onChange={(e) => setType(e.target.value as TourType)}\n                                        required\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value={TourType.OWN}>{t('tours.typeOwn', 'Eigene Tour')}</option>\n                                        <option value={TourType.EXTERNAL}>{t('tours.typeExternal', 'Externe Tour')}</option>\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.status', 'Status')}\n                                    </label>\n                                    <select\n                                        value={isActive ? 'true' : 'false'}\n                                        onChange={(e) => setIsActive(e.target.value === 'true')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"true\">{t('tours.statusActive', 'Aktiv')}</option>\n                                        <option value=\"false\">{t('tours.statusInactive', 'Inaktiv')}</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.branch', 'Niederlassung')}\n                                </label>\n                                <select\n                                    value={branchId}\n                                    onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                >\n                                    <option value=\"\">{t('common.all', 'Alle')}</option>\n                                    {branches.map(branch => (\n                                        <option key={branch.id} value={branch.id}>{branch.name}</option>\n                                    ))}\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* Tour-Details */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.details', 'Tour-Details')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-3 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.duration', 'Dauer (Stunden)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={duration}\n                                        onChange={(e) => setDuration(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.minParticipants', 'Min. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={minParticipants}\n                                        onChange={(e) => setMinParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.maxParticipants', 'Max. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={maxParticipants}\n                                        onChange={(e) => setMaxParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.price', 'Preis')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={price}\n                                        onChange={(e) => setPrice(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.currency', 'Whrung')}\n                                    </label>\n                                    <input\n                                        type=\"text\"\n                                        value={currency}\n                                        onChange={(e) => setCurrency(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.location', 'Ort')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={location}\n                                    onChange={(e) => setLocation(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.meetingPoint', 'Treffpunkt')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={meetingPoint}\n                                    onChange={(e) => setMeetingPoint(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Externe Tour-Informationen */}\n                        {type === TourType.EXTERNAL && (\n                            <div className=\"space-y-4\">\n                                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                    {t('tours.externalInfo', 'Externe Tour-Informationen')}\n                                </h3>\n                                \n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalProvider', 'Externer Anbieter')}\n                                    </label>\n                                    <select\n                                        value={externalProviderId}\n                                        onChange={(e) => setExternalProviderId(e.target.value ? Number(e.target.value) : '')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"\">{t('common.select', 'Auswhlen')}</option>\n                                        {tourProviders.map(provider => (\n                                            <option key={provider.id} value={provider.id}>{provider.name}</option>\n                                        ))}\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalBookingUrl', 'Externe Buchungs-URL')}\n                                    </label>\n                                    <input\n                                        type=\"url\"\n                                        value={externalBookingUrl}\n                                        onChange={(e) => setExternalBookingUrl(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        )}\n\n                        {/* Kommissionen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.commissions', 'Kommissionen')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommission', 'Gesamtkommission')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommission}\n                                        onChange={(e) => setTotalCommission(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommissionPercent', 'Gesamtkommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommissionPercent}\n                                        onChange={(e) => setTotalCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionPercent', 'Verkufer-Kommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionPercent}\n                                        onChange={(e) => setSellerCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionFixed', 'Verkufer-Kommission (Fix)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionFixed}\n                                        onChange={(e) => setSellerCommissionFixed(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Zustzliche Informationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.additionalInfo', 'Zustzliche Informationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.includes', 'Enthlt')}\n                                </label>\n                                <textarea\n                                    value={includes}\n                                    onChange={(e) => setIncludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.excludes', 'Nicht enthalten')}\n                                </label>\n                                <textarea\n                                    value={excludes}\n                                    onChange={(e) => setExcludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.requirements', 'Anforderungen')}\n                                </label>\n                                <textarea\n                                    value={requirements}\n                                    onChange={(e) => setRequirements(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Bild-Upload */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.images', 'Bilder')}\n                            </h3>\n                            \n                            {/* Hauptbild */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.mainImage', 'Hauptbild')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    onChange={handleImageChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {imagePreview && (\n                                    <div className=\"mt-2 relative inline-block\">\n                                        <img\n                                            src={imagePreview}\n                                            alt=\"Vorschau\"\n                                            className=\"max-w-xs h-48 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                        />\n                                        {tour?.imageUrl && (\n                                            <button\n                                                type=\"button\"\n                                                onClick={removeMainImage}\n                                                className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 z-10 shadow-lg\"\n                                                title={t('tours.deleteImage', 'Hauptbild lschen')}\n                                            >\n                                                <XMarkIcon className=\"h-4 w-4\" />\n                                            </button>\n                                        )}\n                                    </div>\n                                )}\n                            </div>\n                            \n                            {/* Galerie */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.gallery', 'Galerie')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    multiple\n                                    onChange={handleGalleryChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {galleryPreviews.length > 0 && (\n                                    <div className=\"mt-2 grid grid-cols-3 gap-2\">\n                                        {galleryPreviews.map((preview, index) => (\n                                            <div key={index} className=\"relative\">\n                                                <img\n                                                    src={preview}\n                                                    alt={`Galerie ${index + 1}`}\n                                                    className=\"w-full h-32 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                                />\n                                                <button\n                                                    type=\"button\"\n                                                    onClick={() => removeGalleryImage(index)}\n                                                    className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600\"\n                                                >\n                                                    <XMarkIcon className=\"h-4 w-4\" />\n                                                </button>\n                                            </div>\n                                        ))}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                            <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                                <button\n                                    type=\"button\"\n                                    onClick={handleClose}\n                                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                    title={t('common.cancel', 'Abbrechen')}\n                                >\n                                    <XMarkIcon className=\"h-5 w-5\" />\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    disabled={loading || loadingData || uploadingImage}\n                                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                    title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                                >\n                                    <CheckIcon className=\"h-5 w-5\" />\n                                </button>\n                            </div>\n                        </form>\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n    \n    // Fr Desktop (ab 640px) - Sidepane\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                        {t('tours.edit', 'Tour bearbeiten')}\n                    </h2>\n                    <button\n                        onClick={handleClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    <form onSubmit={handleSubmit} className=\"space-y-6\">\n                        {error && (\n                            <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200 px-4 py-3 rounded\">\n                                {error}\n                            </div>\n                        )}\n\n                        {/* Grundinformationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.basicInfo', 'Grundinformationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.name', 'Titel')} *\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={title}\n                                    onChange={(e) => setTitle(e.target.value)}\n                                    required\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.description', 'Beschreibung')}\n                                </label>\n                                <textarea\n                                    value={description}\n                                    onChange={(e) => setDescription(e.target.value)}\n                                    rows={4}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.type', 'Typ')} *\n                                    </label>\n                                    <select\n                                        value={type}\n                                        onChange={(e) => setType(e.target.value as TourType)}\n                                        required\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value={TourType.OWN}>{t('tours.typeOwn', 'Eigene Tour')}</option>\n                                        <option value={TourType.EXTERNAL}>{t('tours.typeExternal', 'Externe Tour')}</option>\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.status', 'Status')}\n                                    </label>\n                                    <select\n                                        value={isActive ? 'true' : 'false'}\n                                        onChange={(e) => setIsActive(e.target.value === 'true')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"true\">{t('tours.statusActive', 'Aktiv')}</option>\n                                        <option value=\"false\">{t('tours.statusInactive', 'Inaktiv')}</option>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.branch', 'Niederlassung')}\n                                </label>\n                                <select\n                                    value={branchId}\n                                    onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                >\n                                    <option value=\"\">{t('common.all', 'Alle')}</option>\n                                    {branches.map(branch => (\n                                        <option key={branch.id} value={branch.id}>{branch.name}</option>\n                                    ))}\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* Tour-Details */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.details', 'Tour-Details')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-3 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.duration', 'Dauer (Stunden)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={duration}\n                                        onChange={(e) => setDuration(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.minParticipants', 'Min. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={minParticipants}\n                                        onChange={(e) => setMinParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.maxParticipants', 'Max. Teilnehmer')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={maxParticipants}\n                                        onChange={(e) => setMaxParticipants(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.price', 'Preis')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={price}\n                                        onChange={(e) => setPrice(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.currency', 'Whrung')}\n                                    </label>\n                                    <input\n                                        type=\"text\"\n                                        value={currency}\n                                        onChange={(e) => setCurrency(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.location', 'Ort')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={location}\n                                    onChange={(e) => setLocation(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.meetingPoint', 'Treffpunkt')}\n                                </label>\n                                <input\n                                    type=\"text\"\n                                    value={meetingPoint}\n                                    onChange={(e) => setMeetingPoint(e.target.value)}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Externe Tour-Informationen */}\n                        {type === TourType.EXTERNAL && (\n                            <div className=\"space-y-4\">\n                                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                    {t('tours.externalInfo', 'Externe Tour-Informationen')}\n                                </h3>\n                                \n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalProvider', 'Externer Anbieter')}\n                                    </label>\n                                    <select\n                                        value={externalProviderId}\n                                        onChange={(e) => setExternalProviderId(e.target.value ? Number(e.target.value) : '')}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    >\n                                        <option value=\"\">{t('common.select', 'Auswhlen')}</option>\n                                        {tourProviders.map(provider => (\n                                            <option key={provider.id} value={provider.id}>{provider.name}</option>\n                                        ))}\n                                    </select>\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.externalBookingUrl', 'Externe Buchungs-URL')}\n                                    </label>\n                                    <input\n                                        type=\"url\"\n                                        value={externalBookingUrl}\n                                        onChange={(e) => setExternalBookingUrl(e.target.value)}\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        )}\n\n                        {/* Kommissionen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.commissions', 'Kommissionen')}\n                            </h3>\n                            \n                            <div className=\"grid grid-cols-2 gap-4\">\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommission', 'Gesamtkommission')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommission}\n                                        onChange={(e) => setTotalCommission(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.totalCommissionPercent', 'Gesamtkommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={totalCommissionPercent}\n                                        onChange={(e) => setTotalCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionPercent', 'Verkufer-Kommission (%)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionPercent}\n                                        onChange={(e) => setSellerCommissionPercent(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        max=\"100\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                        {t('tours.sellerCommissionFixed', 'Verkufer-Kommission (Fix)')}\n                                    </label>\n                                    <input\n                                        type=\"number\"\n                                        value={sellerCommissionFixed}\n                                        onChange={(e) => setSellerCommissionFixed(e.target.value ? Number(e.target.value) : '')}\n                                        min=\"0\"\n                                        step=\"0.01\"\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                    />\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Zustzliche Informationen */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.additionalInfo', 'Zustzliche Informationen')}\n                            </h3>\n                            \n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.includes', 'Enthlt')}\n                                </label>\n                                <textarea\n                                    value={includes}\n                                    onChange={(e) => setIncludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.excludes', 'Nicht enthalten')}\n                                </label>\n                                <textarea\n                                    value={excludes}\n                                    onChange={(e) => setExcludes(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.requirements', 'Anforderungen')}\n                                </label>\n                                <textarea\n                                    value={requirements}\n                                    onChange={(e) => setRequirements(e.target.value)}\n                                    rows={3}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                            </div>\n                        </div>\n\n                        {/* Bilder */}\n                        <div className=\"space-y-4\">\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                                {t('tours.images', 'Bilder')}\n                            </h3>\n                            \n                            {/* Hauptbild */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.mainImage', 'Hauptbild')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    onChange={handleImageChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {imagePreview && (\n                                    <div className=\"mt-2 relative inline-block\">\n                                        <img\n                                            src={imagePreview}\n                                            alt=\"Vorschau\"\n                                            className=\"max-w-xs h-48 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                        />\n                                        {tour?.imageUrl && (\n                                            <button\n                                                type=\"button\"\n                                                onClick={removeMainImage}\n                                                className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 z-10 shadow-lg\"\n                                                title={t('tours.deleteImage', 'Hauptbild lschen')}\n                                            >\n                                                <XMarkIcon className=\"h-4 w-4\" />\n                                            </button>\n                                        )}\n                                    </div>\n                                )}\n                            </div>\n                            \n                            {/* Galerie */}\n                            <div>\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                                    {t('tours.gallery', 'Galerie')}\n                                </label>\n                                <input\n                                    type=\"file\"\n                                    accept=\"image/*\"\n                                    multiple\n                                    onChange={handleGalleryChange}\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                                />\n                                {galleryPreviews.length > 0 && (\n                                    <div className=\"mt-2 grid grid-cols-3 gap-2\">\n                                        {galleryPreviews.map((preview, index) => (\n                                            <div key={index} className=\"relative\">\n                                                <img\n                                                    src={preview}\n                                                    alt={`Galerie ${index + 1}`}\n                                                    className=\"w-full h-24 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\n                                                />\n                                                <button\n                                                    type=\"button\"\n                                                    onClick={() => removeGalleryImage(index)}\n                                                    className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 z-10 shadow-lg\"\n                                                    title={t('tours.deleteImage', 'Bild lschen')}\n                                                >\n                                                    <XMarkIcon className=\"h-4 w-4\" />\n                                                </button>\n                                            </div>\n                                        ))}\n                                    </div>\n                                )}\n                            </div>\n                        </div>\n\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                            <button\n                                type=\"button\"\n                                onClick={handleClose}\n                                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                title={t('common.cancel', 'Abbrechen')}\n                            >\n                                <XMarkIcon className=\"h-5 w-5\" />\n                            </button>\n                            <button\n                                type=\"submit\"\n                                disabled={loading || loadingData || uploadingImage}\n                                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                                title={loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\n                            >\n                                <CheckIcon className=\"h-5 w-5\" />\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport default EditTourModal;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, MapPinIcon, ClockIcon, UsersIcon, CurrencyDollarIcon, BuildingOfficeIcon, UserIcon, PlusIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { Tour, TourType, TourBooking } from '../../types/tour.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { format } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport CreateTourBookingModal from './CreateTourBookingModal.tsx';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\n\ninterface TourDetailsModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    tourId: number;\n    onTourUpdated?: (updatedTour: Tour) => void;\n}\n\nconst TourDetailsModal = ({ isOpen, onClose, tourId, onTourUpdated }: TourDetailsModalProps) => {\n    const { t } = useTranslation();\n    const { showMessage } = useMessage();\n    const { hasPermission } = usePermissions();\n    const [tour, setTour] = useState<Tour | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n    const [isCreateBookingModalOpen, setIsCreateBookingModalOpen] = useState(false);\n\n    useEffect(() => {\n        if (isOpen && tourId) {\n            loadTour();\n        }\n    }, [isOpen, tourId]);\n\n    const loadTour = async () => {\n        try {\n            setLoading(true);\n            setError(null);\n            const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(tourId));\n            if (response.data.success) {\n                setTour(response.data.data);\n            } else {\n                setError(response.data.message || t('errors.loadError'));\n            }\n        } catch (err: unknown) {\n            console.error('Error loading tour:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } } })?.response?.data?.message || t('errors.loadError');\n            setError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    if (!isOpen) return null;\n\n    return (\n        <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] overflow-y-auto\">\n                    <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n                        <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white\">\n                            {t('tours.details', 'Tour-Details')}\n                        </Dialog.Title>\n                        <div className=\"flex items-center gap-3\">\n                            {hasPermission('tour_bookings', 'write', 'table') && tour && tour.isActive && (\n                                <div className=\"relative group\">\n                                    <button\n                                        onClick={() => setIsCreateBookingModalOpen(true)}\n                                        className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                                        style={{ width: '30.19px', height: '30.19px' }}\n                                        aria-label={t('tourBookings.create', 'Buchung erstellen')}\n                                    >\n                                        <PlusIcon className=\"h-4 w-4\" />\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                        {t('tourBookings.create', 'Buchung erstellen')}\n                                    </div>\n                                </div>\n                            )}\n                            <button\n                                onClick={onClose}\n                                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n                    </div>\n\n                    <div className=\"p-6\">\n                        {loading ? (\n                            <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                                {t('common.loading')}\n                            </div>\n                        ) : error ? (\n                            <div className=\"text-center py-8 text-red-500 dark:text-red-400\">\n                                {error}\n                            </div>\n                        ) : !tour ? (\n                            <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                                {t('tours.notFound', 'Tour nicht gefunden')}\n                            </div>\n                        ) : (\n                            <div className=\"space-y-6\">\n                                {/* Header */}\n                                <div>\n                                    <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-2\">\n                                        {tour.title || '-'}\n                                    </h2>\n                                    <div className=\"flex items-center gap-2\">\n                                        <span className={`px-3 py-1 text-sm rounded-full ${\n                                            tour.type === TourType.OWN\n                                                ? 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200'\n                                                : 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200'\n                                        }`}>\n                                            {tour.type === TourType.OWN ? t('tours.typeOwn') : t('tours.typeExternal')}\n                                        </span>\n                                        <span className={`px-3 py-1 text-sm rounded-full ${\n                                            tour.isActive\n                                                ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200'\n                                                : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200'\n                                        }`}>\n                                            {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                        </span>\n                                    </div>\n                                </div>\n\n                                {/* Beschreibung */}\n                                {tour.description && (\n                                    <div>\n                                        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\">\n                                            {t('tours.description')}\n                                        </h3>\n                                        <p className=\"text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\n                                            {tour.description}\n                                        </p>\n                                    </div>\n                                )}\n\n                                {/* Tour-Details Grid */}\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                                    {/* Linke Spalte */}\n                                    <div className=\"space-y-4\">\n                                        {tour.duration && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <ClockIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.duration')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.duration} {t('common.hours', 'h')}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {(tour.minParticipants || tour.maxParticipants) && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <UsersIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.participants', 'Teilnehmer')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.minParticipants && tour.maxParticipants\n                                                            ? `${tour.minParticipants} - ${tour.maxParticipants}`\n                                                            : tour.minParticipants\n                                                            ? `${tour.minParticipants}+`\n                                                            : tour.maxParticipants\n                                                            ? `bis ${tour.maxParticipants}`\n                                                            : '-'}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.price && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <CurrencyDollarIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.price')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white font-semibold\">\n                                                        {Number(tour.price).toLocaleString()} {tour.currency || 'COP'}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.location && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <MapPinIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.location')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.location}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.meetingPoint && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <MapPinIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.meetingPoint')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.meetingPoint}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n                                    </div>\n\n                                    {/* Rechte Spalte */}\n                                    <div className=\"space-y-4\">\n                                        {tour.branch && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <BuildingOfficeIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.branch')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.branch.name}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.createdBy && (\n                                            <div className=\"flex items-start gap-3\">\n                                                <UserIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.columns.createdBy')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {tour.createdBy.firstName} {tour.createdBy.lastName}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.createdAt && (\n                                            <div>\n                                                <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                    {t('common.createdAt', 'Erstellt am')}\n                                                </div>\n                                                <div className=\"text-gray-900 dark:text-white\">\n                                                    {format(new Date(tour.createdAt), 'dd.MM.yyyy HH:mm', { locale: de })}\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.externalProvider && (\n                                            <div>\n                                                <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                    {t('tours.externalProvider')}\n                                                </div>\n                                                <div className=\"text-gray-900 dark:text-white\">\n                                                    {tour.externalProvider.name}\n                                                </div>\n                                            </div>\n                                        )}\n\n                                        {tour.externalBookingUrl && (\n                                            <div>\n                                                <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                    {t('tours.externalBookingUrl')}\n                                                </div>\n                                                <a\n                                                    href={tour.externalBookingUrl}\n                                                    target=\"_blank\"\n                                                    rel=\"noopener noreferrer\"\n                                                    className=\"text-blue-600 dark:text-blue-400 hover:underline\"\n                                                >\n                                                    {tour.externalBookingUrl}\n                                                </a>\n                                            </div>\n                                        )}\n                                    </div>\n                                </div>\n\n                                {/* Kommissionen */}\n                                {(tour.totalCommission || tour.totalCommissionPercent || tour.sellerCommissionPercent || tour.sellerCommissionFixed) && (\n                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-6\">\n                                        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n                                            {t('tours.commissions')}\n                                        </h3>\n                                        <div className=\"grid grid-cols-2 gap-4\">\n                                            {tour.totalCommission && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.totalCommission')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {Number(tour.totalCommission).toLocaleString()} {tour.currency || 'COP'}\n                                                    </div>\n                                                </div>\n                                            )}\n                                            {tour.totalCommissionPercent && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.totalCommissionPercent')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {Number(tour.totalCommissionPercent)}%\n                                                    </div>\n                                                </div>\n                                            )}\n                                            {tour.sellerCommissionPercent && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.sellerCommissionPercent')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {Number(tour.sellerCommissionPercent)}%\n                                                    </div>\n                                                </div>\n                                            )}\n                                            {tour.sellerCommissionFixed && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.sellerCommissionFixed')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {Number(tour.sellerCommissionFixed).toLocaleString()} {tour.currency || 'COP'}\n                                                    </div>\n                                                </div>\n                                            )}\n                                        </div>\n                                    </div>\n                                )}\n\n                                {/* Zustzliche Informationen */}\n                                {(tour.includes || tour.excludes || tour.requirements) && (\n                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-6\">\n                                        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n                                            {t('tours.additionalInfo')}\n                                        </h3>\n                                        <div className=\"space-y-4\">\n                                            {tour.includes && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1\">\n                                                        {t('tours.includes')}\n                                                    </div>\n                                                    <p className=\"text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\n                                                        {tour.includes}\n                                                    </p>\n                                                </div>\n                                            )}\n                                            {tour.excludes && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1\">\n                                                        {t('tours.excludes')}\n                                                    </div>\n                                                    <p className=\"text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\n                                                        {tour.excludes}\n                                                    </p>\n                                                </div>\n                                            )}\n                                            {tour.requirements && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1\">\n                                                        {t('tours.requirements')}\n                                                    </div>\n                                                    <p className=\"text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\n                                                        {tour.requirements}\n                                                    </p>\n                                                </div>\n                                            )}\n                                        </div>\n                                    </div>\n                                )}\n\n                                {/* Verfgbarkeit */}\n                                {(tour.availableFrom || tour.availableTo) && (\n                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-6\">\n                                        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n                                            {t('tours.availability', 'Verfgbarkeit')}\n                                        </h3>\n                                        <div className=\"grid grid-cols-2 gap-4\">\n                                            {tour.availableFrom && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.availableFrom', 'Verfgbar ab')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {format(new Date(tour.availableFrom), 'dd.MM.yyyy', { locale: de })}\n                                                    </div>\n                                                </div>\n                                            )}\n                                            {tour.availableTo && (\n                                                <div>\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.availableTo', 'Verfgbar bis')}\n                                                    </div>\n                                                    <div className=\"text-gray-900 dark:text-white\">\n                                                        {format(new Date(tour.availableTo), 'dd.MM.yyyy', { locale: de })}\n                                                    </div>\n                                                </div>\n                                            )}\n                                        </div>\n                                    </div>\n                                )}\n                            </div>\n                        )}\n                    </div>\n\n                    <div className=\"flex justify-end p-6 border-t border-gray-200 dark:border-gray-700\">\n                        <button\n                            onClick={onClose}\n                            className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600\"\n                        >\n                            {t('common.close', 'Schlieen')}\n                        </button>\n                    </div>\n                </Dialog.Panel>\n            </div>\n            \n            {/* Create Tour Booking Modal */}\n            {tour && (\n                <CreateTourBookingModal\n                    isOpen={isCreateBookingModalOpen}\n                    onClose={() => setIsCreateBookingModalOpen(false)}\n                    tour={tour}\n                    onBookingCreated={async (newBooking: TourBooking) => {\n                        showMessage(\n                            t('tourBookings.created', { defaultValue: 'Tour-Buchung erfolgreich erstellt' }),\n                            'success'\n                        );\n                        setIsCreateBookingModalOpen(false);\n                    }}\n                />\n            )}\n        </Dialog>\n    );\n};\n\nexport default TourDetailsModal;\n\n","import React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, ArrowDownTrayIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../../config/axios.ts';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { Tour } from '../../types/tour.ts';\n\ninterface TourExportDialogProps {\n    isOpen: boolean;\n    onClose: () => void;\n    tourCount: number;\n}\n\nconst TourExportDialog = ({ isOpen, onClose, tourCount }: TourExportDialogProps) => {\n    const { t } = useTranslation();\n    const { showMessage } = useMessage();\n    \n    const [selectedFields, setSelectedFields] = useState<string[]>([\n        'id', 'title', 'description', 'type', 'price', 'currency', 'duration',\n        'maxParticipants', 'minParticipants', 'location', 'meetingPoint',\n        'imageUrl', 'galleryUrls', 'availableFrom', 'availableTo'\n    ]);\n    const [exporting, setExporting] = useState(false);\n    const [format, setFormat] = useState<'json' | 'csv'>('json');\n\n    const availableFields = [\n        { id: 'id', label: t('tours.columns.title', 'Titel') },\n        { id: 'title', label: t('tours.name', 'Titel') },\n        { id: 'description', label: t('tours.description', 'Beschreibung') },\n        { id: 'type', label: t('tours.type', 'Typ') },\n        { id: 'price', label: t('tours.price', 'Preis') },\n        { id: 'currency', label: t('tours.currency', 'Whrung') },\n        { id: 'duration', label: t('tours.duration', 'Dauer') },\n        { id: 'maxParticipants', label: t('tours.maxParticipants', 'Max. Teilnehmer') },\n        { id: 'minParticipants', label: t('tours.minParticipants', 'Min. Teilnehmer') },\n        { id: 'location', label: t('tours.location', 'Ort') },\n        { id: 'meetingPoint', label: t('tours.meetingPoint', 'Treffpunkt') },\n        { id: 'includes', label: t('tours.includes', 'Enthlt') },\n        { id: 'excludes', label: t('tours.excludes', 'Nicht enthalten') },\n        { id: 'requirements', label: t('tours.requirements', 'Anforderungen') },\n        { id: 'imageUrl', label: t('tours.mainImage', 'Hauptbild') },\n        { id: 'galleryUrls', label: t('tours.gallery', 'Galerie') },\n        { id: 'availableFrom', label: t('tours.availableFrom', 'Verfgbar ab') },\n        { id: 'availableTo', label: t('tours.availableTo', 'Verfgbar bis') },\n        { id: 'externalBookingUrl', label: t('tours.externalBookingUrl', 'Externe Buchungs-URL') },\n        { id: 'branch', label: t('tours.branch', 'Niederlassung') },\n        { id: 'externalProvider', label: t('tours.externalProvider', 'Externer Anbieter') }\n    ];\n\n    const toggleField = (fieldId: string) => {\n        setSelectedFields(prev =>\n            prev.includes(fieldId)\n                ? prev.filter(f => f !== fieldId)\n                : [...prev, fieldId]\n        );\n    };\n\n    const selectAll = () => {\n        setSelectedFields(availableFields.map(f => f.id));\n    };\n\n    const deselectAll = () => {\n        setSelectedFields([]);\n    };\n\n    const handleExport = async () => {\n        if (selectedFields.length === 0) {\n            showMessage(t('tours.export.noFieldsSelected', 'Bitte whlen Sie mindestens ein Feld aus'), 'error');\n            return;\n        }\n\n        setExporting(true);\n        try {\n            const fieldsParam = selectedFields.join(',');\n            const response = await axiosInstance.get(API_ENDPOINTS.TOURS.EXPORT, {\n                params: { fields: fieldsParam }\n            });\n\n            const tours = response.data.tours || response.data;\n\n            if (format === 'json') {\n                // JSON-Export\n                const blob = new Blob([JSON.stringify(tours, null, 2)], { type: 'application/json' });\n                const url = window.URL.createObjectURL(blob);\n                const a = document.createElement('a');\n                a.href = url;\n                a.download = `tours-export-${new Date().toISOString().split('T')[0]}.json`;\n                document.body.appendChild(a);\n                a.click();\n                document.body.removeChild(a);\n                window.URL.revokeObjectURL(url);\n            } else {\n                // CSV-Export\n                if (!Array.isArray(tours) || tours.length === 0) {\n                    showMessage(t('tours.export.noData', 'Keine Daten zum Exportieren'), 'warning');\n                    return;\n                }\n\n                // CSV-Header\n                const headers = selectedFields.map(fieldId => {\n                    const field = availableFields.find(f => f.id === fieldId);\n                    return field?.label || fieldId;\n                });\n\n                // CSV-Rows\n                const rows = tours.map((tour: Tour) => {\n                    return selectedFields.map(fieldId => {\n                        let value = tour[fieldId];\n                        if (value === null || value === undefined) return '';\n                        if (typeof value === 'object') {\n                            if (fieldId === 'branch') return value?.name || '';\n                            if (fieldId === 'externalProvider') return value?.name || '';\n                            if (fieldId === 'galleryUrls' && Array.isArray(value)) return value.join('; ');\n                            return JSON.stringify(value);\n                        }\n                        if (typeof value === 'boolean') return value ? 'Ja' : 'Nein';\n                        return String(value);\n                    });\n                });\n\n                // CSV-String erstellen\n                const csvContent = [\n                    headers.join(','),\n                    ...rows.map(row => row.map(cell => `\"${String(cell).replace(/\"/g, '\"\"')}\"`).join(','))\n                ].join('\\n');\n\n                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n                const url = window.URL.createObjectURL(blob);\n                const a = document.createElement('a');\n                a.href = url;\n                a.download = `tours-export-${new Date().toISOString().split('T')[0]}.csv`;\n                document.body.appendChild(a);\n                a.click();\n                document.body.removeChild(a);\n                window.URL.revokeObjectURL(url);\n            }\n\n            showMessage(t('tours.export.success', 'Export erfolgreich'), 'success');\n            onClose();\n        } catch (err: unknown) {\n            console.error('Error exporting:', err);\n            showMessage(err.response?.data?.message || t('tours.export.error', 'Fehler beim Exportieren'), 'error');\n        } finally {\n            setExporting(false);\n        }\n    };\n\n    if (!isOpen) return null;\n\n    return (\n        <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                    <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n                        <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white\">\n                            {t('tours.export.title', 'Touren exportieren')} ({tourCount})\n                        </Dialog.Title>\n                        <button\n                            onClick={onClose}\n                            className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                        >\n                            <XMarkIcon className=\"h-6 w-6\" />\n                        </button>\n                    </div>\n\n                    <div className=\"p-6 space-y-6\">\n                        {/* Format-Auswahl */}\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                                {t('tours.export.format', 'Export-Format')}\n                            </label>\n                            <div className=\"flex gap-4\">\n                                <label className=\"flex items-center\">\n                                    <input\n                                        type=\"radio\"\n                                        value=\"json\"\n                                        checked={format === 'json'}\n                                        onChange={(e) => setFormat(e.target.value as 'json' | 'csv')}\n                                        className=\"mr-2\"\n                                    />\n                                    JSON\n                                </label>\n                                <label className=\"flex items-center\">\n                                    <input\n                                        type=\"radio\"\n                                        value=\"csv\"\n                                        checked={format === 'csv'}\n                                        onChange={(e) => setFormat(e.target.value as 'json' | 'csv')}\n                                        className=\"mr-2\"\n                                    />\n                                    CSV\n                                </label>\n                            </div>\n                        </div>\n\n                        {/* Feldauswahl */}\n                        <div>\n                            <div className=\"flex items-center justify-between mb-3\">\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                    {t('tours.export.selectFields', 'Felder auswhlen')}\n                                </label>\n                                <div className=\"flex gap-2\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={selectAll}\n                                        className=\"text-sm text-blue-600 dark:text-blue-400 hover:underline\"\n                                    >\n                                        {t('common.selectAll', 'Alle auswhlen')}\n                                    </button>\n                                    <span className=\"text-gray-400\">|</span>\n                                    <button\n                                        type=\"button\"\n                                        onClick={deselectAll}\n                                        className=\"text-sm text-blue-600 dark:text-blue-400 hover:underline\"\n                                    >\n                                        {t('common.deselectAll', 'Alle abwhlen')}\n                                    </button>\n                                </div>\n                            </div>\n                            <div className=\"border border-gray-300 dark:border-gray-600 rounded-md p-4 max-h-96 overflow-y-auto\">\n                                <div className=\"grid grid-cols-2 gap-2\">\n                                    {availableFields.map(field => (\n                                        <label key={field.id} className=\"flex items-center\">\n                                            <input\n                                                type=\"checkbox\"\n                                                checked={selectedFields.includes(field.id)}\n                                                onChange={() => toggleField(field.id)}\n                                                className=\"mr-2 rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                                            />\n                                            <span className=\"text-sm text-gray-700 dark:text-gray-300\">\n                                                {field.label}\n                                            </span>\n                                        </label>\n                                    ))}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div className=\"flex justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700\">\n                        <button\n                            type=\"button\"\n                            onClick={onClose}\n                            className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                            title={t('common.cancel', 'Abbrechen')}\n                        >\n                            <XMarkIcon className=\"h-5 w-5\" />\n                        </button>\n                        <button\n                            type=\"button\"\n                            onClick={handleExport}\n                            disabled={exporting || selectedFields.length === 0}\n                            className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-blue-500 dark:hover:bg-blue-600\"\n                            title={exporting ? t('common.exporting', 'Exportiere...') : t('common.export', 'Exportieren')}\n                        >\n                            <ArrowDownTrayIcon className=\"h-5 w-5\" />\n                        </button>\n                    </div>\n                </Dialog.Panel>\n            </div>\n        </Dialog>\n    );\n};\n\nexport default TourExportDialog;\n\n","import React, { useState, useEffect, useCallback } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { \r\n  XMarkIcon, \r\n  ChevronLeftIcon, \r\n  ChevronRightIcon,\r\n  MagnifyingGlassPlusIcon,\r\n  MagnifyingGlassMinusIcon,\r\n  ArrowPathIcon\r\n} from '@heroicons/react/24/outline';\r\nimport { getTourImageUrl, getTourGalleryImageUrl } from '../../config/api.ts';\r\n\r\ninterface TourImageLightboxProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  tourId: number;\r\n  initialImageIndex?: number;\r\n  imageUrl?: string | null;\r\n  galleryUrls?: string[] | null;\r\n  tourTitle?: string;\r\n}\r\n\r\nconst TourImageLightbox: React.FC<TourImageLightboxProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  tourId,\r\n  initialImageIndex = 0,\r\n  imageUrl,\r\n  galleryUrls,\r\n  tourTitle\r\n}) => {\r\n  const { t } = useTranslation();\r\n  \r\n  // State\r\n  const [currentImageIndex, setCurrentImageIndex] = useState(initialImageIndex);\r\n  const [zoomLevel, setZoomLevel] = useState(1.0);\r\n  const [imageLoading, setImageLoading] = useState(true);\r\n  const [imageError, setImageError] = useState(false);\r\n\r\n  // Konstruiere Bild-Array: Hauptbild + Galerie\r\n  const images: string[] = [];\r\n  if (imageUrl) {\r\n    images.push(getTourImageUrl(tourId)); // Index 0\r\n  }\r\n  if (galleryUrls && galleryUrls.length > 0) {\r\n    galleryUrls.forEach((_, index) => {\r\n      images.push(getTourGalleryImageUrl(tourId, index)); // Index 1+\r\n    });\r\n  }\r\n\r\n  // Reset state wenn Lightbox geffnet wird\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setCurrentImageIndex(initialImageIndex);\r\n      setZoomLevel(1.0);\r\n      setImageLoading(true);\r\n      setImageError(false);\r\n    }\r\n  }, [isOpen, initialImageIndex]);\r\n\r\n  // Navigation\r\n  const handlePrevious = useCallback(() => {\r\n    if (currentImageIndex > 0) {\r\n      setCurrentImageIndex(currentImageIndex - 1);\r\n      setImageLoading(true);\r\n      setImageError(false);\r\n      setZoomLevel(1.0);\r\n    }\r\n  }, [currentImageIndex]);\r\n\r\n  const handleNext = useCallback(() => {\r\n    if (currentImageIndex < images.length - 1) {\r\n      setCurrentImageIndex(currentImageIndex + 1);\r\n      setImageLoading(true);\r\n      setImageError(false);\r\n      setZoomLevel(1.0);\r\n    }\r\n  }, [currentImageIndex, images.length]);\r\n\r\n  // Zoom\r\n  const handleZoomIn = useCallback(() => {\r\n    setZoomLevel(prev => {\r\n      if (prev >= 3.0) return 3.0;\r\n      if (prev < 1.5) return 1.5;\r\n      if (prev < 2.0) return 2.0;\r\n      if (prev < 2.5) return 2.5;\r\n      return 3.0;\r\n    });\r\n  }, []);\r\n\r\n  const handleZoomOut = useCallback(() => {\r\n    setZoomLevel(prev => {\r\n      if (prev <= 1.0) return 1.0;\r\n      if (prev > 2.5) return 2.5;\r\n      if (prev > 2.0) return 2.0;\r\n      if (prev > 1.5) return 1.5;\r\n      return 1.0;\r\n    });\r\n  }, []);\r\n\r\n  const handleZoomReset = useCallback(() => {\r\n    setZoomLevel(1.0);\r\n  }, []);\r\n\r\n  // Bild-Events\r\n  const handleImageLoad = () => {\r\n    setImageLoading(false);\r\n    setImageError(false);\r\n  };\r\n\r\n  const handleImageError = () => {\r\n    setImageLoading(false);\r\n    setImageError(true);\r\n  };\r\n\r\n  // Keyboard-Navigation\r\n  useEffect(() => {\r\n    if (!isOpen) return;\r\n\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (e.key === 'Escape') {\r\n        onClose();\r\n      } else if (e.key === 'ArrowLeft' && currentImageIndex > 0) {\r\n        handlePrevious();\r\n      } else if (e.key === 'ArrowRight' && currentImageIndex < images.length - 1) {\r\n        handleNext();\r\n      } else if ((e.key === '+' || e.key === '=') && !e.shiftKey) {\r\n        handleZoomIn();\r\n      } else if (e.key === '-' || (e.key === '_' && e.shiftKey)) {\r\n        handleZoomOut();\r\n      } else if (e.key === '0') {\r\n        handleZoomReset();\r\n      }\r\n    };\r\n\r\n    window.addEventListener('keydown', handleKeyDown);\r\n    return () => window.removeEventListener('keydown', handleKeyDown);\r\n  }, [isOpen, currentImageIndex, images.length, handlePrevious, handleNext, handleZoomIn, handleZoomOut, handleZoomReset, onClose]);\r\n\r\n  // Prfe ob Bilder vorhanden\r\n  if (images.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  const currentImage = images[currentImageIndex];\r\n  const canGoPrevious = currentImageIndex > 0;\r\n  const canGoNext = currentImageIndex < images.length - 1;\r\n  const canZoomIn = zoomLevel < 3.0;\r\n  const canZoomOut = zoomLevel > 1.0;\r\n\r\n  return (\r\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n      {/* Overlay */}\r\n      <div className=\"fixed inset-0 bg-black/80\" aria-hidden=\"true\" />\r\n      \r\n      {/* Dialog Panel */}\r\n      <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n        <Dialog.Panel className=\"mx-auto max-w-7xl w-full h-full flex flex-col bg-black/90 rounded-lg shadow-xl overflow-hidden\">\r\n          {/* Header */}\r\n          <div className=\"flex items-center justify-between p-4 border-b border-gray-700 flex-shrink-0\">\r\n            <div className=\"flex items-center gap-4\">\r\n              <Dialog.Title className=\"text-lg font-semibold text-white\">\r\n                {tourTitle && `${tourTitle} - `}\r\n                {t('tours.imageLightbox.title', 'Bild {{current}} von {{total}}', {\r\n                  current: currentImageIndex + 1,\r\n                  total: images.length\r\n                })}\r\n              </Dialog.Title>\r\n              \r\n              {/* Zoom Controls */}\r\n              <div className=\"flex items-center gap-2\">\r\n                <button\r\n                  onClick={handleZoomOut}\r\n                  disabled={!canZoomOut}\r\n                  className=\"p-2 text-white hover:bg-gray-700 rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                  aria-label={t('tours.imageLightbox.zoomOut', 'Verkleinern')}\r\n                  title={t('tours.imageLightbox.zoomOut', 'Verkleinern')}\r\n                >\r\n                  <MagnifyingGlassMinusIcon className=\"h-5 w-5\" />\r\n                </button>\r\n                <button\r\n                  onClick={handleZoomReset}\r\n                  className=\"p-2 text-white hover:bg-gray-700 rounded transition-colors\"\r\n                  aria-label={t('tours.imageLightbox.zoomReset', 'Zoom zurcksetzen')}\r\n                  title={t('tours.imageLightbox.zoomReset', 'Zoom zurcksetzen')}\r\n                >\r\n                  <ArrowPathIcon className=\"h-5 w-5\" />\r\n                </button>\r\n                <button\r\n                  onClick={handleZoomIn}\r\n                  disabled={!canZoomIn}\r\n                  className=\"p-2 text-white hover:bg-gray-700 rounded disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                  aria-label={t('tours.imageLightbox.zoomIn', 'Vergrern')}\r\n                  title={t('tours.imageLightbox.zoomIn', 'Vergrern')}\r\n                >\r\n                  <MagnifyingGlassPlusIcon className=\"h-5 w-5\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Close Button */}\r\n            <button\r\n              onClick={onClose}\r\n              className=\"p-2 text-white hover:bg-gray-700 rounded transition-colors\"\r\n              aria-label={t('tours.imageLightbox.close', 'Schlieen')}\r\n            >\r\n              <XMarkIcon className=\"h-6 w-6\" />\r\n            </button>\r\n          </div>\r\n\r\n          {/* Content */}\r\n          <div className=\"flex-1 relative overflow-hidden flex items-center justify-center\">\r\n            {/* Previous Button */}\r\n            {images.length > 1 && (\r\n              <button\r\n                onClick={handlePrevious}\r\n                disabled={!canGoPrevious}\r\n                className=\"absolute left-4 z-10 p-3 bg-black/50 hover:bg-black/70 text-white rounded-full disabled:opacity-50 disabled:cursor-not-allowed transition-all\"\r\n                aria-label={t('tours.imageLightbox.previous', 'Vorheriges Bild')}\r\n              >\r\n                <ChevronLeftIcon className=\"h-6 w-6\" />\r\n              </button>\r\n            )}\r\n\r\n            {/* Image Container */}\r\n            <div className=\"flex-1 flex items-center justify-center h-full p-4\">\r\n              {imageLoading && !imageError && (\r\n                <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                  <div className=\"text-white\">\r\n                    <ArrowPathIcon className=\"h-8 w-8 animate-spin\" />\r\n                    <p className=\"mt-2 text-sm\">{t('tours.imageLightbox.loading', 'Bild wird geladen...')}</p>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              \r\n              {imageError && (\r\n                <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                  <div className=\"text-white text-center\">\r\n                    <p className=\"text-lg\">{t('tours.imageLightbox.error', 'Bild konnte nicht geladen werden')}</p>\r\n                  </div>\r\n                </div>\r\n              )}\r\n              \r\n              {!imageError && (\r\n                <img\r\n                  src={currentImage}\r\n                  alt={`${tourTitle || 'Tour'} - Bild ${currentImageIndex + 1}`}\r\n                  className={`max-w-full max-h-full object-contain transition-transform duration-200 ${\r\n                    imageLoading ? 'opacity-0' : 'opacity-100'\r\n                  }`}\r\n                  style={{\r\n                    transform: `scale(${zoomLevel})`,\r\n                    cursor: zoomLevel > 1.0 ? 'move' : 'default'\r\n                  }}\r\n                  onLoad={handleImageLoad}\r\n                  onError={handleImageError}\r\n                />\r\n              )}\r\n            </div>\r\n\r\n            {/* Next Button */}\r\n            {images.length > 1 && (\r\n              <button\r\n                onClick={handleNext}\r\n                disabled={!canGoNext}\r\n                className=\"absolute right-4 z-10 p-3 bg-black/50 hover:bg-black/70 text-white rounded-full disabled:opacity-50 disabled:cursor-not-allowed transition-all\"\r\n                aria-label={t('tours.imageLightbox.next', 'Nchstes Bild')}\r\n              >\r\n                <ChevronRightIcon className=\"h-6 w-6\" />\r\n              </button>\r\n            )}\r\n          </div>\r\n        </Dialog.Panel>\r\n      </div>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default TourImageLightbox;\r\n\r\n","import React, { useState, useEffect, useMemo, useCallback, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { PencilIcon, PlusIcon, ArrowsUpDownIcon, FunnelIcon, InformationCircleIcon, Squares2X2Icon, TableCellsIcon, ArrowDownTrayIcon, PhotoIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS, getTourImageUrl, getTourGalleryImageUrl } from '../../config/api.ts';\nimport axiosInstance from '../../config/axios.ts';\nimport CardGrid from '../shared/CardGrid.tsx';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport { useTableSettings } from '../../hooks/useTableSettings.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useError } from '../../contexts/ErrorContext.tsx';\nimport TableColumnConfig from '../TableColumnConfig.tsx';\nimport FilterPane from '../FilterPane.tsx';\nimport SavedFilterTags from '../SavedFilterTags.tsx';\nimport { useFilterContext } from '../../contexts/FilterContext.tsx';\nimport CreateTourModal from './CreateTourModal.tsx';\nimport EditTourModal from './EditTourModal.tsx';\nimport TourDetailsModal from './TourDetailsModal.tsx';\nimport TourExportDialog from './TourExportDialog.tsx';\nimport TourImageLightbox from './TourImageLightbox.tsx';\nimport { Tour, TourType } from '../../types/tour.ts';\nimport { FilterCondition } from '../FilterRow.tsx';\nimport { applyFilters, evaluateUserRoleCondition } from '../../utils/filterLogic.ts';\n\ninterface ToursTabProps {\n}\n\ninterface TourSortConfig {\n    key: 'title' | 'type' | 'price' | 'location' | 'duration' | 'branch' | 'createdBy' | 'isActive';\n    direction: 'asc' | 'desc';\n}\n\nconst TOURS_TABLE_ID = 'worktracker-tours';\n\nconst defaultTourColumnOrder = ['title', 'type', 'price', 'location', 'duration', 'branch', 'isActive', 'actions'];\n\n//  ENTFERNT: defaultTourCardSortDirections\n// Hauptsortierung wird jetzt aus Settings geladen (pro Benutzer gespeichert)\n\nconst tourCardToTableMapping: Record<string, string> = {\n    'title': 'title',\n    'type': 'type',\n    'price': 'price',\n    'location': 'location',\n    'duration': 'duration',\n    'branch': 'branch',\n    'createdBy': 'createdBy',\n    'isActive': 'isActive'\n};\n\nconst getTourCardMetadataFromColumnOrder = (columnOrder: string[]): string[] => {\n    const cardMetadata: string[] = [];\n    columnOrder.forEach(tableCol => {\n        const cardMeta = tourCardToTableMapping[tableCol] || [];\n        if (cardMeta && typeof cardMeta === 'string') {\n            cardMetadata.push(cardMeta);\n        }\n    });\n    return cardMetadata;\n};\n\nconst getTourHiddenCardMetadata = (hiddenTableColumns: string[]): Set<string> => {\n    const hiddenCardMetadata = new Set<string>();\n    hiddenTableColumns.forEach(tableCol => {\n        const cardMeta = tourCardToTableMapping[tableCol];\n        if (cardMeta) {\n            hiddenCardMetadata.add(cardMeta);\n        }\n    });\n    return hiddenCardMetadata;\n};\n\nconst ToursTab: React.FC<ToursTabProps> = () => {\n    const { t } = useTranslation();\n    const { hasPermission, loading: permissionsLoading } = usePermissions();\n    const { showMessage } = useMessage();\n    \n    // Fehlerbehandlung mit Fallback\n    const errorContext = useError();\n    const handleErrorContext = errorContext?.handleError || ((err: unknown, context?: Record<string, unknown>) => {\n        console.error('Error:', err, context);\n        const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                             (err as { message?: string })?.message || \n                             'Ein Fehler ist aufgetreten';\n        showMessage(errorMessage, 'error');\n    });\n    \n    // Tour-States\n    const [tours, setTours] = useState<Tour[]>([]);\n    const [toursLoading, setToursLoading] = useState(false);\n    const [toursError, setToursError] = useState<string | null>(null);\n    const [tourSearchTerm, setTourSearchTerm] = useState('');\n    const [tourFilterConditions, setTourFilterConditions] = useState<FilterCondition[]>([]);\n    const [tourFilterLogicalOperators, setTourFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n    const [tourActiveFilterName, setTourActiveFilterName] = useState<string>(t('tours.filters.current', 'Aktuell'));\n    const [tourSelectedFilterId, setTourSelectedFilterId] = useState<number | null>(null);\n    \n    //  PERFORMANCE: Ref-Pattern fr tourFilterLogicalOperators (verhindert Re-Creation von loadTours)\n    const tourFilterLogicalOperatorsRef = useRef(tourFilterLogicalOperators);\n    \n    useEffect(() => {\n        tourFilterLogicalOperatorsRef.current = tourFilterLogicalOperators;\n    }, [tourFilterLogicalOperators]);\n    const [isCreateTourModalOpen, setIsCreateTourModalOpen] = useState(false);\n    const [isEditTourModalOpen, setIsEditTourModalOpen] = useState(false);\n    const [isTourDetailsModalOpen, setIsTourDetailsModalOpen] = useState(false);\n    const [isTourExportDialogOpen, setIsTourExportDialogOpen] = useState(false);\n    const [lightboxOpen, setLightboxOpen] = useState(false);\n    const [selectedTourForLightbox, setSelectedTourForLightbox] = useState<Tour | null>(null);\n    const [initialImageIndex, setInitialImageIndex] = useState(0);\n    const [selectedTour, setSelectedTour] = useState<Tour | null>(null);\n    const [selectedTourId, setSelectedTourId] = useState<number | null>(null);\n    const [displayLimit, setDisplayLimit] = useState<number>(10);\n    const [draggedColumn, setDraggedColumn] = useState<string | null>(null);\n    const [dragOverColumn, setDragOverColumn] = useState<string | null>(null);\n    const [isFilterModalOpen, setIsFilterModalOpen] = useState(false);\n    \n    // Bildgenerierung States\n    const [generatingImages, setGeneratingImages] = useState<Record<number, boolean>>({});\n    const [imageGenerationJobs, setImageGenerationJobs] = useState<Record<number, string | null>>({});\n    const pollingIntervalsRef = useRef<Record<number, NodeJS.Timeout>>({});\n    const pollCountRef = useRef<Record<number, number>>({});\n    \n    // Tabellen-Einstellungen\n    const {\n        settings,\n        isLoading: isLoadingSettings,\n        updateColumnOrder,\n        updateHiddenColumns,\n        toggleColumnVisibility,\n        isColumnVisible,\n        updateViewMode,\n        updateSortConfig\n    } = useTableSettings(TOURS_TABLE_ID, {\n        defaultColumnOrder: defaultTourColumnOrder,\n        defaultHiddenColumns: [],\n        defaultViewMode: 'cards'\n    });\n    \n    // Hauptsortierung aus Settings laden (fr Table & Cards synchron)\n    const tourTableSortConfig: TourSortConfig = settings?.sortConfig || { key: 'title', direction: 'asc' };\n    \n    // Hauptsortierung Handler (fr Table & Cards synchron)\n    const handleMainSortChange = (key: string, direction: 'asc' | 'desc') => {\n        updateSortConfig({ key: key as TourSortConfig['key'], direction });\n    };\n    \n    // Tours-Spalten\n    const availableTourColumns = useMemo(() => [\n        { id: 'title', label: t('tours.columns.title', 'Titel'), shortLabel: t('tours.columns.title', 'Titel').substring(0, 4) },\n        { id: 'type', label: t('tours.columns.type', 'Typ'), shortLabel: t('tours.columns.type', 'Typ').substring(0, 3) },\n        { id: 'price', label: t('tours.columns.price', 'Preis'), shortLabel: t('tours.columns.price', 'Preis').substring(0, 3) },\n        { id: 'location', label: t('tours.columns.location', 'Ort'), shortLabel: t('tours.columns.location', 'Ort').substring(0, 3) },\n        { id: 'duration', label: t('tours.columns.duration', 'Dauer'), shortLabel: t('tours.columns.duration', 'Dauer').substring(0, 3) },\n        { id: 'branch', label: t('tours.columns.branch', 'Niederlassung'), shortLabel: t('tours.columns.branch', 'Niederlassung').substring(0, 5) },\n        { id: 'createdBy', label: t('tours.columns.createdBy', 'Erstellt von'), shortLabel: t('tours.columns.createdBy', 'Erstellt von').substring(0, 5) },\n        { id: 'isActive', label: t('tours.columns.status', 'Status'), shortLabel: t('tours.columns.status', 'Status').substring(0, 3) },\n        { id: 'actions', label: t('tours.columns.actions', 'Aktionen'), shortLabel: t('common.actions').substring(0, 3) },\n    ], [t]);\n    \n    const tourFilterOnlyColumns = useMemo(() => [\n        { id: 'description', label: t('tours.columns.description', 'Beschreibung'), shortLabel: t('tours.columns.description', 'Beschreibung').substring(0, 3) },\n        { id: 'maxParticipants', label: t('tours.columns.maxParticipants', 'Max. Teilnehmer'), shortLabel: t('tours.columns.maxParticipants', 'Max. Teilnehmer').substring(0, 3) },\n        { id: 'minParticipants', label: t('tours.columns.minParticipants', 'Min. Teilnehmer'), shortLabel: t('tours.columns.minParticipants', 'Min. Teilnehmer').substring(0, 3) },\n    ], [t]);\n    \n    //  ENTFERNT: tourCardSortDirections und handleTourCardSortDirectionChange\n    // Hauptsortierung wird jetzt aus Settings geladen (pro Benutzer gespeichert)\n    \n    const viewMode = settings?.viewMode || 'cards';\n    \n    // Card-Metadaten-Reihenfolge aus columnOrder ableiten\n    const cardMetadataOrder = useMemo(() => {\n        return getTourCardMetadataFromColumnOrder(settings?.columnOrder || defaultTourColumnOrder);\n    }, [settings?.columnOrder]);\n    \n    // Versteckte Card-Metadaten aus hiddenColumns ableiten\n    const hiddenCardMetadata = useMemo(() => {\n        return getTourHiddenCardMetadata(settings?.hiddenColumns || []);\n    }, [settings?.hiddenColumns]);\n    \n    // Sichtbare Card-Metadaten\n    const visibleCardMetadata = useMemo(() => {\n        return new Set(cardMetadataOrder.filter(meta => !hiddenCardMetadata.has(meta)));\n    }, [cardMetadataOrder, hiddenCardMetadata]);\n    \n    // Funktion zum Laden der Tours\n    //  PERFORMANCE: Ref-Pattern verwendet (tourFilterLogicalOperatorsRef) statt State als Dependency\n    const loadTours = useCallback(async (filterId?: number, filterConditions?: any[], background = false) => {\n        try {\n            if (!background) {\n                setToursLoading(true);\n                setToursError(null);\n            }\n            \n            const params: Record<string, unknown> = {};\n            if (filterId) {\n                params.filterId = filterId;\n            } else if (filterConditions && filterConditions.length > 0) {\n                params.filterConditions = JSON.stringify({\n                    conditions: filterConditions,\n                    operators: tourFilterLogicalOperatorsRef.current  //  Ref verwenden statt State\n                });\n            }\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BASE, { params });\n            if (response.data.success) {\n                const rawData = response.data.data || [];\n                const toursData = Array.isArray(rawData) \n                    ? rawData.filter((tour: Tour | null) => \n                        tour != null && \n                        typeof tour === 'object' && \n                        tour.title != null && \n                        typeof tour.title === 'string'\n                    )\n                    : [];\n                if (!background) {\n                    setTours(toursData);\n                }\n            } else {\n                const errorMessage = response.data.message || t('errors.loadError');\n                if (!background) {\n                    setToursError(errorMessage);\n                    showMessage(errorMessage, 'error');\n                }\n            }\n        } catch (err: any) {\n            console.error('Fehler beim Laden der Touren:', err);\n            const errorMessage = err.response?.data?.message || t('errors.loadError');\n            if (!background) {\n                setToursError(errorMessage);\n                showMessage(errorMessage, 'error');\n            }\n        } finally {\n            if (!background) {\n                setToursLoading(false);\n            }\n        }\n    }, [t, showMessage]);  //  tourFilterLogicalOperators entfernt (Ref verwendet)\n    \n    // Handler fr Bildgenerierung\n    const handleGenerateImages = useCallback(async (tourId: number) => {\n        try {\n            setGeneratingImages(prev => ({ ...prev, [tourId]: true }));\n            \n            const response = await axiosInstance.post(API_ENDPOINTS.TOURS.GENERATE_IMAGES(tourId));\n            \n            if (response.data.success) {\n                if (response.data.mode === 'synchronous') {\n                    // Synchroner Modus: Fertig\n                    showMessage(\n                        t('tours.imagesGenerated', { defaultValue: 'Bilder erfolgreich generiert' }),\n                        'success'\n                    );\n                    setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n                    await loadTours();\n                } else {\n                    // Asynchroner Modus: Polling starten\n                    const jobId = response.data.jobId;\n                    setImageGenerationJobs(prev => ({ ...prev, [tourId]: jobId }));\n                    showMessage(\n                        t('tours.imageGenerationStarted', { defaultValue: 'Bildgenerierung gestartet' }),\n                        'info'\n                    );\n                }\n            } else {\n                throw new Error(response.data.message || t('tours.imageGenerationFailed', { defaultValue: 'Fehler beim Starten der Bildgenerierung' }));\n            }\n        } catch (err: unknown) {\n            console.error('Error starting image generation:', err);\n            const errorMessage = (err as { response?: { data?: { message?: string } }; message?: string })?.response?.data?.message || \n                                 (err as { message?: string })?.message || \n                                 t('tours.imageGenerationFailed', { defaultValue: 'Fehler bei Bildgenerierung' });\n            showMessage(errorMessage, 'error');\n            setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n        }\n    }, [t, showMessage, loadTours]);\n    \n    // Polling fr Bildgenerierungs-Status\n    useEffect(() => {\n        // Starte Polling nur fr neue Jobs (die noch kein Intervall haben)\n        Object.entries(imageGenerationJobs).forEach(([tourIdStr, jobId]) => {\n            if (!jobId) return;\n            \n            const tourId = parseInt(tourIdStr, 10);\n            \n            // berspringe, wenn bereits ein Polling luft\n            if (pollingIntervalsRef.current[tourId]) {\n                return;\n            }\n            \n            // Initialisiere Poll-Count fr diesen Job\n            if (!pollCountRef.current[tourId]) {\n                pollCountRef.current[tourId] = 0;\n            }\n            \n            const maxPolls = 30; // Max. 60 Sekunden (30 * 2 Sekunden)\n            \n            // Polling-Intervall starten\n            pollingIntervalsRef.current[tourId] = setInterval(async () => {\n                try {\n                    pollCountRef.current[tourId] = (pollCountRef.current[tourId] || 0) + 1;\n                    \n                    // Timeout nach 60 Sekunden\n                    if (pollCountRef.current[tourId] > maxPolls) {\n                        clearInterval(pollingIntervalsRef.current[tourId]);\n                        delete pollingIntervalsRef.current[tourId];\n                        delete pollCountRef.current[tourId];\n                        setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n                        setImageGenerationJobs(prev => {\n                            const newJobs = { ...prev };\n                            delete newJobs[tourId];\n                            return newJobs;\n                        });\n                        showMessage(\n                            t('tours.imageGenerationTimeout', { defaultValue: 'Bildgenerierung hat zu lange gedauert' }),\n                            'warning'\n                        );\n                        return;\n                    }\n                    \n                    const response = await axiosInstance.get(\n                        API_ENDPOINTS.TOURS.GENERATE_IMAGES_STATUS(tourId),\n                        { params: { jobId } }\n                    );\n                    \n                    if (response.data.success) {\n                        const status = response.data.status;\n                        const progress = response.data.progress || 0;\n                        \n                        if (status === 'completed') {\n                            // Erfolg: Polling stoppen\n                            clearInterval(pollingIntervalsRef.current[tourId]);\n                            delete pollingIntervalsRef.current[tourId];\n                            delete pollCountRef.current[tourId];\n                            setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n                            setImageGenerationJobs(prev => {\n                                const newJobs = { ...prev };\n                                delete newJobs[tourId];\n                                return newJobs;\n                            });\n                            showMessage(\n                                t('tours.imagesGenerated', { defaultValue: 'Bilder erfolgreich generiert' }),\n                                'success'\n                            );\n                            await loadTours();\n                        } else if (status === 'failed') {\n                            // Fehler: Polling stoppen\n                            clearInterval(pollingIntervalsRef.current[tourId]);\n                            delete pollingIntervalsRef.current[tourId];\n                            delete pollCountRef.current[tourId];\n                            setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n                            setImageGenerationJobs(prev => {\n                                const newJobs = { ...prev };\n                                delete newJobs[tourId];\n                                return newJobs;\n                            });\n                            showMessage(\n                                t('tours.imageGenerationFailed', { defaultValue: 'Fehler bei Bildgenerierung' }),\n                                'error'\n                            );\n                        }\n                        // 'waiting' oder 'active': Weiter pollen\n                    }\n                } catch (err: unknown) {\n                    console.error('Error during polling:', err);\n                    // Fehler beim Polling: Wenn Job nicht gefunden, stoppe Polling\n                    if ((err as { response?: { status?: number } })?.response?.status === 404) {\n                        clearInterval(pollingIntervalsRef.current[tourId]);\n                        delete pollingIntervalsRef.current[tourId];\n                        delete pollCountRef.current[tourId];\n                        setGeneratingImages(prev => ({ ...prev, [tourId]: false }));\n                        setImageGenerationJobs(prev => {\n                            const newJobs = { ...prev };\n                            delete newJobs[tourId];\n                            return newJobs;\n                        });\n                        showMessage(\n                            t('tours.imageGenerationFailed', { defaultValue: 'Fehler bei Bildgenerierung' }),\n                            'error'\n                        );\n                    }\n                    // Sonst: Weiter versuchen (nicht stoppen)\n                }\n            }, 2000); // Alle 2 Sekunden\n        });\n        \n        //  MEMORY LEAK PREVENTION: Cleanup-Funktion\n        return () => {\n            Object.values(pollingIntervalsRef.current).forEach(interval => clearInterval(interval));\n        };\n    }, [imageGenerationJobs, t, showMessage, loadTours]);\n    \n    //  MEMORY: Cleanup - Alle groen Arrays beim Unmount lschen\n    useEffect(() => {\n        return () => {\n            setTours([]);\n            setTourFilterConditions([]);\n        };\n    }, []); // Nur beim Unmount ausfhren\n    \n    //  ENTFERNT: Lade Tours beim Mount - wird jetzt durch Standard-Pattern gemacht\n    \n    // Tour-Filter-Funktionen\n    //  PERFORMANCE: Mit useCallback stabilisiert (verhindert Endlosschleife in useEffect)\n    const applyTourFilterConditions = useCallback((conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n        setTourFilterConditions(conditions);\n        setTourFilterLogicalOperators(operators);\n        loadTours(undefined, conditions, false);\n    }, [loadTours]);\n    \n    //  PERFORMANCE: Mit useCallback stabilisiert\n    const resetTourFilterConditions = useCallback(() => {\n        setTourFilterConditions([]);\n        setTourFilterLogicalOperators([]);\n        setTourActiveFilterName(t('tours.filters.current', 'Aktuell'));\n        setTourSelectedFilterId(null);\n        loadTours();\n    }, [loadTours, t]);\n    \n    //  PERFORMANCE: Mit useCallback stabilisiert (verhindert Endlosschleife in useEffect)\n    //  STANDARD: Wie in Requests.tsx - State setzen BEVOR Daten geladen werden\n    const handleTourFilterChange = useCallback(async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n        setTourSelectedFilterId(id);\n        setTourActiveFilterName(name);\n        if (id) {\n            //  STANDARD: State setzen BEVOR Daten geladen werden (wie in Requests.tsx:706-708)\n            setTourFilterConditions(conditions);\n            setTourFilterLogicalOperators(operators);\n            await loadTours(id);\n        } else {\n            await applyTourFilterConditions(conditions, operators);\n        }\n    }, [loadTours, applyTourFilterConditions]);\n    \n    //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n    const filterContext = useFilterContext();\n    const { loadFilters } = filterContext;\n    \n    //  PERFORMANCE: Ref verhindert mehrfache Anwendung des Default-Filters (Endlosschleife)\n    const initialLoadAttemptedRef = useRef(false);\n    \n    //  STANDARD: Filter-Laden und Default-Filter-Anwendung mit leeren Dependencies (wie in Requests.tsx)\n    useEffect(() => {\n        //  STANDARD: Warte bis Berechtigungen geladen sind\n        if (permissionsLoading) {\n            return;\n        }\n        \n        //  PERFORMANCE: Verhindere mehrfache Ausfhrung\n        if (initialLoadAttemptedRef.current) {\n            return;\n        }\n        \n        const initialize = async () => {\n            //  PERFORMANCE: Markiere als versucht, BEVOR async Operation startet\n            initialLoadAttemptedRef.current = true;\n            \n            try {\n                //  STANDARD: Prfe Berechtigung direkt (nicht in Dependencies!)\n                if (!hasPermission('tours', 'read', 'table')) {\n                    return;\n                }\n                \n                // 1. Filter laden (wartet auf State-Update)\n                const filters = await loadFilters(TOURS_TABLE_ID);\n                \n                // 2. Default-Filter anwenden (IMMER vorhanden!)\n                const defaultFilter = filters.find(f => f.name === 'Aktuell');\n                if (defaultFilter) {\n                    await handleTourFilterChange(\n                        defaultFilter.name,\n                        defaultFilter.id,\n                        defaultFilter.conditions,\n                        defaultFilter.operators\n                    );\n                    return; // Daten werden durch handleTourFilterChange geladen\n                }\n                \n                // 3. Fallback: Daten ohne Filter laden (sollte nie passieren)\n                await loadTours();\n            } catch (error) {\n                //  PERFORMANCE: Bei Fehler Ref zurcksetzen, damit Retry mglich ist\n                initialLoadAttemptedRef.current = false;\n                if (process.env.NODE_ENV === 'development') {\n                    console.error('[ToursTab] Error during initialization:', error);\n                }\n            }\n        };\n        \n        initialize();\n    }, [permissionsLoading]); //  STANDARD: permissionsLoading als Dependency (wird erneut ausgefhrt wenn Berechtigungen geladen sind)\n    \n    const handleTourSort = (key: TourSortConfig['key']) => {\n        // Table-Header-Sortierung: Aktualisiert Hauptsortierung direkt (synchron fr Table & Cards)\n        const newDirection = tourTableSortConfig.key === key && tourTableSortConfig.direction === 'asc' ? 'desc' : 'asc';\n        updateSortConfig({ key, direction: newDirection });\n    };\n    \n    // Drag & Drop Handler\n    const handleDragStart = (columnId: string) => {\n        setDraggedColumn(columnId);\n    };\n    \n    const handleDragOver = (e: React.DragEvent, columnId: string) => {\n        e.preventDefault();\n        if (draggedColumn && draggedColumn !== columnId) {\n            setDragOverColumn(columnId);\n        }\n    };\n    \n    const handleDrop = (e: React.DragEvent, columnId: string) => {\n        e.preventDefault();\n            if (draggedColumn && draggedColumn !== columnId) {\n                const columnOrder = settings?.columnOrder || defaultTourColumnOrder;\n                const dragIndex = columnOrder.indexOf(draggedColumn);\n                const hoverIndex = columnOrder.indexOf(columnId);\n\n                if (dragIndex > -1 && hoverIndex > -1) {\n                    const newColumnOrder = [...columnOrder];\n                const draggedColumn_ = newColumnOrder[dragIndex];\n                newColumnOrder.splice(dragIndex, 1);\n                newColumnOrder.splice(hoverIndex, 0, draggedColumn_);\n                updateColumnOrder(newColumnOrder);\n            }\n        }\n        setDraggedColumn(null);\n        setDragOverColumn(null);\n    };\n    \n    const handleDragEnd = () => {\n        setDraggedColumn(null);\n        setDragOverColumn(null);\n    };\n    \n    // Filtern und sortieren der Spalten gem den Benutzereinstellungen\n    const completeColumnOrder = useMemo(() => {\n        const currentOrder = settings?.columnOrder || [];\n        const validOrder = currentOrder.filter(id => id != null && typeof id === 'string');\n        const missingColumns = defaultTourColumnOrder.filter(id => !validOrder.includes(id));\n        return [...validOrder, ...missingColumns];\n    }, [settings?.columnOrder]);\n    \n    const visibleColumnIds = completeColumnOrder.filter(id => id != null && typeof id === 'string' && isColumnVisible(id));\n    \n    const getActiveFilterCount = () => {\n        return tourFilterConditions.length;\n    };\n    \n    // Filter- und Sortierlogik fr Tours\n    const filteredAndSortedTours = useMemo(() => {\n        // Sicherstellen, dass tours ein Array ist\n        if (!Array.isArray(tours)) {\n            return [];\n        }\n        \n        const validTours = tours.filter(tour => tour != null && tour.title != null && typeof tour.title === 'string');\n        \n        let filtered = validTours.filter(tour => {\n            // Such-Filter\n            if (tourSearchTerm) {\n                const searchLower = tourSearchTerm.toLowerCase();\n                \n                //  OPTIMIERUNG: Frhes Beenden bei Match\n                if (tour.title && tour.title.toLowerCase().includes(searchLower)) return true;\n                if (tour.location && tour.location.toLowerCase().includes(searchLower)) return true;\n                if (tour.description && tour.description.toLowerCase().includes(searchLower)) return true;\n                \n                return false; // Kein Match gefunden\n            }\n            \n            return true;\n        });\n\n        // Erweiterte Filterbedingungen anwenden\n        if (tourFilterConditions.length > 0) {\n            const columnEvaluators: Record<string, (tour: Tour, cond: FilterCondition) => boolean | null> = {\n                'title': (tour: Tour, cond: FilterCondition) => {\n                    if (!tour || !tour.title) return false;\n                    const value = (cond.value as string || '').toLowerCase();\n                    const title = (tour.title || '').toLowerCase();\n                    if (cond.operator === 'equals') return tour.title === cond.value;\n                    if (cond.operator === 'contains') return title.includes(value);\n                    if (cond.operator === 'startsWith') return title.startsWith(value);\n                    if (cond.operator === 'endsWith') return title.endsWith(value);\n                    return null;\n                },\n                'type': (tour: Tour, cond: FilterCondition) => {\n                    if (!tour || !tour.type) return false;\n                    if (cond.operator === 'equals') return tour.type === cond.value;\n                    if (cond.operator === 'notEquals') return tour.type !== cond.value;\n                    return null;\n                },\n                'isActive': (tour: Tour, cond: FilterCondition) => {\n                    const value = cond.value === 'true' || cond.value === true || cond.value === '1';\n                    if (cond.operator === 'equals') return tour.isActive === value;\n                    if (cond.operator === 'notEquals') return tour.isActive !== value;\n                    return null;\n                },\n                'price': (tour: Tour, cond: FilterCondition) => {\n                    const price = typeof tour.price === 'string' ? parseFloat(tour.price) : (tour.price || 0);\n                    const compareValue = typeof cond.value === 'string' ? parseFloat(cond.value) : (cond.value || 0);\n                    if (isNaN(price) || isNaN(compareValue)) return false;\n                    if (cond.operator === 'equals') return Math.abs(price - compareValue) < 0.01;\n                    if (cond.operator === 'greaterThan') return price > compareValue;\n                    if (cond.operator === 'lessThan') return price < compareValue;\n                    return null;\n                },\n                'location': (tour: Tour, cond: FilterCondition) => {\n                    const value = (cond.value as string || '').toLowerCase();\n                    const location = (tour.location || '').toLowerCase();\n                    if (cond.operator === 'equals') return tour.location === cond.value;\n                    if (cond.operator === 'contains') return location.includes(value);\n                    if (cond.operator === 'startsWith') return location.startsWith(value);\n                    if (cond.operator === 'endsWith') return location.endsWith(value);\n                    return null;\n                },\n                'branch': (tour: Tour, cond: FilterCondition) => {\n                    const branchName = (tour.branch?.name || '').toLowerCase();\n                    const value = (cond.value as string || '').toLowerCase();\n                    if (cond.operator === 'equals') return branchName === value;\n                    if (cond.operator === 'contains') return branchName.includes(value);\n                    return null;\n                },\n                'createdBy': (tour: Tour, cond: FilterCondition) => {\n                    const createdByName = tour.createdBy\n                        ? `${tour.createdBy.firstName} ${tour.createdBy.lastName}`\n                        : '';\n                    return evaluateUserRoleCondition(\n                        tour.createdById || null,\n                        null,\n                        cond,\n                        createdByName\n                    );\n                }\n            };\n\n            const getFieldValue = (tour: Tour | null, columnId: string): string | number | boolean | null => {\n                if (!tour) return '';\n                switch (columnId) {\n                    case 'title': return tour.title || '';\n                    case 'type': return tour.type || '';\n                    case 'price': return typeof tour.price === 'string' ? parseFloat(tour.price) : (tour.price || 0);\n                    case 'location': return tour.location || '';\n                    case 'duration': return tour.duration || 0;\n                    case 'branch': return tour.branch?.name || '';\n                    case 'createdBy': return tour.createdBy ? `${tour.createdBy.firstName} ${tour.createdBy.lastName}` : '';\n                    case 'isActive': return tour.isActive;\n                    default: return '';\n                }\n            };\n\n            filtered = applyFilters(\n                filtered,\n                tourFilterConditions,\n                tourFilterLogicalOperators,\n                getFieldValue,\n                columnEvaluators\n            );\n        }\n        \n        // Hilfsfunktion zum Extrahieren von Werten fr Sortierung\n        const getTourSortValue = (tour: Tour | null, columnId: string): string | number | boolean | null => {\n            if (!tour) return '';\n            switch (columnId) {\n                case 'title':\n                    return (tour.title || '').toLowerCase();\n                case 'type':\n                    return (tour.type || '').toLowerCase();\n                case 'price':\n                    return typeof tour.price === 'string' ? parseFloat(tour.price) : (tour.price || 0);\n                case 'location':\n                    return (tour.location || '').toLowerCase();\n                case 'duration':\n                    return tour.duration || 0;\n                case 'branch':\n                    return (tour.branch?.name || '').toLowerCase();\n                case 'createdBy':\n                    return tour.createdBy ? `${tour.createdBy.firstName} ${tour.createdBy.lastName}`.toLowerCase() : '';\n                case 'isActive':\n                    return tour.isActive ? 1 : 0;\n                default:\n                    return '';\n            }\n        };\n        \n        // Sortierung basierend auf Prioritten\n        const sorted = filtered.sort((a, b) => {\n            // Null-Check fr a und b\n            if (!a || !b) {\n                if (!a && !b) return 0;\n                if (!a) return 1;\n                if (!b) return -1;\n            }\n            \n            // 2. Prioritt: Table-Header-Sortierung (temporre berschreibung, auch wenn Filter aktiv)\n            if (viewMode === 'table' && tourTableSortConfig.key) {\n                const valueA = getTourSortValue(a, tourTableSortConfig.key);\n                const valueB = getTourSortValue(b, tourTableSortConfig.key);\n                \n                let comparison = 0;\n                if (typeof valueA === 'number' && typeof valueB === 'number') {\n                    comparison = valueA - valueB;\n                } else {\n                    //  OPTIMIERUNG: Vermeide String() Konvertierung wenn bereits String\n                    const strA = typeof valueA === 'string' ? valueA : String(valueA);\n                    const strB = typeof valueB === 'string' ? valueB : String(valueB);\n                    comparison = strA.localeCompare(strB);\n                }\n                \n                if (comparison !== 0) {\n                    return tourTableSortConfig.direction === 'asc' ? comparison : -comparison;\n                }\n            }\n            \n            // 3. Hauptsortierung (tourTableSortConfig) - fr Table & Cards synchron\n            // (wird bereits oben in Prioritt 2 behandelt)\n            \n            // 4. Fallback: Titel (alphabetisch)\n            //  OPTIMIERUNG: toLowerCase() bereits in getTourSortValue, aber hier fr Fallback\n            const titleA = (a?.title || '').toLowerCase();\n            const titleB = (b?.title || '').toLowerCase();\n            return titleA.localeCompare(titleB);\n        });\n        \n        return sorted;\n    }, [tours, tourSearchTerm, tourFilterConditions, tourFilterLogicalOperators, viewMode, tourTableSortConfig]);\n\n    return (\n        <div className=\"space-y-4\">\n            {/* Header mit Suche, View-Toggle, Filter, Export, Create */}\n            <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n                {/* Linke Seite: Suche */}\n                <div className=\"flex-1 w-full sm:max-w-md\">\n                    <input\n                        type=\"text\"\n                        placeholder={t('common.search') + '...'}\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n                        value={tourSearchTerm}\n                        onChange={(e) => setTourSearchTerm(e.target.value)}\n                    />\n                </div>\n                \n                {/* Rechte Seite: View-Toggle, Filter, Export, Create */}\n                <div className=\"flex items-center gap-1.5\">\n                    {/* View-Mode Toggle */}\n                    <div className=\"relative group\">\n                        <button\n                            className={`p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ${\n                                viewMode === 'cards' ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : ''\n                            }`}\n                            onClick={() => updateViewMode(viewMode === 'table' ? 'cards' : 'table')}\n                        >\n                            {viewMode === 'table' ? (\n                                <Squares2X2Icon className=\"h-5 w-5\" />\n                            ) : (\n                                <TableCellsIcon className=\"h-5 w-5\" />\n                            )}\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {viewMode === 'table' ? t('common.viewAsCards') : t('common.viewAsTable')}\n                        </div>\n                    </div>\n                    \n                    {/* Filter-Button */}\n                    <div className=\"relative group ml-1\">\n                        <button\n                            className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n                            onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\n                        >\n                            <FunnelIcon className=\"h-5 w-5\" />\n                            {getActiveFilterCount() > 0 && (\n                                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\n                                    {getActiveFilterCount()}\n                                </span>\n                            )}\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {t('common.filter')}\n                        </div>\n                    </div>\n                    \n                    {/* Export-Button */}\n                    {hasPermission('tour_edit', 'write', 'button') && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => setIsTourExportDialogOpen(true)}\n                                className=\"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700\"\n                            >\n                                <ArrowDownTrayIcon className=\"h-5 w-5\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('tours.export', 'Exportieren')}\n                            </div>\n                        </div>\n                    )}\n                    \n                    {/* Spalten-Konfiguration */}\n                    <div className=\"ml-1\">\n                        <TableColumnConfig\n                            columns={viewMode === 'cards'\n                                ? [\n                                    { id: 'title', label: t('tours.columns.title', 'Titel') },\n                                    { id: 'type', label: t('tours.columns.type', 'Typ') },\n                                    { id: 'price', label: t('tours.columns.price', 'Preis') },\n                                    { id: 'location', label: t('tours.columns.location', 'Ort') },\n                                    { id: 'duration', label: t('tours.columns.duration', 'Dauer') },\n                                    { id: 'branch', label: t('tours.columns.branch', 'Niederlassung') },\n                                    { id: 'createdBy', label: t('tours.columns.createdBy', 'Erstellt von') },\n                                    { id: 'isActive', label: t('tours.columns.status', 'Status') }\n                                ]\n                                : availableTourColumns}\n                            visibleColumns={viewMode === 'cards'\n                                ? Array.from(visibleCardMetadata)\n                                : visibleColumnIds}\n                            columnOrder={viewMode === 'cards'\n                                ? cardMetadataOrder\n                                : settings.columnOrder}\n                            onToggleColumnVisibility={(columnId) => {\n                                if (viewMode === 'cards') {\n                                    const tableColumn = tourCardToTableMapping[columnId];\n                                    if (tableColumn) {\n                                        toggleColumnVisibility(tableColumn);\n                                    }\n                                } else {\n                                    toggleColumnVisibility(columnId);\n                                }\n                            }}\n                            onColumnOrderChange={(newOrder) => {\n                                if (viewMode === 'cards') {\n                                    const newTableOrder = newOrder.map(cardMeta => tourCardToTableMapping[cardMeta] || cardMeta).filter(Boolean);\n                                    updateColumnOrder(newTableOrder);\n                                } else {\n                                    updateColumnOrder(newOrder);\n                                }\n                            }}\n                            modalTitle={viewMode === 'cards' ? t('tableColumn.sortAndDisplay') : t('tableColumn.configure')}\n                            mainSortConfig={tourTableSortConfig}\n                            onMainSortChange={handleMainSortChange}\n                            showMainSort={true}\n                        />\n                    </div>\n                    \n                    {/* Create-Button */}\n                    {hasPermission('tour_create', 'write', 'button') && (\n                        <div className=\"relative group\">\n                            <button\n                                onClick={() => setIsCreateTourModalOpen(true)}\n                                className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                                style={{ width: '30.19px', height: '30.19px' }}\n                                aria-label={t('tours.create', 'Neue Tour erstellen')}\n                            >\n                                <PlusIcon className=\"h-4 w-4\" />\n                            </button>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                {t('tours.create', 'Neue Tour erstellen')}\n                            </div>\n                        </div>\n                    )}\n                </div>\n            </div>\n\n            {/* Filter-Pane */}\n            {isFilterModalOpen && (\n                <div className=\"px-3 sm:px-4 md:px-6\">\n                    <FilterPane\n                        columns={[...availableTourColumns, ...tourFilterOnlyColumns]}\n                        onApply={applyTourFilterConditions}\n                        onReset={resetTourFilterConditions}\n                        savedConditions={tourFilterConditions}\n                        savedOperators={tourFilterLogicalOperators}\n                        tableId={TOURS_TABLE_ID}\n                    />\n                </div>\n            )}\n\n            {/* Gespeicherte Filter als Tags */}\n            <SavedFilterTags\n                tableId={TOURS_TABLE_ID}\n                onSelectFilter={applyTourFilterConditions}\n                onReset={resetTourFilterConditions}\n                activeFilterName={tourActiveFilterName}\n                selectedFilterId={tourSelectedFilterId}\n                onFilterChange={handleTourFilterChange}\n                defaultFilterName=\"Aktuell\" //  FIX: Hardcodiert (konsistent mit DB)\n            />\n\n            {/* Table View */}\n            {viewMode === 'table' && (\n                <div className=\"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6\">\n                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                        <thead className=\"bg-gray-50 dark:bg-gray-800\">\n                            <tr>\n                                {visibleColumnIds.map(columnId => {\n                                    const column = availableTourColumns.find(col => col.id === columnId);\n                                    if (!column) return null;\n                                    \n                                    return (\n                                        <th\n                                            key={columnId}\n                                            scope=\"col\"\n                                            className={`px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider ${columnId === dragOverColumn ? 'bg-blue-100 dark:bg-blue-800' : ''}`}\n                                            draggable={true}\n                                            onDragStart={() => handleDragStart(columnId)}\n                                            onDragOver={(e) => handleDragOver(e, columnId)}\n                                            onDrop={(e) => handleDrop(e, columnId)}\n                                            onDragEnd={handleDragEnd}\n                                        >\n                                            <div className=\"flex items-center\">\n                                                {window.innerWidth <= 640 ? column.shortLabel : column.label}\n                                                {columnId !== 'actions' && (\n                                                    <button \n                                                        onClick={() => handleTourSort(columnId as TourSortConfig['key'])}\n                                                        className=\"ml-1 focus:outline-none\"\n                                                    >\n                                                        <ArrowsUpDownIcon className=\"h-4 w-4 text-gray-400 dark:text-gray-500\" />\n                                                    </button>\n                                                )}\n                                            </div>\n                                        </th>\n                                    );\n                                })}\n                            </tr>\n                        </thead>\n                        <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                            {toursLoading ? (\n                                <tr>\n                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-8 text-center text-gray-500 dark:text-gray-400\">\n                                        {t('common.loading')}\n                                    </td>\n                                </tr>\n                            ) : toursError ? (\n                                <tr>\n                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-8 text-center text-red-500 dark:text-red-400\">\n                                        {toursError}\n                                    </td>\n                                </tr>\n                            ) : filteredAndSortedTours.length === 0 ? (\n                                <tr>\n                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-8 text-center text-gray-500 dark:text-gray-400\">\n                                        {t('tours.noTours')}\n                                    </td>\n                                </tr>\n                            ) : (\n                                <>\n                                    {filteredAndSortedTours.slice(0, displayLimit).filter(tour => tour != null && tour.title != null).map(tour => (\n                                        <tr \n                                            key={tour.id} \n                                            className=\"hover:bg-gray-50 dark:hover:bg-gray-700\"\n                                        >\n                                            {visibleColumnIds.map(columnId => {\n                                                switch (columnId) {\n                                                    case 'title':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200 break-words\">\n                                                                    {tour?.title || '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'type':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.type === TourType.OWN ? t('tours.typeOwn') : t('tours.typeExternal')}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'price':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.price ? `${Number(tour.price).toLocaleString()} ${tour.currency || 'COP'}` : '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'location':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.location || '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'duration':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.duration ? `${tour.duration} ${t('common.hours', 'h')}` : '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'branch':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.branch?.name || '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'createdBy':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                    {tour.createdBy ? `${tour.createdBy.firstName} ${tour.createdBy.lastName}` : '-'}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    case 'isActive':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                {hasPermission('tour_edit', 'write', 'button') ? (\n                                                                    <button\n                                                                        onClick={async (e) => {\n                                                                            e.stopPropagation();\n                                                                            try {\n                                                                                await axiosInstance.put(API_ENDPOINTS.TOURS.TOGGLE_ACTIVE(tour.id));\n                                                                                showMessage(\n                                                                                    tour.isActive \n                                                                                        ? t('tours.deactivated', { defaultValue: 'Tour deaktiviert' })\n                                                                                        : t('tours.activated', { defaultValue: 'Tour aktiviert' }),\n                                                                                    'success'\n                                                                                );\n                                                                                await loadTours();\n                                                                            } catch (err: any) {\n                                                                                console.error('Fehler beim Toggle der Tour:', err);\n                                                                                showMessage(\n                                                                                    err.response?.data?.message || t('errors.unknownError'),\n                                                                                    'error'\n                                                                                );\n                                                                            }\n                                                                        }}\n                                                                        className={`px-2 py-1 text-xs rounded transition-colors ${\n                                                                            tour.isActive \n                                                                                ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 hover:bg-green-200 dark:hover:bg-green-800' \n                                                                                : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700'\n                                                                        }`}\n                                                                    >\n                                                                        {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                                                    </button>\n                                                                ) : (\n                                                                    <span className={`px-2 py-1 text-xs rounded ${\n                                                                        tour.isActive \n                                                                            ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' \n                                                                            : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200'\n                                                                    }`}>\n                                                                        {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                                                    </span>\n                                                                )}\n                                                            </td>\n                                                        );\n                                                    case 'actions':\n                                                        return (\n                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                <div className=\"flex space-x-2 action-buttons\">\n                                                                    <div className=\"relative group\">\n                                                                        <button\n                                                                            onClick={(e) => {\n                                                                                e.stopPropagation();\n                                                                                setSelectedTourId(tour.id);\n                                                                                setIsTourDetailsModalOpen(true);\n                                                                            }}\n                                                                            className=\"p-1.5 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                            title={t('common.viewDetails', { defaultValue: 'Details anzeigen' })}\n                                                                        >\n                                                                            <InformationCircleIcon className=\"h-4 w-4\" />\n                                                                        </button>\n                                                                        <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                            {t('common.viewDetails', 'Details anzeigen')}\n                                                                        </div>\n                                                                    </div>\n                                                                    {hasPermission('tour_edit', 'write', 'button') && (\n                                                                        <>\n                                                                            <div className=\"relative group\">\n                                                                                <button\n                                                                                    onClick={(e) => {\n                                                                                        e.stopPropagation();\n                                                                                        handleGenerateImages(tour.id);\n                                                                                    }}\n                                                                                    disabled={generatingImages[tour.id] || false}\n                                                                                    className={`p-1.5 transition-colors ${\n                                                                                        generatingImages[tour.id]\n                                                                                            ? 'text-gray-400 cursor-not-allowed'\n                                                                                            : 'text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300'\n                                                                                    }`}\n                                                                                    title={generatingImages[tour.id]\n                                                                                        ? t('tours.generatingImages', { defaultValue: 'Bilder werden generiert...' })\n                                                                                        : t('tours.generateImages', { defaultValue: 'Bilder generieren' })}\n                                                                                >\n                                                                                    <PhotoIcon className=\"h-4 w-4\" />\n                                                                                </button>\n                                                                                <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                    {generatingImages[tour.id]\n                                                                                        ? t('tours.generatingImages', { defaultValue: 'Bilder werden generiert...' })\n                                                                                        : t('tours.generateImages', { defaultValue: 'Bilder generieren' })}\n                                                                                </div>\n                                                                            </div>\n                                                                            <button\n                                                                                onClick={(e) => {\n                                                                                    e.stopPropagation();\n                                                                                    setSelectedTour(tour);\n                                                                                    setIsEditTourModalOpen(true);\n                                                                                }}\n                                                                                className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                title={t('tours.edit', { defaultValue: 'Bearbeiten' })}\n                                                                            >\n                                                                                <PencilIcon className=\"h-4 w-4\" />\n                                                                            </button>\n                                                                        </>\n                                                                    )}\n                                                                </div>\n                                                            </td>\n                                                        );\n                                                    default:\n                                                        return null;\n                                                }\n                                            })}\n                                        </tr>\n                                    ))}\n                                </>\n                            )}\n                        </tbody>\n                    </table>\n                </div>\n            )}\n\n            {/* Card View */}\n            {viewMode === 'cards' && (\n                <CardGrid>\n                    {toursLoading ? (\n                        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                            {t('common.loading')}\n                        </div>\n                    ) : toursError ? (\n                        <div className=\"text-center py-8 text-red-500 dark:text-red-400\">\n                            {toursError}\n                        </div>\n                    ) : filteredAndSortedTours.length === 0 ? (\n                        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                            {t('tours.noTours')}\n                        </div>\n                    ) : (\n                        filteredAndSortedTours.slice(0, displayLimit).filter(tour => tour != null && tour.title != null).map((tour) => (\n                            <div\n                                key={tour.id}\n                                className=\"bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 p-4 hover:shadow-md transition-shadow\"\n                            >\n                                {/* Bild-Anzeige */}\n                                {tour.imageUrl && (\n                                    <img \n                                        src={getTourImageUrl(tour.id)}\n                                        alt={tour.title || 'Tour Bild'}\n                                        className=\"w-full h-48 object-cover rounded-lg mb-2 cursor-pointer hover:opacity-90 transition-opacity\"\n                                        loading=\"lazy\"\n                                        onClick={() => {\n                                            setSelectedTourForLightbox(tour);\n                                            setInitialImageIndex(0);\n                                            setLightboxOpen(true);\n                                        }}\n                                    />\n                                )}\n                                \n                                {/* Galerie-Thumbnails */}\n                                {tour.galleryUrls && tour.galleryUrls.length > 0 && (\n                                    <div className=\"flex gap-2 mb-2 overflow-x-auto\">\n                                        {tour.galleryUrls.map((_, index) => (\n                                            <img\n                                                key={index}\n                                                src={getTourGalleryImageUrl(tour.id, index)}\n                                                alt={`${tour.title} - Galerie ${index + 1}`}\n                                                className=\"w-20 h-20 object-cover rounded cursor-pointer hover:opacity-90 transition-opacity flex-shrink-0\"\n                                                onClick={() => {\n                                                    setSelectedTourForLightbox(tour);\n                                                    setInitialImageIndex(index + 1); // +1 weil Index 0 = Hauptbild\n                                                    setLightboxOpen(true);\n                                                }}\n                                            />\n                                        ))}\n                                    </div>\n                                )}\n                                \n                                <div className=\"flex items-start justify-between mb-2\">\n                                    <h4 className=\"text-lg font-semibold dark:text-white\">{tour?.title || '-'}</h4>\n                                    {hasPermission('tour_edit', 'write', 'button') ? (\n                                        <button\n                                            onClick={async () => {\n                                                try {\n                                                    await axiosInstance.put(API_ENDPOINTS.TOURS.TOGGLE_ACTIVE(tour.id));\n                                                    showMessage(\n                                                        tour.isActive \n                                                            ? t('tours.deactivated', { defaultValue: 'Tour deaktiviert' })\n                                                            : t('tours.activated', { defaultValue: 'Tour aktiviert' }),\n                                                        'success'\n                                                    );\n                                                    await loadTours();\n                                                } catch (err: unknown) {\n                                                    console.error('Error toggling tour:', err);\n                                                    showMessage(\n                                                        (err as { response?: { data?: { message?: string } } })?.response?.data?.message || t('errors.unknownError'),\n                                                        'error'\n                                                    );\n                                                }\n                                            }}\n                                            className={`px-2 py-1 text-xs rounded transition-colors ${\n                                                tour.isActive \n                                                    ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 hover:bg-green-200 dark:hover:bg-green-800' \n                                                    : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-700'\n                                            }`}\n                                        >\n                                            {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                        </button>\n                                    ) : (\n                                        <span className={`px-2 py-1 text-xs rounded ${\n                                            tour.isActive \n                                                ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' \n                                                : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200'\n                                        }`}>\n                                            {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                        </span>\n                                    )}\n                                </div>\n                                \n                                {tour.description && (\n                                    <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-2 line-clamp-2\">\n                                        {tour.description}\n                                    </p>\n                                )}\n\n                                <div className=\"flex items-center justify-between mt-4\">\n                                    <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                        <span className=\"font-medium\">{t('tours.type')}:</span>{' '}\n                                        {tour.type === TourType.OWN ? t('tours.typeOwn') : t('tours.typeExternal')}\n                                    </div>\n                                    {tour.price && (\n                                        <div className=\"text-sm font-semibold dark:text-white\">\n                                            {Number(tour.price).toLocaleString()} {tour.currency || 'COP'}\n                                        </div>\n                                    )}\n                                </div>\n                                \n                                {hasPermission('tour_edit', 'write', 'button') && (\n                                    <div className=\"mt-4 flex justify-end gap-2\">\n                                        {/* Bildgenerierungs-Button */}\n                                        <div className=\"relative group\">\n                                            <button\n                                                onClick={() => handleGenerateImages(tour.id)}\n                                                disabled={generatingImages[tour.id] || false}\n                                                className={`p-1.5 rounded transition-colors ${\n                                                    generatingImages[tour.id]\n                                                        ? 'bg-gray-200 dark:bg-gray-600 text-gray-400 cursor-not-allowed'\n                                                        : 'text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/30'\n                                                }`}\n                                            >\n                                                <PhotoIcon className=\"h-4 w-4\" />\n                                            </button>\n                                            <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                {generatingImages[tour.id]\n                                                    ? t('tours.generatingImages', { defaultValue: 'Bilder werden generiert...' })\n                                                    : t('tours.generateImages', { defaultValue: 'Bilder generieren' })}\n                                            </div>\n                                        </div>\n                                        <button\n                                            onClick={() => {\n                                                setSelectedTour(tour);\n                                                setIsEditTourModalOpen(true);\n                                            }}\n                                            className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                            title={t('tours.edit', { defaultValue: 'Bearbeiten' })}\n                                        >\n                                            <PencilIcon className=\"h-4 w-4\" />\n                                        </button>\n                                    </div>\n                                )}\n                            </div>\n                        ))\n                    )}\n                </CardGrid>\n            )}\n\n            {/* \"Mehr anzeigen\" Button */}\n            {filteredAndSortedTours.length > displayLimit && (\n                <div className=\"mt-4 flex justify-center\">\n                    <button\n                        className=\"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-700 border border-blue-300 dark:border-gray-600 rounded-md hover:bg-blue-50 dark:hover:bg-gray-600\"\n                        onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                    >\n                        {t('common.showMore')} ({filteredAndSortedTours.length - displayLimit} {t('common.remaining')})\n                    </button>\n                </div>\n            )}\n\n            {/* Modals */}\n            <CreateTourModal\n                isOpen={isCreateTourModalOpen}\n                onClose={() => setIsCreateTourModalOpen(false)}\n                onTourCreated={async () => {\n                    await loadTours();\n                }}\n            />\n            \n            {selectedTour && (\n                <EditTourModal\n                    isOpen={isEditTourModalOpen}\n                    onClose={() => {\n                        setIsEditTourModalOpen(false);\n                        setSelectedTour(null);\n                    }}\n                    onTourUpdated={async (updatedTour) => {\n                        await loadTours();\n                        // Modal wird nur beim Speichern geschlossen, nicht beim Lschen von Bildern\n                        // setSelectedTour wird hier nicht auf null gesetzt, damit das Modal offen bleibt\n                    }}\n                    tour={selectedTour}\n                />\n            )}\n            \n            {selectedTourId && (\n                <TourDetailsModal\n                    isOpen={isTourDetailsModalOpen}\n                    onClose={() => {\n                        setIsTourDetailsModalOpen(false);\n                        setSelectedTourId(null);\n                    }}\n                    tourId={selectedTourId}\n                    onTourUpdated={async () => {\n                        await loadTours();\n                    }}\n                />\n            )}\n            \n            <TourExportDialog\n                isOpen={isTourExportDialogOpen}\n                onClose={() => setIsTourExportDialogOpen(false)}\n                tourCount={filteredAndSortedTours.length}\n            />\n            \n            {selectedTourForLightbox && (\n                <TourImageLightbox\n                    isOpen={lightboxOpen}\n                    onClose={() => {\n                        setLightboxOpen(false);\n                        setSelectedTourForLightbox(null);\n                    }}\n                    tourId={selectedTourForLightbox.id}\n                    initialImageIndex={initialImageIndex}\n                    imageUrl={selectedTourForLightbox.imageUrl}\n                    galleryUrls={selectedTourForLightbox.galleryUrls}\n                    tourTitle={selectedTourForLightbox.title}\n                />\n            )}\n        </div>\n    );\n};\n\nexport default ToursTab;\n\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { CreateOrganizationRequest } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\nimport { useAuth } from '../../hooks/useAuth.tsx';\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess?: () => void;\n}\n\nconst CreateOrganizationModal: React.FC<Props> = ({ isOpen, onClose, onSuccess }) => {\n  const { t } = useTranslation();\n  const [formData, setFormData] = useState<CreateOrganizationRequest>({\n    name: '',\n    displayName: '',\n    domain: ''\n  });\n  const [loading, setLoading] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  const { fetchCurrentUser } = useAuth();\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    \n    if (!formData.name.trim()) {\n      newErrors.name = t('organization.create.nameRequired');\n    }\n    \n    if (!formData.displayName.trim()) {\n      newErrors.displayName = t('organization.create.displayNameRequired');\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n    // Fehler fr dieses Feld lschen\n    if (errors[name]) {\n      setErrors(prev => ({ ...prev, [name]: '' }));\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      showMessage(t('joinRequest.fillRequired'), 'error');\n      return;\n    }\n    \n    try {\n      setLoading(true);\n      await organizationService.createOrganization(formData);\n      setErrors({});\n      showMessage(t('organization.create.createSuccess'), 'success');\n      \n      // WICHTIG: User und Berechtigungen neu laden nach Erstellen der Organisation\n      // Der User wurde der Admin-Rolle zugeordnet und hat jetzt neue Berechtigungen\n      await fetchCurrentUser();\n      \n      // Formular zurcksetzen\n      setFormData({\n        name: '',\n        displayName: '',\n        domain: ''\n      });\n      onClose();\n      if (onSuccess) {\n        onSuccess();\n      }\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('organization.create.createError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    // Formular zurcksetzen\n    setFormData({\n      name: '',\n      displayName: '',\n      domain: ''\n    });\n    setErrors({});\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('organization.create.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                <div>\n                  <label \n                    htmlFor=\"name\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.create.name')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"name\"\n                    name=\"name\"\n                    value={formData.name}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.name \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.name && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"displayName\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.create.displayName')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"displayName\"\n                    name=\"displayName\"\n                    value={formData.displayName}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.displayName \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.displayName && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"domain\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.create.domain')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"domain\"\n                    name=\"domain\"\n                    value={formData.domain}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('joinRequest.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.create.creating') : t('organization.create.createButton')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('organization.create.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <label \n                htmlFor=\"name\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.create.name')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"name\"\n                name=\"name\"\n                value={formData.name}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.name \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.name && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"displayName\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.create.displayName')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"displayName\"\n                name=\"displayName\"\n                value={formData.displayName}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.displayName \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.displayName && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"domain\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.create.domain')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"domain\"\n                name=\"domain\"\n                value={formData.domain}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                title={loading ? t('organization.create.creating') : t('organization.create.createButton')}\n              >\n                {loading ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : (\n                  <CheckIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default CreateOrganizationModal; ","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { CreateJoinRequestRequest, Organization } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess?: () => void;\n}\n\nconst JoinOrganizationModal: React.FC<Props> = ({ isOpen, onClose, onSuccess }) => {\n  const { t } = useTranslation();\n  const [formData, setFormData] = useState<CreateJoinRequestRequest>({\n    organizationName: '',\n    message: ''\n  });\n  const [loading, setLoading] = useState<boolean>(false);\n  const [searching, setSearching] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [organizations, setOrganizations] = useState<Organization[]>([]);\n  const [showDropdown, setShowDropdown] = useState<boolean>(false);\n  const [selectedOrganization, setSelectedOrganization] = useState<Organization | null>(null);\n  const searchTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n  const { showMessage } = useMessage();\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  // Click outside handler fr Dropdown\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setShowDropdown(false);\n      }\n    };\n\n    if (showDropdown) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [showDropdown]);\n\n  const searchOrganizations = async (searchTerm: string) => {\n    if (searchTerm.length < 2) {\n      setOrganizations([]);\n      setShowDropdown(false);\n      return;\n    }\n\n    try {\n      setSearching(true);\n      const results = await organizationService.searchOrganizations(searchTerm);\n      setOrganizations(results);\n      setShowDropdown(true);\n    } catch (err: any) {\n      console.error('Fehler bei der Organisationen-Suche:', err);\n      setOrganizations([]);\n    } finally {\n      setSearching(false);\n    }\n  };\n\n  const handleOrganizationInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value;\n    setFormData(prev => ({ ...prev, organizationName: value }));\n    setSelectedOrganization(null);\n    \n    // Fehler lschen\n    if (errors.organizationName) {\n      setErrors(prev => ({ ...prev, organizationName: '' }));\n    }\n\n    // Debounce fr Suche\n    if (searchTimeoutRef.current) {\n      clearTimeout(searchTimeoutRef.current);\n    }\n\n    searchTimeoutRef.current = setTimeout(() => {\n      searchOrganizations(value);\n    }, 300);\n  };\n\n  const handleSelectOrganization = (org: Organization) => {\n    setSelectedOrganization(org);\n    setFormData(prev => ({ ...prev, organizationName: org.name }));\n    setShowDropdown(false);\n    setOrganizations([]);\n  };\n\n  const handleMessageChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    setFormData(prev => ({ ...prev, message: e.target.value }));\n    if (errors.message) {\n      setErrors(prev => ({ ...prev, message: '' }));\n    }\n  };\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    \n    if (!formData.organizationName.trim()) {\n      newErrors.organizationName = t('organization.join.nameRequired');\n    } else if (!selectedOrganization) {\n      newErrors.organizationName = t('organization.join.selectFromList');\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      showMessage(t('joinRequest.fillRequired'), 'error');\n      return;\n    }\n    \n    try {\n      setLoading(true);\n      await organizationService.createJoinRequest(formData);\n      setErrors({});\n      showMessage(t('organization.join.sendSuccess'), 'success');\n      // Formular zurcksetzen\n      setFormData({\n        organizationName: '',\n        message: ''\n      });\n      setSelectedOrganization(null);\n      setOrganizations([]);\n      onClose();\n      if (onSuccess) {\n        onSuccess();\n      }\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('organization.join.sendError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    // Formular zurcksetzen\n    setFormData({\n      organizationName: '',\n      message: ''\n    });\n    setSelectedOrganization(null);\n    setOrganizations([]);\n    setErrors({});\n    setShowDropdown(false);\n    if (searchTimeoutRef.current) {\n      clearTimeout(searchTimeoutRef.current);\n    }\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('organization.join.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                <div className=\"relative\" ref={dropdownRef}>\n                  <label \n                    htmlFor=\"organizationName\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.join.search')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"organizationName\"\n                    name=\"organizationName\"\n                    value={formData.organizationName}\n                    onChange={handleOrganizationInputChange}\n                    placeholder={t('organization.join.searchPlaceholder')}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.organizationName \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.organizationName && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.organizationName}</p>\n                  )}\n                  \n                  {/* Autocomplete Dropdown */}\n                  {showDropdown && (organizations.length > 0 || searching) && (\n                    <div className=\"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto\">\n                      {searching ? (\n                        <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                          {t('organization.join.searching')}\n                        </div>\n                      ) : organizations.length > 0 ? (\n                        organizations.map(org => (\n                          <button\n                            key={org.id}\n                            type=\"button\"\n                            onClick={() => handleSelectOrganization(org)}\n                            className=\"w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 focus:bg-gray-100 dark:focus:bg-gray-700 focus:outline-none\"\n                          >\n                            <div className=\"font-medium text-gray-900 dark:text-white\">\n                              {org.displayName || org.name}\n                            </div>\n                            {org.displayName && (\n                              <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                {org.name}\n                              </div>\n                            )}\n                          </button>\n                        ))\n                      ) : (\n                        <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                          {t('organization.join.noOrganizations')}\n                        </div>\n                      )}\n                    </div>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"message\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.join.message')}\n                  </label>\n                  <textarea\n                    id=\"message\"\n                    name=\"message\"\n                    value={formData.message || ''}\n                    onChange={handleMessageChange}\n                    rows={3}\n                    placeholder={t('organization.join.messagePlaceholder')}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('joinRequest.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.join.sending') : t('organization.join.send')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('organization.join.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div className=\"relative\" ref={dropdownRef}>\n              <label \n                htmlFor=\"organizationName\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.join.search')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"organizationName\"\n                name=\"organizationName\"\n                value={formData.organizationName}\n                onChange={handleOrganizationInputChange}\n                placeholder={t('organization.join.searchPlaceholder')}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.organizationName \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.organizationName && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.organizationName}</p>\n              )}\n              \n              {/* Autocomplete Dropdown */}\n              {showDropdown && (organizations.length > 0 || searching) && (\n                <div className=\"absolute z-10 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg max-h-60 overflow-auto\">\n                  {searching ? (\n                    <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                      {t('organization.join.searching')}\n                    </div>\n                  ) : organizations.length > 0 ? (\n                    organizations.map(org => (\n                      <button\n                        key={org.id}\n                        type=\"button\"\n                        onClick={() => handleSelectOrganization(org)}\n                        className=\"w-full text-left px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 focus:bg-gray-100 dark:focus:bg-gray-700 focus:outline-none\"\n                      >\n                        <div className=\"font-medium text-gray-900 dark:text-white\">\n                          {org.displayName || org.name}\n                        </div>\n                        {org.displayName && (\n                          <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                            {org.name}\n                          </div>\n                        )}\n                      </button>\n                    ))\n                  ) : (\n                    <div className=\"p-3 text-center text-gray-500 dark:text-gray-400\">\n                      {t('organization.join.noOrganizations')}\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"message\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.join.message')}\n              </label>\n              <textarea\n                id=\"message\"\n                name=\"message\"\n                value={formData.message || ''}\n                onChange={handleMessageChange}\n                rows={3}\n                placeholder={t('organization.join.messagePlaceholder')}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                title={loading ? t('organization.join.sending') : t('organization.join.send')}\n              >\n                {loading ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : (\n                  <CheckIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default JoinOrganizationModal; ","import React, { useState, useEffect, Suspense } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { UpdateOrganizationRequest, Organization } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\nimport { useLanguage } from '../../hooks/useLanguage.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\n//  PERFORMANCE: Lazy Loading fr Tab-Komponenten\nconst RoleConfigurationTab = React.lazy(() => import('./RoleConfigurationTab.tsx'));\nconst DocumentConfigurationTab = React.lazy(() => import('./DocumentConfigurationTab.tsx'));\nconst SMTPConfigurationTab = React.lazy(() => import('./SMTPConfigurationTab.tsx'));\nconst ApiConfigurationTab = React.lazy(() => import('./ApiConfigurationTab.tsx'));\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess?: () => void;\n  organization: Organization | null;\n}\n\nconst EditOrganizationModal: React.FC<Props> = ({ isOpen, onClose, onSuccess, organization }) => {\n  const { t } = useTranslation();\n  const { fetchCurrentUser } = useAuth();\n  const [formData, setFormData] = useState<UpdateOrganizationRequest>({\n    displayName: '',\n    domain: '',\n    logo: '',\n    country: null,\n    nit: null,\n    settings: {}\n  });\n  //  PERFORMANCE: Organization mit Settings fr Tab-Komponenten\n  const [organizationWithSettings, setOrganizationWithSettings] = useState<Organization | null>(null);\n  const [selectedCountry, setSelectedCountry] = useState<string>('');\n  const [nit, setNit] = useState<string>('');\n  const [loading, setLoading] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n  const { organizationLanguage, setOrganizationLanguage } = useLanguage();\n  const [selectedOrgLanguage, setSelectedOrgLanguage] = useState<string>('');\n  const [savingOrgLanguage, setSavingOrgLanguage] = useState<boolean>(false);\n  const [activeTab, setActiveTab] = useState<'general' | 'roles' | 'documents' | 'smtp' | 'api'>('general');\n  const [logoFile, setLogoFile] = useState<File | null>(null);\n  const [logoPreview, setLogoPreview] = useState<string | null>(null);\n\n  // Lnder-Liste\n  const COUNTRIES = [\n    { code: 'CO', name: t('countries.CO') },\n    { code: 'CH', name: t('countries.CH') },\n    { code: 'DE', name: t('countries.DE') },\n    { code: 'AT', name: t('countries.AT') }\n  ];\n\n  // Lade Organisations-Daten wenn Modal geffnet wird\n  useEffect(() => {\n    if (isOpen && organization) {\n      //  PERFORMANCE: Settings laden wenn Modal geffnet wird und Settings fehlen\n      const loadSettingsIfNeeded = async () => {\n        let orgWithSettings = organization;\n        \n        // Settings laden wenn fehlen\n        if (!organization.settings) {\n          try {\n            orgWithSettings = await organizationService.getCurrentOrganization(undefined, true);\n          } catch (error) {\n            console.error('Fehler beim Laden der Settings:', error);\n          }\n        }\n        \n        //  PERFORMANCE: Organization mit Settings fr Tab-Komponenten speichern\n        setOrganizationWithSettings(orgWithSettings);\n        \n        const orgSettings = orgWithSettings.settings || {};\n        setFormData({\n          displayName: orgWithSettings.displayName || '',\n          domain: orgWithSettings.domain || '',\n          logo: orgWithSettings.logo || '',\n          country: orgWithSettings.country || null,\n          nit: orgWithSettings.nit || null,\n          settings: orgSettings\n        });\n        \n        // Setze Land direkt aus organization (statt aus settings)\n        setSelectedCountry(orgWithSettings.country || '');\n        setNit(orgWithSettings.nit || '');\n        \n        // Setze Logo-Preview wenn Logo vorhanden\n        if (orgWithSettings.logo) {\n          setLogoPreview(orgWithSettings.logo);\n        } else {\n          setLogoPreview(null);\n        }\n        setLogoFile(null);\n        \n        // Lade Organisation-Sprache\n        const loadOrgLanguage = async () => {\n          try {\n            const langResponse = await organizationService.getOrganizationLanguage();\n            setSelectedOrgLanguage(langResponse.language || '');\n          } catch (langError) {\n            console.error(t('organization.loadLanguageError'), langError);\n            setSelectedOrgLanguage('');\n          }\n        };\n        \n        loadOrgLanguage();\n      };\n      \n      loadSettingsIfNeeded();\n    } else if (!isOpen) {\n      //  PERFORMANCE: State zurcksetzen beim Schlieen\n      setOrganizationWithSettings(null);\n    }\n  }, [isOpen, organization, t]);\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLSelectElement>) => {\n    const { name, value } = e.target;\n    if (name === 'country') {\n      setSelectedCountry(value);\n      setFormData(prev => ({\n        ...prev,\n        country: value || null\n      }));\n      // Wenn Country nicht \"CO\" ist, NIT zurcksetzen\n      if (value !== 'CO') {\n        setNit('');\n        setFormData(prev => ({\n          ...prev,\n          nit: null\n        }));\n      }\n    } else if (name === 'nit') {\n      setNit(value);\n      setFormData(prev => ({\n        ...prev,\n        nit: value || null\n      }));\n    } else {\n      setFormData(prev => ({ ...prev, [name]: value }));\n    }\n    // Fehler fr dieses Feld lschen\n    if (errors[name]) {\n      setErrors(prev => ({ ...prev, [name]: '' }));\n    }\n  };\n\n  const handleLogoFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    // Prfe Dateityp\n    if (!file.type.match('image/(png|jpeg|jpg)')) {\n      showMessage(t('organization.logoInvalidType') || 'Nur PNG und JPEG Dateien sind erlaubt', 'error');\n      return;\n    }\n\n    // Prfe Dateigre (max 5MB)\n    if (file.size > 5 * 1024 * 1024) {\n      showMessage(t('organization.logoTooLarge') || 'Logo darf maximal 5MB gro sein', 'error');\n      return;\n    }\n\n    setLogoFile(file);\n\n    // Erstelle Preview\n    const reader = new FileReader();\n    reader.onloadend = () => {\n      const base64String = reader.result as string;\n      setLogoPreview(base64String);\n      setFormData(prev => ({ ...prev, logo: base64String }));\n    };\n    reader.readAsDataURL(file);\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    try {\n      setLoading(true);\n      setErrors({});\n      await organizationService.updateOrganization(formData);\n      showMessage(t('organization.updateSuccess'), 'success');\n      \n      // User-Daten neu laden, damit das Logo im Header aktualisiert wird\n      try {\n        await fetchCurrentUser();\n      } catch (error) {\n        console.error('Fehler beim Neuladen der User-Daten:', error);\n      }\n      \n      onClose();\n      if (onSuccess) {\n        onSuccess();\n      }\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('organization.updateError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleClose = () => {\n    // Formular zurcksetzen\n    if (organization) {\n      const orgSettings = organization.settings || {};\n      setFormData({\n        displayName: organization.displayName || '',\n        domain: organization.domain || '',\n        logo: organization.logo || '',\n        country: organization.country || null,\n        nit: organization.nit || null,\n        settings: orgSettings\n      });\n      setSelectedCountry(organization.country || '');\n      setNit(organization.nit || '');\n    }\n    setErrors({});\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('organization.edit.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                <div>\n                  <label \n                    htmlFor=\"displayName\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.displayName')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"displayName\"\n                    name=\"displayName\"\n                    value={formData.displayName || ''}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.displayName \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.displayName && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n                  )}\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"domain\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.domain')}\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"domain\"\n                    name=\"domain\"\n                    value={formData.domain || ''}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n\n                <div>\n                  <label \n                    htmlFor=\"logo-mobile\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.logo') || 'Logo'}\n                  </label>\n                  <input\n                    type=\"file\"\n                    id=\"logo-mobile\"\n                    name=\"logo\"\n                    accept=\"image/png,image/jpeg,image/jpg\"\n                    onChange={handleLogoFileChange}\n                    className=\"mt-1 block w-full text-sm text-gray-500 dark:text-gray-400\n                      file:mr-4 file:py-2 file:px-4\n                      file:rounded-md file:border-0\n                      file:text-sm file:font-semibold\n                      file:bg-blue-50 file:text-blue-700\n                      hover:file:bg-blue-100\n                      dark:file:bg-blue-900 dark:file:text-blue-300\n                      dark:hover:file:bg-blue-800\"\n                  />\n                  {logoPreview && (\n                    <div className=\"mt-2\">\n                      <img \n                        src={logoPreview} \n                        alt=\"Logo Preview\" \n                        className=\"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded\"\n                      />\n                    </div>\n                  )}\n                  {formData.logo && !logoPreview && (\n                    <div className=\"mt-2\">\n                      <img \n                        src={formData.logo} \n                        alt=\"Current Logo\" \n                        className=\"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded\"\n                      />\n                    </div>\n                  )}\n                </div>\n\n                {/* Land */}\n                <div className=\"border-t pt-4\">\n                  <label \n                    htmlFor=\"country\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.country')}\n                  </label>\n                  <select\n                    id=\"country\"\n                    name=\"country\"\n                    value={selectedCountry}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  >\n                    <option value=\"\">{t('organization.selectCountry')}</option>\n                    {COUNTRIES.map((country) => (\n                      <option key={country.code} value={country.code}>\n                        {country.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n\n                {/* Organisation-Sprache */}\n                <div className=\"border-t pt-4\">\n                  <label \n                    htmlFor=\"organizationLanguage\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('organization.language')}\n                  </label>\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-2\">\n                    {t('organization.languageDescription')}\n                  </p>\n                  <select\n                    id=\"organizationLanguage\"\n                    value={selectedOrgLanguage || organizationLanguage || ''}\n                    onChange={async (e) => {\n                      const newLanguage = e.target.value;\n                      setSelectedOrgLanguage(newLanguage);\n                      if (newLanguage && newLanguage !== organizationLanguage) {\n                        setSavingOrgLanguage(true);\n                        try {\n                          await setOrganizationLanguage(newLanguage);\n                          showMessage(t('common.save'), 'success');\n                        } catch (error) {\n                          console.error(t('organization.saveLanguageError'), error);\n                          showMessage(t('worktime.messages.orgLanguageError'), 'error');\n                        } finally {\n                          setSavingOrgLanguage(false);\n                        }\n                      }\n                    }}\n                    disabled={savingOrgLanguage || loading}\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:cursor-not-allowed\"\n                  >\n                    <option value=\"\">{t('settings.useOrganizationLanguage')} ({t('worktime.language.fallback')}: {t('worktime.language.german')})</option>\n                    <option value=\"de\">{t('worktime.language.german')}</option>\n                    <option value=\"es\">{t('worktime.language.spanish')}</option>\n                    <option value=\"en\">{t('worktime.language.english')}</option>\n                  </select>\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('common.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.saving') : t('common.save')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('organization.edit.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        {/* Tabs Navigation */}\n        <div className=\"border-b border-gray-200 dark:border-gray-700\">\n          <nav className=\"-mb-px flex space-x-4 px-4\" aria-label=\"Tabs\">\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('general')}\n              className={`${\n                activeTab === 'general'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.general')}\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('roles')}\n              className={`${\n                activeTab === 'roles'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.roles')}\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('documents')}\n              className={`${\n                activeTab === 'documents'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.documents')}\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setActiveTab('smtp')}\n              className={`${\n                activeTab === 'smtp'\n                  ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n              } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n            >\n              {t('organization.tabs.smtp')}\n            </button>\n            {selectedCountry === 'CO' && (\n              <button\n                type=\"button\"\n                onClick={() => setActiveTab('api')}\n                className={`${\n                  activeTab === 'api'\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n              >\n                {t('organization.tabs.api')}\n              </button>\n            )}\n          </nav>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          {activeTab === 'general' && (\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\n            <div>\n              <label \n                htmlFor=\"displayName\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.displayName')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"displayName\"\n                name=\"displayName\"\n                value={formData.displayName || ''}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                  errors.displayName \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.displayName && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.displayName}</p>\n              )}\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"domain\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.domain')}\n              </label>\n              <input\n                type=\"text\"\n                id=\"domain\"\n                name=\"domain\"\n                value={formData.domain || ''}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div>\n              <label \n                htmlFor=\"logo\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.logo') || 'Logo'}\n              </label>\n              <input\n                type=\"file\"\n                id=\"logo\"\n                name=\"logo\"\n                accept=\"image/png,image/jpeg,image/jpg\"\n                onChange={handleLogoFileChange}\n                className=\"mt-1 block w-full text-sm text-gray-500 dark:text-gray-400\n                  file:mr-4 file:py-2 file:px-4\n                  file:rounded-md file:border-0\n                  file:text-sm file:font-semibold\n                  file:bg-blue-50 file:text-blue-700\n                  hover:file:bg-blue-100\n                  dark:file:bg-blue-900 dark:file:text-blue-300\n                  dark:hover:file:bg-blue-800\"\n              />\n              {logoPreview && (\n                <div className=\"mt-2\">\n                  <img \n                    src={logoPreview} \n                    alt=\"Logo Preview\" \n                    className=\"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded\"\n                  />\n                </div>\n              )}\n              {formData.logo && !logoPreview && (\n                <div className=\"mt-2\">\n                  <img \n                    src={formData.logo} \n                    alt=\"Current Logo\" \n                    className=\"h-20 w-auto border border-gray-300 dark:border-gray-600 rounded\"\n                  />\n                </div>\n              )}\n            </div>\n\n            {/* Land */}\n            <div className=\"border-t pt-4\">\n              <label \n                htmlFor=\"country\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.country')}\n              </label>\n              <select\n                id=\"country\"\n                name=\"country\"\n                value={selectedCountry}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              >\n                <option value=\"\">{t('organization.selectCountry')}</option>\n                {COUNTRIES.map((country) => (\n                  <option key={country.code} value={country.code}>\n                    {country.name}\n                  </option>\n                ))}\n              </select>\n            </div>\n\n            {/* NIT (nur fr Kolumbien) */}\n            {selectedCountry === 'CO' && (\n              <div>\n                <label \n                  htmlFor=\"nit\" \n                  className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                >\n                  {t('organization.nit')}\n                </label>\n                <input\n                  type=\"text\"\n                  id=\"nit\"\n                  name=\"nit\"\n                  value={nit}\n                  onChange={handleChange}\n                  placeholder={t('organization.nitDescription')}\n                  className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                />\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                  {t('organization.nitDescription')}\n                </p>\n              </div>\n            )}\n\n            {/* Organisation-Sprache */}\n            <div className=\"border-t pt-4\">\n              <label \n                htmlFor=\"organizationLanguage\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('organization.language')}\n              </label>\n              <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-2\">\n                {t('organization.languageDescription')}\n              </p>\n              <select\n                id=\"organizationLanguage\"\n                value={selectedOrgLanguage || organizationLanguage || ''}\n                onChange={async (e) => {\n                  const newLanguage = e.target.value;\n                  setSelectedOrgLanguage(newLanguage);\n                  if (newLanguage && newLanguage !== organizationLanguage) {\n                    setSavingOrgLanguage(true);\n                    try {\n                      await setOrganizationLanguage(newLanguage);\n                      showMessage(t('common.save'), 'success');\n                    } catch (error) {\n                      console.error('Fehler beim Speichern der Organisation-Sprache:', error);\n                      showMessage(t('worktime.messages.orgLanguageError'), 'error');\n                    } finally {\n                      setSavingOrgLanguage(false);\n                    }\n                  }\n                }}\n                disabled={savingOrgLanguage || loading}\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:cursor-not-allowed\"\n              >\n                <option value=\"\">{t('settings.useOrganizationLanguage')} ({t('worktime.language.fallback')}: {t('worktime.language.german')})</option>\n                <option value=\"de\">{t('worktime.language.german')}</option>\n                <option value=\"es\">{t('worktime.language.spanish')}</option>\n                <option value=\"en\">{t('worktime.language.english')}</option>\n              </select>\n            </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('common.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? t('organization.saving') : t('common.save')}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          )}\n\n          {activeTab === 'roles' && (\n            <Suspense fallback={<div className=\"p-4 text-center\">{t('common.loading', 'Lade...')}</div>}>\n              <RoleConfigurationTab \n                organization={organizationWithSettings || organization}\n                onSave={() => {\n                  if (onSuccess) {\n                    onSuccess();\n                  }\n                }}\n              />\n            </Suspense>\n          )}\n\n          {activeTab === 'documents' && (\n            <Suspense fallback={<div className=\"p-4 text-center\">{t('common.loading', 'Lade...')}</div>}>\n              <DocumentConfigurationTab \n                organization={organizationWithSettings || organization}\n                onSave={() => {\n                  if (onSuccess) {\n                    onSuccess();\n                  }\n                }}\n              />\n            </Suspense>\n          )}\n\n          {activeTab === 'smtp' && (\n            <Suspense fallback={<div className=\"p-4 text-center\">{t('common.loading', 'Lade...')}</div>}>\n              <SMTPConfigurationTab \n                organization={organizationWithSettings || organization}\n                onSave={() => {\n                  if (onSuccess) {\n                    onSuccess();\n                  }\n                }}\n              />\n            </Suspense>\n          )}\n\n          {activeTab === 'api' && selectedCountry === 'CO' && (\n            <Suspense fallback={<div className=\"p-4 text-center\">{t('common.loading', 'Lade...')}</div>}>\n              <ApiConfigurationTab \n                organization={organizationWithSettings || organization}\n                onSave={() => {\n                  if (onSuccess) {\n                    onSuccess();\n                  }\n                }}\n              />\n            </Suspense>\n          )}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default EditOrganizationModal;\n\n","import React, { useState, useEffect, useMemo, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { XMarkIcon, ArrowPathIcon, FunnelIcon, ArrowUturnLeftIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { OrganizationJoinRequest } from '../../types/organization.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport FilterPane from '../FilterPane.tsx';\nimport SavedFilterTags from '../SavedFilterTags.tsx';\nimport { useFilterContext } from '../../contexts/FilterContext.tsx';\nimport { FilterCondition } from '../FilterRow.tsx';\nimport axiosInstance from '../../config/axios.ts';\nimport { logger } from '../../utils/logger.ts';\n\n// Status-Badge Funktionen\nconst getStatusColor = (status: string) => {\n  switch (status) {\n    case 'pending':\n      return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300';\n    case 'approved':\n      return 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300';\n    case 'rejected':\n      return 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300';\n    case 'withdrawn':\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n    default:\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n  }\n};\n\nconst getStatusText = (status: string, t: any) => {\n  switch (status) {\n    case 'pending':\n      return t('joinRequestsList.status.pending');\n    case 'approved':\n      return t('joinRequestsList.status.approved');\n    case 'rejected':\n      return t('joinRequestsList.status.rejected');\n    case 'withdrawn':\n      return t('joinRequestsList.status.withdrawn');\n    default:\n      return status;\n  }\n};\n\nconst MY_JOIN_REQUESTS_TABLE_ID = 'my-join-requests-table';\n\nconst MyJoinRequestsList: React.FC = () => {\n  const { t } = useTranslation();\n  const [joinRequests, setJoinRequests] = useState<OrganizationJoinRequest[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isFilterPanelOpen, setIsFilterPanelOpen] = useState<boolean>(false);\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const { showMessage } = useMessage();\n  const mountedRef = useRef(true);\n  const [withdrawingId, setWithdrawingId] = useState<number | null>(null);\n  \n  // Filter State Management (Controlled Mode)\n  const [activeFilterName, setActiveFilterName] = useState<string>('Alle');\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n\n  useEffect(() => {\n    return () => {\n      mountedRef.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    logger.log('MyJoinRequestsList: useEffect called - component mounted');\n    \n    // WICHTIG: State beim Mount zurcksetzen, um Caching zwischen Usern zu vermeiden\n    logger.log('MyJoinRequestsList: Resetting state on mount to prevent data leaks');\n    setJoinRequests([]);\n    setError(null);\n    setLoading(true);\n    \n    let isMounted = true;\n    \n    const fetchMyJoinRequests = async () => {\n      if (!isMounted) {\n        logger.log('MyJoinRequestsList: Component unmounted, skipping fetch');\n        return;\n      }\n      \n      logger.log('MyJoinRequestsList: Starting fetch');\n      \n      // Timeout nach 10 Sekunden\n      const timeoutId = setTimeout(() => {\n        if (isMounted) {\n          console.error('Request timeout after 10 seconds');\n          setError('Anfrage dauert zu lange. Bitte Seite neu laden.');\n          setLoading(false);\n        }\n      }, 10000);\n      \n      try {\n        logger.log('MyJoinRequestsList: Setting loading to true');\n        setLoading(true);\n        setError(null);\n        \n        // Debug: Log die URL die aufgerufen wird\n        logger.log('MyJoinRequestsList: Fetching my join requests from:', API_ENDPOINTS.ORGANIZATIONS.MY_JOIN_REQUESTS);\n        \n        const requests = await organizationService.getMyJoinRequests();\n        \n        logger.log('MyJoinRequestsList: Received requests:', requests);\n        logger.log('MyJoinRequestsList: Requests type:', typeof requests);\n        logger.log('MyJoinRequestsList: Requests isArray:', Array.isArray(requests));\n        logger.log('MyJoinRequestsList: Requests length:', requests?.length || 0);\n        \n        // SICHERHEIT: Validiere, dass alle Anfragen wirklich Arrays sind\n        if (!Array.isArray(requests)) {\n          console.error(' MyJoinRequestsList: Response is not an array!', requests);\n          throw new Error('Ungltige Antwort vom Server');\n        }\n        \n        clearTimeout(timeoutId);\n        \n        // State immer setzen, auch wenn Component unmounted ist\n        // (React kann den State trotzdem setzen, wenn Component wieder gemountet wird)\n        if (isMounted) {\n          logger.log('MyJoinRequestsList: Setting joinRequests state');\n          setJoinRequests(requests);\n          logger.log('MyJoinRequestsList: State updated with', requests.length, 'requests');\n        } else {\n          logger.log('MyJoinRequestsList: Component was unmounted, but setting state anyway');\n          setJoinRequests(requests);\n        }\n      } catch (err: any) {\n        clearTimeout(timeoutId);\n        \n        if (!isMounted) {\n          logger.log('MyJoinRequestsList: Component unmounted during error, skipping error handling');\n          return;\n        }\n        \n        console.error('MyJoinRequestsList: Error fetching my join requests:', err);\n        console.error('MyJoinRequestsList: Error response:', err.response);\n        console.error('MyJoinRequestsList: Error status:', err.response?.status);\n        console.error('MyJoinRequestsList: Error data:', err.response?.data);\n        \n        const errorMessage = err.response?.data?.message || err.message || t('myJoinRequests.loadError');\n        setError(errorMessage);\n        setTimeout(() => {\n          showMessage(errorMessage, 'error');\n        }, 0);\n      } finally {\n        if (isMounted) {\n          logger.log('MyJoinRequestsList: Setting loading to false');\n          setLoading(false);\n        } else {\n          // Auch wenn unmounted, loading auf false setzen\n          logger.log('MyJoinRequestsList: Component unmounted, but setting loading to false anyway');\n          setLoading(false);\n        }\n      }\n    };\n\n    // IMMER neu laden beim Mount (auch beim Tab-Wechsel zurck)\n    fetchMyJoinRequests();\n    \n    return () => {\n      logger.log('MyJoinRequestsList: useEffect cleanup - component unmounting');\n      isMounted = false;\n      mountedRef.current = false;\n      // State beim Unmount zurcksetzen\n      setJoinRequests([]);\n      setError(null);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const handleWithdraw = async (requestId: number) => {\n    if (!window.confirm(t('myJoinRequests.confirmWithdraw'))) {\n      return;\n    }\n\n    try {\n      setWithdrawingId(requestId);\n      await organizationService.withdrawJoinRequest(requestId);\n      \n      // Update local state\n      setJoinRequests(prev => \n        prev.map(req => \n          req.id === requestId \n            ? { ...req, status: 'withdrawn' as const, processedAt: new Date().toISOString() }\n            : req\n        )\n      );\n      \n      showMessage(t('myJoinRequests.withdrawSuccess'), 'success');\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('myJoinRequests.withdrawError');\n      showMessage(errorMessage, 'error');\n    } finally {\n      setWithdrawingId(null);\n    }\n  };\n\n  const formatDate = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('de-DE', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  // Filter-Funktionen\n  const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  };\n\n  const resetFilterConditions = () => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n    setActiveFilterName('');\n    setSelectedFilterId(null);\n  };\n\n  // Filter Change Handler (Controlled Mode)\n  const handleFilterChange = async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  };\n\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n  const filterContext = useFilterContext();\n  const { loadFilters } = filterContext;\n  \n  useEffect(() => {\n    const initialize = async () => {\n      // 1. Filter laden (wartet auf State-Update)\n      const filters = await loadFilters(MY_JOIN_REQUESTS_TABLE_ID);\n      \n      // 2. Default-Filter anwenden (IMMER vorhanden!)\n      const defaultFilter = filters.find(f => f.name === 'Alle');\n      if (defaultFilter) {\n        await handleFilterChange(\n          defaultFilter.name,\n          defaultFilter.id,\n          defaultFilter.conditions,\n          defaultFilter.operators\n        );\n        return; // Filter wird angewendet\n      }\n      \n      // 3. Fallback: Kein Filter (sollte nie passieren)\n      // MyJoinRequestsList filtert client-seitig, daher keine Daten-Lade-Funktion ntig\n    };\n    \n    initialize();\n  }, [loadFilters, handleFilterChange]);\n\n  // Standard-Filter erstellen und speichern\n  useEffect(() => {\n    const createStandardFilters = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        \n        if (!token) {\n          console.error('Nicht authentifiziert');\n          return;\n        }\n\n        // Prfen, ob die Standard-Filter bereits existieren\n        const existingFiltersResponse = await axiosInstance.get(\n          API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(MY_JOIN_REQUESTS_TABLE_ID)\n        );\n\n        const existingFilters = existingFiltersResponse.data || [];\n        const alleFilterExists = existingFilters.some((filter: any) => filter.name === 'Alle');\n\n        // Erstelle \"Alle\"-Filter, wenn er noch nicht existiert\n        if (!alleFilterExists) {\n          const alleFilter = {\n            tableId: MY_JOIN_REQUESTS_TABLE_ID,\n            name: 'Alle',\n            conditions: [],\n            operators: []\n          };\n\n          await axiosInstance.post(\n            API_ENDPOINTS.SAVED_FILTERS.BASE,\n            alleFilter\n          );\n          logger.log('Alle-Filter fr Meine Beitrittsanfragen erstellt');\n        }\n      } catch (error) {\n        console.error('Fehler beim Erstellen der Standard-Filter:', error);\n      }\n    };\n\n    createStandardFilters();\n  }, []);\n\n  // Gefilterte Join-Requests\n  const filteredJoinRequests = useMemo(() => {\n    let filtered = [...joinRequests];\n\n    // Suchfeld-Filter\n    if (searchTerm) {\n      const searchLower = searchTerm.toLowerCase();\n      filtered = filtered.filter(request => {\n        const orgName = (request.organization.displayName || request.organization.name || '').toLowerCase();\n        const message = request.message?.toLowerCase() || '';\n        return orgName.includes(searchLower) || message.includes(searchLower);\n      });\n    }\n\n    // Filter-Bedingungen aus FilterPane\n    if (filterConditions.length > 0) {\n      filtered = filterConditions.reduce((acc, condition, index) => {\n        if (!condition.column || condition.value === null || condition.value === '') {\n          return acc;\n        }\n\n        const operator = condition.operator;\n        const value = condition.value;\n\n        return acc.filter(request => {\n          switch (condition.column) {\n            case 'organization':\n              const orgName = (request.organization.displayName || request.organization.name || '').toLowerCase();\n              const searchValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return orgName.includes(searchValue);\n              } else if (operator === 'equals') {\n                return orgName === searchValue;\n              } else if (operator === 'startsWith') {\n                return orgName.startsWith(searchValue);\n              }\n              return false;\n\n            case 'message':\n              const message = request.message?.toLowerCase() || '';\n              const msgValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return message.includes(msgValue);\n              } else if (operator === 'equals') {\n                return message === msgValue;\n              } else if (operator === 'startsWith') {\n                return message.startsWith(msgValue);\n              }\n              return false;\n\n            case 'status':\n              if (operator === 'equals') {\n                return request.status === value;\n              }\n              return false;\n\n            default:\n              return true;\n          }\n        });\n      }, filtered);\n    }\n\n    return filtered;\n  }, [joinRequests, searchTerm, filterConditions, filterLogicalOperators]);\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n      {/* Titelzeile mit Icon, Suchfeld, Filter-Button */}\n      <div className=\"flex items-center justify-between mb-4\">\n        <h2 className=\"text-xl font-semibold dark:text-white\">\n          {t('myJoinRequests.title')}\n        </h2>\n        \n        <div className=\"flex items-center gap-1.5\">\n          {/* Suchfeld */}\n          <input\n            type=\"text\"\n            placeholder={t('common.search', { defaultValue: 'Suchen...' })}\n            className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n\n          {/* Filter-Button */}\n          <button\n            className={`p-2 rounded-md border ${getActiveFilterCount() > 0 ? 'border-blue-300 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n            onClick={() => setIsFilterPanelOpen(!isFilterPanelOpen)}\n            title={t('common.filter')}\n          >\n            <FunnelIcon className=\"h-5 w-5\" />\n            {getActiveFilterCount() > 0 && (\n              <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center\">\n                {getActiveFilterCount()}\n              </span>\n            )}\n          </button>\n        </div>\n      </div>\n\n      {/* Filter-Panel */}\n      {isFilterPanelOpen && (\n        <div className=\"mb-4\">\n          <FilterPane\n            columns={[\n              { id: 'organization', label: t('myJoinRequests.filter.organization', { defaultValue: 'Organisation' }) },\n              { id: 'message', label: t('joinRequestsList.filter.message') },\n              { id: 'status', label: t('joinRequestsList.status.title', { defaultValue: 'Status' }) }\n            ]}\n            onApply={applyFilterConditions}\n            onReset={resetFilterConditions}\n            savedConditions={filterConditions}\n            savedOperators={filterLogicalOperators}\n            tableId={MY_JOIN_REQUESTS_TABLE_ID}\n          />\n        </div>\n      )}\n\n      {/* Gespeicherte Filter als Tags anzeigen */}\n      <SavedFilterTags\n        tableId={MY_JOIN_REQUESTS_TABLE_ID}\n        onSelectFilter={applyFilterConditions}\n        onReset={resetFilterConditions}\n        activeFilterName={activeFilterName}\n        selectedFilterId={selectedFilterId}\n        onFilterChange={handleFilterChange}\n        defaultFilterName=\"Alle\"\n      />\n\n      {/* Error Display */}\n      {error && (\n        <div className=\"mb-4 p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded\">\n          {error}\n        </div>\n      )}\n\n      {/* Loading State */}\n      {loading ? (\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('myJoinRequests.loading')}</span>\n        </div>\n      ) : joinRequests.length === 0 ? (\n        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n          {t('myJoinRequests.noRequests')}\n        </div>\n      ) : (\n        /* Cards fr Join-Requests */\n        <div className=\"space-y-4\">\n          {filteredJoinRequests.map(request => (\n            <div\n              key={request.id}\n              className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\"\n            >\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <div>\n                      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                        {request.organization.displayName || request.organization.name}\n                      </h3>\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                        {formatDate(request.createdAt)}\n                      </p>\n                    </div>\n                    <span className={`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusColor(request.status)}`}>\n                      {getStatusText(request.status, t)}\n                    </span>\n                  </div>\n\n                  {request.message && (\n                    <div className=\"mt-3 p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n                      <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.filter.message')}:</span> {request.message}\n                      </p>\n                    </div>\n                  )}\n\n                  {request.response && (\n                    <div className=\"mt-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-200 dark:border-blue-700\">\n                      <p className=\"text-sm text-blue-700 dark:text-blue-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.response')}:</span> {request.response}\n                      </p>\n                    </div>\n                  )}\n\n                  {request.processor && (\n                    <div className=\"mt-2 text-sm text-gray-600 dark:text-gray-400\">\n                      {t('myJoinRequests.processedBy')}: {request.processor.firstName} {request.processor.lastName}\n                      {request.processedAt && ` - ${formatDate(request.processedAt)}`}\n                    </div>\n                  )}\n\n                  {request.status === 'pending' && (\n                    <div className=\"mt-4 flex items-center gap-2\">\n                      <button \n                        onClick={() => handleWithdraw(request.id)}\n                        disabled={withdrawingId === request.id}\n                        className=\"p-2 bg-red-600 hover:bg-red-700 text-white rounded-md dark:bg-red-700 dark:hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n                        title={withdrawingId === request.id ? t('myJoinRequests.withdrawing') : t('myJoinRequests.withdraw')}\n                      >\n                        {withdrawingId === request.id ? (\n                          <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                        ) : (\n                          <ArrowUturnLeftIcon className=\"h-5 w-5\" />\n                        )}\n                      </button>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default MyJoinRequestsList;\n\n","import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { BuildingOfficeIcon, PlusIcon, UserPlusIcon, UserGroupIcon, ShieldCheckIcon, EnvelopeIcon, ChartBarIcon, PencilIcon } from '@heroicons/react/24/outline';\nimport { useTranslation } from 'react-i18next';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { Organization } from '../../types/organization.ts';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useOrganization } from '../../contexts/OrganizationContext.tsx';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport CreateOrganizationModal from './CreateOrganizationModal.tsx';\nimport JoinOrganizationModal from './JoinOrganizationModal.tsx';\nimport EditOrganizationModal from './EditOrganizationModal.tsx';\nimport MyJoinRequestsList from './MyJoinRequestsList.tsx';\n\ninterface OrganizationStats {\n  currentUsers: number;\n  maxUsers: number;\n  availableSlots: number;\n  utilizationPercent: number;\n  _count: {\n    roles: number;\n    joinRequests: number;\n    invitations: number;\n  };\n}\n\nconst OrganizationSettings: React.FC = () => {\n  const [organization, setOrganization] = useState<Organization | null>(null);\n  const [stats, setStats] = useState<OrganizationStats | null>(null);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [loadingStats, setLoadingStats] = useState<boolean>(false);\n  const [error, setError] = useState<string | null>(null);\n  const [isCreateModalOpen, setIsCreateModalOpen] = useState<boolean>(false);\n  const [isJoinModalOpen, setIsJoinModalOpen] = useState<boolean>(false);\n  const [isEditModalOpen, setIsEditModalOpen] = useState<boolean>(false);\n  const { canViewOrganization, canManageOrganization, loading: permissionsLoading } = usePermissions();\n  const { showMessage } = useMessage();\n  const { t } = useTranslation();\n  const { refreshOrganization } = useOrganization();\n  const { fetchCurrentUser } = useAuth();\n\n  const fetchOrganization = useCallback(async (includeSettings = false) => {\n    try {\n      setLoading(true);\n      setError(null);\n      //  PERFORMANCE: Settings nur laden wenn wirklich bentigt (beim Bearbeiten)\n      const org = await organizationService.getCurrentOrganization(undefined, includeSettings);\n      setOrganization(org);\n      \n      // Statistiken laden\n      try {\n        setLoadingStats(true);\n        const statsData = await organizationService.getOrganizationStats();\n        setStats(statsData);\n      } catch (statsErr: any) {\n        console.error('Fehler beim Laden der Statistiken:', statsErr);\n        // Statistiken-Fehler nicht kritisch, keine Error-Message\n      } finally {\n        setLoadingStats(false);\n      }\n    } catch (err: any) {\n      // Prfe ob es ein 404-Fehler ist (keine Organisation gefunden)\n      if (err.response?.status === 404 && err.response?.data?.hasOrganization === false) {\n        // Benutzer hat keine Organisation - das ist OK, setze Error aber nicht kritisch\n        // Verwende IMMER die bersetzung, nicht die Backend-Nachricht\n        setError(t('organization.notFound'));\n        setOrganization(null);\n        // Zeige Info-Message statt Error\n        showMessage(t('organization.notFound'), 'info');\n      } else {\n        // Andere Fehler - kritisch\n        const errorMessage = err.response?.data?.message || t('organization.loadError');\n        setError(errorMessage);\n        showMessage(errorMessage, 'error');\n      }\n    } finally {\n      setLoading(false);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const hasInitialLoadRef = useRef(false);\n\n  useEffect(() => {\n    // Warte bis Berechtigungen geladen sind\n    if (permissionsLoading) {\n      return;\n    }\n\n    // Nur einmal beim initialen Load ausfhren\n    if (hasInitialLoadRef.current) {\n      return;\n    }\n\n    const hasPermission = canViewOrganization();\n    if (hasPermission) {\n    hasInitialLoadRef.current = true;\n    //  PERFORMANCE: Initial OHNE Settings laden (nur beim Bearbeiten)\n    fetchOrganization(false);\n    } else {\n      setError(t('organization.noPermission'));\n      setLoading(false);\n      hasInitialLoadRef.current = true;\n    }\n    \n    //  MEMORY: Cleanup - Settings aus State entfernen beim Unmount\n    return () => {\n      setOrganization(null);\n      setStats(null);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [permissionsLoading]);\n\n  const handleEditSuccess = () => {\n    //  PERFORMANCE: Nach Bearbeiten Settings laden (fr Anzeige)\n    fetchOrganization(true);\n    // Aktualisiere auch den OrganizationContext\n    refreshOrganization();\n  };\n\n  //  MEMORY: Settings beim Schlieen des Modals lschen\n  const handleEditModalClose = () => {\n    setIsEditModalOpen(false);\n    // Settings aus State entfernen (nur Settings, nicht die gesamte Organization)\n    if (organization?.settings) {\n      setOrganization({\n        ...organization,\n        settings: undefined\n      });\n    }\n  };\n\n  if (permissionsLoading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('common.loadingPermissions')}</span>\n        </div>\n      </div>\n    );\n  }\n\n  if (!canViewOrganization()) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n          <div className=\"p-4 text-red-600 dark:text-red-400\">\n          {t('organization.noPermission')}\n        </div>\n      </div>\n    );\n  }\n\n  const handleCreateSuccess = () => {\n    //  PERFORMANCE: Nach Erstellen OHNE Settings laden (nicht bentigt)\n    fetchOrganization(false);\n  };\n\n  const handleJoinSuccess = async () => {\n    // Nach Beitritt: Organisation neu laden (OHNE Settings, nicht bentigt)\n    fetchOrganization(false);\n    // WICHTIG: User-Rollen neu laden, damit neue Rolle sichtbar wird\n    // OnboardingContext erkennt dann automatisch die neue Rolle\n    await fetchCurrentUser();\n  };\n\n  return (\n    <>\n      <div className=\"space-y-4\">\n        {/* Titelzeile mit Action-Buttons */}\n        <div className=\"flex items-center mb-4 sm:mb-4\">\n          {/* Linke Seite: Action-Buttons */}\n          <div className=\"flex items-center gap-1.5\" data-onboarding=\"organization-buttons\">\n            {/* Button: Neue Organisation erstellen - immer sichtbar (nicht nur fr Admins) */}\n            <button\n              onClick={() => setIsCreateModalOpen(true)}\n              data-onboarding=\"create-organization-button\"\n              className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n              style={{ width: '30.19px', height: '30.19px' }}\n              title={t('organization.createOrganization')}\n              aria-label={t('organization.createOrganization')}\n            >\n              <PlusIcon className=\"h-4 w-4\" />\n            </button>\n            \n            {/* Button: Organisation beitreten - immer sichtbar */}\n            <button\n              onClick={() => setIsJoinModalOpen(true)}\n              data-onboarding=\"join-organization-button\"\n              className=\"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-700 border border-blue-200 dark:border-gray-700 shadow-sm flex items-center justify-center\"\n              style={{ width: '30.19px', height: '30.19px' }}\n              title={t('organization.joinOrganization')}\n              aria-label={t('organization.joinOrganization')}\n            >\n              <UserPlusIcon className=\"h-4 w-4\" />\n            </button>\n          </div>\n        </div>\n\n      {/* Loading State */}\n      {loading ? (\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('common.loadingOrganization')}</span>\n        </div>\n      ) : (\n        <>\n          {/* Error/Info Display */}\n          {error && (\n            <div className={`mb-4 p-4 border rounded ${\n              !organization \n                ? 'bg-blue-50 dark:bg-blue-900/30 border-blue-400 dark:border-blue-700 text-blue-700 dark:text-blue-300'\n                : 'bg-red-100 dark:bg-red-900 border-red-400 dark:border-red-700 text-red-700 dark:text-red-300'\n            }`}>\n              <div className=\"flex items-start\">\n                <div className=\"flex-shrink-0\">\n                  {!organization ? (\n                    <UserGroupIcon className=\"h-5 w-5\" />\n                  ) : (\n                    <span className=\"text-red-600 dark:text-red-400\"></span>\n                  )}\n                </div>\n                <div className=\"ml-3 flex-1\">\n                  <p className=\"font-medium\">{error}</p>\n                  {!organization && (\n                    <p className=\"mt-2 text-sm\">{t('organization.createOrJoinHint')}</p>\n                  )}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Card-Ansicht - nur anzeigen wenn Organisation existiert */}\n          {organization ? (\n            <>\n            {/* Card mit Organisations-Infos */}\n            <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center justify-between mb-4\">\n            <div>\n                      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white flex items-center\">\n                        <BuildingOfficeIcon className=\"h-5 w-5 mr-2\" />\n                        {organization.displayName || organization.name}\n                      </h3>\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">\n                        {organization.domain || t('organization.noDomain')}\n                      </p>\n            </div>\n                    {canManageOrganization() && (\n                      <button\n                        onClick={() => {\n                          //  PERFORMANCE: Modal ffnet sofort - Settings werden im Modal geladen wenn bentigt\n                          setIsEditModalOpen(true);\n                        }}\n                        className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n                        title={t('organization.edit.title')}\n                      >\n                        <PencilIcon className=\"h-5 w-5\" />\n                      </button>\n                    )}\n            </div>\n\n                  {/* Organisations-Infos */}\n                  <div className=\"space-y-3\">\n                    {organization.subscriptionPlan && (\n            <div>\n                        <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">{t('organization.subscriptionPlan')}:</span>\n                        <span className=\"ml-2 text-sm text-gray-900 dark:text-white capitalize\">{organization.subscriptionPlan}</span>\n              </div>\n            )}\n              </div>\n\n                  {/* Statistiken direkt in der Card */}\n          {stats && (\n                    <>\n            <div className=\"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700\">\n              <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">{t('organization.statistics')}</h3>\n              {loadingStats ? (\n                <div className=\"flex items-center justify-center py-4\">\n                  <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mr-2\"></div>\n                  <span className=\"text-sm text-gray-500 dark:text-gray-400\">{t('common.loadingStatistics')}</span>\n                </div>\n              ) : (\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {/* Benutzer Card */}\n                  <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 bg-blue-100 dark:bg-blue-900/30 rounded-lg p-3\">\n                        <UserGroupIcon className=\"h-6 w-6 text-blue-600 dark:text-blue-400\" />\n                      </div>\n                      <div className=\"ml-4\">\n                        <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.users')}</p>\n                        <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                          {stats.currentUsers} / {stats.maxUsers}\n                        </p>\n                            {stats.utilizationPercent !== undefined && (\n                          <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                            {stats.utilizationPercent}% {t('organization.utilizationPercent')}\n                          </p>\n                        )}\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Rollen Card */}\n                  <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 bg-purple-100 dark:bg-purple-900/30 rounded-lg p-3\">\n                        <ShieldCheckIcon className=\"h-6 w-6 text-purple-600 dark:text-purple-400\" />\n                      </div>\n                      <div className=\"ml-4\">\n                        <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.roles')}</p>\n                        <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                          {stats._count.roles}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Beitrittsanfragen Card */}\n                  <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                    <div className=\"flex items-center\">\n                      <div className=\"flex-shrink-0 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg p-3\">\n                        <EnvelopeIcon className=\"h-6 w-6 text-yellow-600 dark:text-yellow-400\" />\n                      </div>\n                      <div className=\"ml-4\">\n                        <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.joinRequests')}</p>\n                        <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                          {stats._count.joinRequests}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Einladungen Card */}\n                  {stats._count.invitations !== undefined && (\n                    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                      <div className=\"flex items-center\">\n                        <div className=\"flex-shrink-0 bg-green-100 dark:bg-green-900/30 rounded-lg p-3\">\n                          <EnvelopeIcon className=\"h-6 w-6 text-green-600 dark:text-green-400\" />\n                        </div>\n                        <div className=\"ml-4\">\n                          <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.invitations')}</p>\n                          <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                            {stats._count.invitations}\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Auslastung Card */}\n                  {stats.utilizationPercent !== undefined && (\n                    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\">\n                      <div className=\"flex items-center\">\n                        <div className=\"flex-shrink-0 bg-indigo-100 dark:bg-indigo-900/30 rounded-lg p-3\">\n                          <ChartBarIcon className=\"h-6 w-6 text-indigo-600 dark:text-indigo-400\" />\n                        </div>\n                        <div className=\"ml-4\">\n                          <p className=\"text-sm font-medium text-gray-600 dark:text-gray-400\">{t('organization.utilization')}</p>\n                          <p className=\"text-2xl font-semibold text-gray-900 dark:text-white\">\n                            {stats.utilizationPercent}%\n                          </p>\n                          <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                            {stats.availableSlots} {t('organization.availableSlots')}\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n                    </>\n                  )}\n                </div>\n              </div>\n            </div>\n\n            </>\n          ) : (\n            /* Keine Organisation - zeige Hinweis */\n            <div className=\"text-center py-8\">\n            <UserGroupIcon className=\"mx-auto h-12 w-12 text-gray-400 dark:text-gray-500 mb-4\" />\n            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">\n              {t('organization.notFound')}\n            </h3>\n            <p className=\"text-gray-600 dark:text-gray-400\">\n              {t('organization.createOrJoinHint')}\n            </p>\n          </div>\n        )}\n        </>\n      )}\n      </div>\n\n      {/* Meine Beitrittsanfragen - immer anzeigen */}\n      <MyJoinRequestsList />\n\n      {/* Modals */}\n      <CreateOrganizationModal\n        isOpen={isCreateModalOpen}\n        onClose={() => setIsCreateModalOpen(false)}\n        onSuccess={handleCreateSuccess}\n      />\n\n      <JoinOrganizationModal\n        isOpen={isJoinModalOpen}\n        onClose={() => setIsJoinModalOpen(false)}\n        onSuccess={handleJoinSuccess}\n      />\n\n      <EditOrganizationModal\n        isOpen={isEditModalOpen}\n        onClose={handleEditModalClose}\n        onSuccess={handleEditSuccess}\n        organization={organization}\n      />\n    </>\n  );\n};\n\nexport default OrganizationSettings; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon, XCircleIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { OrganizationJoinRequest, ProcessJoinRequestRequest } from '../../types/organization.ts';\nimport { roleApi } from '../../api/apiClient.ts';\nimport { Role } from '../../types/interfaces.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface Props {\n  isOpen: boolean;\n  onClose: () => void;\n  joinRequest: OrganizationJoinRequest | null;\n  onSuccess: () => void;\n}\n\nconst ProcessJoinRequestModal: React.FC<Props> = ({ isOpen, onClose, joinRequest, onSuccess }) => {\n  const { t } = useTranslation();\n  const [action, setAction] = useState<'approve' | 'reject'>('approve');\n  const [roleId, setRoleId] = useState<number | null>(null);\n  const [response, setResponse] = useState<string>('');\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [loadingRoles, setLoadingRoles] = useState<boolean>(false);\n  const [saving, setSaving] = useState<boolean>(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const { openSidepane, closeSidepane } = useSidepane();\n  const { showMessage } = useMessage();\n\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  useEffect(() => {\n    if (isOpen && joinRequest) {\n      // Reset form when modal opens\n      setAction('approve');\n      setRoleId(null);\n      setResponse('');\n      setErrors({});\n      \n      // Load roles for the organization\n      if (joinRequest.organizationId) {\n        fetchRoles();\n      }\n    }\n  }, [isOpen, joinRequest]);\n\n  const fetchRoles = async () => {\n    try {\n      setLoadingRoles(true);\n      const response = await roleApi.getAll();\n      if (response.data && Array.isArray(response.data)) {\n        setRoles(response.data);\n      }\n    } catch (err: any) {\n      console.error('Fehler beim Laden der Rollen:', err);\n      showMessage(t('joinRequest.loadRolesError'), 'error');\n    } finally {\n      setLoadingRoles(false);\n    }\n  };\n\n  const validateForm = (): boolean => {\n    const newErrors: Record<string, string> = {};\n    \n    if (action === 'approve' && !roleId) {\n      newErrors.roleId = t('joinRequest.selectRoleError');\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) {\n      showMessage(t('joinRequest.fillRequired'), 'error');\n      return;\n    }\n    \n    if (!joinRequest) {\n      return;\n    }\n    \n    try {\n      setSaving(true);\n      const data: ProcessJoinRequestRequest = {\n        action,\n        response: response.trim() || undefined,\n        roleId: action === 'approve' ? roleId || undefined : undefined\n      };\n      \n      await organizationService.processJoinRequest(joinRequest.id, data);\n      showMessage(\n        action === 'approve' ? t('joinRequest.approveSuccess') : t('joinRequest.rejectSuccess'),\n        'success'\n      );\n      \n      // Reset form\n      setAction('approve');\n      setRoleId(null);\n      setResponse('');\n      setErrors({});\n      \n      onClose();\n      onSuccess();\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || t('joinRequest.processError');\n      showMessage(errorMessage, 'error');\n      setErrors({ submit: errorMessage });\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleClose = () => {\n    setAction('approve');\n    setRoleId(null);\n    setResponse('');\n    setErrors({});\n    onClose();\n  };\n\n  if (!joinRequest) {\n    return null;\n  }\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('joinRequest.title')}\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              {errors.submit && (\n                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                  {errors.submit}\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                {/* Antragsteller Info */}\n                <div className=\"p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n                  <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.applicant')}:</p>\n                  <p className=\"text-sm text-gray-900 dark:text-white\">\n                    {joinRequest.requester.firstName} {joinRequest.requester.lastName}\n                  </p>\n                  <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.requester.email}</p>\n                  {joinRequest.message && (\n                    <div className=\"mt-2 pt-2 border-t border-gray-200 dark:border-gray-600\">\n                      <p className=\"text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.message')}:</p>\n                      <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.message}</p>\n                    </div>\n                  )}\n                </div>\n\n                {/* Aktion (Genehmigen/Ablehnen) */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('joinRequest.actionRequired')}\n                  </label>\n                  <div className=\"flex gap-4 mt-2\">\n                    <label className=\"flex items-center\">\n                      <input\n                        type=\"radio\"\n                        value=\"approve\"\n                        checked={action === 'approve'}\n                        onChange={(e) => {\n                          setAction(e.target.value as 'approve' | 'reject');\n                          setErrors({});\n                        }}\n                        className=\"mr-2 text-blue-600 focus:ring-blue-500\"\n                      />\n                      <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.approve')}</span>\n                    </label>\n                    <label className=\"flex items-center\">\n                      <input\n                        type=\"radio\"\n                        value=\"reject\"\n                        checked={action === 'reject'}\n                        onChange={(e) => {\n                          setAction(e.target.value as 'approve' | 'reject');\n                          setErrors({});\n                        }}\n                        className=\"mr-2 text-red-600 focus:ring-red-500\"\n                      />\n                      <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.reject')}</span>\n                    </label>\n                  </div>\n                </div>\n\n                {/* Rollenauswahl (nur bei Genehmigung) */}\n                {action === 'approve' && (\n                  <div>\n                    <label \n                      htmlFor=\"roleId\" \n                      className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                    >\n                      {t('joinRequest.assignRole')}\n                    </label>\n                    {loadingRoles ? (\n                      <div className=\"flex items-center py-2\">\n                        <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2\"></div>\n                        <span className=\"text-sm text-gray-500 dark:text-gray-400\">{t('joinRequest.loadingRoles')}</span>\n                      </div>\n                    ) : (\n                      <select\n                        id=\"roleId\"\n                        value={roleId || ''}\n                        onChange={(e) => {\n                          setRoleId(Number(e.target.value) || null);\n                          if (errors.roleId) {\n                            setErrors(prev => ({ ...prev, roleId: '' }));\n                          }\n                        }}\n                        className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                          errors.roleId \n                            ? 'border-red-300 dark:border-red-600' \n                            : 'border-gray-300 dark:border-gray-600'\n                        }`}\n                      >\n                        <option value=\"\">{t('joinRequest.selectRole')}</option>\n                        {roles.map(role => (\n                          <option key={role.id} value={role.id}>\n                            {role.name} {role.description ? `- ${role.description}` : ''}\n                          </option>\n                        ))}\n                      </select>\n                    )}\n                    {errors.roleId && (\n                      <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.roleId}</p>\n                    )}\n                  </div>\n                )}\n\n                {/* Antwort-Message */}\n                <div>\n                  <label \n                    htmlFor=\"response\" \n                    className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                  >\n                    {t('joinRequest.response')}\n                  </label>\n                  <textarea\n                    id=\"response\"\n                    value={response}\n                    onChange={(e) => setResponse(e.target.value)}\n                    rows={3}\n                    placeholder={t('joinRequest.addOptional', { type: action === 'approve' ? t('joinRequest.welcomeMessage') : t('joinRequest.rejectionReason') })}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                  title={t('joinRequest.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={saving}\n                  className={`p-2 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors ${\n                    action === 'approve'\n                      ? 'bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800 focus:ring-green-500'\n                      : 'bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 focus:ring-red-500'\n                  }`}\n                  title={saving ? (action === 'approve' ? t('joinRequest.approving') : t('joinRequest.rejecting')) : (action === 'approve' ? t('joinRequest.approve') : t('joinRequest.reject'))}\n                >\n                  {saving ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : action === 'approve' ? (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  ) : (\n                    <XCircleIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('joinRequest.title')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {errors.submit && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {errors.submit}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            {/* Antragsteller Info */}\n            <div className=\"p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n              <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.applicant')}:</p>\n              <p className=\"text-sm text-gray-900 dark:text-white\">\n                {joinRequest.requester.firstName} {joinRequest.requester.lastName}\n              </p>\n              <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.requester.email}</p>\n              {joinRequest.message && (\n                <div className=\"mt-2 pt-2 border-t border-gray-200 dark:border-gray-600\">\n                  <p className=\"text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">{t('joinRequest.message')}:</p>\n                  <p className=\"text-xs text-gray-600 dark:text-gray-400\">{joinRequest.message}</p>\n                </div>\n              )}\n            </div>\n\n            {/* Aktion (Genehmigen/Ablehnen) */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                {t('joinRequest.actionRequired')}\n              </label>\n              <div className=\"flex gap-4 mt-2\">\n                <label className=\"flex items-center\">\n                  <input\n                    type=\"radio\"\n                    value=\"approve\"\n                    checked={action === 'approve'}\n                    onChange={(e) => {\n                      setAction(e.target.value as 'approve' | 'reject');\n                      setErrors({});\n                    }}\n                    className=\"mr-2 text-blue-600 focus:ring-blue-500\"\n                  />\n                  <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.approve')}</span>\n                </label>\n                <label className=\"flex items-center\">\n                  <input\n                    type=\"radio\"\n                    value=\"reject\"\n                    checked={action === 'reject'}\n                    onChange={(e) => {\n                      setAction(e.target.value as 'approve' | 'reject');\n                      setErrors({});\n                    }}\n                    className=\"mr-2 text-red-600 focus:ring-red-500\"\n                  />\n                  <span className=\"text-sm text-gray-700 dark:text-gray-300\">{t('joinRequest.reject')}</span>\n                </label>\n              </div>\n            </div>\n\n            {/* Rollenauswahl (nur bei Genehmigung) */}\n            {action === 'approve' && (\n              <div>\n                <label \n                  htmlFor=\"roleId\" \n                  className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n                >\n                  {t('joinRequest.assignRole')}\n                </label>\n                {loadingRoles ? (\n                  <div className=\"flex items-center py-2\">\n                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2\"></div>\n                    <span className=\"text-sm text-gray-500 dark:text-gray-400\">{t('joinRequest.loadingRoles')}</span>\n                  </div>\n                ) : (\n                  <select\n                    id=\"roleId\"\n                    value={roleId || ''}\n                    onChange={(e) => {\n                      setRoleId(Number(e.target.value) || null);\n                      if (errors.roleId) {\n                        setErrors(prev => ({ ...prev, roleId: '' }));\n                      }\n                    }}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2 ${\n                      errors.roleId \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  >\n                    <option value=\"\">{t('joinRequest.selectRole')}</option>\n                    {roles.map(role => (\n                      <option key={role.id} value={role.id}>\n                        {role.name} {role.description ? `- ${role.description}` : ''}\n                      </option>\n                    ))}\n                  </select>\n                )}\n                {errors.roleId && (\n                  <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.roleId}</p>\n                )}\n              </div>\n            )}\n\n            {/* Antwort-Message */}\n            <div>\n              <label \n                htmlFor=\"response\" \n                className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\"\n              >\n                {t('joinRequest.response')}\n              </label>\n              <textarea\n                id=\"response\"\n                value={response}\n                onChange={(e) => setResponse(e.target.value)}\n                rows={3}\n                placeholder={t('joinRequest.addOptional', { type: action === 'approve' ? t('joinRequest.welcomeMessage') : t('joinRequest.rejectionReason') })}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white px-3 py-2\"\n              />\n            </div>\n\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={saving}\n                className={`p-2 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed ${\n                  action === 'approve'\n                    ? 'bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-800 focus:ring-green-500'\n                    : 'bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-800 focus:ring-red-500'\n                }`}\n                title={saving ? (action === 'approve' ? 'Genehmige...' : 'Lehne ab...') : (action === 'approve' ? 'Genehmigen' : 'Ablehnen')}\n              >\n                {saving ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : action === 'approve' ? (\n                  <CheckIcon className=\"h-5 w-5\" />\n                ) : (\n                  <XCircleIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default ProcessJoinRequestModal;\n\n","import React, { useState, useEffect, useMemo, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { UserPlusIcon, FunnelIcon, PencilIcon } from '@heroicons/react/24/outline';\nimport { organizationService } from '../../services/organizationService.ts';\nimport { OrganizationJoinRequest } from '../../types/organization.ts';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport FilterPane from '../FilterPane.tsx';\nimport SavedFilterTags from '../SavedFilterTags.tsx';\nimport { useFilterContext } from '../../contexts/FilterContext.tsx';\nimport { FilterCondition } from '../FilterRow.tsx';\nimport ProcessJoinRequestModal from './ProcessJoinRequestModal.tsx';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport axiosInstance from '../../config/axios.ts';\nimport { logger } from '../../utils/logger.ts';\n\n// Status-Badge Funktionen\nconst getStatusColor = (status: string) => {\n  switch (status) {\n    case 'pending':\n      return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300';\n    case 'approved':\n      return 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300';\n    case 'rejected':\n      return 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300';\n    case 'withdrawn':\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n    default:\n      return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n  }\n};\n\nconst getStatusText = (status: string, t: any) => {\n  switch (status) {\n    case 'pending':\n      return t('joinRequestsList.status.pending');\n    case 'approved':\n      return t('joinRequestsList.status.approved');\n    case 'rejected':\n      return t('joinRequestsList.status.rejected');\n    case 'withdrawn':\n      return t('joinRequestsList.status.withdrawn');\n    default:\n      return status;\n  }\n};\n\nconst JOIN_REQUESTS_TABLE_ID = 'join-requests-table';\n\nconst JoinRequestsList: React.FC = () => {\n  const { t } = useTranslation();\n  const [joinRequests, setJoinRequests] = useState<OrganizationJoinRequest[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isFilterPanelOpen, setIsFilterPanelOpen] = useState<boolean>(false);\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const [isProcessModalOpen, setIsProcessModalOpen] = useState<boolean>(false);\n  const [selectedRequest, setSelectedRequest] = useState<OrganizationJoinRequest | null>(null);\n  \n  // Filter State Management (Controlled Mode)\n  const [activeFilterName, setActiveFilterName] = useState<string>('Alle');\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n  \n  const { canViewJoinRequests, canManageJoinRequests, loading: permissionsLoading } = usePermissions();\n  const { showMessage } = useMessage();\n  const mountedRef = useRef(true);\n  const hasInitialLoadRef = useRef(false);\n\n  // Debug: Log permissionsLoading nderungen\n  useEffect(() => {\n    logger.log('[JoinRequestsList] permissionsLoading gendert:', permissionsLoading);\n  }, [permissionsLoading]);\n\n  // Reset beim Mount - wichtig fr Neuladen wenn Komponente neu gemountet wird\n  useEffect(() => {\n    logger.log('[JoinRequestsList] Component mounted, reset hasInitialLoadRef');\n    hasInitialLoadRef.current = false;\n    mountedRef.current = true;\n    \n    return () => {\n      logger.log('[JoinRequestsList] Component unmounting');\n      mountedRef.current = false;\n    };\n  }, []);\n\n  useEffect(() => {\n    logger.log('[JoinRequestsList] useEffect triggered', { \n      permissionsLoading, \n      hasInitialLoad: hasInitialLoadRef.current,\n      joinRequestsCount: joinRequests.length \n    });\n    \n    // Warte bis Berechtigungen geladen sind\n    if (permissionsLoading) {\n      logger.log('[JoinRequestsList] Warte auf Berechtigungen...');\n      return;\n    }\n\n    // Prfe Berechtigung direkt\n    const hasPermission = canViewJoinRequests();\n    logger.log('[JoinRequestsList] Berechtigung geprft:', hasPermission);\n    \n    if (!hasPermission) {\n      logger.log('[JoinRequestsList] Keine Berechtigung zum Anzeigen');\n      setError(t('joinRequestsList.noPermission'));\n      setLoading(false);\n      hasInitialLoadRef.current = true;\n      return;\n    }\n\n    // WICHTIG: Nur laden wenn noch nicht erfolgreich geladen wurde\n    // Das verhindert unntige Re-Fetches bei jedem permissionsLoading-Change\n    if (hasInitialLoadRef.current) {\n      logger.log('[JoinRequestsList] Bereits geladen, berspringe Fetch');\n      return;\n    }\n\n    logger.log('[JoinRequestsList] Starte Fetch der Join Requests...');\n    \n    const fetchJoinRequests = async () => {\n      if (!mountedRef.current) {\n        logger.log('[JoinRequestsList] Component unmounted, breche ab');\n        return;\n      }\n      \n      try {\n        logger.log('[JoinRequestsList] Setze loading auf true');\n        setLoading(true);\n        setError(null);\n        \n        logger.log('[JoinRequestsList] Rufe organizationService.getJoinRequests() auf...');\n        logger.log('[JoinRequestsList] API Endpoint:', API_ENDPOINTS.ORGANIZATIONS.JOIN_REQUESTS);\n        \n        const requests = await organizationService.getJoinRequests();\n        \n        logger.log('[JoinRequestsList] Antwort erhalten:', requests);\n        logger.log('[JoinRequestsList] Antwort Typ:', typeof requests);\n        logger.log('[JoinRequestsList] Ist Array:', Array.isArray(requests));\n        logger.log('[JoinRequestsList] Ist null/undefined:', requests === null || requests === undefined);\n        \n        if (!mountedRef.current) {\n          logger.log('[JoinRequestsList] Component whrend Request unmounted');\n          return;\n        }\n        \n        // Validiere, dass die Antwort vorhanden ist\n        if (requests === null || requests === undefined) {\n          console.error('[JoinRequestsList]  Antwort ist null oder undefined!');\n          throw new Error('Ungltige Antwort vom Server: Antwort ist null oder undefined');\n        }\n        \n        // Validiere, dass die Antwort ein Array ist\n        if (!Array.isArray(requests)) {\n          console.error('[JoinRequestsList]  Antwort ist kein Array!', requests);\n          throw new Error('Ungltige Antwort vom Server: Erwartetes Array, erhalten: ' + typeof requests);\n        }\n        \n        logger.log('[JoinRequestsList]  Setze', requests.length, 'Join Requests');\n        setJoinRequests(requests);\n        setError(null); // Fehler zurcksetzen bei Erfolg\n        hasInitialLoadRef.current = true; // Nur bei Erfolg setzen\n      } catch (err: any) {\n        console.error('[JoinRequestsList]  Fehler beim Laden:', err);\n        console.error('[JoinRequestsList] Fehler Details:', {\n          message: err.message,\n          response: err.response,\n          status: err.response?.status,\n          data: err.response?.data,\n          stack: err.stack\n        });\n        \n        if (!mountedRef.current) {\n          logger.log('[JoinRequestsList] Component whrend Error-Handling unmounted');\n          return;\n        }\n        \n        const errorMessage = err.response?.data?.message || err.message || t('joinRequestsList.loadError', { defaultValue: 'Fehler beim Laden der Beitrittsanfragen' });\n        logger.log('[JoinRequestsList] Zeige Fehlermeldung:', errorMessage);\n        setError(errorMessage);\n        // showMessage nur auerhalb useEffect verwenden, um Re-Renders zu vermeiden\n        // Verwende setTimeout, um es asynchron auszufhren\n        setTimeout(() => {\n          showMessage(errorMessage, 'error');\n        }, 0);\n        // Bei Fehler NICHT hasInitialLoadRef setzen, damit bei nchstem permissionsLoading-Change neu geladen wird\n      } finally {\n        if (mountedRef.current) {\n          logger.log('[JoinRequestsList] Setze loading auf false');\n          setLoading(false);\n        }\n      }\n    };\n\n    fetchJoinRequests();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [permissionsLoading]); // canViewJoinRequests ist eine Funktion, nicht als Dependency\n\n  const handleOpenProcessModal = (request: OrganizationJoinRequest) => {\n    if (!canManageJoinRequests()) {\n      const errorMessage = t('joinRequestsList.noPermissionEdit');\n      setError(errorMessage);\n      showMessage(errorMessage, 'error');\n      return;\n    }\n    setSelectedRequest(request);\n    setIsProcessModalOpen(true);\n  };\n\n  const handleProcessSuccess = async () => {\n    // Neulade die Liste nach erfolgreicher Bearbeitung\n    // Reset das Flag, damit neu geladen werden kann\n    hasInitialLoadRef.current = false;\n    \n    try {\n      setLoading(true);\n      const requests = await organizationService.getJoinRequests();\n      setJoinRequests(requests);\n      setError(null);\n      hasInitialLoadRef.current = true;\n    } catch (err: any) {\n      const errorMessage = err.response?.data?.message || 'Fehler beim Laden der Beitrittsanfragen';\n      setError(errorMessage);\n      hasInitialLoadRef.current = true;\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Filter-Funktionen\n  const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  };\n\n  const resetFilterConditions = () => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n    setActiveFilterName('');\n    setSelectedFilterId(null);\n  };\n\n  // Filter Change Handler (Controlled Mode)\n  const handleFilterChange = async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  };\n  \n  //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n  const filterContext = useFilterContext();\n  const { loadFilters } = filterContext;\n  \n  useEffect(() => {\n    const initialize = async () => {\n      // 1. Filter laden (wartet auf State-Update)\n      const filters = await loadFilters(JOIN_REQUESTS_TABLE_ID);\n      \n      // 2. Default-Filter anwenden (IMMER vorhanden!)\n      const defaultFilter = filters.find(f => f.name === 'Alle');\n      if (defaultFilter) {\n        await handleFilterChange(\n          defaultFilter.name,\n          defaultFilter.id,\n          defaultFilter.conditions,\n          defaultFilter.operators\n        );\n        return; // Filter wird angewendet\n      }\n      \n      // 3. Fallback: Kein Filter (sollte nie passieren)\n      // fetchJoinRequests wird bereits durch useEffect aufgerufen\n    };\n    \n    initialize();\n  }, [loadFilters, handleFilterChange]);\n\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  //  PERFORMANCE: Filter werden von SavedFilterTags geladen (FilterContext)\n  //  PERFORMANCE: Standard-Filter wird im Seed erstellt (nicht mehr im Frontend)\n  // Keine redundanten API-Calls mehr ntig\n\n  // Gefilterte Join-Requests\n  const filteredJoinRequests = useMemo(() => {\n    let filtered = [...joinRequests];\n\n    // Suchfeld-Filter\n    if (searchTerm) {\n      const searchLower = searchTerm.toLowerCase();\n      filtered = filtered.filter(request => {\n        const requesterName = `${request.requester.firstName} ${request.requester.lastName}`.toLowerCase();\n        const requesterEmail = request.requester.email?.toLowerCase() || '';\n        const message = request.message?.toLowerCase() || '';\n        return requesterName.includes(searchLower) || requesterEmail.includes(searchLower) || message.includes(searchLower);\n      });\n    }\n\n    // Filter-Bedingungen aus FilterPane\n    if (filterConditions.length > 0) {\n      filtered = filterConditions.reduce((acc, condition, index) => {\n        if (!condition.column || condition.value === null || condition.value === '') {\n          return acc;\n        }\n\n        const operator = condition.operator;\n        const value = condition.value;\n\n        return acc.filter(request => {\n          switch (condition.column) {\n            case 'requester':\n              const requesterName = `${request.requester.firstName} ${request.requester.lastName}`.toLowerCase();\n              const requesterEmail = request.requester.email?.toLowerCase() || '';\n              const searchValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return requesterName.includes(searchValue) || requesterEmail.includes(searchValue);\n              } else if (operator === 'equals') {\n                return requesterName === searchValue || requesterEmail === searchValue;\n              } else if (operator === 'startsWith') {\n                return requesterName.startsWith(searchValue) || requesterEmail.startsWith(searchValue);\n    }\n              return false;\n\n            case 'message':\n              const message = request.message?.toLowerCase() || '';\n              const msgValue = String(value).toLowerCase();\n              \n              if (operator === 'contains') {\n                return message.includes(msgValue);\n              } else if (operator === 'equals') {\n                return message === msgValue;\n              } else if (operator === 'startsWith') {\n                return message.startsWith(msgValue);\n              }\n              return false;\n\n            case 'status':\n              if (operator === 'equals') {\n                return request.status === value;\n              }\n              return false;\n\n            default:\n              return true;\n          }\n        });\n      }, filtered);\n    }\n\n    return filtered;\n  }, [joinRequests, searchTerm, filterConditions, filterLogicalOperators]);\n\n  if (permissionsLoading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('joinRequestsList.loadingPermissions')}</span>\n        </div>\n      </div>\n    );\n  }\n\n  if (!canViewJoinRequests()) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 mb-6\">\n      <div className=\"p-4 text-red-600 dark:text-red-400\">\n        {t('joinRequestsList.noPermission')}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 shadow p-6 sm:p-6 mb-6\">\n      {/* Titelzeile mit Icon, Suchfeld, Filter-Button */}\n      <div className=\"flex items-center justify-between mb-4 sm:mb-4\">\n        <h2 className=\"text-xl sm:text-xl font-semibold flex items-center dark:text-white\">\n          <UserPlusIcon className=\"h-6 w-6 sm:h-6 sm:w-6 mr-2 sm:mr-2\" />\n          {t('joinRequestsList.title')}\n        </h2>\n        \n        <div className=\"flex items-center gap-1.5\">\n          {/* Suchfeld */}\n          <input\n            type=\"text\"\n            placeholder={t('common.search', { defaultValue: 'Suchen...' })}\n            className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n\n          {/* Filter-Button */}\n          <button\n            className={`p-2 rounded-md border ${getActiveFilterCount() > 0 ? 'border-blue-300 bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n            onClick={() => setIsFilterPanelOpen(!isFilterPanelOpen)}\n            title={t('common.filter')}\n          >\n            <FunnelIcon className=\"h-5 w-5\" />\n            {getActiveFilterCount() > 0 && (\n              <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center\">\n                {getActiveFilterCount()}\n              </span>\n            )}\n          </button>\n        </div>\n      </div>\n\n      {/* Filter-Panel */}\n      {isFilterPanelOpen && (\n        <div className=\"mb-4\">\n          <FilterPane\n            columns={[\n              { id: 'requester', label: t('joinRequestsList.filter.requester') },\n              { id: 'message', label: t('joinRequestsList.filter.message') },\n              { id: 'status', label: t('joinRequestsList.status.title', { defaultValue: 'Status' }) }\n            ]}\n            onApply={applyFilterConditions}\n            onReset={resetFilterConditions}\n            savedConditions={filterConditions}\n            savedOperators={filterLogicalOperators}\n            tableId={JOIN_REQUESTS_TABLE_ID}\n          />\n        </div>\n      )}\n\n      {/* Gespeicherte Filter als Tags anzeigen */}\n      <SavedFilterTags\n        tableId={JOIN_REQUESTS_TABLE_ID}\n        onSelectFilter={applyFilterConditions}\n        onReset={resetFilterConditions}\n        activeFilterName={activeFilterName}\n        selectedFilterId={selectedFilterId}\n        onFilterChange={handleFilterChange}\n        defaultFilterName=\"Alle\"\n      />\n\n      {/* Error Display */}\n      {error && (\n        <div className=\"mb-4 p-4 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded\">\n          {error}\n        </div>\n      )}\n\n      {/* Loading State */}\n      {loading ? (\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n          <span className=\"ml-3 text-gray-700 dark:text-gray-300\">{t('joinRequestsList.loading')}</span>\n        </div>\n      ) : filteredJoinRequests.length === 0 ? (\n        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n          {joinRequests.length === 0 \n            ? t('joinRequestsList.noRequests')\n            : t('joinRequestsList.noMatching')}\n        </div>\n      ) : (\n        /* Cards fr Join-Requests */\n        <div className=\"space-y-4\">\n          {filteredJoinRequests.map(request => (\n            <div\n              key={request.id}\n              className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 shadow hover:shadow-md transition-shadow\"\n            >\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <div>\n                      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                        {request.requester.firstName} {request.requester.lastName}\n                      </h3>\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                        {request.requester.email}\n              </p>\n                    </div>\n                    <span className={`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusColor(request.status)}`}>\n                      {getStatusText(request.status, t)}\n                    </span>\n                  </div>\n\n                  {request.message && (\n                    <div className=\"mt-3 p-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\n                      <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.filter.message')}:</span> {request.message}\n                      </p>\n                    </div>\n                  )}\n\n                  {request.response && (\n                    <div className=\"mt-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-200 dark:border-blue-700\">\n                      <p className=\"text-sm text-blue-700 dark:text-blue-300\">\n                        <span className=\"font-medium\">{t('joinRequestsList.response')}:</span> {request.response}\n                      </p>\n                    </div>\n                  )}\n\n              {request.status === 'pending' && canManageJoinRequests() && (\n                    <div className=\"mt-4 flex items-center gap-2\">\n                  <button \n                        onClick={() => handleOpenProcessModal(request)}\n                        className=\"p-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md dark:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n                        title={t('joinRequestsList.edit')}\n                      >\n                        <PencilIcon className=\"h-5 w-5\" />\n                  </button>\n                </div>\n              )}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {/* Process Join Request Modal */}\n      <ProcessJoinRequestModal\n        isOpen={isProcessModalOpen}\n        onClose={() => {\n          setIsProcessModalOpen(false);\n          setSelectedRequest(null);\n        }}\n        joinRequest={selectedRequest}\n        onSuccess={handleProcessSuccess}\n      />\n    </div>\n  );\n};\n\nexport default JoinRequestsList; ","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { UserGroupIcon, UserIcon, ShieldCheckIcon, MapPinIcon, TruckIcon, CalendarIcon } from '@heroicons/react/24/outline';\nimport UserManagementTab from '../components/UserManagementTab.tsx';\nimport RoleManagementTab from '../components/RoleManagementTab.tsx';\nimport BranchManagementTab from '../components/BranchManagementTab.tsx';\nimport TourProvidersTab from '../components/tours/TourProvidersTab.tsx';\nimport ToursTab from '../components/tours/ToursTab.tsx';\nimport useMessage from '../hooks/useMessage.ts';\nimport OrganizationSettings from '../components/organization/OrganizationSettings.tsx';\nimport JoinRequestsList from '../components/organization/JoinRequestsList.tsx';\n\nconst Organisation: React.FC = () => {\n  const { t } = useTranslation();\n  // Gemeinsame States\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const { showMessage } = useMessage();\n\n  const { \n    isAdmin, \n    hasPermission, \n    canViewOrganization,\n    loading: permissionsLoading\n  } = usePermissions();\n\n  // Berechtigungen prfen\n  const canViewOrganisation = hasPermission('organization_management', 'read', 'page');\n  const canViewUsers = hasPermission('users', 'read', 'table');\n  const canViewRoles = hasPermission('roles', 'read', 'table');\n  const canViewBranches = hasPermission('branches', 'read', 'table');\n  const canViewProviders = hasPermission('tour_providers', 'read', 'table');\n  const canViewOrg = canViewOrganization();\n\n  const [activeTabState, setActiveTabState] = useState<'users' | 'roles' | 'branches' | 'providers' | 'organization'>('users');\n  const [providersViewMode, setProvidersViewMode] = useState<'tours' | 'providers'>('tours');\n  const isInitialized = useRef(false);\n\n  // Tab beim ersten Laden basierend auf Berechtigungen setzen (nur wenn Berechtigungen geladen sind)\n  // Reihenfolge: users -> roles -> branches -> providers -> organization\n  useEffect(() => {\n    if (!permissionsLoading && !isInitialized.current) {\n      let defaultTab: 'users' | 'roles' | 'branches' | 'providers' | 'organization' = 'organization'; // Fallback\n      \n      if (canViewUsers) {\n        defaultTab = 'users';\n      } else if (canViewRoles) {\n        defaultTab = 'roles';\n      } else if (canViewBranches) {\n        defaultTab = 'branches';\n      } else if (canViewProviders) {\n        defaultTab = 'providers';\n      } else if (canViewOrg) {\n        defaultTab = 'organization';\n      }\n      \n      setActiveTabState(defaultTab);\n      isInitialized.current = true;\n    }\n  }, [permissionsLoading, canViewUsers, canViewRoles, canViewBranches, canViewProviders, canViewOrg]);\n\n  // Tab-Wechsel Handler - Fehler beim Wechsel zurcksetzen\n  const handleTabChange = (tab: 'users' | 'roles' | 'branches' | 'providers' | 'organization') => {\n    // Prfe Berechtigung fr den Tab\n    if (tab === 'users' && !canViewUsers) {\n      return; // Tab nicht aktivierbar\n    }\n    if (tab === 'roles' && !canViewRoles) {\n      return; // Tab nicht aktivierbar\n    }\n    if (tab === 'branches' && !canViewBranches) {\n      return; // Tab nicht aktivierbar\n    }\n    if (tab === 'providers' && !canViewProviders) {\n      return; // Tab nicht aktivierbar\n    }\n    if (tab === 'organization' && !canViewOrg) {\n      return; // Tab nicht aktivierbar\n    }\n    setActiveTabState(tab);\n    setError(null);\n  };\n\n  // Gemeinsame Fehlerbehandlung entfernt - ErrorContext wird jetzt verwendet\n\n  // Keine Berechtigung fr die Seite\n  if (!canViewOrganisation) {\n    return <div className=\"p-4 text-red-600 dark:text-red-400\">{t('organisation.noPermission')}</div>;\n  }\n\n  return (\n    <div className=\"min-h-screen dark:bg-gray-900\">\n      <div className=\"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6\">\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n          {/* Header mit Icon */}\n          <div className=\"flex items-center mb-6\">\n            <UserGroupIcon className=\"h-6 w-6 mr-2 dark:text-white\" />\n            <h2 className=\"text-xl font-semibold dark:text-white\">{t('organisation.title')}</h2>\n          </div>\n\n          {/* Tabs fr Navigation */}\n          <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6\">\n            <nav className=\"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto overflow-y-hidden\">\n              {/* Users Tab - immer sichtbar, aber mit Pro-Badge wenn nicht berechtigt */}\n              <button\n                className={`${\n                  activeTabState === 'users' && canViewUsers\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                    : !canViewUsers\n                    ? 'border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60'\n                    : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                } whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0`}\n                onClick={() => canViewUsers && handleTabChange('users')}\n                disabled={!canViewUsers}\n              >\n                <UserIcon className=\"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                {t('organisation.tabs.users')}\n                {!canViewUsers && (\n                  <span className=\"ml-1 sm:ml-2 px-1 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded\">\n                    PRO\n                  </span>\n                )}\n              </button>\n\n              {/* Roles Tab - immer sichtbar, aber mit Pro-Badge wenn nicht berechtigt */}\n              <button\n                className={`${\n                  activeTabState === 'roles' && canViewRoles\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                    : !canViewRoles\n                    ? 'border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60'\n                    : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                } whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0`}\n                onClick={() => canViewRoles && handleTabChange('roles')}\n                disabled={!canViewRoles}\n              >\n                <ShieldCheckIcon className=\"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                {t('organisation.tabs.roles')}\n                {!canViewRoles && (\n                  <span className=\"ml-1 sm:ml-2 px-1 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded\">\n                    PRO\n                  </span>\n                )}\n              </button>\n\n              {/* Branches Tab - immer sichtbar, aber mit Pro-Badge wenn nicht berechtigt */}\n              <button\n                className={`${\n                  activeTabState === 'branches' && canViewBranches\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                    : !canViewBranches\n                    ? 'border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60'\n                    : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                } whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0`}\n                onClick={() => canViewBranches && handleTabChange('branches')}\n                disabled={!canViewBranches}\n              >\n                <MapPinIcon className=\"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                {t('organisation.tabs.branches', { defaultValue: 'Niederlassungen' })}\n                {!canViewBranches && (\n                  <span className=\"ml-1 sm:ml-2 px-1 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded\">\n                    PRO\n                  </span>\n                )}\n              </button>\n\n              {/* Providers Tab - immer sichtbar, aber mit Pro-Badge wenn nicht berechtigt */}\n              <button\n                className={`${\n                  activeTabState === 'providers' && canViewProviders\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                    : !canViewProviders\n                    ? 'border-transparent text-gray-400 dark:text-gray-500 cursor-not-allowed opacity-60'\n                    : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                } whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center relative flex-shrink-0`}\n                onClick={() => canViewProviders && handleTabChange('providers')}\n                disabled={!canViewProviders}\n              >\n                <TruckIcon className=\"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                {t('organisation.tabs.providers', { defaultValue: 'Proveedores' })}\n                {!canViewProviders && (\n                  <span className=\"ml-1 sm:ml-2 px-1 sm:px-2 py-0.5 text-[0.625rem] sm:text-xs font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded\">\n                    PRO\n                  </span>\n                )}\n              </button>\n\n              {/* Organization Tab - sichtbar wenn berechtigt */}\n              {canViewOrg && (\n                <button\n                  className={`${\n                    activeTabState === 'organization'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600'\n                  } whitespace-nowrap py-2 sm:py-4 px-1 border-b-2 font-medium text-xs sm:text-sm flex items-center flex-shrink-0`}\n                  onClick={() => handleTabChange('organization')}\n                >\n                  <UserGroupIcon className=\"h-3 w-3 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                  {t('organisation.tabs.organization')}\n                </button>\n              )}\n            </nav>\n          </div>\n\n          {error && (\n            <div className=\"bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 px-4 py-3 rounded mb-4\">\n              <p className=\"font-bold\">{t('organisation.error')}</p>\n              <p>{error}</p>\n            </div>\n          )}\n\n          {loading && <div className=\"p-4 dark:text-gray-300\">{t('organisation.loading')}</div>}\n\n          {/* Tab Inhalte */}\n          <div className=\"mt-6\">\n            {activeTabState === 'users' ? (\n              canViewUsers ? (\n                <UserManagementTab />\n              ) : (\n                <div className=\"p-8 text-center\">\n                  <div className=\"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6\">\n                    <span className=\"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4\">\n                      PRO\n                    </span>\n                    <p className=\"text-gray-700 dark:text-gray-300 mt-4\">\n                      {t('organisation.proFeature.users')}\n                    </p>\n                  </div>\n                </div>\n              )\n            ) : activeTabState === 'roles' ? (\n              canViewRoles ? (\n                <RoleManagementTab />\n              ) : (\n                <div className=\"p-8 text-center\">\n                  <div className=\"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6\">\n                    <span className=\"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4\">\n                      PRO\n                    </span>\n                    <p className=\"text-gray-700 dark:text-gray-300 mt-4\">\n                      {t('organisation.proFeature.roles')}\n                    </p>\n                  </div>\n                </div>\n              )\n            ) : activeTabState === 'branches' ? (\n              canViewBranches ? (\n                <BranchManagementTab />\n              ) : (\n                <div className=\"p-8 text-center\">\n                  <div className=\"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6\">\n                    <span className=\"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4\">\n                      PRO\n                    </span>\n                    <p className=\"text-gray-700 dark:text-gray-300 mt-4\">\n                      {t('organisation.proFeature.branches', { defaultValue: 'Niederlassungs-Verwaltung ist eine PRO-Funktion' })}\n                    </p>\n                  </div>\n                </div>\n              )\n            ) : activeTabState === 'providers' ? (\n              canViewProviders ? (\n                <div className=\"space-y-4\">\n                  {/* Switch fr Tours/Providers */}\n                  <div className=\"flex gap-2 mb-4\">\n                    <button\n                      type=\"button\"\n                      onClick={() => setProvidersViewMode('tours')}\n                      className={`p-2 rounded-md transition-colors ${\n                        providersViewMode === 'tours'\n                          ? 'bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400'\n                          : 'text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700'\n                      }`}\n                      title={t('tours.title', 'Touren')}\n                    >\n                      <CalendarIcon className=\"h-5 w-5\" />\n                    </button>\n                    <button\n                      type=\"button\"\n                      onClick={() => setProvidersViewMode('providers')}\n                      className={`p-2 rounded-md transition-colors ${\n                        providersViewMode === 'providers'\n                          ? 'bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400'\n                          : 'text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700'\n                      }`}\n                      title={t('organisation.tabs.providers', { defaultValue: 'Proveedores' })}\n                    >\n                      <TruckIcon className=\"h-5 w-5\" />\n                    </button>\n                  </div>\n                  \n                  {/* Bedingtes Rendering */}\n                  {providersViewMode === 'tours' ? (\n                    <ToursTab />\n                  ) : (\n                    <TourProvidersTab />\n                  )}\n                </div>\n              ) : (\n                <div className=\"p-8 text-center\">\n                  <div className=\"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 rounded-lg p-6\">\n                    <span className=\"inline-block px-3 py-1 text-sm font-semibold bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 rounded mb-4\">\n                      PRO\n                    </span>\n                    <p className=\"text-gray-700 dark:text-gray-300 mt-4\">\n                      {t('organisation.proFeature.providers', { defaultValue: 'Tour-Provider-Verwaltung ist eine PRO-Funktion' })}\n                    </p>\n                  </div>\n                </div>\n              )\n            ) : activeTabState === 'organization' && canViewOrg ? (\n              <div className=\"space-y-6\">\n                <OrganizationSettings />\n                <JoinRequestsList />\n              </div>\n            ) : (\n              <div className=\"p-4 text-red-600 dark:text-red-400\">\n                {t('organisation.noPermissionForPage')}\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Organisation;\n\n\n"],"names":["_ref","children","columns","mobile","tablet","desktop","largeDesktop","gap","className","gapClass","sm","md","lg","_jsx","concat","getLocalStorageKey","tableId","tableSettingsApi","async","axiosInstance","get","data","error","console","localStorageKey","storedSettings","localStorage","getItem","JSON","parse","localError","columnOrder","hiddenColumns","post","settings","setItem","stringify","useTableSettings","options","setSettings","useState","defaultColumnOrder","defaultHiddenColumns","isLoading","setIsLoading","setError","useEffect","isMounted","loadedSettings","logger","log","length","viewMode","defaultViewMode","err","Error","loadSettings","updateColumnOrder","useCallback","updatedSettings","_objectSpread","newColumnOrder","updateHiddenColumns","newHiddenColumns","toggleColumnVisibility","includes","columnId","filter","id","updateViewMode","newViewMode","updateSortConfig","sortConfig","newSortConfig","isColumnVisible","evaluateCondition","fieldValue","condition","operator","value","undefined","strField","strValue","fieldValueStr","String","lowerField","toLowerCase","valueStr","lowerValue","startsWith","typeof","endsWith","fieldDate","Date","valueDate","isNaN","getTime","fieldNum","parseFloat","valueNum","applyFilters","items","conditions","operators","getFieldValue","columnEvaluators","item","result","i","conditionMet","column","customResult","evaluateDateCondition","dateValue","date","dateYear","getUTCFullYear","dateMonth","getUTCMonth","dateDay","getUTCDate","normalizedDate","weekStart","startOfWeek","weekStartsOn","setHours","weekEnd","endOfWeek","monthStart","startOfMonth","monthEnd","endOfMonth","yearStart","startOfYear","yearEnd","endOfYear","conditionDate","localToday","conditionDateRaw","conditionYear","conditionMonth","conditionDay","evaluateUserRoleCondition","userId","roleId","textValue","targetUserId","parseInt","replace","matches","targetRoleId","textValueLower","valueLower","isOpen","onClose","onBookingCreated","tour","preselectedTour","t","useTranslation","user","useAuth","showMessage","useMessage","tourId","setTourId","tourDate","setTourDate","numberOfParticipants","setNumberOfParticipants","customerName","setCustomerName","customerEmail","setCustomerEmail","customerPhone","setCustomerPhone","customerNotes","setCustomerNotes","tours","setTours","selectedTour","setSelectedTour","loading","setLoading","loadingData","setLoadingData","_response$data","response","API_ENDPOINTS","TOURS","BASE","params","isActive","toursData","Array","isArray","loadData","find","Number","_jsxs","Dialog","open","Panel","Title","defaultValue","onClick","XMarkIcon","onSubmit","e","preventDefault","trim","numPart","minParticipants","min","max","maxParticipants","_response$data2","_response$data3","TOUR_BOOKINGS","_response$data4","success","message","_response","_response$data5","errorMessage","onChange","target","required","disabled","title","map","type","rows","CheckIcon","DraggableColumnItem","label","index","isVisible","onToggleVisibility","sortDirection","onSortDirectionChange","showMainSort","isMainSort","stopPropagation","ArrowUpIcon","ArrowDownIcon","ArrowsUpDownIcon","EyeIcon","EyeSlashIcon","_ref2","visibleColumns","onToggleColumnVisibility","onMoveColumn","buttonTitle","modalTitle","mainSortConfig","onMainSortChange","externalIsOpen","onOpenChange","defaultButtonTitle","defaultModalTitle","internalIsOpen","setInternalIsOpen","menuRef","useRef","sortedColumns","sort","a","b","indexA","indexOf","indexB","handleClose","handleOpen","handleClickOutside","event","current","contains","document","addEventListener","removeEventListener","handleKeyDown","key","ref","xmlns","viewBox","fill","fillRule","d","clipRule","role","direction","showSortButton","onCertificateCreated","userName","currentUser","isHR","isAdmin","permissionsLoading","usePermissions","openSidepane","closeSidepane","useSidepane","isMobile","setIsMobile","window","innerWidth","isLargeScreen","setIsLargeScreen","activeTab","setActiveTab","userData","setUserData","issueDate","setIssueDate","toISOString","split","certificateType","setCertificateType","pdfFile","setPdfFile","pdfPreviewUrl","setPdfPreviewUrl","uploading","setUploading","availableTemplates","setAvailableTemplates","selectedTemplate","setSelectedTemplate","useTemplate","setUseTemplate","fileInputRef","handleResize","fetchUserData","fetchTemplates","documentTemplates","ORGANIZATION_LIFECYCLE","DOCUMENT_TEMPLATES","templates","employmentCertificate","push","version","path","userResponse","lifecycleResponse","Promise","all","USERS","BY_ID","LIFECYCLE","BY_USER","lifecycle","userDataObj","firstName","lastName","identificationNumber","contractStartDate","contractEndDate","contractType","salary","position","URL","revokeObjectURL","style","animation","DocumentTextIcon","_Fragment","UserIcon","CalendarIcon","toLocaleDateString","checked","template","accept","_event$target$files","file","files","size","url","createObjectURL","name","toFixed","_fileInputRef$current","click","src","height","validationError","validateForm","issueDateObj","pdfPath","templateUsed","templateVersion","now","certificateData","CERTIFICATES","_err$response","_err$response$data","ArrowPathIcon","onContractCreated","setContractType","startDate","setStartDate","endDate","setEndDate","setSalary","workingHours","setWorkingHours","setPosition","employmentContract","toString","placeholder","CurrencyDollarIcon","step","startDateObj","endDateObj","contractData","CONTRACTS","onCertificateUpdated","certificate","existingPdfUrl","setExistingPdfUrl","CERTIFICATE_DOWNLOAD","handleSubmit","updateData","put","CERTIFICATE","onContractUpdated","contract","CONTRACT_DOWNLOAD","CONTRACT","lifecycleId","onUpdate","isLegal","registrations","setRegistrations","arl","eps","pension","caja","editingType","setEditingType","formData","setFormData","status","registrationNumber","provider","registrationDate","notes","saving","setSaving","loadingRef","abortControllerRef","loadRegistrations","abort","abortController","AbortController","registrationPromises","signal","aborted","registration","SOCIAL_SECURITY","timeout","_error$response","_error$message","code","warn","results","newRegistrations","forEach","registrationType","number","registeredAt","completedAt","handleCancel","handleSave","resolve","setTimeout","_error$response2","_error$response2$data","getStatusIcon","CheckCircleIcon","ClockIcon","XCircleIcon","getStatusLabel","labelKey","getTypeLabel","isEditing","handleEdit","PencilIcon","onOffboardingStarted","exitDate","setExitDate","exitReason","setExitReason","validationErrors","setValidationErrors","today","errors","selectedDate","maxDate","setFullYear","getFullYear","Object","keys","STATUS","renderForm","ExclamationTriangleIcon","htmlFor","prev","ArrowRightIcon","opacity","transition","pointerEvents","onOffboardingCompleted","offboardingTasks","confirmText","setConfirmText","completedTasks","task","allTasksCompleted","requiredConfirmText","isCompleted","_lifecycleData$lifecy","lifecycleData","setLifecycleData","certificates","setCertificates","contracts","setContracts","setOffboardingTasks","isCertificateCreateModalOpen","setIsCertificateCreateModalOpen","isContractCreateModalOpen","setIsContractCreateModalOpen","editingCertificate","setEditingCertificate","editingContract","setEditingContract","downloadingCertId","setDownloadingCertId","downloadingContractId","setDownloadingContractId","isOffboardingStartModalOpen","setIsOffboardingStartModalOpen","isOffboardingCompleteModalOpen","setIsOffboardingCompleteModalOpen","isEditContractDatesModalOpen","setIsEditContractDatesModalOpen","editingContractStartDate","setEditingContractStartDate","editingContractEndDate","setEditingContractEndDate","fetchDataRef","isMountedRef","retryTimeoutRef","statusChangeTimeoutRef","fetchData","force","arguments","_certsResponse$data","_contractsResponse$da","_lifecycleResponse$da","_lifecycleResponse$da2","_lifecycleResponse$da3","_lifecycleResponse$da4","certsResponse","contractsResponse","tasksResponse","TASKS","catch","allTasks","offboardingTaskTitles","filteredTasks","progress","percent","clearTimeout","handleEditContractDates","formatDate","dateString","year","month","day","socialSecurityRegistrations","BuildingOfficeIcon","clickable","config","onboarding","color","active","contract_change","offboarding","archived","getStatusBadge","onboardingStartedAt","onboardingCompletedAt","offboardingStartedAt","completed","total","width","totalTasks","Math","round","description","PlusIcon","cert","isLatest","generatedByUser","certId","responseType","blob","Blob","downloadUrl","link","createElement","href","download","body","appendChild","removeChild","handleDownloadCertificate","ArrowDownTrayIcon","toLocaleString","currency","contractId","handleDownloadContract","SocialSecurityEditor","CertificateCreationModal","ContractCreationModal","CertificateEditModal","ContractEditModal","OffboardingStartModal","OffboardingCompleteModal","CONTRACT_TYPES","UserManagementTab","handleError","handleErrorContext","useError","COUNTRIES","PAYROLL_COUNTRIES","LANGUAGES","users","setUsers","selectedUser","setSelectedUser","userFormData","setUserFormData","isEditingUser","setIsEditingUser","selectedRoles","setSelectedRoles","lifecycleRefreshKey","setLifecycleRefreshKey","isDebugMode","setIsDebugMode","roleWarning","setRoleWarning","roles","setRoles","loadingRoles","setLoadingRoles","branches","setBranches","loadingBranches","setLoadingBranches","selectedBranches","setSelectedBranches","activeUserTab","setActiveUserTab","userFilterTab","setUserFilterTab","isUploading","setIsUploading","documentListRef","isCreateModalOpen","setIsCreateModalOpen","newUserFormData","setNewUserFormData","email","password","allUsers","setAllUsers","fetchAllUsers","userApi","getAll","filterUsersByActiveStatus","sorted","aUsername","username","bUsername","aFirstName","bFirstName","localeCompare","fetchUserDetails","getById","birthday","roleIds","userRole","r","branchIds","branch","userBranch","branchId","fallbackRoles","permissions","roleApi","fetchRoles","branchApi","fetchBranches","handleUserInputChange","finalValue","toggleRole","isRoleSelected","newSelectedRoles","updateRoles","toggleBranch","isBranchSelected","newSelectedBranches","updateBranches","handleNewUserInputChange","handleCreateUser","match","create","newUser","prevUsers","_err$response5","_err$response5$data","UserCircleIcon","ShieldCheckIcon","MapPinIcon","_userFormData$usernam","_userFormData$email","dataToSend","bankDetails","gender","phoneNumber","language","hourlyRate","monthlySalary","payrollCountry","update","updatedData","_err$response2","_err$response4","_err$response3","_err$response3$data","errorMsg","handleDirectDocumentUpload","_documentListRef$curr","loadDocuments","_COUNTRIES$find","latestDoc","identificationDocuments","readOnly","country","c","documentType","passport","national_id","driving_license","residence_permit","work_permit","tax_id","social_security","documentNumber","expiryDate","issuingCountry","issuingAuthority","handleCancelEdit","currentUserId","currentActiveStatus","newActiveStatus","selectedUserActive","updatePayload","updatedAllUsers","IdentificationDocumentList","some","ids","join","isFixedRole","LifecycleView","alwaysVisiblePages","defaultPages","defaultTables","defaultButtons","tableToPageMapping","buttonToPageMapping","buttonToTableMapping","ROLES_TABLE_ID","STANDARD_ROLE_IDS","STANDARD_ROLE_NAMES","isStandardRole","roleName","RoleCard","onEdit","onDelete","onCopy","canEdit","canDelete","canCopy","DocumentDuplicateIcon","TrashIcon","allBranches","perm","accessLevel","slice","permission","entity","entityType","onRolesChange","onError","isModalOpen","setIsModalOpen","editingRole","setEditingRole","pageDisplayNames","useMemo","tableDisplayNames","buttonDisplayNames","page","table","button","hasPermission","searchTerm","setSearchTerm","isFilterModalOpen","setIsFilterModalOpen","setAllBranches","selectedBranchIds","setSelectedBranchIds","filterConditions","setFilterConditions","filterLogicalOperators","setFilterLogicalOperators","activeFilterName","setActiveFilterName","selectedFilterId","setSelectedFilterId","onErrorRef","errorContext","context","handleValidationError","fieldErrors","isAddPermissionModalOpen","setIsAddPermissionModalOpen","selectedPermission","setSelectedPermission","displayLimit","setDisplayLimit","component","action","filteredPermissions","category","ErrorCategory","PERMISSION","updateError","meta","cause","createError","resetForm","handleDelete","confirm","delete","deleteError","refreshError","handleCopyRole","copiedRoleData","prevRoles","prepareRoleForEditing","allPermissions","existingPermIndex","findIndex","p","_branchData$branches","branchData","getRoleBranches","setAllPagePermissions","newPermissions","permIndex","setAllTablePermissions","setAllButtonPermissions","getActiveFilterCount","filteredAndSortedRoles","searchLower","roleNameLower","nameConditionValueLower","roleDescLower","descConditionValueLower","count","existingFilters","SAVED_FILTERS","BY_TABLE","alleFilter","createStandardFilters","filterContext","useFilterContext","loadFilters","applyFilterConditions","resetFilterConditions","handleFilterChange","defaultFilter","f","initialize","FunnelIcon","FilterPane","onApply","onReset","savedConditions","savedOperators","SavedFilterTags","onSelectFilter","onFilterChange","defaultFilterName","prevLimit","ChevronDownIcon","tablePerm","aName","bName","priorityOrder","aIndex","bIndex","tableIndex","tablePermIndex","isTableActive","tableEntity","tableDisplayName","relatedButtons","buttonPerm","order","buttonIndex","buttonPermIndex","isButtonActive","buttonDisplayName","roomDescriptions","setRoomDescriptions","editingCategoryId","setEditingCategoryId","editForm","setEditForm","text","imageUrl","videoUrl","rooms","setRooms","loadingRooms","setLoadingRooms","loadRoomDescriptions","BRANCHES","ROOM_DESCRIPTIONS","RESERVATION","limit","categoryMap","Map","reservation","categoryId","roomNumber","isDorm","roomType","roomName","has","set","roomsArray","from","entries","loadRooms","updatedDescriptions","alert","room","rel","BranchCard","BRANCHES_TABLE_ID","BranchManagementTab","editingBranch","setEditingBranch","address","city","whatsappSettings","apiKey","apiSecret","phoneNumberId","ai","enabled","model","systemPrompt","rules","sources","temperature","maxTokens","lobbyPmsSettings","apiUrl","propertyId","syncEnabled","autoCreateTasks","lateCheckInThreshold","notificationChannels","autoSendInvitation","boldPaymentSettings","merchantId","environment","doorSystemSettings","clientId","clientSecret","lockIds","appName","emailSettings","smtpHost","smtpPort","smtpUser","smtpPass","smtpFromEmail","smtpFromName","imap","host","port","secure","folder","processedFolder","messageTemplates","checkInInvitation","en","whatsappTemplateName","whatsappTemplateParams","emailSubject","emailContent","es","de","checkInConfirmation","autoSendReservationInvitation","activeSettingsTab","setActiveSettingsTab","showSecrets","setShowSecrets","selectedTemplateType","setSelectedTemplateType","selectedLanguage","setSelectedLanguage","canCreate","sireSettings","autoRegisterOnCheckIn","propertyCode","existingWhatsapp","existingLobbyPms","existingBoldPayment","existingDoorSystem","existingEmail","existingMessageTemplates","existingAutoSend","_hasEncryptedValues","handleCloseModal","UPDATE","CREATE","DELETE","filteredAndSortedBranches","branchNameLower","conditionValueLower","handleCreate","autoFocus","tab","whatsappApiKey","stroke","strokeLinecap","strokeLinejoin","strokeWidth","whatsappApiSecret","s","RoomDescriptionsSection","emailSmtpPass","emailImapPass","_formData$messageTemp","_formData$messageTemp2","currentTemplate","_formData$messageTemp3","_formData$messageTemp4","_formData$messageTemp5","_formData$messageTemp6","onProviderCreated","setName","phone","setPhone","setEmail","contactPerson","setContactPerson","setNotes","setBranchId","_branchesRes$data","branchesRes","checkScreenSize","TOUR_PROVIDERS","onProviderUpdated","ProviderCard","TourProvidersTab","isEditModalOpen","setIsEditModalOpen","editingProvider","setEditingProvider","providers","setProviders","fetchProviders","_error$response$data","filteredProviders","_provider$contactPers","_provider$phone","_provider$email","_provider$notes","search","providerId","CreateTourProviderModal","newProvider","EditTourProviderModal","updatedProvider","TourType","onTourCreated","setTitle","setDescription","setType","OWN","setIsActive","duration","setDuration","setMaxParticipants","setMinParticipants","price","setPrice","setCurrency","location","setLocation","meetingPoint","setMeetingPoint","setIncludes","excludes","setExcludes","requirements","setRequirements","totalCommission","setTotalCommission","totalCommissionPercent","setTotalCommissionPercent","sellerCommissionPercent","setSellerCommissionPercent","sellerCommissionFixed","setSellerCommissionFixed","externalProviderId","setExternalProviderId","externalBookingUrl","setExternalBookingUrl","imageFile","setImageFile","imagePreview","setImagePreview","galleryFiles","setGalleryFiles","galleryPreviews","setGalleryPreviews","uploadingImage","setUploadingImage","tourProviders","setTourProviders","_API_ENDPOINTS$TOUR_P","_providersRes$data","providersRes","maxPart","minPart","EXTERNAL","tourData","createdTour","FormData","append","UPLOAD_IMAGE","headers","imgErr","UPLOAD_GALLERY","galleryErr","updatedResponse","_e$target$files","reader","FileReader","onloadend","readAsDataURL","alt","multiple","preview","_","removeGalleryImage","_tour$isActive","_tour$galleryUrls","onTourUpdated","getTourImageUrl","galleryUrls","getTourGalleryImageUrl","_tour$isActive2","_tour$galleryUrls2","handleImageChange","handleGalleryChange","removeMainImage","DELETE_IMAGE","currentGallery","DELETE_GALLERY_IMAGE","_response2","_response2$data","newIndex","_response3","_response3$data","setTour","isCreateBookingModalOpen","setIsCreateBookingModalOpen","loadTour","UsersIcon","createdBy","createdAt","format","locale","externalProvider","availableFrom","availableTo","CreateTourBookingModal","tourCount","selectedFields","setSelectedFields","exporting","setExporting","setFormat","availableFields","selectAll","deselectAll","field","toggleField","fieldId","fieldsParam","EXPORT","fields","csvContent","row","cell","initialImageIndex","tourTitle","currentImageIndex","setCurrentImageIndex","zoomLevel","setZoomLevel","imageLoading","setImageLoading","imageError","setImageError","images","handlePrevious","handleNext","handleZoomIn","handleZoomOut","handleZoomReset","shiftKey","currentImage","canGoPrevious","canGoNext","canZoomIn","canZoomOut","MagnifyingGlassMinusIcon","MagnifyingGlassPlusIcon","ChevronLeftIcon","transform","cursor","onLoad","handleImageLoad","handleImageError","ChevronRightIcon","TOURS_TABLE_ID","defaultTourColumnOrder","tourCardToTableMapping","ToursTab","toursLoading","setToursLoading","toursError","setToursError","tourSearchTerm","setTourSearchTerm","tourFilterConditions","setTourFilterConditions","tourFilterLogicalOperators","setTourFilterLogicalOperators","tourActiveFilterName","setTourActiveFilterName","tourSelectedFilterId","setTourSelectedFilterId","tourFilterLogicalOperatorsRef","isCreateTourModalOpen","setIsCreateTourModalOpen","isEditTourModalOpen","setIsEditTourModalOpen","isTourDetailsModalOpen","setIsTourDetailsModalOpen","isTourExportDialogOpen","setIsTourExportDialogOpen","lightboxOpen","setLightboxOpen","selectedTourForLightbox","setSelectedTourForLightbox","setInitialImageIndex","selectedTourId","setSelectedTourId","draggedColumn","setDraggedColumn","dragOverColumn","setDragOverColumn","generatingImages","setGeneratingImages","imageGenerationJobs","setImageGenerationJobs","pollingIntervalsRef","pollCountRef","isLoadingSettings","tourTableSortConfig","availableTourColumns","shortLabel","substring","tourFilterOnlyColumns","cardMetadataOrder","cardMetadata","tableCol","cardMeta","getTourCardMetadataFromColumnOrder","hiddenCardMetadata","hiddenTableColumns","Set","add","getTourHiddenCardMetadata","visibleCardMetadata","loadTours","filterId","background","rawData","handleGenerateImages","GENERATE_IMAGES","mode","jobId","tourIdStr","setInterval","clearInterval","newJobs","GENERATE_IMAGES_STATUS","values","interval","applyTourFilterConditions","resetTourFilterConditions","handleTourFilterChange","initialLoadAttemptedRef","handleDragEnd","visibleColumnIds","validOrder","missingColumns","filteredAndSortedTours","filtered","cond","compareValue","abs","_tour$branch","branchName","createdByName","createdById","_tour$branch2","getTourSortValue","_tour$branch3","valueA","valueB","comparison","strA","strB","titleA","titleB","Squares2X2Icon","TableCellsIcon","TableColumnConfig","tableColumn","onColumnOrderChange","newOrder","newTableOrder","Boolean","handleMainSortChange","col","scope","draggable","onDragStart","handleDragStart","onDragOver","handleDragOver","onDrop","handleDrop","dragIndex","hoverIndex","draggedColumn_","splice","onDragEnd","newDirection","handleTourSort","colSpan","_tour$branch4","TOGGLE_ACTIVE","_err$response2$data","InformationCircleIcon","PhotoIcon","CardGrid","_response4","_response4$data","CreateTourModal","EditTourModal","TourDetailsModal","TourExportDialog","TourImageLightbox","onSuccess","displayName","domain","setErrors","fetchCurrentUser","handleChange","newErrors","organizationService","createOrganization","submit","organizationName","searching","setSearching","organizations","setOrganizations","showDropdown","setShowDropdown","selectedOrganization","setSelectedOrganization","searchTimeoutRef","dropdownRef","handleOrganizationInputChange","searchOrganizations","handleSelectOrganization","org","handleMessageChange","createJoinRequest","RoleConfigurationTab","React","DocumentConfigurationTab","SMTPConfigurationTab","ApiConfigurationTab","organization","logo","nit","organizationWithSettings","setOrganizationWithSettings","selectedCountry","setSelectedCountry","setNit","organizationLanguage","setOrganizationLanguage","useLanguage","selectedOrgLanguage","setSelectedOrgLanguage","savingOrgLanguage","setSavingOrgLanguage","logoFile","setLogoFile","logoPreview","setLogoPreview","orgWithSettings","getCurrentOrganization","orgSettings","langResponse","getOrganizationLanguage","langError","loadOrgLanguage","loadSettingsIfNeeded","handleLogoFileChange","base64String","updateOrganization","newLanguage","Suspense","fallback","onSave","getStatusColor","getStatusText","MY_JOIN_REQUESTS_TABLE_ID","MyJoinRequestsList","joinRequests","setJoinRequests","isFilterPanelOpen","setIsFilterPanelOpen","mountedRef","withdrawingId","setWithdrawingId","timeoutId","ORGANIZATIONS","MY_JOIN_REQUESTS","requests","getMyJoinRequests","fetchMyJoinRequests","hour","minute","filteredJoinRequests","request","_request$message","orgName","reduce","acc","_request$message2","searchValue","msgValue","processor","processedAt","requestId","withdrawJoinRequest","req","_err$response4$data","handleWithdraw","ArrowUturnLeftIcon","OrganizationSettings","setOrganization","stats","setStats","loadingStats","setLoadingStats","isJoinModalOpen","setIsJoinModalOpen","canViewOrganization","canManageOrganization","refreshOrganization","useOrganization","fetchOrganization","includeSettings","statsData","getOrganizationStats","statsErr","hasOrganization","hasInitialLoadRef","UserPlusIcon","UserGroupIcon","subscriptionPlan","currentUsers","maxUsers","utilizationPercent","_count","EnvelopeIcon","invitations","ChartBarIcon","availableSlots","CreateOrganizationModal","handleCreateSuccess","JoinOrganizationModal","EditOrganizationModal","handleEditModalClose","handleEditSuccess","joinRequest","setAction","setRoleId","setResponse","organizationId","processJoinRequest","requester","JOIN_REQUESTS_TABLE_ID","JoinRequestsList","isProcessModalOpen","setIsProcessModalOpen","selectedRequest","setSelectedRequest","canViewJoinRequests","canManageJoinRequests","hasInitialLoad","joinRequestsCount","JOIN_REQUESTS","getJoinRequests","stack","fetchJoinRequests","_request$requester$em","requesterName","requesterEmail","_request$requester$em2","handleOpenProcessModal","ProcessJoinRequestModal","Organisation","canViewOrganisation","canViewUsers","canViewRoles","canViewBranches","canViewProviders","canViewOrg","activeTabState","setActiveTabState","providersViewMode","setProvidersViewMode","isInitialized","defaultTab","handleTabChange","TruckIcon","RoleManagementTab"],"sourceRoot":""}