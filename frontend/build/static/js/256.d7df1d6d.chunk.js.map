{"version":3,"file":"static/js/256.d7df1d6d.chunk.js","mappings":"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","sources":["components/teamWorktime/StopWorktimeModal.tsx","components/teamWorktime/EditWorktimeModal.tsx","components/teamWorktime/ActiveUsersList.tsx","api/worktimeApi.ts","components/teamWorktime/TodoAnalyticsTab.tsx","components/teamWorktime/RequestAnalyticsTab.tsx","components/teamWorktime/CreateShiftModal.tsx","components/teamWorktime/SwapRequestModal.tsx","components/teamWorktime/EditShiftModal.tsx","components/teamWorktime/GenerateShiftPlanModal.tsx","components/teamWorktime/SwapRequestList.tsx","components/teamWorktime/ShiftTemplateManagement.tsx","components/teamWorktime/AvailabilityManagement.tsx","utils/colorPalette.ts","components/teamWorktime/ShiftPlannerTab.tsx","pages/TeamWorktimeControl.tsx","utils/filterLogic.ts"],"sourcesContent":["import React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog, Transition } from '@headlessui/react';\nimport { Fragment } from 'react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { format } from 'date-fns';\n\ninterface StopWorktimeModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onConfirm: (endTime: string) => Promise<void>;\n  userName: string;\n}\n\nconst StopWorktimeModal: React.FC<StopWorktimeModalProps> = ({\n  isOpen,\n  onClose,\n  onConfirm,\n  userName\n}) => {\n  const { t } = useTranslation();\n  // Aktuelles Datum und Zeit als Standardwert\n  const now = new Date();\n  const formattedDate = format(now, 'yyyy-MM-dd');\n  const formattedTime = format(now, 'HH:mm:ss');\n  \n  // State fr Datum und Zeit\n  const [date, setDate] = useState(formattedDate);\n  const [time, setTime] = useState(formattedTime);\n  const [loading, setLoading] = useState(false);\n  \n  // Besttige das Stoppen der Zeiterfassung\n  const handleConfirm = async () => {\n    try {\n      setLoading(true);\n      \n      // Kombiniere Datum und Zeit zu einem ISO-String ohne 'Z' am Ende,\n      // um zu verhindern, dass JavaScript den Zeitstempel als UTC interpretiert\n      const endTime = `${date}T${time}`;\n      \n      await onConfirm(endTime);\n    } catch (error) {\n      console.error('Fehler beim Stoppen der Zeiterfassung:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n  \n  return (\n    <Transition appear show={isOpen} as={Fragment}>\n      <Dialog as=\"div\" className=\"relative z-10\" onClose={onClose}>\n        <Transition.Child\n          as={Fragment}\n          enter=\"ease-out duration-300\"\n          enterFrom=\"opacity-0\"\n          enterTo=\"opacity-100\"\n          leave=\"ease-in duration-200\"\n          leaveFrom=\"opacity-100\"\n          leaveTo=\"opacity-0\"\n        >\n          <div className=\"fixed inset-0 bg-black bg-opacity-25\" />\n        </Transition.Child>\n\n        <div className=\"fixed inset-0 overflow-y-auto\">\n          <div className=\"flex min-h-full items-center justify-center p-4 text-center\">\n            <Transition.Child\n              as={Fragment}\n              enter=\"ease-out duration-300\"\n              enterFrom=\"opacity-0 scale-95\"\n              enterTo=\"opacity-100 scale-100\"\n              leave=\"ease-in duration-200\"\n              leaveFrom=\"opacity-100 scale-100\"\n              leaveTo=\"opacity-0 scale-95\"\n            >\n              <Dialog.Panel className=\"w-full max-w-md transform overflow-hidden rounded-2xl bg-white dark:bg-gray-800 p-6 text-left align-middle shadow-xl transition-all\">\n                <div className=\"flex justify-between items-start\">\n                  <Dialog.Title\n                    as=\"h3\"\n                    className=\"text-lg font-medium leading-6 text-gray-900 dark:text-white\"\n                  >\n                    {t('teamWorktime.modal.stopTracking.title')}\n                  </Dialog.Title>\n                  <button\n                    type=\"button\"\n                    className=\"bg-white dark:bg-gray-800 rounded-md text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                    onClick={onClose}\n                  >\n                    <span className=\"sr-only\">{t('common.close')}</span>\n                    <XMarkIcon className=\"h-6 w-6\" aria-hidden=\"true\" />\n                  </button>\n                </div>\n\n                <div className=\"mt-2\">\n                  <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                    {t('teamWorktime.modal.stopTracking.description', { userName })}\n                  </p>\n                </div>\n\n                <div className=\"mt-4 grid grid-cols-2 gap-4\">\n                  <div>\n                    <label htmlFor=\"date\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                      {t('teamWorktime.modal.stopTracking.date')}\n                    </label>\n                    <input\n                      type=\"date\"\n                      id=\"date\"\n                      className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                      value={date}\n                      onChange={(e) => setDate(e.target.value)}\n                    />\n                  </div>\n                  <div>\n                    <label htmlFor=\"time\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                      {t('teamWorktime.modal.stopTracking.time')}\n                    </label>\n                    <input\n                      type=\"time\"\n                      id=\"time\"\n                      step=\"1\"\n                      className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                      value={time}\n                      onChange={(e) => setTime(e.target.value)}\n                    />\n                  </div>\n                </div>\n\n                <div className=\"mt-6 flex justify-end space-x-3\">\n                  <button\n                    type=\"button\"\n                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed\"\n                    onClick={onClose}\n                    disabled={loading}\n                    title={t('common.cancel')}\n                  >\n                    <XMarkIcon className=\"h-5 w-5\" />\n                  </button>\n                  <button\n                    type=\"button\"\n                    className=\"p-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed\"\n                    onClick={handleConfirm}\n                    disabled={loading}\n                    title={loading ? t('teamWorktime.modal.stopTracking.stopping') : t('teamWorktime.modal.stopTracking.stop')}\n                  >\n                    {loading ? (\n                      <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                    ) : (\n                      <CheckIcon className=\"h-5 w-5\" />\n                    )}\n                  </button>\n                </div>\n              </Dialog.Panel>\n            </Transition.Child>\n          </div>\n        </div>\n      </Dialog>\n    </Transition>\n  );\n};\n\nexport default StopWorktimeModal; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, TrashIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { format, parse } from 'date-fns';\n\n// Hilfsfunktion fr lokale Datumsberechnungen\nimport { createLocalDate } from '../../utils/dateUtils.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface WorktimeEntry {\n  id: number;\n  startTime: string;\n  endTime: string | null;\n  userId: number;\n  branch: {\n    id: number;\n    name: string;\n  };\n}\n\ninterface EditableEntry extends WorktimeEntry {\n  date: string;\n  startTimeTime: string;\n  endTimeTime: string | null;\n  startDateTime: string; // datetime-local format: YYYY-MM-DDTHH:mm\n  endDateTime: string | null; // datetime-local format: YYYY-MM-DDTHH:mm\n  isDeleted?: boolean;\n  isModified?: boolean;\n}\n\ninterface EditWorktimeModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSave: (entries: EditableEntry[]) => Promise<void>;\n  userName: string;\n  entries: WorktimeEntry[];\n  selectedDate: string;\n}\n\nconst EditWorktimeModal: React.FC<EditWorktimeModalProps> = ({\n  isOpen,\n  onClose,\n  onSave,\n  userName,\n  entries,\n  selectedDate\n}) => {\n  const { t } = useTranslation();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [editedEntries, setEditedEntries] = useState<EditableEntry[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  \n  // Responsive Erkennung\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    handleResize();\n    window.addEventListener('resize', handleResize);\n    \n    return () => {\n      window.removeEventListener('resize', handleResize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  // Initialisiere die bearbeitbaren Eintrge, wenn sich die Props ndern\n  useEffect(() => {\n    if (entries && entries.length > 0) {\n      // Konvertiere Eintrge in das bearbeitbare Format\n      const formattedEntries = entries.map(entry => {\n        // Extrahiere direkt die Datums- und Zeitteile aus den ISO-Strings ohne Date-Objekte zu erstellen\n        const datePart = entry.startTime.split('T')[0]; // YYYY-MM-DD\n        const startTimePart = entry.startTime.split('T')[1].substring(0, 8); // HH:MM:SS\n        const endTimePart = entry.endTime ? entry.endTime.split('T')[1].substring(0, 8) : null; // HH:MM:SS oder null\n        \n        // Erstelle datetime-local Format (YYYY-MM-DDTHH:mm)\n        const startDateTime = `${datePart}T${startTimePart.substring(0, 5)}`; // YYYY-MM-DDTHH:mm\n        const endDateTime = endTimePart ? `${entry.endTime.split('T')[0]}T${endTimePart.substring(0, 5)}` : null;\n        \n        return {\n          ...entry,\n          date: datePart,\n          startTimeTime: startTimePart,\n          endTimeTime: endTimePart,\n          startDateTime: startDateTime,\n          endDateTime: endDateTime,\n          isDeleted: false,\n          isModified: false\n        };\n      });\n      \n      setEditedEntries(formattedEntries);\n    } else {\n      setEditedEntries([]);\n    }\n  }, [entries]);\n  \n  // Handler fr nderungen an der Startzeit (datetime-local)\n  const handleStartDateTimeChange = (index: number, value: string) => {\n    const newEntries = [...editedEntries];\n    if (newEntries[index].startDateTime !== value) {\n      // Extrahiere Datum und Zeit aus datetime-local Format\n      const [datePart, timePart] = value.split('T');\n      const timeWithSeconds = timePart ? `${timePart}:00` : '00:00:00';\n      \n      newEntries[index].date = datePart;\n      newEntries[index].startDateTime = value;\n      newEntries[index].startTimeTime = timeWithSeconds;\n      newEntries[index].isModified = true;\n      setEditedEntries(newEntries);\n      validateEntries(newEntries);\n    }\n  };\n  \n  // Handler fr nderungen an der Endzeit (datetime-local)\n  const handleEndDateTimeChange = (index: number, value: string | null) => {\n    const newEntries = [...editedEntries];\n    if (newEntries[index].endDateTime !== value) {\n      if (value) {\n        // Extrahiere Datum und Zeit aus datetime-local Format\n        const [datePart, timePart] = value.split('T');\n        const timeWithSeconds = timePart ? `${timePart}:00` : '00:00:00';\n        \n        newEntries[index].endDateTime = value;\n        newEntries[index].endTimeTime = timeWithSeconds;\n      } else {\n        newEntries[index].endDateTime = null;\n        newEntries[index].endTimeTime = null;\n      }\n      newEntries[index].isModified = true;\n      setEditedEntries(newEntries);\n      validateEntries(newEntries);\n    }\n  };\n\n  // Handler fr das Markieren eines Eintrags zum Lschen\n  const handleToggleDelete = (index: number) => {\n    const newEntries = [...editedEntries];\n    newEntries[index].isDeleted = !newEntries[index].isDeleted;\n    newEntries[index].isModified = true;\n    setEditedEntries(newEntries);\n  };\n  \n  // Validierung der Eintrge\n  const validateEntries = (entriesToValidate: EditableEntry[]) => {\n    // Filtere alle Eintrge, die nicht zum Lschen markiert sind\n    const activeEntries = entriesToValidate.filter(entry => !entry.isDeleted);\n    \n    // Prfe, ob es berlappende Zeitrume gibt\n    for (let i = 0; i < activeEntries.length; i++) {\n      const entry1 = activeEntries[i];\n      \n      // Verwende datetime-local Format fr Vergleich (YYYY-MM-DDTHH:mm)\n      const start1 = entry1.startDateTime;\n      const end1 = entry1.endDateTime;\n      \n      // Prfe, ob Endzeit nach Startzeit liegt\n      if (end1 && start1 >= end1) {\n        setError(`Eintrag ${i+1}: Die Endzeit muss nach der Startzeit liegen.`);\n        return false;\n      }\n      \n      // Prfe auf berlappungen mit anderen Eintrgen\n      for (let j = i + 1; j < activeEntries.length; j++) {\n        const entry2 = activeEntries[j];\n        \n        const start2 = entry2.startDateTime;\n        const end2 = entry2.endDateTime;\n        \n        // berlappung prfen: Vergleiche datetime-local Strings\n        if (\n          (end1 && end2 && start1 < end2 && end1 > start2) ||\n          (end1 && !end2 && end1 > start2) ||\n          (end2 && !end1 && end2 > start1)\n        ) {\n          setError(`Es gibt eine berlappung zwischen Eintrag ${i+1} und Eintrag ${j+1}.`);\n          return false;\n        }\n      }\n    }\n    \n    setError(null);\n    return true;\n  };\n  \n  // Speichern der nderungen\n  const handleSave = async () => {\n    // Validiere noch einmal vor dem Speichern\n    if (!validateEntries(editedEntries)) {\n      return;\n    }\n    \n    try {\n      setLoading(true);\n      \n      // Filtere nur die tatschlich genderten oder gelschten Eintrge\n      const modifiedEntries = editedEntries.filter(entry => entry.isModified || entry.isDeleted);\n      \n      // Konvertiere bearbeitete Eintrge zurck in das API-Format\n      // Achtung: Da im Backend new Date() verwendet wird, was zu einer Zeitzonenkonvertierung fhrt,\n      // sollten wir hier mit den lokalen ISO-Strings ohne Zeitzone arbeiten\n      const updatedEntries = modifiedEntries.map(entry => {\n        // Erstelle direkte ISO-Strings ohne Zeitzone aus datetime-local Format\n        const startTimeStr = entry.startDateTime ? `${entry.startDateTime}:00` : `${entry.date}T${entry.startTimeTime}`;\n        const endTimeStr = entry.endDateTime ? `${entry.endDateTime}:00` : (entry.endTimeTime ? `${entry.date}T${entry.endTimeTime}` : null);\n        \n        return {\n          ...entry,\n          startTime: startTimeStr,\n          endTime: endTimeStr\n        };\n      });\n      \n      // Nur wenn es nderungen gibt, senden wir diese an das Backend\n      if (updatedEntries.length > 0) {\n        await onSave(updatedEntries);\n      }\n      \n      onClose();\n    } catch (error) {\n      console.error('Fehler beim Speichern der Zeiterfassungen:', error);\n      setError(t('teamWorktime.modal.editWorktimes.saveError'));\n    } finally {\n      setLoading(false);\n    }\n  };\n  \n  // Render-Funktion fr den Formularinhalt\n  const renderForm = () => (\n    <div className=\"space-y-4\">\n      <div>\n        <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n          {t('teamWorktime.modal.editWorktimes.description', { \n            userName, \n            date: selectedDate.split('-').reverse().join('.') \n          })}\n        </p>\n      </div>\n\n      {error && (\n        <div className=\"p-2 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded\">\n          {error}\n        </div>\n      )}\n\n      <div>\n        <div className=\"overflow-x-auto border dark:border-gray-700 rounded-lg\">\n          <table className=\"w-full divide-y divide-gray-200 dark:divide-gray-700\" style={{ tableLayout: 'auto' }}>\n            <thead className=\"bg-gray-50 dark:bg-gray-700\">\n              <tr>\n                <th scope=\"col\" className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\" style={{ minWidth: '250px' }}>{t('teamWorktime.modal.editWorktimes.columns.startTime')}</th>\n                <th scope=\"col\" className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\" style={{ minWidth: '250px' }}>{t('teamWorktime.modal.editWorktimes.columns.endTime')}</th>\n                <th scope=\"col\" className=\"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\" style={{ width: '80px' }}>{t('common.actions')}</th>\n              </tr>\n            </thead>\n            <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n              {editedEntries.length === 0 ? (\n                <tr>\n                  <td colSpan={3} className=\"px-4 py-4 text-center text-sm text-gray-500 dark:text-gray-400\">\n                    {t('teamWorktime.modal.editWorktimes.noEntries')}\n                  </td>\n                </tr>\n              ) : (\n                editedEntries.map((entry, index) => (\n                  <tr key={entry.id} className={entry.isDeleted ? 'bg-red-50 dark:bg-red-900' : ''}>\n                    <td className=\"px-4 py-3\" style={{ minWidth: '250px' }}>\n                      <input\n                        type=\"datetime-local\"\n                        className={`w-full px-3 py-2 border ${entry.isDeleted ? 'border-red-300 bg-red-50 dark:border-red-700 dark:bg-red-900' : 'border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white'} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`}\n                        value={entry.startDateTime}\n                        onChange={(e) => handleStartDateTimeChange(index, e.target.value)}\n                        disabled={entry.isDeleted}\n                        style={{ minWidth: '230px' }}\n                      />\n                    </td>\n                    <td className=\"px-4 py-3\" style={{ minWidth: '250px' }}>\n                      <input\n                        type=\"datetime-local\"\n                        className={`w-full px-3 py-2 border ${entry.isDeleted ? 'border-red-300 bg-red-50 dark:border-red-700 dark:bg-red-900' : 'border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white'} rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`}\n                        value={entry.endDateTime || ''}\n                        onChange={(e) => handleEndDateTimeChange(index, e.target.value || null)}\n                        disabled={entry.isDeleted}\n                        style={{ minWidth: '230px' }}\n                      />\n                    </td>\n                    <td className=\"px-4 py-3 whitespace-nowrap text-right text-sm font-medium\">\n                      <button\n                        type=\"button\"\n                        onClick={() => handleToggleDelete(index)}\n                        className={`p-1 rounded ${entry.isDeleted ? 'text-green-600 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300' : 'text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300'}`}\n                        title={entry.isDeleted ? t('teamWorktime.modal.editWorktimes.restore') : t('teamWorktime.modal.editWorktimes.markForDelete')}\n                      >\n                        <TrashIcon className=\"h-5 w-5\" />\n                      </button>\n                    </td>\n                  </tr>\n                ))\n              )}\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      <div className=\"flex justify-end space-x-3 pt-4 border-t dark:border-gray-700\">\n        <button\n          type=\"button\"\n          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed\"\n          onClick={onClose}\n          disabled={loading}\n          title={t('common.cancel')}\n        >\n          <XMarkIcon className=\"h-5 w-5\" />\n        </button>\n        <button\n          type=\"button\"\n          className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n          onClick={handleSave}\n          disabled={loading || Boolean(error)}\n          title={loading ? t('common.saving') : t('common.save')}\n        >\n          {loading ? (\n            <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n          ) : (\n            <CheckIcon className=\"h-5 w-5\" />\n          )}\n        </button>\n      </div>\n    </div>\n  );\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                {t('teamWorktime.modal.editWorktimes.title')}\n              </Dialog.Title>\n              <button\n                onClick={onClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <div className=\"p-4\">\n              {renderForm()}\n            </div>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={onClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-lg w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('teamWorktime.modal.editWorktimes.title')}\n          </h2>\n          <button\n            onClick={onClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {renderForm()}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default EditWorktimeModal; ","import React, { useState, useMemo, useCallback, useEffect } from 'react';\nimport { format, formatDistanceToNow, subDays, addDays } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport { useTranslation } from 'react-i18next';\nimport { StopIcon, ArrowPathIcon, MagnifyingGlassIcon, Bars3Icon, ChevronUpIcon, ChevronDownIcon, ArrowsUpDownIcon, CalendarIcon, PencilIcon, FunnelIcon, Squares2X2Icon, TableCellsIcon, UserIcon, BuildingOfficeIcon, ClockIcon } from '@heroicons/react/24/outline';\nimport StopWorktimeModal from './StopWorktimeModal.tsx';\nimport EditWorktimeModal from './EditWorktimeModal.tsx';\nimport FilterPane from '../FilterPane.tsx';\nimport SavedFilterTags from '../SavedFilterTags.tsx';\nimport { useFilterContext } from '../../contexts/FilterContext.tsx';\nimport { FilterCondition } from '../FilterRow.tsx';\nimport { applyFilters } from '../../utils/filterLogic.ts';\nimport { useTableSettings } from '../../hooks/useTableSettings.ts';\nimport { usePermissions } from '../../hooks/usePermissions.ts';\nimport { createLocalDate } from '../../utils/dateUtils.ts';\nimport * as worktimeApi from '../../api/worktimeApi.ts';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport axiosInstance from '../../config/axios.ts';\nimport TableColumnConfig from '../TableColumnConfig.tsx';\nimport DataCard, { MetadataItem } from '../shared/DataCard.tsx';\nimport CardGrid from '../shared/CardGrid.tsx';\nimport { logger } from '../../utils/logger.ts';\n\ninterface ActiveUsersListProps {\n  activeUsers: any[];\n  allWorktimes: any[];\n  loading: boolean;\n  selectedDate: string;\n  onDateChange: (date: string) => void;\n  onStopWorktime: (userId: number, endTime: string) => Promise<void>;\n  onRefresh: () => void;\n  showTodos?: boolean;\n  showRequests?: boolean;\n}\n\n// Definition der verfgbaren Spalten wird jetzt dynamisch mit useTranslation gemacht\n\n// Standardreihenfolge der Spalten\nconst defaultColumnOrder = ['name', 'startTime', 'duration', 'pauseTime', 'branch', 'actions'];\n\n// Card-Einstellungen Standardwerte\nconst defaultCardMetadata = ['name', 'startTime', 'duration', 'pauseTime', 'branch'];\nconst defaultCardColumnOrder = ['name', 'startTime', 'duration', 'pauseTime', 'branch'];\n\n// Mapping zwischen Tabellen-Spalten-IDs und Card-Metadaten-IDs\n// Tabellen-Spalte -> Card-Metadaten (kann Array sein fr 1:N Mapping)\nconst tableToCardMapping: Record<string, string[]> = {\n  'name': ['name'],\n  'startTime': ['startTime'],\n  'duration': ['duration'],\n  'pauseTime': ['pauseTime'],\n  'branch': ['branch'],\n  'actions': [] // Keine Card-Entsprechung\n};\n\n// Reverse Mapping: Card-Metadaten -> Tabellen-Spalten\nconst cardToTableMapping: Record<string, string> = {\n  'name': 'name',\n  'startTime': 'startTime',\n  'duration': 'duration',\n  'pauseTime': 'pauseTime',\n  'branch': 'branch'\n};\n\n// Helfer-Funktion: Tabellen-Spalte ausgeblendet -> Card-Metadaten ausblenden\nconst getHiddenCardMetadata = (hiddenTableColumns: string[]): Set<string> => {\n  const hiddenCardMetadata = new Set<string>();\n  hiddenTableColumns.forEach(tableCol => {\n    const cardMetadata = tableToCardMapping[tableCol] || [];\n    cardMetadata.forEach(cardMeta => hiddenCardMetadata.add(cardMeta));\n  });\n  return hiddenCardMetadata;\n};\n\n// Helfer-Funktion: Card-Metadaten zu Tabellen-Spalten konvertieren\nconst getCardMetadataFromColumnOrder = (columnOrder: string[]): string[] => {\n  const cardMetadata: string[] = [];\n  columnOrder.forEach(tableCol => {\n    const cardMeta = tableToCardMapping[tableCol];\n    if (cardMeta && cardMeta.length > 0) {\n      cardMetadata.push(...cardMeta);\n    }\n  });\n  return cardMetadata;\n};\n\ninterface SortConfig {\n  key: string;\n  direction: 'asc' | 'desc';\n}\n\ninterface WorktimeGroup {\n  user: {\n    id: number;\n    username: string;\n    firstName: string;\n    lastName: string;\n    normalWorkingHours: number;\n    approvedOvertimeHours: number;\n  };\n  branch: {\n    id: number;\n    name: string;\n  };\n  entries: any[];\n  startTime: Date;\n  endTime: Date | null;\n  totalDuration: number;\n  activeEntries: any[];\n  hasActiveWorktime: boolean;\n}\n\n// TableID fr gespeicherte Filter\nconst WORKCENTER_TABLE_ID = 'workcenter-table';\n\nconst ActiveUsersList: React.FC<ActiveUsersListProps> = ({\n  activeUsers,\n  allWorktimes,\n  loading,\n  selectedDate,\n  onDateChange,\n  onStopWorktime,\n  onRefresh,\n  showTodos = false,\n  showRequests = false\n}) => {\n  const { t } = useTranslation();\n  \n  // Definition der verfgbaren Spalten (dynamisch aus bersetzungen)\n  const availableColumns = useMemo(() => [\n    { id: 'name', label: t('teamWorktime.columns.name') },\n    { id: 'startTime', label: t('teamWorktime.columns.startTime') },\n    { id: 'duration', label: t('teamWorktime.columns.duration') },\n    { id: 'pauseTime', label: t('teamWorktime.columns.pauseTime') },\n    { id: 'branch', label: t('teamWorktime.columns.branch') },\n    { id: 'actions', label: t('teamWorktime.columns.actions') }\n  ], [t]);\n  \n  const [showStopModal, setShowStopModal] = useState(false);\n  const [showEditModal, setShowEditModal] = useState(false);\n  const [selectedUser, setSelectedUser] = useState<any>(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [isFilterOpen, setIsFilterOpen] = useState(false);\n  const [draggedColumn, setDraggedColumn] = useState<string | null>(null);\n  const [isColumnConfigOpen, setIsColumnConfigOpen] = useState(false);\n  const [displayLimit, setDisplayLimit] = useState<number>(10);\n  \n  // Neue State-Variablen fr erweiterte Filterbedingungen\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  \n  // Filter State Management (Controlled Mode)\n  const [activeFilterName, setActiveFilterName] = useState<string>(t('teamWorktime.filters.active'));\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n  \n  // State fr To-Dos und Requests pro User\n  const [userTodos, setUserTodos] = useState<Record<number, any>>({});\n  const [userRequests, setUserRequests] = useState<Record<number, any>>({});\n  const [expandedUsers, setExpandedUsers] = useState<Set<number>>(new Set());\n  const [loadingTodos, setLoadingTodos] = useState<boolean>(false);\n  const [loadingRequests, setLoadingRequests] = useState<boolean>(false);\n  \n  const { hasPermission } = usePermissions();\n\n  // Lade To-Dos fr User (wenn showTodos aktiv)\n  useEffect(() => {\n    const loadUserTodos = async () => {\n      if (!showTodos || !selectedDate) return;\n      \n      try {\n        setLoadingTodos(true);\n        const response = await axiosInstance.get(API_ENDPOINTS.TEAM_WORKTIME.ANALYTICS.TODOS_BY_USER, {\n          params: {\n            date: selectedDate\n          }\n        });\n        \n        // Konvertiere Array zu Record mit userId als Key\n        const todosMap: Record<number, any> = {};\n        response.data.forEach((item: any) => {\n          todosMap[item.userId] = item.todos;\n        });\n        setUserTodos(todosMap);\n      } catch (error) {\n        console.error('Fehler beim Laden der To-Dos:', error);\n      } finally {\n        setLoadingTodos(false);\n      }\n    };\n    \n    loadUserTodos();\n  }, [showTodos, selectedDate]);\n\n  //  MEMORY: Cleanup - Alle groen Arrays/Objekte beim Unmount lschen\n  useEffect(() => {\n    return () => {\n      setUserTodos({});\n      setUserRequests({});\n      setExpandedUsers(new Set());\n    };\n  }, []); // Nur beim Unmount ausfhren\n\n  // Lade Requests fr User (wenn showRequests aktiv)\n  useEffect(() => {\n    const loadUserRequests = async () => {\n      if (!showRequests || !selectedDate) return;\n      \n      try {\n        setLoadingRequests(true);\n        const response = await axiosInstance.get(API_ENDPOINTS.TEAM_WORKTIME.ANALYTICS.REQUESTS_BY_USER, {\n          params: {\n            date: selectedDate\n          }\n        });\n        \n        // Konvertiere Array zu Record mit userId als Key\n        const requestsMap: Record<number, any> = {};\n        response.data.forEach((item: any) => {\n          requestsMap[item.userId] = item.requests;\n        });\n        setUserRequests(requestsMap);\n      } catch (error) {\n        console.error('Fehler beim Laden der Requests:', error);\n      } finally {\n        setLoadingRequests(false);\n      }\n    };\n    \n    loadUserRequests();\n  }, [showRequests, selectedDate]);\n\n  const toggleExpand = (userId: number) => {\n    setExpandedUsers(prev => {\n      const next = new Set(prev);\n      if (next.has(userId)) {\n        next.delete(userId);\n      } else {\n        next.add(userId);\n      }\n      return next;\n    });\n  };\n\n  // Spalten-Konfiguration mit Hook\n  const { \n    settings,\n    updateColumnOrder,\n    updateHiddenColumns,\n    isColumnVisible,\n    updateViewMode,\n    updateSortConfig\n  } = useTableSettings('team_worktime_active', {\n    defaultColumnOrder: defaultColumnOrder,\n    defaultHiddenColumns: [],\n    defaultViewMode: 'cards'\n  });\n\n  // Benutze die vom Hook zurckgegebenen Werte\n  const columnOrder = settings.columnOrder;\n  const hiddenColumns = settings.hiddenColumns;\n\n  // View-Mode aus Settings laden\n  const viewMode = settings.viewMode || 'cards';\n  \n  // sortConfig aus settings verwenden (fr Table & Cards synchron)\n  const sortConfig = settings.sortConfig || { key: 'startTime', direction: 'asc' };\n\n  // Abgeleitete Werte fr Card-Ansicht aus Tabellen-Settings\n  // Card-Metadaten-Reihenfolge aus columnOrder ableiten\n  const cardMetadataOrder = useMemo(() => {\n    return getCardMetadataFromColumnOrder(settings.columnOrder || defaultColumnOrder);\n  }, [settings.columnOrder]);\n\n  // Versteckte Card-Metadaten aus hiddenColumns ableiten\n  const hiddenCardMetadata = useMemo(() => {\n    return getHiddenCardMetadata(settings.hiddenColumns || []);\n  }, [settings.hiddenColumns]);\n\n  // Sichtbare Card-Metadaten (alle Card-Metadaten minus versteckte)\n  const visibleCardMetadata = useMemo(() => {\n    return new Set(cardMetadataOrder.filter(meta => !hiddenCardMetadata.has(meta)));\n  }, [cardMetadataOrder, hiddenCardMetadata]);\n\n  // CSS-Klasse fr Container-Box setzen (fr CSS-basierte Schattierungs-Entfernung)\n  useEffect(() => {\n    const wrappers = document.querySelectorAll('.dashboard-workcenter-wrapper');\n    wrappers.forEach(wrapper => {\n      if (viewMode === 'cards') {\n        wrapper.classList.add('cards-mode');\n      } else {\n        wrapper.classList.remove('cards-mode');\n      }\n    });\n  }, [viewMode]);\n\n  // ffne das Modal zum Stoppen der Zeiterfassung\n  const handleOpenStopModal = (user: any) => {\n    setSelectedUser(user);\n    setShowStopModal(true);\n  };\n\n  // Schliee das Modal\n  const handleCloseStopModal = () => {\n    setShowStopModal(false);\n    setSelectedUser(null);\n  };\n\n  // ffne das Modal zur Bearbeitung der Zeiterfassungen\n  const handleOpenEditModal = (user: any) => {\n    setSelectedUser(user);\n    setShowEditModal(true);\n  };\n\n  // Schliee das Modal fr die Bearbeitung\n  const handleCloseEditModal = () => {\n    setShowEditModal(false);\n    setSelectedUser(null);\n  };\n\n  // Stoppe die Zeiterfassung eines Benutzers\n  const handleStopWorktime = async (endTime: string) => {\n    if (!selectedUser) return;\n\n    // Wenn mehrere aktive Zeiterfassungen vorhanden sind, stoppe die neueste\n    const activeEntry = selectedUser.activeEntries.length > 0 \n      ? selectedUser.activeEntries.reduce((latest: any, current: any) => {\n          const latestDate = createLocalDate(latest.startTime);\n          const currentDate = createLocalDate(current.startTime);\n          return currentDate > latestDate ? current : latest;\n        }, selectedUser.activeEntries[0])\n      : null;\n\n    if (activeEntry) {\n      await onStopWorktime(activeEntry.user.id, endTime);\n    } else {\n      await onStopWorktime(selectedUser.user.id, endTime);\n    }\n    \n    handleCloseStopModal();\n  };\n\n  // Sortieren\n  const handleSort = (key: string) => {\n    const newDirection = sortConfig.key === key && sortConfig.direction === 'asc' ? 'desc' : 'asc';\n    updateSortConfig({ key, direction: newDirection });\n  };\n\n  // Drag & Drop fr Spalten\n  const handleDragStart = (columnId: string) => {\n    setDraggedColumn(columnId);\n  };\n\n  const handleDragOver = useCallback((e: React.DragEvent) => {\n    e.preventDefault();\n  }, []);\n\n  const handleDrop = useCallback((e: React.DragEvent, targetColumnId: string) => {\n    e.preventDefault();\n    if (!draggedColumn || draggedColumn === targetColumnId) return;\n\n    const newOrder = [...columnOrder];\n    const draggedIndex = newOrder.indexOf(draggedColumn);\n    const targetIndex = newOrder.indexOf(targetColumnId);\n    \n    newOrder.splice(draggedIndex, 1);\n    newOrder.splice(targetIndex, 0, draggedColumn);\n    \n    updateColumnOrder(newOrder);\n  }, [draggedColumn, columnOrder, updateColumnOrder]);\n\n  const handleDragEnd = () => {\n    setDraggedColumn(null);\n  };\n\n  // Funktion zum Zhlen aktiver Filter\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  // Filtern und sortieren der Benutzer\n  const filteredAndSortedUsers = useMemo(() => {\n    // Kombiniere aktive und abgeschlossene Zeiterfassungen fr das ausgewhlte Datum\n    const allEntries = [...allWorktimes];\n    const activeEntriesForDate = activeUsers.filter(worktime => {\n      const startDate = worktime.startTime.split('T')[0];\n      return startDate === selectedDate;\n    });\n    \n    // Fge aktive Eintrge hinzu, die noch nicht in allWorktimes sind\n    activeEntriesForDate.forEach(activeEntry => {\n      if (!allEntries.find(entry => entry.id === activeEntry.id)) {\n        allEntries.push(activeEntry);\n      }\n    });\n\n    // Gruppiere Eintrge nach Benutzer\n    const userGroups = allEntries.reduce((groups, entry) => {\n      const userId = entry.user.id;\n      if (!groups[userId]) {\n        groups[userId] = {\n          user: entry.user,\n          branch: entry.branch,\n          entries: [],\n          startTime: createLocalDate(entry.startTime),\n          endTime: entry.endTime ? createLocalDate(entry.endTime) : null,\n          totalDuration: 0,\n          activeEntries: [],\n          hasActiveWorktime: false\n        };\n      }\n\n      const group = groups[userId];\n      group.entries.push(entry);\n      \n      // Update startTime if this entry has an earlier start\n      const entryStartTime = createLocalDate(entry.startTime);\n      if (entryStartTime < group.startTime) {\n        group.startTime = entryStartTime;\n      }\n\n      // Update endTime if this entry has a later end\n      if (entry.endTime) {\n        const entryEndTime = createLocalDate(entry.endTime);\n        if (!group.endTime || entryEndTime > group.endTime) {\n          group.endTime = entryEndTime;\n        }\n      } else {\n        group.hasActiveWorktime = true;\n        group.activeEntries.push(entry);\n      }\n\n      // Add duration of this entry\n      if (entry.endTime) {\n        const duration = createLocalDate(entry.endTime).getTime() - createLocalDate(entry.startTime).getTime();\n        group.totalDuration += duration;\n      }\n\n      return groups;\n    }, {});\n\n    // Konvertiere gruppierte Daten zurck in Array\n    let grouped = Object.values(userGroups) as WorktimeGroup[];\n\n    // Globale Suchfunktion - zuerst einfache Suche anwenden\n    let filtered = grouped.filter((group: WorktimeGroup) => {\n      if (!searchTerm) return true;\n      \n      const searchTermLower = searchTerm.toLowerCase();\n      \n      //  OPTIMIERUNG: Frhes Beenden bei Match\n      if (group.user.username.toLowerCase().includes(searchTermLower)) return true;\n      if (group.branch.name.toLowerCase().includes(searchTermLower)) return true;\n      \n      //  OPTIMIERUNG: Template-String nur wenn ntig\n      const fullName = `${group.user.firstName} ${group.user.lastName}`.toLowerCase();\n      if (fullName.includes(searchTermLower)) return true;\n      \n      return false; // Kein Match gefunden\n    });\n\n    // Wenn erweiterte Filterbedingungen definiert sind, wende diese an (auerhalb des filter-Callbacks)\n    if (filterConditions.length > 0) {\n      // Column-Evaluatoren fr WorktimeGroups\n      const columnEvaluators: any = {\n        'name': (group: WorktimeGroup, cond: FilterCondition) => {\n          //  OPTIMIERUNG: Template-String nur einmal erstellen\n          const fullName = `${group.user.firstName} ${group.user.lastName}`.toLowerCase();\n          const value = (cond.value as string || '').toLowerCase();\n          if (cond.operator === 'equals') return fullName === value;\n          if (cond.operator === 'contains') return fullName.includes(value);\n          if (cond.operator === 'startsWith') return fullName.startsWith(value);\n          if (cond.operator === 'endsWith') return fullName.endsWith(value);\n          return null;\n        },\n        'branch': (group: WorktimeGroup, cond: FilterCondition) => {\n          const branchName = group.branch.name.toLowerCase();\n          const value = (cond.value as string || '').toLowerCase();\n          if (cond.operator === 'equals') return branchName === value;\n          if (cond.operator === 'contains') return branchName.includes(value);\n          if (cond.operator === 'startsWith') return branchName.startsWith(value);\n          if (cond.operator === 'endsWith') return branchName.endsWith(value);\n          return null;\n        },\n        'hasActiveWorktime': (group: WorktimeGroup, cond: FilterCondition) => {\n          if (cond.operator === 'equals') {\n            const isActive = (cond.value === 'true' || cond.value === true);\n            return group.hasActiveWorktime === isActive;\n          }\n          return null;\n        },\n        'duration': (group: WorktimeGroup, cond: FilterCondition) => {\n          const minDuration = parseInt(cond.value as string || '0') * 60 * 60 * 1000; // Stunden in Millisekunden\n          if (cond.operator === 'greaterThan') return group.totalDuration > minDuration;\n          if (cond.operator === 'lessThan') return group.totalDuration < minDuration;\n          if (cond.operator === 'equals') {\n            const tolerance = 30 * 60 * 1000; // 30 Minuten Toleranz\n            return Math.abs(group.totalDuration - minDuration) <= tolerance;\n          }\n          return null;\n        }\n      };\n\n      const getFieldValue = (group: WorktimeGroup, columnId: string): any => {\n        switch (columnId) {\n          case 'name': return `${group.user.firstName} ${group.user.lastName}`;\n          case 'branch': return group.branch.name;\n          case 'hasActiveWorktime': return group.hasActiveWorktime;\n          case 'duration': return group.totalDuration;\n          case 'startTime': return group.startTime;\n          case 'endTime': return group.endTime;\n          default: return (group as any)[columnId];\n        }\n      };\n\n      filtered = applyFilters(\n        filtered,\n        filterConditions,\n        filterLogicalOperators,\n        getFieldValue,\n        columnEvaluators\n      );\n    }\n\n    // Hilfsfunktion zum Extrahieren von Werten fr Sortierung\n    const getSortValue = (group: WorktimeGroup, columnId: string): any => {\n      switch (columnId) {\n        case 'name':\n          return `${group.user.firstName} ${group.user.lastName}`.toLowerCase();\n        case 'startTime':\n          return group.startTime.getTime();\n        case 'duration':\n          return group.totalDuration;\n        case 'pauseTime':\n          return group.endTime ? (group.endTime.getTime() - group.startTime.getTime()) - group.totalDuration : 0;\n        case 'branch':\n          return group.branch.name.toLowerCase();\n        default:\n          return '';\n      }\n    };\n    \n    // Sortieren nach Prioritten\n    filtered.sort((a: any, b: any) => {\n      // 1. Prioritt: Table-Header-Sortierung (temporre berschreibung, auch wenn Filter aktiv)\n      if (viewMode === 'table' && sortConfig.key) {\n        const valueA = getSortValue(a, sortConfig.key);\n        const valueB = getSortValue(b, sortConfig.key);\n        \n        let comparison = 0;\n        if (typeof valueA === 'number' && typeof valueB === 'number') {\n          comparison = valueA - valueB;\n        } else {\n          //  OPTIMIERUNG: Vermeide String() Konvertierung wenn bereits String\n          const strA = typeof valueA === 'string' ? valueA : String(valueA);\n          const strB = typeof valueB === 'string' ? valueB : String(valueB);\n          comparison = strA.localeCompare(strB);\n        }\n        \n        if (comparison !== 0) {\n          return sortConfig.direction === 'asc' ? comparison : -comparison;\n        }\n      }\n      \n      // 3. Prioritt: Cards-Mode Hauptsortierung (wenn kein Filter aktiv, Cards-Mode)\n      if (viewMode === 'cards' && filterConditions.length === 0 && sortConfig.key) {\n        const valueA = getSortValue(a, sortConfig.key);\n        const valueB = getSortValue(b, sortConfig.key);\n        \n        let comparison = 0;\n        if (typeof valueA === 'number' && typeof valueB === 'number') {\n          comparison = valueA - valueB;\n        } else {\n          //  OPTIMIERUNG: Vermeide String() Konvertierung wenn bereits String\n          const strA = typeof valueA === 'string' ? valueA : String(valueA);\n          const strB = typeof valueB === 'string' ? valueB : String(valueB);\n          comparison = strA.localeCompare(strB);\n        }\n        \n        if (comparison !== 0) {\n          return sortConfig.direction === 'asc' ? comparison : -comparison;\n        }\n      }\n      \n      // 4. Prioritt: Tabellen-Mode Einzel-Sortierung (wenn kein Filter aktiv, Table-Mode)\n      if (viewMode === 'table' && filterConditions.length === 0 && sortConfig.key) {\n        const valueA = getSortValue(a, sortConfig.key);\n        const valueB = getSortValue(b, sortConfig.key);\n        \n        let comparison = 0;\n        if (typeof valueA === 'number' && typeof valueB === 'number') {\n          comparison = valueA - valueB;\n        } else {\n          //  OPTIMIERUNG: Vermeide String() Konvertierung wenn bereits String\n          const strA = typeof valueA === 'string' ? valueA : String(valueA);\n          const strB = typeof valueB === 'string' ? valueB : String(valueB);\n          comparison = strA.localeCompare(strB);\n        }\n        \n        if (comparison !== 0) {\n          return sortConfig.direction === 'asc' ? comparison : -comparison;\n        }\n      }\n      \n      // 5. Fallback: Standardsortierung\n      return 0;\n    });\n    \n    return filtered;\n  }, [allWorktimes, activeUsers, searchTerm, sortConfig, selectedDate, filterConditions, filterLogicalOperators, viewMode, cardMetadataOrder, visibleCardMetadata]);\n\n  // Render-Methode fr Spaltenheader\n  const renderSortableHeader = (columnId: string, label: string) => {\n    // berprfen, ob diese Spalte gerade sortiert wird\n    const isSorted = sortConfig?.key === columnId;\n    \n    return (\n      <th\n        key={columnId}\n        scope=\"col\"\n        className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer group relative\"\n        onClick={() => handleSort(columnId)}\n        draggable\n        onDragStart={() => handleDragStart(columnId)}\n        onDragOver={handleDragOver}\n        onDrop={(e) => handleDrop(e, columnId)}\n        onDragEnd={handleDragEnd}\n      >\n        <div className={`flex items-center ${draggedColumn === columnId ? 'opacity-50' : ''}`}>\n          <ArrowsUpDownIcon className=\"h-3 w-3 mr-1 text-gray-400 dark:text-gray-500\" />\n          {label} {isSorted && (\n            sortConfig.direction === 'asc' ? '' : ''\n          )}\n        </div>\n      </th>\n    );\n  };\n\n  // Handler fr die TableColumnConfig-Komponente\n  const handleToggleColumnVisibility = (columnId: string) => {\n    if (viewMode === 'cards') {\n      // Fr Cards: Mapping zurck zu Tabellen-Spalten\n      const tableColumn = cardToTableMapping[columnId];\n      if (tableColumn) {\n        const newHiddenColumns = hiddenColumns.includes(tableColumn)\n          ? hiddenColumns.filter(id => id !== tableColumn)\n          : [...hiddenColumns, tableColumn];\n        updateHiddenColumns(newHiddenColumns);\n      }\n    } else {\n    const newHiddenColumns = hiddenColumns.includes(columnId)\n      ? hiddenColumns.filter(id => id !== columnId)\n      : [...hiddenColumns, columnId];\n    updateHiddenColumns(newHiddenColumns);\n    }\n  };\n\n  const handleMoveColumn = (dragIndex: number, hoverIndex: number) => {\n    if (viewMode === 'cards') {\n      // Fr Cards: Card-Metadaten-Reihenfolge ndern\n      const newCardOrder = [...cardMetadataOrder];\n      const dragged = newCardOrder[dragIndex];\n      newCardOrder.splice(dragIndex, 1);\n      newCardOrder.splice(hoverIndex, 0, dragged);\n      \n      // Konvertiere zurck zu Tabellen-Spalten-Reihenfolge\n      const newTableOrder: string[] = [];\n      const usedTableColumns = new Set<string>();\n      \n      newCardOrder.forEach(cardMeta => {\n        const tableCol = cardToTableMapping[cardMeta];\n        if (tableCol && !usedTableColumns.has(tableCol)) {\n          usedTableColumns.add(tableCol);\n          newTableOrder.push(tableCol);\n        }\n      });\n      \n      // Fge fehlende Tabellen-Spalten hinzu\n      availableColumns.forEach(col => {\n        if (!newTableOrder.includes(col.id) && col.id !== 'actions') {\n          newTableOrder.push(col.id);\n        }\n      });\n      \n      updateColumnOrder(newTableOrder);\n    } else {\n    const newColumnOrder = [...columnOrder];\n    const draggedItem = newColumnOrder[dragIndex];\n    newColumnOrder.splice(dragIndex, 1);\n    newColumnOrder.splice(hoverIndex, 0, draggedItem);\n    updateColumnOrder(newColumnOrder);\n    }\n  };\n\n  // Speichere die bearbeiteten Zeiterfassungen\n  const handleSaveWorktimeEdits = async (editedEntries: any[]) => {\n    try {\n      // Verwende die API-Funktion fr das Batch-Update\n      await worktimeApi.updateWorktimeEntries(editedEntries);\n      \n      // Aktualisiere die Daten\n      onRefresh();\n      \n      // Zeige Erfolgsmeldung\n      alert(t('teamWorktime.messages.saveSuccess'));\n      \n      // Schliee das Modal\n      handleCloseEditModal();\n    } catch (error: any) {\n      console.error('Fehler beim Aktualisieren der Zeiterfassungen:', error);\n      \n      // Zeige eine benutzerfreundliche Fehlermeldung\n      let errorMessage = t('teamWorktime.messages.unknownError');\n      \n      if (error.response) {\n        // Server antwortet mit Fehlerstatus\n        if (error.response.status === 401) {\n          errorMessage = t('teamWorktime.messages.unauthorized');\n        } else if (error.response.status === 403) {\n          errorMessage = t('teamWorktime.messages.forbidden');\n        } else if (error.response.status === 404) {\n          errorMessage = t('teamWorktime.messages.notFound');\n        } else if (error.response.status === 500) {\n          errorMessage = t('teamWorktime.messages.serverError');\n        } else if (error.response.data && error.response.data.message) {\n          errorMessage = error.response.data.message;\n        }\n      } else if (error.request) {\n        // Keine Antwort vom Server\n        errorMessage = t('teamWorktime.messages.noResponse');\n      } else {\n        // Fehler bei der Anfrage\n        errorMessage = error.message || t('teamWorktime.messages.error');\n      }\n      \n      alert(t('teamWorktime.messages.saveError') + ' ' + errorMessage);\n    }\n  };\n\n  // Standard-Filter erstellen und speichern\n  React.useEffect(() => {\n    const createStandardFilters = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        \n        if (!token) {\n          console.error('Nicht authentifiziert');\n          return;\n        }\n\n        // Prfen, ob die Standard-Filter bereits existieren\n        const existingFiltersResponse = await axiosInstance.get(\n          `${API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(WORKCENTER_TABLE_ID)}`,\n          {\n            headers: {\n              Authorization: `Bearer ${token}`\n            }\n          }\n        );\n\n        const existingFilters = existingFiltersResponse.data || [];\n        // Prfe auf Filter mit verschiedenen mglichen Namen (Deutsch, Spanisch, Englisch)\n        const aktiveFilterExists = existingFilters.some(filter => \n          filter.name === 'Aktive' || filter.name === t('teamWorktime.filters.active') || filter.name === 'Active' || filter.name === 'Activo'\n        );\n        const alleFilterExists = existingFilters.some(filter => \n          filter.name === 'Alle' || filter.name === t('teamWorktime.filters.all') || filter.name === 'All' || filter.name === 'Todos'\n        );\n\n        // Erstelle \"Aktive\"-Filter, wenn er noch nicht existiert\n        if (!aktiveFilterExists) {\n          const aktiveFilter = {\n            tableId: WORKCENTER_TABLE_ID,\n            name: t('teamWorktime.filters.active'),\n            conditions: [\n              { column: 'hasActiveWorktime', operator: 'equals', value: 'true' }\n            ],\n            operators: []\n          };\n\n          await axiosInstance.post(\n            `${API_ENDPOINTS.SAVED_FILTERS.BASE}`,\n            aktiveFilter,\n            {\n              headers: {\n                Authorization: `Bearer ${token}`,\n                'Content-Type': 'application/json'\n              }\n            }\n          );\n          if (process.env.NODE_ENV === 'development') {\n          logger.log('Aktive-Filter fr Workcenter erstellt');\n          }\n        }\n\n        // Erstelle \"Alle\"-Filter, wenn er noch nicht existiert\n        if (!alleFilterExists) {\n          const alleFilter = {\n            tableId: WORKCENTER_TABLE_ID,\n            name: t('teamWorktime.filters.all'),\n            conditions: [],\n            operators: []\n          };\n\n          await axiosInstance.post(\n            `${API_ENDPOINTS.SAVED_FILTERS.BASE}`,\n            alleFilter,\n            {\n              headers: {\n                Authorization: `Bearer ${token}`,\n                'Content-Type': 'application/json'\n              }\n            }\n          );\n          if (process.env.NODE_ENV === 'development') {\n          logger.log('Alle-Filter fr Workcenter erstellt');\n          }\n        }\n      } catch (error) {\n        if (process.env.NODE_ENV === 'development') {\n        console.error('Fehler beim Erstellen der Standard-Filter:', error);\n        }\n      }\n    };\n\n    createStandardFilters();\n  }, [t]);\n\n  //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n  const filterContext = useFilterContext();\n  const { loadFilters } = filterContext;\n\n  // Funktion zum Anwenden von Filterbedingungen\n  const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  };\n  \n  // Funktion zum Zurcksetzen der Filter\n  const resetFilterConditions = () => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n    setActiveFilterName('');\n    setSelectedFilterId(null);\n  };\n  \n  // Filter Change Handler (Controlled Mode)\n  const handleFilterChange = React.useCallback(async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  }, [applyFilterConditions]);\n\n  React.useEffect(() => {\n    const initialize = async () => {\n      // 1. Filter laden (wartet auf State-Update)\n      const filters = await loadFilters(WORKCENTER_TABLE_ID);\n      \n      // 2. Default-Filter anwenden (IMMER vorhanden!)\n      // Suche nach Filter mit aktuellem Namen oder alten Namen (fr Migration)\n      const defaultFilter = filters.find((filter: any) => \n        filter.name === 'Aktive' || \n        filter.name === t('teamWorktime.filters.active') ||\n        filter.name === 'Active' || \n        filter.name === 'Activo'\n      );\n      if (defaultFilter) {\n        await handleFilterChange(\n          defaultFilter.name,\n          defaultFilter.id,\n          defaultFilter.conditions,\n          defaultFilter.operators\n        );\n        return; // Filter wird angewendet\n      }\n      \n      // 3. Fallback: Kein Filter (sollte nie passieren)\n      // ActiveUsersList filtert client-seitig, daher keine Daten-Lade-Funktion ntig\n    };\n    \n    initialize();\n  }, [t, loadFilters, handleFilterChange]);\n\n  // Datum zu vorherigem Tag ndern\n  const handlePreviousDay = () => {\n    const [year, month, day] = selectedDate.split('-').map(Number);\n    const selected = new Date(year, month - 1, day);\n    const previousDate = subDays(selected, 1);\n    onDateChange(format(previousDate, 'yyyy-MM-dd'));\n  };\n\n  // Datum zu nchstem Tag ndern\n  const handleNextDay = () => {\n    const [year, month, day] = selectedDate.split('-').map(Number);\n    const selected = new Date(year, month - 1, day);\n    const nextDate = addDays(selected, 1);\n    onDateChange(format(nextDate, 'yyyy-MM-dd'));\n  };\n\n  // Prfen ob selectedDate kleiner als heute ist (dynamisch bei nderung)\n  const isDateBeforeToday = useMemo(() => {\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    \n    const [year, month, day] = selectedDate.split('-').map(Number);\n    const selected = new Date(year, month - 1, day);\n    selected.setHours(0, 0, 0, 0);\n    \n    return selected.getTime() < today.getTime();\n  }, [selectedDate]);\n\n  return (\n    <div>\n      {/* Header mit Datumsauswahl, Suche und Buttons */}\n      <div className=\"flex items-center justify-between mb-4 px-3 sm:px-4 md:px-6\">\n        {/* Datumsauswahl mit Pfeilen - linksbndig */}\n        <div className=\"flex items-center gap-0.5\">\n          {/* Links-Pfeil (zurck) */}\n          <div className=\"relative group\">\n            <button\n              type=\"button\"\n              onClick={handlePreviousDay}\n              className=\"p-1 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\n              </svg>\n            </button>\n            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n              {t('common.previousDay')}\n            </div>\n          </div>\n\n          {/* Datumsfeld */}\n          <div className=\"relative w-[180px]\">\n            <input\n              type=\"date\"\n              id=\"date-select\"\n              className=\"block w-full pl-3 pr-8 py-2 text-base border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n              value={selectedDate}\n              onChange={(e) => onDateChange(e.target.value)}\n            />\n          </div>\n\n          {/* Rechts-Pfeil (vorwrts) - nur wenn Datum < heute */}\n          {isDateBeforeToday && (\n            <div className=\"relative group\">\n              <button\n                type=\"button\"\n                onClick={handleNextDay}\n                className=\"p-1 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              >\n                <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\n                </svg>\n              </button>\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                {t('common.nextDay')}\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Suche und Buttons - rechtsbndig */}\n        <div className=\"flex items-center\">\n          <input\n            type=\"text\"\n            className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n            placeholder={t('common.searchPlaceholder')}\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n          \n          {/* View-Mode Toggle */}\n          <div className=\"relative group ml-1\">\n            <button\n              type=\"button\"\n              className={`p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ${\n                viewMode === 'cards' ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : ''\n              }`}\n              onClick={() => updateViewMode(viewMode === 'table' ? 'cards' : 'table')}\n            >\n              {viewMode === 'table' ? (\n                <Squares2X2Icon className=\"h-5 w-5\" />\n              ) : (\n                <TableCellsIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n              {viewMode === 'table' ? t('common.viewAsCards') : t('common.viewAsTable')}\n            </div>\n          </div>\n          \n          {/* Filter-Button */}\n          <div className=\"relative group ml-1\">\n            <button\n              type=\"button\"\n              className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n              onClick={() => setIsFilterOpen(!isFilterOpen)}\n            >\n              <FunnelIcon className=\"h-5 w-5\" />\n              {getActiveFilterCount() > 0 && (\n                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center z-10\" style={{ position: 'absolute', top: '-0.25rem', right: '-0.25rem' }}>\n                  {getActiveFilterCount()}\n                </span>\n              )}\n            </button>\n            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n              {t('common.showFilter')}\n            </div>\n          </div>\n          \n          {/* Spalten-Konfiguration */}\n          <div className=\"ml-1\">\n            <TableColumnConfig\n              columns={viewMode === 'cards'\n                ? [\n                    { id: 'name', label: t('teamWorktime.columns.name') },\n                    { id: 'startTime', label: t('teamWorktime.columns.startTime') },\n                    { id: 'duration', label: t('teamWorktime.columns.duration') },\n                    { id: 'pauseTime', label: t('teamWorktime.columns.pauseTime') },\n                    { id: 'branch', label: t('teamWorktime.columns.branch') }\n                  ]\n                : availableColumns}\n              visibleColumns={viewMode === 'cards'\n                ? Array.from(visibleCardMetadata)\n                : columnOrder.filter(id => !hiddenColumns.includes(id))}\n              columnOrder={viewMode === 'cards'\n                ? cardMetadataOrder\n                : columnOrder}\n              onToggleColumnVisibility={handleToggleColumnVisibility}\n              onMoveColumn={handleMoveColumn}\n              mainSortConfig={sortConfig}\n              onMainSortChange={updateSortConfig}\n              showMainSort={true}\n              buttonTitle={viewMode === 'cards' ? t('teamWorktime.sortAndDisplay') : t('teamWorktime.configureColumns')}\n              modalTitle={viewMode === 'cards' ? t('teamWorktime.sortAndDisplay') : t('teamWorktime.configureColumns')}\n            />\n          </div>\n        </div>\n      </div>\n      \n      {/* Filter-Panel */}\n      {isFilterOpen && (\n        <div className={viewMode === 'cards' ? '-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6' : 'px-3 sm:px-4 md:px-6'}>\n          <FilterPane\n          columns={[\n            { id: 'name', label: t('teamWorktime.columns.name') },\n            { id: 'branch', label: t('teamWorktime.columns.branch') },\n            { id: 'hasActiveWorktime', label: t('worktime.active') },\n            { id: 'duration', label: t('teamWorktime.columns.duration') }\n          ]}\n          onApply={applyFilterConditions}\n          onReset={resetFilterConditions}\n          savedConditions={filterConditions}\n          savedOperators={filterLogicalOperators}\n          tableId={WORKCENTER_TABLE_ID}\n        />\n        </div>\n      )}\n      \n      {/* Gespeicherte Filter als Tags anzeigen */}\n      <div className={viewMode === 'cards' ? '-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6' : 'px-3 sm:px-4 md:px-6'}>\n        <SavedFilterTags\n        tableId={WORKCENTER_TABLE_ID}\n        onSelectFilter={(conditions, operators) => applyFilterConditions(conditions, operators)}\n        onReset={resetFilterConditions}\n        activeFilterName={activeFilterName}\n        selectedFilterId={selectedFilterId}\n        onFilterChange={handleFilterChange}\n          defaultFilterName=\"Aktive\" //  FIX: Hardcodiert (konsistent mit DB)\n      />\n      </div>\n      \n      {/* Tabelle oder Cards */}\n      {viewMode === 'table' ? (\n        /* Tabellen-Ansicht */\n        <div className=\"dashboard-workcenter-wrapper bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 overflow-hidden -mx-3 sm:-mx-4 md:-mx-6\">\n        <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n          <thead className=\"bg-gray-50 dark:bg-gray-700\">\n            <tr>\n              {columnOrder\n                .filter(columnId => !hiddenColumns.includes(columnId))\n                .map(columnId => {\n                  const column = availableColumns.find(col => col.id === columnId);\n                  if (!column) return null;\n                  \n                  if (columnId === 'actions') {\n                    return (\n                      <th\n                        key={columnId}\n                        scope=\"col\"\n                        className=\"px-3 sm:px-4 md:px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider\"\n                        draggable\n                        onDragStart={() => handleDragStart(columnId)}\n                        onDragOver={handleDragOver}\n                        onDrop={(e) => handleDrop(e, columnId)}\n                        onDragEnd={handleDragEnd}\n                      >\n                        {column.label}\n                      </th>\n                    );\n                  }\n                  \n                  return renderSortableHeader(columnId, column.label);\n                })\n              }\n            </tr>\n          </thead>\n          <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n            {filteredAndSortedUsers.length === 0 ? (\n              <tr>\n                <td colSpan={columnOrder.filter(id => !hiddenColumns.includes(id)).length} className=\"px-3 sm:px-4 md:px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400\">\n                  Keine Zeiterfassungen gefunden\n                </td>\n              </tr>\n            ) : (\n              filteredAndSortedUsers.slice(0, displayLimit).map((group) => {\n                const totalPauseTime = group.endTime \n                  ? (group.endTime.getTime() - group.startTime.getTime()) - group.totalDuration\n                  : 0;\n\n                const userTodosData = userTodos[group.user.id] || null;\n                const userRequestsData = userRequests[group.user.id] || null;\n                const isExpanded = expandedUsers.has(group.user.id);\n                const hasActivities = (showTodos && userTodosData && userTodosData.total > 0) || \n                                    (showRequests && userRequestsData && userRequestsData.total > 0);\n\n                return (\n                  <React.Fragment key={group.user.id}>\n                    <tr>\n                      {columnOrder\n                        .filter(columnId => !hiddenColumns.includes(columnId))\n                        .map(columnId => {\n                          if (columnId === 'name') {\n                            return (\n                              <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                <div className=\"flex items-center\">\n                                  <div>\n                                    <div className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                                      {group.user.firstName} {group.user.lastName}\n                                    </div>\n                                    <div className=\"text-sm text-gray-500 dark:text-gray-400\">{group.user.username}</div>\n                                  </div>\n                                </div>\n                              </td>\n                            );\n                          }\n                        \n                        if (columnId === 'startTime') {\n                          return (\n                            <td key={columnId} className=\"px-6 py-4 whitespace-nowrap\">\n                              <div className=\"text-sm text-gray-900 dark:text-white\">\n                                {format(group.startTime, 'dd.MM.yyyy')}\n                              </div>\n                              <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                {format(group.startTime, 'HH:mm:ss')}\n                              </div>\n                            </td>\n                          );\n                        }\n                        \n                        if (columnId === 'duration') {\n                          return (\n                            <td key={columnId} className=\"px-6 py-4 whitespace-nowrap\">\n                              <div className=\"text-sm text-gray-900 dark:text-white\">\n                                {formatDistanceToNow(new Date(Date.now() - group.totalDuration), { locale: de, addSuffix: false })}\n                              </div>\n                            </td>\n                          );\n                        }\n\n                        if (columnId === 'pauseTime') {\n                          return (\n                            <td key={columnId} className=\"px-6 py-4 whitespace-nowrap\">\n                              <div className=\"text-sm text-gray-900 dark:text-white\">\n                                {totalPauseTime > 0 \n                                  ? formatDistanceToNow(new Date(Date.now() - totalPauseTime), { locale: de, addSuffix: false })\n                                  : '-'}\n                              </div>\n                            </td>\n                          );\n                        }\n                        \n                        if (columnId === 'branch') {\n                          return (\n                            <td key={columnId} className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                              {group.branch.name}\n                            </td>\n                          );\n                        }\n                        \n                        if (columnId === 'actions') {\n                          return (\n                            <td key={columnId} className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                              <div className=\"flex flex-row space-x-2 justify-end items-center\">\n                                {group.hasActiveWorktime && (\n                                  <div className=\"relative group\">\n                                    <button\n                                      onClick={() => handleOpenStopModal(group)}\n                                      className=\"p-1 bg-red-600 text-white rounded hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600\"\n                                    >\n                                      <StopIcon className=\"h-5 w-5 text-white fill-white\" />\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                      {t('teamWorktime.actions.stopTracking')}\n                                    </div>\n                                  </div>\n                                )}\n                                {hasPermission('team_worktime_control', 'both', 'page') && hasPermission('team_worktime', 'both', 'table') && (\n                                  <div className=\"relative group\">\n                                    <button\n                                      onClick={() => handleOpenEditModal(group)}\n                                      className=\"text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 edit-button\"\n                                    >\n                                      <PencilIcon className=\"h-5 w-5\" />\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                      {t('teamWorktime.actions.editWorktimes')}\n                                    </div>\n                                  </div>\n                                )}\n                              </div>\n                            </td>\n                          );\n                        }\n                        \n                        return null;\n                      })}\n                    </tr>\n                    {/* To-Dos und Requests fr User */}\n                    {(showTodos || showRequests) && hasActivities && (\n                      <tr className=\"bg-gray-50 dark:bg-gray-800/50\">\n                        <td colSpan={columnOrder.filter(id => !hiddenColumns.includes(id)).length} className=\"px-3 sm:px-4 md:px-6 py-3\">\n                          <div className=\"ml-4 border-l-2 border-blue-200 dark:border-blue-700 pl-4\">\n                            {/* To-Dos */}\n                            {showTodos && userTodosData && userTodosData.total > 0 && (\n                              <div className=\"mb-3\">\n                                <div className=\"flex items-center justify-between mb-2\">\n                                  <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                    To-Dos ({selectedDate}): {userTodosData.completed} erledigt | {userTodosData.open} offen | {userTodosData.inProgress} in Bearbeitung\n                                  </h4>\n                                  <button\n                                    onClick={() => toggleExpand(group.user.id)}\n                                    className=\"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300\"\n                                  >\n                                    {isExpanded ? 'Weniger anzeigen ' : 'Details anzeigen '}\n                                  </button>\n                                </div>\n                                {isExpanded && userTodosData.details && userTodosData.details.length > 0 && (\n                                  <div className=\"mt-2 space-y-1\">\n                                    {userTodosData.details.map((todo: any) => (\n                                      <div key={todo.id} className=\"text-xs text-gray-600 dark:text-gray-400 flex items-center gap-2\">\n                                        <span className={todo.status === 'done' ? 'text-green-600 dark:text-green-400' : 'text-gray-400'}>\n                                          {todo.status === 'done' ? '' : ''}\n                                        </span>\n                                        <span className=\"font-medium\">{todo.title}</span>\n                                        <span className=\"text-gray-400\">({todo.status})</span>\n                                        <span className=\"text-gray-400\">\n                                          - {format(new Date(todo.updatedAt), 'HH:mm')}\n                                        </span>\n                                      </div>\n                                    ))}\n                                  </div>\n                                )}\n                              </div>\n                            )}\n                            {/* Requests */}\n                            {showRequests && userRequestsData && userRequestsData.total > 0 && (\n                              <div>\n                                <div className=\"flex items-center justify-between mb-2\">\n                                  <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                    Requests ({selectedDate}): {userRequestsData.approved} genehmigt | {userRequestsData.pending} offen\n                                  </h4>\n                                  {!showTodos && (\n                                    <button\n                                      onClick={() => toggleExpand(group.user.id)}\n                                      className=\"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300\"\n                                    >\n                                      {isExpanded ? 'Weniger anzeigen ' : 'Details anzeigen '}\n                                    </button>\n                                  )}\n                                </div>\n                                {isExpanded && userRequestsData.details && userRequestsData.details.length > 0 && (\n                                  <div className=\"mt-2 space-y-1\">\n                                    {userRequestsData.details.map((request: any) => (\n                                      <div key={request.id} className=\"text-xs text-gray-600 dark:text-gray-400 flex items-center gap-2\">\n                                        <span className={request.status === 'approved' ? 'text-green-600 dark:text-green-400' : 'text-gray-400'}>\n                                          {request.status === 'approved' ? '' : ''}\n                                        </span>\n                                        <span className=\"font-medium\">{request.title}</span>\n                                        <span className=\"text-gray-400\">({request.status})</span>\n                                        <span className=\"text-gray-400\">\n                                          - {format(new Date(request.createdAt), 'HH:mm')}\n                                        </span>\n                                      </div>\n                                    ))}\n                                  </div>\n                                )}\n                              </div>\n                            )}\n                          </div>\n                        </td>\n                      </tr>\n                    )}\n                  </React.Fragment>\n                );\n              })\n            )}\n          </tbody>\n        </table>\n      </div>\n      ) : (\n        /* Card-Ansicht - ohne Box-Schattierung, Cards auf voller Breite */\n        <div className=\"dashboard-workcenter-wrapper bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 -mx-3 sm:-mx-4 md:-mx-6\">\n          {filteredAndSortedUsers.length === 0 ? (\n            <div className=\"text-center py-8 text-sm text-gray-500 dark:text-gray-400\">\n              Keine Zeiterfassungen gefunden\n            </div>\n          ) : (\n            <CardGrid gap=\"md\">\n              {filteredAndSortedUsers.slice(0, displayLimit).map((group) => {\n                const totalPauseTime = group.endTime \n                  ? (group.endTime.getTime() - group.startTime.getTime()) - group.totalDuration\n                  : 0;\n\n                const userTodosData = userTodos[group.user.id] || null;\n                const userRequestsData = userRequests[group.user.id] || null;\n                const isExpanded = expandedUsers.has(group.user.id);\n                const hasActivities = (showTodos && userTodosData && userTodosData.total > 0) || \n                                    (showRequests && userRequestsData && userRequestsData.total > 0);\n\n                // Metadaten fr Card aufbauen - Hauptinfos strukturiert\n                const metadata: MetadataItem[] = [];\n                const firstRowMetadata: MetadataItem[] = [];\n                const secondRowMetadata: MetadataItem[] = [];\n\n                // Erste Zeile: Name, Startzeit (nebeneinander)\n                if (visibleCardMetadata.has('name')) {\n                  firstRowMetadata.push({\n                    label: 'Name',\n                    value: `${group.user.firstName} ${group.user.lastName} (${group.user.username})`,\n                    icon: <UserIcon className=\"h-4 w-4\" />\n                  });\n                }\n\n                if (visibleCardMetadata.has('startTime')) {\n                  firstRowMetadata.push({\n                    label: 'Startzeit',\n                    value: `${format(group.startTime, 'dd.MM.yyyy')} ${format(group.startTime, 'HH:mm:ss')}`,\n                    icon: <ClockIcon className=\"h-4 w-4\" />\n                  });\n                }\n\n                // Zweite Zeile: Arbeitszeit, Pausen (vertikal untereinander, linksbndig)\n                if (visibleCardMetadata.has('duration')) {\n                  secondRowMetadata.push({\n                    label: 'Arbeitszeit',\n                    value: formatDistanceToNow(new Date(Date.now() - group.totalDuration), { locale: de, addSuffix: false }),\n                    icon: <ClockIcon className=\"h-4 w-4\" />\n                  });\n                }\n\n                if (visibleCardMetadata.has('pauseTime')) {\n                  secondRowMetadata.push({\n                    label: 'Pausen',\n                    value: totalPauseTime > 0 \n                      ? formatDistanceToNow(new Date(Date.now() - totalPauseTime), { locale: de, addSuffix: false })\n                      : '-',\n                    icon: <ClockIcon className=\"h-4 w-4\" />\n                  });\n                }\n\n                // Niederlassung (falls angezeigt)\n                if (visibleCardMetadata.has('branch')) {\n                  metadata.push({\n                    label: 'Niederlassung',\n                    value: group.branch.name,\n                    icon: <BuildingOfficeIcon className=\"h-4 w-4\" />\n                  });\n                }\n\n                // Action-Buttons\n                const actions = (\n                  <div className=\"flex flex-row space-x-2 justify-end items-center\">\n                    {group.hasActiveWorktime && (\n                      <div className=\"relative group\">\n                        <button\n                          onClick={() => handleOpenStopModal(group)}\n                          className=\"p-1 bg-red-600 text-white rounded hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600\"\n                        >\n                          <StopIcon className=\"h-5 w-5 text-white fill-white\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('teamWorktime.actions.stopTracking')}\n                        </div>\n                      </div>\n                    )}\n                    {hasPermission('team_worktime_control', 'both', 'page') && hasPermission('team_worktime', 'both', 'table') && (\n                      <div className=\"relative group\">\n                        <button\n                          onClick={() => handleOpenEditModal(group)}\n                          className=\"text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300\"\n                        >\n                          <PencilIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                          {t('teamWorktime.actions.editWorktimes')}\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                );\n\n                // Expandable Content fr To-Dos und Requests\n                const expandableContent = hasActivities ? (\n                  <div>\n                    {/* To-Dos */}\n                    {showTodos && userTodosData && userTodosData.total > 0 && (\n                      <div className=\"mb-3\">\n                        <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                          To-Dos ({selectedDate}): {userTodosData.completed} erledigt | {userTodosData.open} offen | {userTodosData.inProgress} in Bearbeitung\n                        </h4>\n                        {userTodosData.details && userTodosData.details.length > 0 && (\n                          <div className=\"mt-2 space-y-1\">\n                            {userTodosData.details.map((todo: any) => (\n                              <div key={todo.id} className=\"text-xs text-gray-600 dark:text-gray-400 flex items-center gap-2\">\n                                <span className={todo.status === 'done' ? 'text-green-600 dark:text-green-400' : 'text-gray-400'}>\n                                  {todo.status === 'done' ? '' : ''}\n                                </span>\n                                <span className=\"font-medium\">{todo.title}</span>\n                                <span className=\"text-gray-400\">({todo.status})</span>\n                                <span className=\"text-gray-400\">\n                                  - {format(new Date(todo.updatedAt), 'HH:mm')}\n                                </span>\n                              </div>\n                            ))}\n                          </div>\n                        )}\n                      </div>\n                    )}\n                    {/* Requests */}\n                    {showRequests && userRequestsData && userRequestsData.total > 0 && (\n                      <div>\n                        <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                          Requests ({selectedDate}): {userRequestsData.approved} genehmigt | {userRequestsData.pending} offen\n                        </h4>\n                        {userRequestsData.details && userRequestsData.details.length > 0 && (\n                          <div className=\"mt-2 space-y-1\">\n                            {userRequestsData.details.map((request: any) => (\n                              <div key={request.id} className=\"text-xs text-gray-600 dark:text-gray-400 flex items-center gap-2\">\n                                <span className={request.status === 'approved' ? 'text-green-600 dark:text-green-400' : 'text-gray-400'}>\n                                  {request.status === 'approved' ? '' : ''}\n                                </span>\n                                <span className=\"font-medium\">{request.title}</span>\n                                <span className=\"text-gray-400\">({request.status})</span>\n                                <span className=\"text-gray-400\">\n                                  - {format(new Date(request.createdAt), 'HH:mm')}\n                                </span>\n                              </div>\n                            ))}\n                          </div>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                ) : null;\n\n                return (\n                  <DataCard\n                    key={group.user.id}\n                    title={`${group.user.firstName} ${group.user.lastName}`}\n                    metadata={metadata}\n                    actions={actions}\n                    expandable={expandableContent ? {\n                      isExpanded: isExpanded,\n                      content: expandableContent,\n                      onToggle: () => toggleExpand(group.user.id)\n                    } : undefined}\n                  >\n                    {/* Hauptinfos: Erste Zeile (Name, Startzeit) nebeneinander */}\n                    {firstRowMetadata.length > 0 && (\n                      <div className=\"flex flex-wrap items-center gap-3 sm:gap-4 mb-3 sm:mb-4\">\n                        {firstRowMetadata.map((item, index) => (\n                          <div\n                            key={index}\n                            className=\"flex items-center gap-1 sm:gap-1.5 text-xs sm:text-sm md:text-base lg:text-lg xl:text-xl 2xl:text-2xl text-gray-600 dark:text-gray-400\"\n                          >\n                            {item.icon && <span className=\"flex-shrink-0\">{item.icon}</span>}\n                            <span className=\"font-medium mr-1 whitespace-nowrap\">{item.label}:</span>\n                            <span className={item.className || 'text-gray-900 dark:text-white'}>\n                              {typeof item.value === 'string' ? item.value : item.value}\n                            </span>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                    {/* Zweite Zeile: Arbeitszeit, Pausen (vertikal untereinander, linksbndig) */}\n                    {secondRowMetadata.length > 0 && (\n                      <div className=\"flex flex-col gap-2 mb-3 sm:mb-4\">\n                        {secondRowMetadata.map((item, index) => (\n                          <div\n                            key={index}\n                            className=\"flex items-center gap-1 sm:gap-1.5 text-xs sm:text-sm md:text-base lg:text-lg xl:text-xl 2xl:text-2xl text-gray-600 dark:text-gray-400\"\n                          >\n                            {item.icon && <span className=\"flex-shrink-0\">{item.icon}</span>}\n                            <span className=\"font-medium mr-1 whitespace-nowrap\">{item.label}:</span>\n                            <span className={item.className || 'text-gray-900 dark:text-white'}>\n                              {typeof item.value === 'string' ? item.value : item.value}\n                            </span>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                  </DataCard>\n                );\n              })}\n            </CardGrid>\n          )}\n        </div>\n      )}\n\n      {/* \"Mehr anzeigen\" Button */}\n      {filteredAndSortedUsers.length > displayLimit && (\n        <div className=\"mt-4 flex justify-center\">\n          <button\n            className=\"p-2 text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n            onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n            title={`Mehr anzeigen (${filteredAndSortedUsers.length - displayLimit} verbleibend)`}\n          >\n            <ChevronDownIcon className=\"h-5 w-5\" />\n          </button>\n        </div>\n      )}\n\n      {/* Modal zum Stoppen der Zeiterfassung */}\n      {showStopModal && selectedUser && (\n        <StopWorktimeModal\n          isOpen={showStopModal}\n          onClose={handleCloseStopModal}\n          onConfirm={handleStopWorktime}\n          userName={`${selectedUser.user.firstName} ${selectedUser.user.lastName}`}\n        />\n      )}\n\n      {/* Modal zum Bearbeiten der Zeiterfassungen */}\n      {selectedUser && (\n        <EditWorktimeModal\n          isOpen={showEditModal}\n          onClose={handleCloseEditModal}\n          onSave={handleSaveWorktimeEdits}\n          userName={`${selectedUser.user.firstName} ${selectedUser.user.lastName}`}\n          entries={selectedUser.entries}\n          selectedDate={selectedDate}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default ActiveUsersList; ","import axiosInstance from '../config/axios.ts';\n\n/**\n * API-Funktionen fr die Zeiterfassung\n */\n\ninterface WorktimeEntry {\n  id: number;\n  startTime: string;\n  endTime: string | null;\n  userId: number;\n  branch: {\n    id: number;\n    name: string;\n  };\n  isDeleted?: boolean;\n}\n\n/**\n * Startet eine neue Zeiterfassung\n * @param userId Benutzer-ID\n * @param startTime Startzeit (ISO-String)\n * @param comment Optionaler Kommentar\n * @returns Die erstellte Zeiterfassung\n */\nexport const startWorktime = async (\n  userId: number, \n  startTime: string, \n  comment?: string\n) => {\n  try {\n    const response = await axiosInstance.post('/worktime', {\n      userId,\n      startTime,\n      comment\n    });\n    return response.data;\n  } catch (error) {\n    console.error('Fehler beim Starten der Zeiterfassung:', error);\n    throw error;\n  }\n};\n\n/**\n * Stoppt eine laufende Zeiterfassung\n * @param userId Benutzer-ID\n * @param endTime Endzeit (ISO-String)\n * @returns Die aktualisierte Zeiterfassung\n */\nexport const stopWorktime = async (\n  userId: number,\n  endTime: string\n) => {\n  try {\n    const response = await axiosInstance.put(`/worktime/stop/${userId}`, {\n      endTime\n    });\n    return response.data;\n  } catch (error) {\n    console.error('Fehler beim Stoppen der Zeiterfassung:', error);\n    throw error;\n  }\n};\n\n/**\n * Holt alle Zeiterfassungen eines Benutzers fr einen bestimmten Tag\n * @param userId Benutzer-ID\n * @param date Datum im Format YYYY-MM-DD\n * @returns Liste der Zeiterfassungen\n */\nexport const getWorktimesByUserAndDate = async (\n  userId: number,\n  date: string\n) => {\n  try {\n    const response = await axiosInstance.get(`/worktime/user/${userId}/date/${date}`);\n    return response.data;\n  } catch (error) {\n    console.error('Fehler beim Abrufen der Zeiterfassungen:', error);\n    throw error;\n  }\n};\n\n/**\n * Aktualisiert eine einzelne Zeiterfassung\n * @param entryId ID der Zeiterfassung\n * @param data Update-Daten (startTime, endTime)\n * @returns Die aktualisierte Zeiterfassung\n */\nexport const updateWorktimeEntry = async (\n  entryId: number,\n  data: { startTime?: string; endTime?: string | null }\n) => {\n  try {\n    // Sende die Daten unverndert, ohne weitere Zeitzonenkonvertierung\n    const response = await axiosInstance.put(`/worktime/${entryId}`, data);\n    return response.data;\n  } catch (error) {\n    console.error('Fehler beim Aktualisieren der Zeiterfassung:', error);\n    throw error;\n  }\n};\n\n/**\n * Lscht eine Zeiterfassung\n * @param entryId ID der Zeiterfassung\n * @returns Status der Lschoperation\n */\nexport const deleteWorktimeEntry = async (entryId: number) => {\n  try {\n    const response = await axiosInstance.delete(`/worktime/${entryId}`);\n    return response.data;\n  } catch (error) {\n    console.error('Fehler beim Lschen der Zeiterfassung:', error);\n    throw error;\n  }\n};\n\n/**\n * Fhrt mehrere Aktualisierungen von Zeiterfassungen in einem Batch durch\n * @param entries Liste der zu aktualisierenden Zeiterfassungen\n * @returns Status der Batch-Operation\n */\nexport const updateWorktimeEntries = async (entries: WorktimeEntry[]) => {\n  try {\n    // Filtern, um nur Eintrge zu behalten, die aktualisiert oder gelscht werden sollen\n    const entriesToUpdate = entries.filter(entry => !entry.isDeleted);\n    const entriesToDelete = entries.filter(entry => entry.isDeleted).map(entry => entry.id);\n    \n    // Sequentiell jeden Eintrag aktualisieren\n    // Dabei nur die wirklich notwendigen Felder extrahieren\n    const updatePromises = entriesToUpdate.map(entry => \n      axiosInstance.put(`/worktime/${entry.id}`, {\n        startTime: entry.startTime,  // ISO-String ohne Zeitzone\n        endTime: entry.endTime       // ISO-String ohne Zeitzone oder null\n      })\n    );\n    \n    // Sequentiell jeden zu lschenden Eintrag lschen\n    const deletePromises = entriesToDelete.map(id => \n      axiosInstance.delete(`/worktime/${id}`)\n    );\n    \n    // Alle Promises ausfhren\n    await Promise.all([...updatePromises, ...deletePromises]);\n    \n    return { success: true };\n  } catch (error) {\n    console.error('Fehler beim Aktualisieren der Zeiterfassungen:', error);\n    throw error;\n  }\n}; ","import React, { useState, useEffect, useRef, useMemo, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { format } from 'date-fns';\nimport { \n  FunnelIcon,\n  Squares2X2Icon,\n  TableCellsIcon,\n  ClipboardDocumentListIcon,\n  UserIcon,\n  BuildingOfficeIcon,\n  ClockIcon,\n  ArrowPathIcon,\n  ChevronDownIcon,\n  ChevronUpIcon,\n  ChartBarIcon,\n  TrashIcon\n} from '@heroicons/react/24/outline';\nimport FilterPane from '../FilterPane.tsx';\nimport SavedFilterTags from '../SavedFilterTags.tsx';\nimport { useFilterContext } from '../../contexts/FilterContext.tsx';\nimport { FilterCondition } from '../FilterRow.tsx';\nimport DataCard, { MetadataItem } from '../shared/DataCard.tsx';\nimport CardGrid from '../shared/CardGrid.tsx';\nimport { useTableSettings } from '../../hooks/useTableSettings.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\n\ninterface TodoAnalyticsTabProps {\n  selectedDate?: string; // Optional fr Rckwrtskompatibilitt\n}\n\ninterface StatusHistoryItem {\n  id: number;\n  oldStatus: string | null;\n  newStatus: string;\n  changedAt: string;\n  user: {\n    id: number;\n    firstName: string;\n    lastName: string;\n    username: string;\n  };\n}\n\ninterface Todo {\n  id: number;\n  title: string;\n  status: string;\n  responsible?: {\n    id: number;\n    firstName: string;\n    lastName: string;\n    username: string;\n  };\n  qualityControl?: {\n    id: number;\n    firstName: string;\n    lastName: string;\n    username: string;\n  };\n  branch: {\n    id: number;\n    name: string;\n  };\n  updatedAt: string;\n  createdAt: string;\n  createdBy?: {\n    id: number;\n    firstName: string;\n    lastName: string;\n    username: string;\n  };\n  deletedAt?: string | null;\n  deletedBy?: {\n    id: number;\n    firstName: string;\n    lastName: string;\n    username: string;\n  } | null;\n  statusHistory?: StatusHistoryItem[];\n}\n\n// TableID fr gespeicherte Filter\nconst TODO_ANALYTICS_TABLE_ID = 'todo-analytics-table';\n\n// Standardreihenfolge der Spalten\nconst defaultColumnOrder = ['time', 'title', 'status', 'responsible', 'qualityControl', 'branch', 'createdBy', 'deletedAt'];\n\nconst TodoAnalyticsTab: React.FC<TodoAnalyticsTabProps> = ({ selectedDate }) => {\n  const { t } = useTranslation();\n  const { user } = useAuth();\n  const [todos, setTodos] = useState<Todo[]>([]);\n  const [loading, setLoading] = useState<boolean>(false);\n  const [error, setError] = useState<string | null>(null);\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  \n  // Filter State Management (Controlled Mode)\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  const [activeFilterName, setActiveFilterName] = useState<string>('');\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n  const [isFilterPanelOpen, setIsFilterPanelOpen] = useState(false);\n  \n  // Table Settings\n  const {\n    settings,\n    isLoading: isLoadingSettings,\n    updateColumnOrder,\n    updateHiddenColumns,\n    toggleColumnVisibility,\n    isColumnVisible,\n    updateViewMode\n  } = useTableSettings(TODO_ANALYTICS_TABLE_ID, {\n    defaultColumnOrder,\n    defaultViewMode: 'table'\n  });\n\n  // Abgeleitete Werte aus Settings\n  const columnOrder = settings?.columnOrder || defaultColumnOrder;\n  const hiddenColumns = settings?.hiddenColumns || [];\n  const visibleColumnIds = columnOrder.filter(id => !hiddenColumns.includes(id));\n  const savedViewMode = settings?.viewMode || 'table';\n  \n  // View Mode - initialisiere aus Settings, falls vorhanden\n  const [viewMode, setViewMode] = useState<'table' | 'cards'>(savedViewMode);\n  \n  // View Mode synchronisieren mit Settings\n  useEffect(() => {\n    if (settings?.viewMode && settings.viewMode !== viewMode) {\n      setViewMode(settings.viewMode);\n    }\n  }, [settings?.viewMode]);\n\n  // Expandierte To-Dos fr Status-Historie\n  const [expandedTodos, setExpandedTodos] = useState<Set<number>>(new Set());\n  \n  const toggleTodoExpand = (todoId: number) => {\n    setExpandedTodos(prev => {\n      const next = new Set(prev);\n      if (next.has(todoId)) {\n        next.delete(todoId);\n      } else {\n        next.add(todoId);\n      }\n      return next;\n    });\n  };\n\n  // Hufigkeitsanalyse State\n  const [frequencyData, setFrequencyData] = useState<any>(null);\n  const [loadingFrequency, setLoadingFrequency] = useState<boolean>(false);\n  const [showFrequencyAnalysis, setShowFrequencyAnalysis] = useState<boolean>(false);\n\n  // Schicht-Analyse State\n  const [shiftData, setShiftData] = useState<any>(null);\n  const [loadingShifts, setLoadingShifts] = useState<boolean>(false);\n  const [showShiftAnalysis, setShowShiftAnalysis] = useState<boolean>(false);\n  const [expandedShifts, setExpandedShifts] = useState<Set<number>>(new Set());\n  \n  const toggleShiftExpand = (workTimeId: number) => {\n    setExpandedShifts(prev => {\n      const next = new Set(prev);\n      if (next.has(workTimeId)) {\n        next.delete(workTimeId);\n      } else {\n        next.add(workTimeId);\n      }\n      return next;\n    });\n  };\n\n  // Verfgbare Spalten fr Filter und Table Settings\n  const availableColumns = useMemo(() => [\n    { id: 'time', label: t('analytics.todo.columns.time') },\n    { id: 'title', label: t('analytics.todo.columns.title') },\n    { id: 'status', label: t('analytics.todo.columns.status') },\n    { id: 'responsible', label: t('analytics.todo.columns.responsible') },\n    { id: 'qualityControl', label: t('analytics.todo.columns.qualityControl') },\n    { id: 'branch', label: t('analytics.todo.columns.branch') },\n    { id: 'createdBy', label: t('analytics.todo.columns.createdBy', { defaultValue: 'Erstellt von' }) },\n    { id: 'deletedAt', label: t('analytics.todo.columns.deletedAt', { defaultValue: 'Gelscht am' }) }\n  ], [t]);\n\n  //  PERFORMANCE: Stabilisiere Array-Dependencies (verhindert unntige Re-Runs durch neue Array-Referenzen)\n  const filterConditionsKey = useMemo(() => JSON.stringify(filterConditions), [filterConditions]);\n  const filterOperatorsKey = useMemo(() => JSON.stringify(filterLogicalOperators), [filterLogicalOperators]);\n\n  // Lade To-Dos\n  useEffect(() => {\n    //  PHASE 8: Memory Leak Prevention - AbortController\n    const abortController = new AbortController();\n    \n    const fetchTodos = async () => {\n      try {\n        setLoading(true);\n        setError(null);\n        \n        const params: any = {};\n        \n        // Untersttze selectedDate fr Rckwrtskompatibilitt\n        if (selectedDate) {\n          params.date = selectedDate;\n        } else {\n          // Standard: Diese Woche, wenn kein selectedDate vorhanden\n          params.period = 'week';\n        }\n        \n        // Filter-Bedingungen als JSON-String senden\n        if (selectedFilterId) {\n          params.filterId = selectedFilterId;\n        } else if (filterConditions.length > 0) {\n          params.filterConditions = JSON.stringify({\n            conditions: filterConditions,\n            operators: filterLogicalOperators\n          });\n        }\n        \n        const response = await axiosInstance.get(API_ENDPOINTS.TEAM_WORKTIME.ANALYTICS.TODOS_CHRONOLOGICAL, {\n          params,\n          signal: abortController.signal\n        });\n        \n        setTodos(response.data || []);\n      } catch (error: any) {\n        // Axios verwendet \"CanceledError\"/code \"ERR_CANCELED\" bei Abbruch ber AbortController\n        if (error?.name === 'AbortError' || error?.name === 'CanceledError' || error?.code === 'ERR_CANCELED') {\n          return;\n        }\n        console.error('Error loading todos:', error);\n        setError(t('analytics.todo.loadError'));\n      } finally {\n        if (!abortController.signal.aborted) {\n          setLoading(false);\n        }\n      }\n    };\n\n    fetchTodos();\n    \n    //  PHASE 8: Memory Leak Prevention - Cleanup\n    return () => {\n      abortController.abort();\n    };\n  }, [selectedDate, filterConditionsKey, filterOperatorsKey, selectedFilterId, t]);\n\n  // Lade Hufigkeitsanalyse\n  useEffect(() => {\n    //  PHASE 8: Memory Leak Prevention - AbortController\n    const abortController = new AbortController();\n    \n    const fetchFrequencyAnalysis = async () => {\n      if (!selectedDate || !showFrequencyAnalysis) return;\n      \n      try {\n        setLoadingFrequency(true);\n        \n        const response = await axiosInstance.get(API_ENDPOINTS.TEAM_WORKTIME.ANALYTICS.TODOS_FREQUENCY, {\n          params: {\n            date: selectedDate\n          },\n          signal: abortController.signal\n        });\n        \n        setFrequencyData(response.data);\n      } catch (error: any) {\n        if (error.name !== 'AbortError') {\n          console.error('Error loading frequency analysis:', error);\n        // Kein setError hier, da nicht kritisch\n        }\n      } finally {\n        if (!abortController.signal.aborted) {\n        setLoadingFrequency(false);\n        }\n      }\n    };\n\n    fetchFrequencyAnalysis();\n    \n    //  PHASE 8: Memory Leak Prevention - Cleanup\n    return () => {\n      abortController.abort();\n    };\n  }, [selectedDate, showFrequencyAnalysis]);\n\n  // Lade Schicht-Analyse\n  useEffect(() => {\n    //  PHASE 8: Memory Leak Prevention - AbortController\n    const abortController = new AbortController();\n    \n    const fetchShiftAnalysis = async () => {\n      if (!selectedDate || !showShiftAnalysis) return;\n      \n      try {\n        setLoadingShifts(true);\n        \n        const response = await axiosInstance.get(API_ENDPOINTS.TEAM_WORKTIME.ANALYTICS.TODOS_SHIFTS, {\n          params: {\n            date: selectedDate\n          },\n          signal: abortController.signal\n        });\n        \n        setShiftData(response.data);\n      } catch (error: any) {\n        if (error.name !== 'AbortError') {\n          console.error('Error loading shift analysis:', error);\n        // Kein setError hier, da nicht kritisch\n        }\n      } finally {\n        if (!abortController.signal.aborted) {\n        setLoadingShifts(false);\n        }\n      }\n    };\n\n    fetchShiftAnalysis();\n    \n    //  PHASE 8: Memory Leak Prevention - Cleanup\n    return () => {\n      abortController.abort();\n    };\n  }, [selectedDate, showShiftAnalysis]);\n\n  // Filter-Handler\n  const applyFilterConditions = useCallback((conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n    setIsFilterPanelOpen(false);\n  }, []);\n\n  const resetFilterConditions = useCallback(() => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n    setActiveFilterName('');\n    setSelectedFilterId(null);\n  }, []);\n\n  const handleFilterChange = useCallback(async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  }, [applyFilterConditions]);\n  \n  //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n  const filterContext = useFilterContext();\n  const { loadFilters } = filterContext;\n  \n  useEffect(() => {\n    const initialize = async () => {\n      if (!user) return; // Warten auf User\n      \n      // 1. Filter laden (wartet auf State-Update)\n      const filters = await loadFilters(TODO_ANALYTICS_TABLE_ID);\n      \n      // 2. Default-Filter anwenden: Filter fr aktuellen Benutzer\n      // Filter-Name = `${user.firstName} ${user.lastName}` oder `user.username`\n      const userFilterName = `${user.firstName} ${user.lastName}`.trim() || user.username;\n      const defaultFilter = filters.find(f => f.name === userFilterName) || filters.find(f => f.name === 'Alle');\n      \n      if (defaultFilter) {\n        await handleFilterChange(\n          defaultFilter.name,\n          defaultFilter.id,\n          defaultFilter.conditions,\n          defaultFilter.operators\n        );\n        return; // Filter wird angewendet (fetchTodos wird durch filterConditions-nderung ausgelst)\n      }\n      \n      // 3. Fallback: Kein Filter (sollte nie passieren)\n      // fetchTodos wird automatisch durch filterConditions-nderung aufgerufen\n    };\n    \n    if (user) {\n    initialize();\n    }\n  }, [loadFilters, handleFilterChange, user]);\n\n  const getActiveFilterCount = useCallback(() => {\n    return filterConditions.filter(c => c.column !== '' && c.value !== null).length;\n  }, [filterConditions]);\n\n  // Status-Funktionen\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'done':\n        return 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400';\n      case 'in_progress':\n        return 'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400';\n      case 'quality_control':\n        return 'bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400';\n      case 'open':\n        return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400';\n      case 'improval':\n        return 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400';\n      default:\n        return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n    }\n  };\n\n  const getStatusLabel = (status: string) => {\n    const labels: Record<string, string> = {\n      done: 'Erledigt',\n      in_progress: 'In Bearbeitung',\n      quality_control: 'Qualittskontrolle',\n      open: 'Offen',\n      improval: 'Nachbesserung'\n    };\n    return labels[status] || status;\n  };\n\n  // Gefilterte und durchsuchte To-Dos\n  const filteredTodos = useMemo(() => {\n    let filtered = [...todos];\n\n    // Textsuche\n    if (searchTerm) {\n      const searchLower = searchTerm.toLowerCase();\n      filtered = filtered.filter(todo =>\n        todo.title.toLowerCase().includes(searchLower) ||\n        todo.branch.name.toLowerCase().includes(searchLower) ||\n        (todo.responsible && `${todo.responsible.firstName} ${todo.responsible.lastName}`.toLowerCase().includes(searchLower))\n      );\n    }\n\n    // Filter-Bedingungen (Frontend-Filterung fr Spalten, die Backend nicht untersttzt)\n    filterConditions.forEach((condition, index) => {\n      if (condition.column === '' || condition.value === null) return;\n      \n      const operator = condition.operator || 'equals';\n      const value = condition.value;\n\n      filtered = filtered.filter(todo => {\n        switch (condition.column) {\n          case 'status':\n            if (operator === 'equals') {\n              return todo.status === value;\n            }\n            return true;\n          case 'title':\n            if (operator === 'contains') {\n              return todo.title.toLowerCase().includes(String(value).toLowerCase());\n            }\n            return true;\n          default:\n            return true;\n        }\n      });\n    });\n\n    return filtered;\n  }, [todos, searchTerm, filterConditions]);\n\n  // Statistiken\n  const stats = useMemo(() => ({\n    total: filteredTodos.length,\n    done: filteredTodos.filter(t => t.status === 'done').length,\n    inProgress: filteredTodos.filter(t => t.status === 'in_progress').length,\n    open: filteredTodos.filter(t => t.status === 'open').length,\n    qualityControl: filteredTodos.filter(t => t.status === 'quality_control').length,\n    improval: filteredTodos.filter(t => t.status === 'improval').length\n  }), [filteredTodos]);\n\n  if (error) {\n    return (\n      <div className=\"bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 px-4 py-3 rounded\">\n        {error}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 todo-analytics-wrapper\">\n      {/* Titelzeile */}\n      <div className=\"flex items-center justify-between mb-4 px-3 sm:px-4 md:px-6\">\n        {/* Linke Seite: Titel mit Icon */}\n        <div className=\"flex items-center\">\n          <ClipboardDocumentListIcon className=\"h-6 w-6 mr-2 dark:text-white\" />\n          <h2 className=\"text-xl font-semibold dark:text-white\">{t('analytics.todo.title')}</h2>\n        </div>\n        \n        {/* Rechte Seite: Suchfeld, View-Mode Toggle, Filter-Button */}\n        <div className=\"flex items-center gap-1.5\">\n          <input\n            type=\"text\"\n            placeholder={t('common.searchPlaceholder')}\n            className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n          \n          {/* View-Mode Toggle */}\n          <div className=\"relative group\">\n            <button\n              className={`p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ${\n                viewMode === 'cards' ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : ''\n              }`}\n              onClick={() => {\n                const newMode = viewMode === 'table' ? 'cards' : 'table';\n                setViewMode(newMode);\n                if (updateViewMode) {\n                  updateViewMode(newMode);\n                }\n              }}\n            >\n              {viewMode === 'table' ? (\n                <Squares2X2Icon className=\"h-5 w-5\" />\n              ) : (\n                <TableCellsIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n              {viewMode === 'table' ? t('common.viewAsCards') : t('common.viewAsTable')}\n            </div>\n          </div>\n          \n          {/* Filter-Button */}\n          <div className=\"relative group ml-1\">\n            <button\n              className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n              onClick={() => setIsFilterPanelOpen(!isFilterPanelOpen)}\n              style={{ position: 'relative' }}\n            >\n              <FunnelIcon className=\"h-5 w-5\" />\n              {getActiveFilterCount() > 0 && (\n                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center z-10\">\n                  {getActiveFilterCount()}\n                </span>\n              )}\n            </button>\n            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n              {t('common.filter')}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Filter-Pane */}\n      {isFilterPanelOpen && (\n        <div className={viewMode === 'cards' ? '-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6' : 'px-3 sm:px-4 md:px-6'}>\n          <FilterPane\n          columns={availableColumns}\n          onApply={applyFilterConditions}\n          onReset={resetFilterConditions}\n          savedConditions={filterConditions}\n          savedOperators={filterLogicalOperators}\n          tableId={TODO_ANALYTICS_TABLE_ID}\n        />\n        </div>\n      )}\n      \n      {/* Gespeicherte Filter als Tags */}\n      <div className={viewMode === 'cards' ? '-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6' : 'px-3 sm:px-4 md:px-6'}>\n        <SavedFilterTags\n        tableId={TODO_ANALYTICS_TABLE_ID}\n        onSelectFilter={applyFilterConditions}\n        onReset={resetFilterConditions}\n        activeFilterName={activeFilterName}\n        selectedFilterId={selectedFilterId}\n        onFilterChange={handleFilterChange}\n        defaultFilterName=\"Alle\" //  FIX: Hardcodiert (konsistent mit DB)\n      />\n      </div>\n\n      {/* Hufigkeitsanalyse & Schicht-Analyse Toggle */}\n      <div className=\"mb-4 flex items-center gap-2\">\n        <button\n          onClick={() => setShowFrequencyAnalysis(!showFrequencyAnalysis)}\n          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n          title={`${t('analytics.todo.frequencyAnalysis')} ${showFrequencyAnalysis ? t('common.collapse') : t('common.expand')}`}\n        >\n          <ChartBarIcon className={`h-5 w-5 transition-transform ${showFrequencyAnalysis ? 'rotate-180' : ''}`} />\n        </button>\n        <button\n          onClick={() => setShowShiftAnalysis(!showShiftAnalysis)}\n          className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n          title={`${t('analytics.todo.shiftAnalysis')} ${showShiftAnalysis ? t('common.collapse') : t('common.expand')}`}\n        >\n          <ClockIcon className={`h-5 w-5 transition-transform ${showShiftAnalysis ? 'rotate-180' : ''}`} />\n        </button>\n      </div>\n\n      {/* Hufigkeitsanalyse Sektion */}\n      {showFrequencyAnalysis && (\n        <div className=\"mb-6 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2\">\n            <ArrowPathIcon className=\"h-5 w-5\" />\n            {t('analytics.todo.frequencyAnalysis')}\n          </h3>\n          \n          {loadingFrequency ? (\n            <div className=\"flex items-center justify-center py-8\">\n              <div className=\"text-gray-500 dark:text-gray-400\">{t('analytics.todo.loadingAnalysis')}</div>\n            </div>\n          ) : frequencyData ? (\n            <div className=\"space-y-6\">\n              {/* Zusammenfassung */}\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                <div className=\"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800\">\n                  <div className=\"text-sm text-blue-600 dark:text-blue-400\">{t('analytics.todo.frequency.totalTodos')}</div>\n                  <div className=\"text-2xl font-bold text-blue-700 dark:text-blue-300\">{frequencyData.summary.totalTasks}</div>\n                </div>\n                <div className=\"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-green-200 dark:border-green-800\">\n                  <div className=\"text-sm text-green-600 dark:text-green-400\">{t('analytics.todo.frequency.completed')}</div>\n                  <div className=\"text-2xl font-bold text-green-700 dark:text-green-300\">{frequencyData.summary.completedTasks}</div>\n                </div>\n                <div className=\"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 border border-yellow-200 dark:border-yellow-800\">\n                  <div className=\"text-sm text-yellow-600 dark:text-yellow-400\">{t('analytics.todo.frequency.neverCompleted')}</div>\n                  <div className=\"text-2xl font-bold text-yellow-700 dark:text-yellow-300\">{frequencyData.summary.neverCompletedTasks}</div>\n                </div>\n                <div className=\"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4 border border-purple-200 dark:border-purple-800\">\n                  <div className=\"text-sm text-purple-600 dark:text-purple-400\">{t('analytics.todo.frequency.completionRate')}</div>\n                  <div className=\"text-2xl font-bold text-purple-700 dark:text-purple-300\">{frequencyData.summary.completionRate}%</div>\n                </div>\n              </div>\n\n              {/* Erledigungsrate pro User */}\n              {frequencyData.userStats && frequencyData.userStats.length > 0 && (\n                <div>\n                  <h4 className=\"text-base font-medium text-gray-900 dark:text-white mb-3\">{t('analytics.todo.frequency.completionsPerUser')}</h4>\n                  <div className=\"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6\">\n                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                      <thead className=\"bg-gray-50 dark:bg-gray-800\">\n                        <tr>\n                          <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                            {t('analytics.todo.frequency.user')}\n                          </th>\n                          <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                            {t('analytics.todo.frequency.completed')}\n                          </th>\n                          <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                            {t('analytics.todo.frequency.lastCompletion')}\n                          </th>\n                        </tr>\n                      </thead>\n                      <tbody className=\"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800\">\n                        {frequencyData.userStats.slice(0, 10).map((stat: any) => (\n                          <tr key={stat.userId} className=\"hover:bg-gray-50 dark:hover:bg-gray-800\">\n                            <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white\">\n                              {stat.user ? `${stat.user.firstName} ${stat.user.lastName}` : t('analytics.todo.unknown')}\n                            </td>\n                            <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                              {stat.completedCount}\n                            </td>\n                            <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                              {stat.lastCompletedAt ? format(new Date(stat.lastCompletedAt), 'HH:mm') : '-'}\n                            </td>\n                          </tr>\n                        ))}\n                      </tbody>\n                    </table>\n                  </div>\n                </div>\n              )}\n\n              {/* Hufigste/nicht erledigte To-Dos */}\n              {frequencyData.taskStats && frequencyData.taskStats.length > 0 && (\n                <div>\n                  <h4 className=\"text-base font-medium text-gray-900 dark:text-white mb-3\">{t('analytics.todo.frequency.frequentCompleted')}</h4>\n                  <div className=\"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6\">\n                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                      <thead className=\"bg-gray-50 dark:bg-gray-800\">\n                        <tr>\n                          <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                            {t('analytics.todo.columns.title')}\n                          </th>\n                          <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                            {t('analytics.todo.columns.status')}\n                          </th>\n                          <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                            {t('analytics.todo.columns.branch')}\n                          </th>\n                          <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                            {t('analytics.todo.frequency.completed')}\n                          </th>\n                        </tr>\n                      </thead>\n                      <tbody className=\"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800\">\n                        {frequencyData.taskStats.slice(0, 20).map((stat: any) => (\n                          <tr key={stat.taskId} className={`hover:bg-gray-50 dark:hover:bg-gray-800 ${stat.neverCompleted ? 'bg-red-50 dark:bg-red-900/10' : ''}`}>\n                            <td className=\"px-3 sm:px-4 md:px-6 py-4 text-sm font-medium text-gray-900 dark:text-white\">\n                              {stat.title}\n                            </td>\n                            <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                              <span className={`px-2 py-1 text-xs font-semibold rounded-full ${getStatusColor(stat.currentStatus)}`}>\n                                {getStatusLabel(stat.currentStatus)}\n                              </span>\n                            </td>\n                            <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                              {stat.branch.name}\n                            </td>\n                            <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                              {stat.completedCount}x {stat.neverCompleted && <span className=\"text-red-600 dark:text-red-400\">{t('analytics.todo.never')}</span>}\n                            </td>\n                          </tr>\n                        ))}\n                      </tbody>\n                    </table>\n                  </div>\n                </div>\n              )}\n\n              {/* Durchschnittliche Zeit pro Status */}\n              {frequencyData.statusAverages && Object.keys(frequencyData.statusAverages).length > 0 && (\n                <div>\n                  <h4 className=\"text-base font-medium text-gray-900 dark:text-white mb-3\">{t('analytics.todo.frequency.averageTimePerStatus')}</h4>\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4\">\n                    {Object.entries(frequencyData.statusAverages).map(([status, data]: [string, any]) => (\n                      <div key={status} className=\"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600\">\n                        <div className=\"text-sm text-gray-500 dark:text-gray-400 mb-1\">{getStatusLabel(status)}</div>\n                        <div className=\"text-xl font-bold text-gray-900 dark:text-white\">\n                          {data.averageHours.toFixed(1)}h\n                        </div>\n                        <div className=\"text-xs text-gray-400 dark:text-gray-500 mt-1\">\n                          {data.taskCount} To-Do(s)\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {/* Status-Verteilung Diagramm */}\n              {frequencyData.summary && (\n                <div>\n                  <h4 className=\"text-base font-medium text-gray-900 dark:text-white mb-3\">{t('analytics.todo.frequency.statusDistribution')}</h4>\n                  <div className=\"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600\">\n                    <div className=\"relative\" style={{ height: '200px' }}>\n                      {/* Y-Achse Beschriftungen */}\n                      <div className=\"absolute right-0 h-full flex flex-col justify-between text-xs text-gray-500 dark:text-gray-400 pr-1\">\n                        <span>{frequencyData.summary.totalTasks}</span>\n                        <span>{Math.round(frequencyData.summary.totalTasks * 0.75)}</span>\n                        <span>{Math.round(frequencyData.summary.totalTasks * 0.5)}</span>\n                        <span>{Math.round(frequencyData.summary.totalTasks * 0.25)}</span>\n                        <span>0</span>\n                      </div>\n                      \n                      {/* Horizontale Hilfslinien */}\n                      <div className=\"absolute inset-0 flex flex-col justify-between pointer-events-none pr-8\">\n                        <div className=\"w-full border-t border-gray-300 dark:border-gray-600\"></div>\n                        <div className=\"w-full border-t border-gray-300 dark:border-gray-600\"></div>\n                        <div className=\"w-full border-t border-gray-300 dark:border-gray-600\"></div>\n                        <div className=\"w-full border-t border-gray-300 dark:border-gray-600\"></div>\n                        <div className=\"w-full border-t border-gray-300 dark:border-gray-600\"></div>\n                      </div>\n                      \n                      {/* Balken */}\n                      <div className=\"absolute inset-0 flex items-end justify-around gap-2 pr-8 pb-1\">\n                        <div className=\"flex flex-col items-center gap-1 flex-1\">\n                          <div className=\"relative group w-full\">\n                            <div \n                              className=\"w-full bg-green-500 dark:bg-green-600 rounded-t\"\n                              style={{ \n                                height: `${frequencyData.summary.completedTasks > 0 ? (frequencyData.summary.completedTasks / frequencyData.summary.totalTasks) * 100 : 0}%`,\n                                minHeight: frequencyData.summary.completedTasks > 0 ? '4px' : '0px'\n                              }}\n                            ></div>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {`${t('analytics.todo.frequency.completed')}: ${frequencyData.summary.completedTasks}`}\n                            </div>\n                          </div>\n                          <span className=\"text-xs text-gray-600 dark:text-gray-400 font-medium\">{t('analytics.todo.frequency.completed')}</span>\n                          <span className=\"text-xs text-gray-500 dark:text-gray-500\">{frequencyData.summary.completedTasks}</span>\n                        </div>\n                        <div className=\"flex flex-col items-center gap-1 flex-1\">\n                          <div className=\"relative group w-full\">\n                            <div \n                              className=\"w-full bg-yellow-500 dark:bg-yellow-600 rounded-t\"\n                              style={{ \n                                height: `${frequencyData.summary.totalTasks - frequencyData.summary.completedTasks - frequencyData.summary.neverCompletedTasks > 0 ? ((frequencyData.summary.totalTasks - frequencyData.summary.completedTasks - frequencyData.summary.neverCompletedTasks) / frequencyData.summary.totalTasks) * 100 : 0}%`,\n                                minHeight: frequencyData.summary.totalTasks - frequencyData.summary.completedTasks - frequencyData.summary.neverCompletedTasks > 0 ? '4px' : '0px'\n                              }}\n                            ></div>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {`${t('tasks.status.open')}: ${frequencyData.summary.totalTasks - frequencyData.summary.completedTasks - frequencyData.summary.neverCompletedTasks}`}\n                            </div>\n                          </div>\n                          <span className=\"text-xs text-gray-600 dark:text-gray-400 font-medium\">{t('tasks.status.open')}</span>\n                          <span className=\"text-xs text-gray-500 dark:text-gray-500\">{frequencyData.summary.totalTasks - frequencyData.summary.completedTasks - frequencyData.summary.neverCompletedTasks}</span>\n                        </div>\n                        <div className=\"flex flex-col items-center gap-1 flex-1\">\n                          <div className=\"relative group w-full\">\n                            <div \n                              className=\"w-full bg-red-500 dark:bg-red-600 rounded-t\"\n                              style={{ \n                                height: `${frequencyData.summary.neverCompletedTasks > 0 ? (frequencyData.summary.neverCompletedTasks / frequencyData.summary.totalTasks) * 100 : 0}%`,\n                                minHeight: frequencyData.summary.neverCompletedTasks > 0 ? '4px' : '0px'\n                              }}\n                            ></div>\n                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                              {`${t('analytics.todo.frequency.neverCompleted')}: ${frequencyData.summary.neverCompletedTasks}`}\n                            </div>\n                          </div>\n                          <span className=\"text-xs text-gray-600 dark:text-gray-400 font-medium\">{t('analytics.todo.frequency.neverCompleted')}</span>\n                          <span className=\"text-xs text-gray-500 dark:text-gray-500\">{frequencyData.summary.neverCompletedTasks}</span>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n          ) : (\n            <div className=\"text-gray-500 dark:text-gray-400 text-center py-8\">\n              {t('analytics.todo.noData')}\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Schicht-Analyse Sektion */}\n      {showShiftAnalysis && (\n        <div className=\"mb-6 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2\">\n            <ClockIcon className=\"h-5 w-5\" />\n            {t('analytics.todo.shift.shiftBased')}\n          </h3>\n          \n          {loadingShifts ? (\n            <div className=\"flex items-center justify-center py-8\">\n              <div className=\"text-gray-500 dark:text-gray-400\">{t('analytics.todo.loadingAnalysis')}</div>\n            </div>\n          ) : shiftData ? (\n            <div className=\"space-y-6\">\n              {/* Zusammenfassung */}\n              <div className=\"grid grid-cols-2 md:grid-cols-5 gap-4\">\n                <div className=\"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800\">\n                  <div className=\"text-sm text-blue-600 dark:text-blue-400\">{t('analytics.todo.shift.totalShifts')}</div>\n                  <div className=\"text-2xl font-bold text-blue-700 dark:text-blue-300\">{shiftData.summary.totalShifts}</div>\n                </div>\n                <div className=\"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-green-200 dark:border-green-800\">\n                  <div className=\"text-sm text-green-600 dark:text-green-400\">{t('analytics.todo.shift.todosInShifts')}</div>\n                  <div className=\"text-2xl font-bold text-green-700 dark:text-green-300\">{shiftData.summary.totalTasksInShifts}</div>\n                </div>\n                <div className=\"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4 border border-purple-200 dark:border-purple-800\">\n                  <div className=\"text-sm text-purple-600 dark:text-purple-400\">{t('analytics.todo.shift.totalHours')}</div>\n                  <div className=\"text-2xl font-bold text-purple-700 dark:text-purple-300\">\n                    {shiftData.summary.totalDurationHours || '0.00'}\n                  </div>\n                </div>\n                <div className=\"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 border border-yellow-200 dark:border-yellow-800\">\n                  <div className=\"text-sm text-yellow-600 dark:text-yellow-400\">{t('analytics.todo.shift.averageDuration')}</div>\n                  <div className=\"text-2xl font-bold text-yellow-700 dark:text-yellow-300\">\n                    {shiftData.summary.averageDurationHours || '-'}h\n                  </div>\n                </div>\n                <div className=\"bg-indigo-50 dark:bg-indigo-900/20 rounded-lg p-4 border border-indigo-200 dark:border-indigo-800\">\n                  <div className=\"text-sm text-indigo-600 dark:text-indigo-400\">{t('analytics.todo.shift.averageTodosPerShift')}</div>\n                  <div className=\"text-2xl font-bold text-indigo-700 dark:text-indigo-300\">\n                    {shiftData.summary.totalShifts > 0 \n                      ? (shiftData.summary.totalTasksInShifts / shiftData.summary.totalShifts).toFixed(1)\n                      : '0'\n                    }\n                  </div>\n                </div>\n              </div>\n\n              {/* Schichten-Liste */}\n              {shiftData.shifts && shiftData.shifts.length > 0 && (\n                <div>\n                  <h4 className=\"text-base font-medium text-gray-900 dark:text-white mb-3\">{t('analytics.todo.shift.shiftsWithTodos')}</h4>\n                  <div className=\"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6\">\n                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                      <thead className=\"bg-gray-50 dark:bg-gray-800\">\n                        <tr>\n                          <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                            {t('analytics.todo.frequency.user')}\n                          </th>\n                          <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                            {t('analytics.todo.columns.branch')}\n                          </th>\n                          <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                            {t('analytics.todo.shift.time')}\n                          </th>\n                          <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                            {t('analytics.todo.shift.duration')}\n                          </th>\n                          <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                            {t('analytics.todo.columns.title')}\n                          </th>\n                        </tr>\n                      </thead>\n                      <tbody className=\"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800\">\n                        {shiftData.shifts.map((shift: any) => {\n                          const isExpanded = expandedShifts.has(shift.workTimeId);\n                          return (\n                            <React.Fragment key={shift.workTimeId}>\n                              <tr className=\"hover:bg-gray-50 dark:hover:bg-gray-800\">\n                                <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white\">\n                                  {shift.user.firstName} {shift.user.lastName}\n                                </td>\n                                <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                                  {shift.branch.name}\n                                </td>\n                                <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                                  {format(new Date(shift.startTime), 'HH:mm')}\n                                  {shift.endTime && ` - ${format(new Date(shift.endTime), 'HH:mm')}`}\n                                </td>\n                                <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                                  {shift.durationHours ? `${shift.durationHours}h` : t('worktime.running')}\n                                </td>\n                                <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                                  <div className=\"flex items-center gap-2\">\n                                    <span>{shift.linkedTasksCount}</span>\n                                    {shift.linkedTasksCount > 0 && (\n                                      <div className=\"relative group\">\n                                        <button\n                                          onClick={() => toggleShiftExpand(shift.workTimeId)}\n                                          className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n                                        >\n                                          {isExpanded ? (\n                                            <ChevronUpIcon className=\"h-4 w-4\" />\n                                          ) : (\n                                            <ChevronDownIcon className=\"h-4 w-4\" />\n                                          )}\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                          {t('analytics.todo.shift.showTodos')}\n                                        </div>\n                                      </div>\n                                    )}\n                                  </div>\n                                </td>\n                              </tr>\n                              {isExpanded && shift.linkedTasksCount > 0 && (\n                                <tr className=\"bg-gray-50 dark:bg-gray-800/50\">\n                                  <td colSpan={5} className=\"px-3 sm:px-4 md:px-6 py-4\">\n                                    <div className=\"ml-4 border-l-2 border-blue-200 dark:border-blue-700 pl-4\">\n                                      <h5 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('analytics.todo.shift.linkedTasks')}</h5>\n                                      <div className=\"space-y-2\">\n                                        {shift.linkedTasks.map((task: any) => (\n                                          <div key={task.id} className=\"flex items-center gap-3 text-xs text-gray-600 dark:text-gray-400\">\n                                            <span className={`px-2 py-1 rounded-full ${getStatusColor(task.status)}`}>\n                                              {getStatusLabel(task.status)}\n                                            </span>\n                                            <span className=\"font-medium\">{task.title}</span>\n                                            {task.responsible && (\n                                              <span className=\"text-gray-400\">\n                                                ({task.responsible.firstName} {task.responsible.lastName})\n                                              </span>\n                                            )}\n                                          </div>\n                                        ))}\n                                      </div>\n                                    </div>\n                                  </td>\n                                </tr>\n                              )}\n                            </React.Fragment>\n                          );\n                        })}\n                      </tbody>\n                    </table>\n                  </div>\n                </div>\n              )}\n\n              {/* To-Dos mit Schicht-Verteilung */}\n              {shiftData.tasksWithShifts && shiftData.tasksWithShifts.length > 0 && (\n                <div>\n                  <h4 className=\"text-base font-medium text-gray-900 dark:text-white mb-3\">{t('analytics.todo.shift.tasksWithShiftDistribution')}</h4>\n                  <div className=\"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6\">\n                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                      <thead className=\"bg-gray-50 dark:bg-gray-800\">\n                        <tr>\n                          <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                            {t('analytics.todo.columns.title')}\n                          </th>\n                          <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                            {t('analytics.todo.columns.status')}\n                          </th>\n                          <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                            {t('analytics.todo.shift.totalShifts')}\n                          </th>\n                          <th className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                            {t('analytics.todo.shift.totalTime')}\n                          </th>\n                        </tr>\n                      </thead>\n                      <tbody className=\"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800\">\n                        {shiftData.tasksWithShifts.slice(0, 30).map((item: any) => (\n                          <tr key={item.task.id} className=\"hover:bg-gray-50 dark:hover:bg-gray-800\">\n                            <td className=\"px-3 sm:px-4 md:px-6 py-4 text-sm font-medium text-gray-900 dark:text-white\">\n                              {item.task.title}\n                            </td>\n                            <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                              <span className={`px-2 py-1 text-xs font-semibold rounded-full ${getStatusColor(item.task.status)}`}>\n                                {getStatusLabel(item.task.status)}\n                              </span>\n                            </td>\n                            <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                              {item.shiftCount}x\n                            </td>\n                            <td className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                              {item.totalDurationHours}h\n                            </td>\n                          </tr>\n                        ))}\n                      </tbody>\n                    </table>\n                  </div>\n                </div>\n              )}\n            </div>\n          ) : (\n            <div className=\"text-gray-500 dark:text-gray-400 text-center py-8\">\n              {t('analytics.todo.noShiftData')}\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Statistiken */}\n      <div className=\"grid grid-cols-2 md:grid-cols-6 gap-4 mb-6\">\n        <div className=\"bg-white dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600\">\n          <div className=\"text-sm text-gray-500 dark:text-gray-400\">{t('analytics.todo.stats.total')}</div>\n          <div className=\"text-2xl font-bold text-gray-900 dark:text-white\">{stats.total}</div>\n        </div>\n        <div className=\"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-green-200 dark:border-green-800\">\n          <div className=\"text-sm text-green-600 dark:text-green-400\">{t('analytics.todo.frequency.completed')}</div>\n          <div className=\"text-2xl font-bold text-green-700 dark:text-green-300\">{stats.done}</div>\n        </div>\n        <div className=\"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800\">\n          <div className=\"text-sm text-blue-600 dark:text-blue-400\">{t('analytics.todo.stats.inProgress')}</div>\n          <div className=\"text-2xl font-bold text-blue-700 dark:text-blue-300\">{stats.inProgress}</div>\n        </div>\n        <div className=\"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4 border border-purple-200 dark:border-purple-800\">\n          <div className=\"text-sm text-purple-600 dark:text-purple-400\">{t('analytics.todo.stats.qualityControl')}</div>\n          <div className=\"text-2xl font-bold text-purple-700 dark:text-purple-300\">{stats.qualityControl}</div>\n        </div>\n        <div className=\"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 border border-yellow-200 dark:border-yellow-800\">\n          <div className=\"text-sm text-yellow-600 dark:text-yellow-400\">{t('tasks.status.open')}</div>\n          <div className=\"text-2xl font-bold text-yellow-700 dark:text-yellow-300\">{stats.open}</div>\n        </div>\n        <div className=\"bg-red-50 dark:bg-red-900/20 rounded-lg p-4 border border-red-200 dark:border-red-800\">\n          <div className=\"text-sm text-red-600 dark:text-red-400\">{t('tasks.status.improval')}</div>\n          <div className=\"text-2xl font-bold text-red-700 dark:text-red-300\">{stats.improval}</div>\n        </div>\n      </div>\n\n      {/* Status-Verteilung Diagramm */}\n      {filteredTodos.length > 0 && (\n        <div className=\"mb-6 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2\">\n            <ChartBarIcon className=\"h-5 w-5\" />\n            {t('analytics.todo.statusDistribution')}\n          </h3>\n          <div className=\"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600\">\n            <div className=\"relative\" style={{ height: '200px' }}>\n              {/* Y-Achse Beschriftungen */}\n              <div className=\"absolute right-0 h-full flex flex-col justify-between text-xs text-gray-500 dark:text-gray-400 pr-1\">\n                <span>{stats.total}</span>\n                <span>{Math.round(stats.total * 0.75)}</span>\n                <span>{Math.round(stats.total * 0.5)}</span>\n                <span>{Math.round(stats.total * 0.25)}</span>\n                <span>0</span>\n              </div>\n              \n              {/* Horizontale Hilfslinien */}\n              <div className=\"absolute inset-0 flex flex-col justify-between pointer-events-none pr-8\">\n                <div className=\"w-full border-t border-gray-300 dark:border-gray-600\"></div>\n                <div className=\"w-full border-t border-gray-300 dark:border-gray-600\"></div>\n                <div className=\"w-full border-t border-gray-300 dark:border-gray-600\"></div>\n                <div className=\"w-full border-t border-gray-300 dark:border-gray-600\"></div>\n                <div className=\"w-full border-t border-gray-300 dark:border-gray-600\"></div>\n              </div>\n              \n              {/* Balken */}\n              <div className=\"absolute inset-0 flex items-end justify-around gap-1 sm:gap-2 pr-8 pb-1\">\n                <div className=\"flex flex-col items-center gap-1 flex-1\">\n                  <div className=\"relative group w-full\">\n                    <div \n                      className=\"w-full bg-green-500 dark:bg-green-600 rounded-t transition-all hover:opacity-80\"\n                      style={{ \n                        height: `${stats.total > 0 ? (stats.done / stats.total) * 100 : 0}%`,\n                        minHeight: stats.done > 0 ? '4px' : '0px'\n                      }}\n                    ></div>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                      {`${t('analytics.todo.frequency.completed')}: ${stats.done}`}\n                    </div>\n                  </div>\n                  <span className=\"text-xs text-gray-600 dark:text-gray-400 font-medium text-center\">{t('analytics.todo.frequency.completed')}</span>\n                  <span className=\"text-xs text-gray-500 dark:text-gray-500\">{stats.done}</span>\n                </div>\n                <div className=\"flex flex-col items-center gap-1 flex-1\">\n                  <div className=\"relative group w-full\">\n                    <div \n                      className=\"w-full bg-blue-500 dark:bg-blue-600 rounded-t transition-all hover:opacity-80\"\n                      style={{ \n                        height: `${stats.total > 0 ? (stats.inProgress / stats.total) * 100 : 0}%`,\n                        minHeight: stats.inProgress > 0 ? '4px' : '0px'\n                      }}\n                    ></div>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                      {`${t('analytics.todo.stats.inProgress')}: ${stats.inProgress}`}\n                    </div>\n                  </div>\n                  <span className=\"text-xs text-gray-600 dark:text-gray-400 font-medium text-center\">{t('analytics.todo.stats.inProgress')}</span>\n                  <span className=\"text-xs text-gray-500 dark:text-gray-500\">{stats.inProgress}</span>\n                </div>\n                <div className=\"flex flex-col items-center gap-1 flex-1\">\n                  <div className=\"relative group w-full\">\n                    <div \n                      className=\"w-full bg-purple-500 dark:bg-purple-600 rounded-t transition-all hover:opacity-80\"\n                      style={{ \n                        height: `${stats.total > 0 ? (stats.qualityControl / stats.total) * 100 : 0}%`,\n                        minHeight: stats.qualityControl > 0 ? '4px' : '0px'\n                      }}\n                    ></div>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                      {`${t('analytics.todo.stats.qualityControl')}: ${stats.qualityControl}`}\n                    </div>\n                  </div>\n                  <span className=\"text-xs text-gray-600 dark:text-gray-400 font-medium text-center\">{t('analytics.todo.columns.qualityControl')}</span>\n                  <span className=\"text-xs text-gray-500 dark:text-gray-500\">{stats.qualityControl}</span>\n                </div>\n                <div className=\"flex flex-col items-center gap-1 flex-1\">\n                  <div className=\"relative group w-full\">\n                    <div \n                      className=\"w-full bg-yellow-500 dark:bg-yellow-600 rounded-t transition-all hover:opacity-80\"\n                      style={{ \n                        height: `${stats.total > 0 ? (stats.open / stats.total) * 100 : 0}%`,\n                        minHeight: stats.open > 0 ? '4px' : '0px'\n                      }}\n                    ></div>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                      {`${t('tasks.status.open')}: ${stats.open}`}\n                    </div>\n                  </div>\n                  <span className=\"text-xs text-gray-600 dark:text-gray-400 font-medium text-center\">{t('tasks.status.open')}</span>\n                  <span className=\"text-xs text-gray-500 dark:text-gray-500\">{stats.open}</span>\n                </div>\n                <div className=\"flex flex-col items-center gap-1 flex-1\">\n                  <div className=\"relative group w-full\">\n                    <div \n                      className=\"w-full bg-red-500 dark:bg-red-600 rounded-t transition-all hover:opacity-80\"\n                      style={{ \n                        height: `${stats.total > 0 ? (stats.improval / stats.total) * 100 : 0}%`,\n                        minHeight: stats.improval > 0 ? '4px' : '0px'\n                      }}\n                    ></div>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                      {`${t('tasks.status.improval')}: ${stats.improval}`}\n                    </div>\n                  </div>\n                  <span className=\"text-xs text-gray-600 dark:text-gray-400 font-medium text-center\">{t('tasks.status.improval')}</span>\n                  <span className=\"text-xs text-gray-500 dark:text-gray-500\">{stats.improval}</span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Content: Tabelle oder Cards */}\n      {loading ? (\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"text-gray-500 dark:text-gray-400\">{t('common.loading')}</div>\n        </div>\n      ) : viewMode === 'table' ? (\n        /* Tabellen-Ansicht */\n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n            <thead className=\"bg-gray-50 dark:bg-gray-800\">\n              <tr>\n                {columnOrder.filter(id => visibleColumnIds.includes(id)).map((columnId) => {\n                  const column = availableColumns.find(c => c.id === columnId);\n                  return column ? (\n                    <th\n                      key={columnId}\n                      className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\"\n                    >\n                      {column.label}\n                    </th>\n                  ) : null;\n                })}\n              </tr>\n            </thead>\n            <tbody className=\"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800\">\n              {filteredTodos.length === 0 ? (\n                <tr>\n                  <td colSpan={columnOrder.filter(id => visibleColumnIds.includes(id)).length} className=\"px-3 sm:px-4 md:px-6 py-4 text-center text-gray-500 dark:text-gray-400\">\n                    Keine To-Dos fr dieses Datum gefunden\n                  </td>\n                </tr>\n              ) : (\n                filteredTodos.map((todo) => {\n                  const isExpanded = expandedTodos.has(todo.id);\n                  const hasStatusHistory = todo.statusHistory && todo.statusHistory.length > 0;\n                  \n                  return (\n                    <React.Fragment key={todo.id}>\n                      <tr className=\"hover:bg-gray-50 dark:hover:bg-gray-800\">\n                        {columnOrder.filter(id => visibleColumnIds.includes(id)).map((columnId) => {\n                          switch (columnId) {\n                            case 'time':\n                              return (\n                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                                  {format(new Date(todo.updatedAt), 'HH:mm')}\n                                </td>\n                              );\n                            case 'title':\n                              return (\n                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 text-sm font-medium text-gray-900 dark:text-white\">\n                                  <div className=\"flex items-center gap-2\">\n                                    {hasStatusHistory && (\n                                      <div className=\"relative group\">\n                                        <button\n                                          onClick={() => toggleTodoExpand(todo.id)}\n                                          className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n                                        >\n                                          {isExpanded ? (\n                                            <ChevronUpIcon className=\"h-4 w-4\" />\n                                          ) : (\n                                            <ChevronDownIcon className=\"h-4 w-4\" />\n                                          )}\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                          Status-Historie anzeigen\n                                        </div>\n                                      </div>\n                                    )}\n                                    <span>{todo.title}</span>\n                                  </div>\n                                </td>\n                              );\n                            case 'status':\n                              return (\n                                <td key={columnId} className=\"px-6 py-4 whitespace-nowrap\">\n                                  <span className={`px-2 py-1 text-xs font-semibold rounded-full ${getStatusColor(todo.status)}`}>\n                                    {getStatusLabel(todo.status)}\n                                  </span>\n                                </td>\n                              );\n                            case 'responsible':\n                              return (\n                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                                  {todo.responsible\n                                    ? `${todo.responsible.firstName} ${todo.responsible.lastName}`\n                                    : '-'}\n                                </td>\n                              );\n                            case 'qualityControl':\n                              return (\n                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                                  {todo.qualityControl\n                                    ? `${todo.qualityControl.firstName} ${todo.qualityControl.lastName}`\n                                    : '-'}\n                                </td>\n                              );\n                            case 'branch':\n                              return (\n                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                                  {todo.branch.name}\n                                </td>\n                              );\n                            case 'createdBy':\n                              return (\n                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                                  {todo.createdBy\n                                    ? `${todo.createdBy.firstName} ${todo.createdBy.lastName}`\n                                    : '-'}\n                                </td>\n                              );\n                            case 'deletedAt':\n                              return (\n                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                                  {todo.deletedAt ? (\n                                    <div className=\"flex items-center gap-2\">\n                                      <TrashIcon className=\"h-4 w-4 text-red-500\" />\n                                      <span>{format(new Date(todo.deletedAt), 'dd.MM.yyyy HH:mm')}</span>\n                                      {todo.deletedBy && (\n                                        <span className=\"text-gray-400\">\n                                          ({todo.deletedBy.firstName} {todo.deletedBy.lastName})\n                                        </span>\n                                      )}\n                                    </div>\n                                  ) : (\n                                    '-'\n                                  )}\n                                </td>\n                              );\n                            default:\n                              return null;\n                          }\n                        })}\n                      </tr>\n                      {/* Status-Historie Zeile */}\n                      {isExpanded && hasStatusHistory && (\n                        <tr className=\"bg-gray-50 dark:bg-gray-800/50\">\n                          <td colSpan={columnOrder.filter(id => visibleColumnIds.includes(id)).length} className=\"px-3 sm:px-4 md:px-6 py-4\">\n                            <div className=\"ml-4 border-l-2 border-blue-200 dark:border-blue-700 pl-4\">\n                              <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2\">\n                                <ArrowPathIcon className=\"h-4 w-4\" />\n                                Status-Wechsel\n                              </h4>\n                              <div className=\"space-y-2\">\n                                {todo.statusHistory!.map((historyItem, idx) => (\n                                  <div key={historyItem.id} className=\"flex items-center gap-3 text-xs text-gray-600 dark:text-gray-400\">\n                                    <span className=\"font-medium\">\n                                      {format(new Date(historyItem.changedAt), 'HH:mm:ss')}\n                                    </span>\n                                    <span className=\"text-gray-400\"></span>\n                                    <span className={`px-2 py-1 rounded-full ${getStatusColor(historyItem.oldStatus || 'open')}`}>\n                                      {getStatusLabel(historyItem.oldStatus || 'open')}\n                                    </span>\n                                    <span className=\"text-gray-400\"></span>\n                                    <span className={`px-2 py-1 rounded-full ${getStatusColor(historyItem.newStatus)}`}>\n                                      {getStatusLabel(historyItem.newStatus)}\n                                    </span>\n                                    <span className=\"text-gray-400\">von</span>\n                                    <span className=\"font-medium\">\n                                      {historyItem.user.firstName} {historyItem.user.lastName}\n                                    </span>\n                                  </div>\n                                ))}\n                              </div>\n                            </div>\n                          </td>\n                        </tr>\n                      )}\n                    </React.Fragment>\n                  );\n                })\n              )}\n            </tbody>\n          </table>\n        </div>\n      ) : (\n        /* Card-Ansicht */\n        <div className=\"-mx-3 sm:-mx-4 md:-mx-6\">\n          {filteredTodos.length === 0 ? (\n            <div className=\"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400\">\n              <ClipboardDocumentListIcon className=\"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500\" />\n              <div className=\"text-sm\">Keine To-Dos gefunden</div>\n            </div>\n          ) : (\n            <CardGrid>\n              {filteredTodos.map(todo => {\n                const metadata: MetadataItem[] = [];\n                \n                // Links: Niederlassung\n                if (visibleColumnIds.includes('branch')) {\n                  metadata.push({\n                    icon: <BuildingOfficeIcon className=\"h-4 w-4\" />,\n                    label: 'Niederlassung',\n                    value: todo.branch.name,\n                    section: 'left'\n                  });\n                }\n                \n                // Haupt-Metadaten: Verantwortlich & Qualittskontrolle\n                if (visibleColumnIds.includes('responsible')) {\n                  metadata.push({\n                    icon: <UserIcon className=\"h-4 w-4\" />,\n                    label: 'Verantwortlich',\n                    value: todo.responsible\n                      ? `${todo.responsible.firstName} ${todo.responsible.lastName}`\n                      : '-',\n                    section: 'main'\n                  });\n                }\n                \n                if (visibleColumnIds.includes('qualityControl')) {\n                  metadata.push({\n                    icon: <UserIcon className=\"h-4 w-4\" />,\n                    label: 'Qualittskontrolle',\n                    value: todo.qualityControl\n                      ? `${todo.qualityControl.firstName} ${todo.qualityControl.lastName}`\n                      : '-',\n                    section: 'main'\n                  });\n                }\n                \n                // Rechts: Zeit\n                if (visibleColumnIds.includes('time')) {\n                  metadata.push({\n                    icon: <ClockIcon className=\"h-4 w-4\" />,\n                    label: 'Zeit',\n                    value: format(new Date(todo.updatedAt), 'HH:mm'),\n                    section: 'right'\n                  });\n                }\n\n                // Expandierbarer Content fr Status-Historie\n                const hasStatusHistory = todo.statusHistory && todo.statusHistory.length > 0;\n                const isExpanded = expandedTodos.has(todo.id);\n                \n                const expandableContent = hasStatusHistory ? (\n                  <div className=\"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                    <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2\">\n                      <ArrowPathIcon className=\"h-4 w-4\" />\n                      Status-Wechsel\n                    </h4>\n                    <div className=\"space-y-2\">\n                      {todo.statusHistory!.map((historyItem) => (\n                        <div key={historyItem.id} className=\"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400\">\n                          <span className=\"font-medium\">\n                            {format(new Date(historyItem.changedAt), 'HH:mm:ss')}\n                          </span>\n                          <span className=\"text-gray-400\"></span>\n                          <span className={`px-2 py-1 rounded-full ${getStatusColor(historyItem.oldStatus || 'open')}`}>\n                            {getStatusLabel(historyItem.oldStatus || 'open')}\n                          </span>\n                          <span className=\"text-gray-400\"></span>\n                          <span className={`px-2 py-1 rounded-full ${getStatusColor(historyItem.newStatus)}`}>\n                            {getStatusLabel(historyItem.newStatus)}\n                          </span>\n                          <span className=\"text-gray-400\">von</span>\n                          <span className=\"font-medium\">\n                            {historyItem.user.firstName} {historyItem.user.lastName}\n                          </span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                ) : null;\n\n                return (\n                  <DataCard\n                    key={todo.id}\n                    title={\n                      <span>\n                        <span className=\"text-xs text-gray-600 dark:text-gray-400\">{todo.id}:</span>{' '}\n                        <span>{todo.title}</span>\n                      </span>\n                    }\n                    status={{\n                      label: getStatusLabel(todo.status),\n                      color: getStatusColor(todo.status)\n                    }}\n                    metadata={metadata}\n                    expandable={expandableContent ? {\n                      isExpanded: isExpanded,\n                      content: expandableContent,\n                      onToggle: () => toggleTodoExpand(todo.id)\n                    } : undefined}\n                  />\n                );\n              })}\n            </CardGrid>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default TodoAnalyticsTab;\n","import React, { useState, useEffect, useRef, useMemo, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { format } from 'date-fns';\nimport { \n  FunnelIcon,\n  Squares2X2Icon,\n  TableCellsIcon,\n  DocumentTextIcon,\n  UserIcon,\n  BuildingOfficeIcon,\n  ClockIcon,\n  ArrowPathIcon,\n  ChevronDownIcon,\n  ChevronUpIcon,\n  TrashIcon\n} from '@heroicons/react/24/outline';\nimport FilterPane from '../FilterPane.tsx';\nimport SavedFilterTags from '../SavedFilterTags.tsx';\nimport { useFilterContext } from '../../contexts/FilterContext.tsx';\nimport { FilterCondition } from '../FilterRow.tsx';\nimport DataCard, { MetadataItem } from '../shared/DataCard.tsx';\nimport CardGrid from '../shared/CardGrid.tsx';\nimport { useTableSettings } from '../../hooks/useTableSettings.ts';\nimport { useAuth } from '../../hooks/useAuth.tsx';\n\ninterface RequestAnalyticsTabProps {\n  selectedDate?: string; // Optional fr Rckwrtskompatibilitt\n}\n\ninterface StatusHistoryItem {\n  id: number;\n  oldStatus: string | null;\n  newStatus: string;\n  changedAt: string;\n  user: {\n    id: number;\n    firstName: string;\n    lastName: string;\n    username: string;\n  };\n}\n\ninterface Request {\n  id: number;\n  title: string;\n  status: string;\n  requester: {\n    id: number;\n    firstName: string;\n    lastName: string;\n    username: string;\n  };\n  responsible: {\n    id: number;\n    firstName: string;\n    lastName: string;\n    username: string;\n  };\n  branch: {\n    id: number;\n    name: string;\n  };\n  createdAt: string;\n  updatedAt: string;\n  deletedAt?: string | null;\n  deletedBy?: {\n    id: number;\n    firstName: string;\n    lastName: string;\n    username: string;\n  } | null;\n  statusHistory?: StatusHistoryItem[];\n}\n\n// TableID fr gespeicherte Filter\nconst REQUEST_ANALYTICS_TABLE_ID = 'request-analytics-table';\n\n// Standardreihenfolge der Spalten\nconst defaultColumnOrder = ['time', 'title', 'status', 'requester', 'responsible', 'branch', 'deletedAt'];\n\nconst RequestAnalyticsTab: React.FC<RequestAnalyticsTabProps> = ({ selectedDate }) => {\n  const { t } = useTranslation();\n  const { user } = useAuth();\n  const [requests, setRequests] = useState<Request[]>([]);\n  const [loading, setLoading] = useState<boolean>(false);\n  const [error, setError] = useState<string | null>(null);\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  \n  // Expandierte Requests fr Status-Historie\n  const [expandedRequests, setExpandedRequests] = useState<Set<number>>(new Set());\n  \n  const toggleRequestExpand = (requestId: number) => {\n    setExpandedRequests(prev => {\n      const next = new Set(prev);\n      if (next.has(requestId)) {\n        next.delete(requestId);\n      } else {\n        next.add(requestId);\n      }\n      return next;\n    });\n  };\n  \n  // Filter State Management (Controlled Mode)\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  const [activeFilterName, setActiveFilterName] = useState<string>('');\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n  const [isFilterPanelOpen, setIsFilterPanelOpen] = useState(false);\n  \n  // Table Settings\n  const {\n    settings,\n    isLoading: isLoadingSettings,\n    updateColumnOrder,\n    updateHiddenColumns,\n    toggleColumnVisibility,\n    isColumnVisible,\n    updateViewMode\n  } = useTableSettings(REQUEST_ANALYTICS_TABLE_ID, {\n    defaultColumnOrder,\n    defaultViewMode: 'table'\n  });\n\n  // Abgeleitete Werte aus Settings\n  const columnOrder = settings?.columnOrder || defaultColumnOrder;\n  const hiddenColumns = settings?.hiddenColumns || [];\n  const visibleColumnIds = columnOrder.filter(id => !hiddenColumns.includes(id));\n  const savedViewMode = settings?.viewMode || 'table';\n  \n  // View Mode - initialisiere aus Settings, falls vorhanden\n  const [viewMode, setViewMode] = useState<'table' | 'cards'>(savedViewMode);\n  \n  // View Mode synchronisieren mit Settings\n  useEffect(() => {\n    if (settings?.viewMode && settings.viewMode !== viewMode) {\n      setViewMode(settings.viewMode);\n    }\n  }, [settings?.viewMode]);\n\n  // Verfgbare Spalten fr Filter und Table Settings\n  const availableColumns = useMemo(() => [\n    { id: 'time', label: t('analytics.request.columns.time') },\n    { id: 'title', label: t('analytics.request.columns.title') },\n    { id: 'status', label: t('analytics.request.columns.status') },\n    { id: 'requester', label: t('analytics.request.columns.requester') },\n    { id: 'responsible', label: t('analytics.request.columns.responsible') },\n    { id: 'branch', label: t('analytics.request.columns.branch') },\n    { id: 'deletedAt', label: t('analytics.request.columns.deletedAt', { defaultValue: 'Gelscht am' }) }\n  ], [t]);\n\n  //  PERFORMANCE: Stabilisiere Array-Dependencies (verhindert unntige Re-Runs durch neue Array-Referenzen)\n  const filterConditionsKey = useMemo(() => JSON.stringify(filterConditions), [filterConditions]);\n  const filterOperatorsKey = useMemo(() => JSON.stringify(filterLogicalOperators), [filterLogicalOperators]);\n\n  // Lade Requests\n  useEffect(() => {\n    //  PHASE 8: Memory Leak Prevention - AbortController\n    const abortController = new AbortController();\n    \n    const fetchRequests = async () => {\n      try {\n        setLoading(true);\n        setError(null);\n        \n        const params: any = {};\n        \n        // Untersttze selectedDate fr Rckwrtskompatibilitt\n        if (selectedDate) {\n          params.date = selectedDate;\n        } else {\n          // Standard: Diese Woche, wenn kein selectedDate vorhanden\n          params.period = 'week';\n        }\n        \n        // Filter-Bedingungen als JSON-String senden\n        if (selectedFilterId) {\n          params.filterId = selectedFilterId;\n        } else if (filterConditions.length > 0) {\n          params.filterConditions = JSON.stringify({\n            conditions: filterConditions,\n            operators: filterLogicalOperators\n          });\n        }\n        \n        const response = await axiosInstance.get(API_ENDPOINTS.TEAM_WORKTIME.ANALYTICS.REQUESTS_CHRONOLOGICAL, {\n          params,\n          signal: abortController.signal\n        });\n        \n        setRequests(response.data || []);\n      } catch (error: any) {\n        // Axios verwendet \"CanceledError\"/code \"ERR_CANCELED\" bei Abbruch ber AbortController\n        if (error?.name === 'AbortError' || error?.name === 'CanceledError' || error?.code === 'ERR_CANCELED') {\n          return;\n        }\n        console.error('Error loading requests:', error);\n        setError(t('analytics.request.loadError'));\n      } finally {\n        if (!abortController.signal.aborted) {\n          setLoading(false);\n        }\n      }\n    };\n\n    fetchRequests();\n    \n    //  PHASE 8: Memory Leak Prevention - Cleanup\n    return () => {\n      abortController.abort();\n    };\n  }, [selectedDate, filterConditionsKey, filterOperatorsKey, selectedFilterId, t]);\n\n  // Filter-Handler\n  const applyFilterConditions = useCallback((conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n    setIsFilterPanelOpen(false);\n  }, []);\n\n  const resetFilterConditions = useCallback(() => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n    setActiveFilterName('');\n    setSelectedFilterId(null);\n  }, []);\n\n  const handleFilterChange = useCallback(async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  }, [applyFilterConditions]);\n  \n  //  STANDARD: Filter-Laden und Default-Filter-Anwendung\n  const filterContext = useFilterContext();\n  const { loadFilters } = filterContext;\n  \n  useEffect(() => {\n    const initialize = async () => {\n      if (!user) return; // Warten auf User\n      \n      // 1. Filter laden (wartet auf State-Update)\n      const filters = await loadFilters(REQUEST_ANALYTICS_TABLE_ID);\n      \n      // 2. Default-Filter anwenden: Filter fr aktuellen Benutzer\n      // Filter-Name = `${user.firstName} ${user.lastName}` oder `user.username`\n      const userFilterName = `${user.firstName} ${user.lastName}`.trim() || user.username;\n      const defaultFilter = filters.find(f => f.name === userFilterName) || filters.find(f => f.name === 'Alle');\n      \n      if (defaultFilter) {\n        await handleFilterChange(\n          defaultFilter.name,\n          defaultFilter.id,\n          defaultFilter.conditions,\n          defaultFilter.operators\n        );\n        return; // Filter wird angewendet (fetchRequests wird durch filterConditions-nderung ausgelst)\n      }\n      \n      // 3. Fallback: Kein Filter (sollte nie passieren)\n      // fetchRequests wird automatisch durch filterConditions-nderung aufgerufen\n    };\n    \n    if (user) {\n    initialize();\n    }\n  }, [loadFilters, handleFilterChange, user]);\n\n  const getActiveFilterCount = useCallback(() => {\n    return filterConditions.filter(c => c.column !== '' && c.value !== null).length;\n  }, [filterConditions]);\n\n  // Status-Funktionen\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'approved':\n        return 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400';\n      case 'approval':\n        return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400';\n      case 'denied':\n        return 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400';\n      case 'to_improve':\n        return 'bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400';\n      default:\n        return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\n    }\n  };\n\n  const getStatusLabel = (status: string) => {\n    const labels: Record<string, string> = {\n      approved: t('analytics.request.status.approved'),\n      approval: t('analytics.request.status.approval'),\n      denied: t('analytics.request.status.denied'),\n      to_improve: t('analytics.request.status.to_improve')\n    };\n    return labels[status] || status;\n  };\n\n  // Gefilterte und durchsuchte Requests\n  const filteredRequests = useMemo(() => {\n    let filtered = [...requests];\n\n    // Textsuche\n    if (searchTerm) {\n      const searchLower = searchTerm.toLowerCase();\n      filtered = filtered.filter(request =>\n        request.title.toLowerCase().includes(searchLower) ||\n        request.branch.name.toLowerCase().includes(searchLower) ||\n        `${request.requester.firstName} ${request.requester.lastName}`.toLowerCase().includes(searchLower) ||\n        `${request.responsible.firstName} ${request.responsible.lastName}`.toLowerCase().includes(searchLower)\n      );\n    }\n\n    // Filter-Bedingungen (Frontend-Filterung fr Spalten, die Backend nicht untersttzt)\n    filterConditions.forEach((condition) => {\n      if (condition.column === '' || condition.value === null) return;\n      \n      const operator = condition.operator || 'equals';\n      const value = condition.value;\n\n      filtered = filtered.filter(request => {\n        switch (condition.column) {\n          case 'status':\n            if (operator === 'equals') {\n              return request.status === value;\n            }\n            return true;\n          case 'title':\n            if (operator === 'contains') {\n              return request.title.toLowerCase().includes(String(value).toLowerCase());\n            }\n            return true;\n          default:\n            return true;\n        }\n      });\n    });\n\n    return filtered;\n  }, [requests, searchTerm, filterConditions]);\n\n  // Statistiken\n  const stats = useMemo(() => ({\n    total: filteredRequests.length,\n    approved: filteredRequests.filter(r => r.status === 'approved').length,\n    pending: filteredRequests.filter(r => r.status === 'approval').length,\n    denied: filteredRequests.filter(r => r.status === 'denied').length,\n    toImprove: filteredRequests.filter(r => r.status === 'to_improve').length\n  }), [filteredRequests]);\n\n  if (error) {\n    return (\n      <div className=\"bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 px-4 py-3 rounded\">\n        {error}\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 request-analytics-wrapper\">\n      {/* Titelzeile */}\n      <div className=\"flex items-center justify-between mb-4 px-3 sm:px-4 md:px-6\">\n        {/* Linke Seite: Titel mit Icon */}\n        <div className=\"flex items-center\">\n          <DocumentTextIcon className=\"h-6 w-6 mr-2 dark:text-white\" />\n          <h2 className=\"text-xl font-semibold dark:text-white\">{t('analytics.request.title')}</h2>\n        </div>\n        \n        {/* Rechte Seite: Suchfeld, View-Mode Toggle, Filter-Button */}\n        <div className=\"flex items-center gap-1.5\">\n          <input\n            type=\"text\"\n            placeholder={t('common.searchPlaceholder')}\n            className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n          \n          {/* View-Mode Toggle */}\n          <button\n            className={`p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ${\n              viewMode === 'cards' ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : ''\n            }`}\n            onClick={() => {\n              const newMode = viewMode === 'table' ? 'cards' : 'table';\n              setViewMode(newMode);\n              if (updateViewMode) {\n                updateViewMode(newMode);\n              }\n            }}\n            title={viewMode === 'table' ? t('common.viewAsCards') : t('common.viewAsTable')}\n          >\n            {viewMode === 'table' ? (\n              <Squares2X2Icon className=\"h-5 w-5\" />\n            ) : (\n              <TableCellsIcon className=\"h-5 w-5\" />\n            )}\n          </button>\n          \n          {/* Filter-Button */}\n          <button\n            className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'hover:bg-gray-100 dark:hover:bg-gray-700'} ml-1 relative`}\n            onClick={() => setIsFilterPanelOpen(!isFilterPanelOpen)}\n            title={t('common.filter')}\n            style={{ position: 'relative' }}\n          >\n            <FunnelIcon className=\"h-5 w-5\" />\n            {getActiveFilterCount() > 0 && (\n              <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center z-10\">\n                {getActiveFilterCount()}\n              </span>\n            )}\n          </button>\n        </div>\n      </div>\n\n      {/* Filter-Pane */}\n      {isFilterPanelOpen && (\n        <div className={viewMode === 'cards' ? '-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6' : 'px-3 sm:px-4 md:px-6'}>\n          <FilterPane\n          columns={availableColumns}\n          onApply={applyFilterConditions}\n          onReset={resetFilterConditions}\n          savedConditions={filterConditions}\n          savedOperators={filterLogicalOperators}\n          tableId={REQUEST_ANALYTICS_TABLE_ID}\n        />\n        </div>\n      )}\n      \n      {/* Gespeicherte Filter als Tags */}\n      <div className={viewMode === 'cards' ? '-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6' : 'px-3 sm:px-4 md:px-6'}>\n        <SavedFilterTags\n        tableId={REQUEST_ANALYTICS_TABLE_ID}\n        onSelectFilter={applyFilterConditions}\n        onReset={resetFilterConditions}\n        activeFilterName={activeFilterName}\n        selectedFilterId={selectedFilterId}\n        onFilterChange={handleFilterChange}\n        defaultFilterName=\"Alle\" //  FIX: Hardcodiert (konsistent mit DB)\n      />\n      </div>\n\n      {/* Statistiken */}\n      <div className=\"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6\">\n        <div className=\"bg-white dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600\">\n          <div className=\"text-sm text-gray-500 dark:text-gray-400\">{t('analytics.request.stats.total')}</div>\n          <div className=\"text-2xl font-bold text-gray-900 dark:text-white\">{stats.total}</div>\n        </div>\n        <div className=\"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-green-200 dark:border-green-800\">\n          <div className=\"text-sm text-green-600 dark:text-green-400\">{t('analytics.request.status.approved')}</div>\n          <div className=\"text-2xl font-bold text-green-700 dark:text-green-300\">{stats.approved}</div>\n        </div>\n        <div className=\"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 border border-yellow-200 dark:border-yellow-800\">\n          <div className=\"text-sm text-yellow-600 dark:text-yellow-400\">{t('analytics.request.status.approval')}</div>\n          <div className=\"text-2xl font-bold text-yellow-700 dark:text-yellow-300\">{stats.pending}</div>\n        </div>\n        <div className=\"bg-red-50 dark:bg-red-900/20 rounded-lg p-4 border border-red-200 dark:border-red-800\">\n          <div className=\"text-sm text-red-600 dark:text-red-400\">{t('analytics.request.status.denied')}</div>\n          <div className=\"text-2xl font-bold text-red-700 dark:text-red-300\">{stats.denied}</div>\n        </div>\n        <div className=\"bg-orange-50 dark:bg-orange-900/20 rounded-lg p-4 border border-orange-200 dark:border-orange-800\">\n          <div className=\"text-sm text-orange-600 dark:text-orange-400\">{t('analytics.request.status.to_improve')}</div>\n          <div className=\"text-2xl font-bold text-orange-700 dark:text-orange-300\">{stats.toImprove}</div>\n        </div>\n      </div>\n\n      {/* Content: Tabelle oder Cards */}\n      {loading ? (\n        <div className=\"flex items-center justify-center py-8\">\n          <div className=\"text-gray-500 dark:text-gray-400\">{t('analytics.request.loading')}</div>\n        </div>\n      ) : viewMode === 'table' ? (\n        /* Tabellen-Ansicht */\n        <div className=\"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6\">\n          <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n            <thead className=\"bg-gray-50 dark:bg-gray-800\">\n              <tr>\n                {columnOrder.filter(id => visibleColumnIds.includes(id)).map((columnId) => {\n                  const column = availableColumns.find(c => c.id === columnId);\n                  return column ? (\n                    <th\n                      key={columnId}\n                      className=\"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\"\n                    >\n                      {column.label}\n                    </th>\n                  ) : null;\n                })}\n              </tr>\n            </thead>\n            <tbody className=\"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800\">\n              {filteredRequests.length === 0 ? (\n                <tr>\n                  <td colSpan={columnOrder.filter(id => visibleColumnIds.includes(id)).length} className=\"px-3 sm:px-4 md:px-6 py-4 text-center text-gray-500 dark:text-gray-400\">\n                    {t('analytics.request.noRequestsForDate')}\n                  </td>\n                </tr>\n              ) : (\n                filteredRequests.map((request) => {\n                  const isExpanded = expandedRequests.has(request.id);\n                  const hasStatusHistory = request.statusHistory && request.statusHistory.length > 0;\n                  \n                  return (\n                    <React.Fragment key={request.id}>\n                      <tr className=\"hover:bg-gray-50 dark:hover:bg-gray-800\">\n                    {columnOrder.filter(id => visibleColumnIds.includes(id)).map((columnId) => {\n                      switch (columnId) {\n                        case 'time':\n                          return (\n                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                              {format(new Date(request.createdAt), 'HH:mm')}\n                            </td>\n                          );\n                        case 'title':\n                          return (\n                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 text-sm font-medium text-gray-900 dark:text-white\">\n                                  <div className=\"flex items-center gap-2\">\n                                    {hasStatusHistory && (\n                                      <div className=\"relative group\">\n                                        <button\n                                          onClick={() => toggleRequestExpand(request.id)}\n                                          className=\"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300\"\n                                        >\n                                          {isExpanded ? (\n                                            <ChevronUpIcon className=\"h-4 w-4\" />\n                                          ) : (\n                                            <ChevronDownIcon className=\"h-4 w-4\" />\n                                          )}\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                          Status-Historie anzeigen\n                                        </div>\n                                      </div>\n                                    )}\n                                    <span>{request.title}</span>\n                                  </div>\n                            </td>\n                          );\n                        case 'status':\n                          return (\n                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                              <span className={`px-2 py-1 text-xs font-semibold rounded-full ${getStatusColor(request.status)}`}>\n                                {getStatusLabel(request.status)}\n                              </span>\n                            </td>\n                          );\n                        case 'requester':\n                          return (\n                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                              {request.requester.firstName} {request.requester.lastName}\n                            </td>\n                          );\n                        case 'responsible':\n                          return (\n                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                              {request.responsible.firstName} {request.responsible.lastName}\n                            </td>\n                          );\n                        case 'branch':\n                          return (\n                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                              {request.branch.name}\n                            </td>\n                          );\n                            case 'deletedAt':\n                              return (\n                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400\">\n                                  {request.deletedAt ? (\n                                    <div className=\"flex items-center gap-2\">\n                                      <TrashIcon className=\"h-4 w-4 text-red-500\" />\n                                      <span>{format(new Date(request.deletedAt), 'dd.MM.yyyy HH:mm')}</span>\n                                      {request.deletedBy && (\n                                        <span className=\"text-gray-400\">\n                                          ({request.deletedBy.firstName} {request.deletedBy.lastName})\n                                        </span>\n                                      )}\n                                    </div>\n                                  ) : (\n                                    '-'\n                                  )}\n                                </td>\n                              );\n                        default:\n                          return null;\n                      }\n                    })}\n                  </tr>\n                      {/* Status-Historie Zeile */}\n                      {isExpanded && hasStatusHistory && (\n                        <tr className=\"bg-gray-50 dark:bg-gray-800/50\">\n                          <td colSpan={columnOrder.filter(id => visibleColumnIds.includes(id)).length} className=\"px-3 sm:px-4 md:px-6 py-4\">\n                            <div className=\"ml-4 border-l-2 border-blue-200 dark:border-blue-700 pl-4\">\n                              <h4 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2\">\n                                <ArrowPathIcon className=\"h-4 w-4\" />\n                                Status-Wechsel\n                              </h4>\n                              <div className=\"space-y-2\">\n                                {request.statusHistory!.map((historyItem) => (\n                                  <div key={historyItem.id} className=\"flex items-center gap-3 text-xs text-gray-600 dark:text-gray-400\">\n                                    <span className=\"font-medium\">\n                                      {format(new Date(historyItem.changedAt), 'HH:mm:ss')}\n                                    </span>\n                                    <span className=\"text-gray-400\"></span>\n                                    <span className={`px-2 py-1 rounded-full ${getStatusColor(historyItem.oldStatus || 'approval')}`}>\n                                      {getStatusLabel(historyItem.oldStatus || 'approval')}\n                                    </span>\n                                    <span className=\"text-gray-400\"></span>\n                                    <span className={`px-2 py-1 rounded-full ${getStatusColor(historyItem.newStatus)}`}>\n                                      {getStatusLabel(historyItem.newStatus)}\n                                    </span>\n                                    <span className=\"text-gray-400\">von</span>\n                                    <span className=\"font-medium\">\n                                      {historyItem.user.firstName} {historyItem.user.lastName}\n                                    </span>\n                                  </div>\n                                ))}\n                              </div>\n                            </div>\n                          </td>\n                        </tr>\n                      )}\n                    </React.Fragment>\n                  );\n                })\n              )}\n            </tbody>\n          </table>\n        </div>\n      ) : (\n        /* Card-Ansicht */\n        <div className=\"-mx-3 sm:-mx-4 md:-mx-6\">\n          {filteredRequests.length === 0 ? (\n            <div className=\"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400\">\n              <DocumentTextIcon className=\"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500\" />\n              <div className=\"text-sm\">{t('analytics.request.noRequests')}</div>\n            </div>\n          ) : (\n            <CardGrid>\n              {filteredRequests.map(request => {\n                const metadata: MetadataItem[] = [];\n                \n                // Links: Niederlassung\n                if (visibleColumnIds.includes('branch')) {\n                  metadata.push({\n                    icon: <BuildingOfficeIcon className=\"h-4 w-4\" />,\n                    label: t('analytics.request.metadata.branch'),\n                    value: request.branch.name,\n                    section: 'left'\n                  });\n                }\n                \n                // Haupt-Metadaten: Antragsteller & Verantwortlich\n                if (visibleColumnIds.includes('requester')) {\n                  metadata.push({\n                    icon: <UserIcon className=\"h-4 w-4\" />,\n                    label: t('analytics.request.metadata.requester'),\n                    value: `${request.requester.firstName} ${request.requester.lastName}`,\n                    section: 'main'\n                  });\n                }\n                \n                if (visibleColumnIds.includes('responsible')) {\n                  metadata.push({\n                    icon: <UserIcon className=\"h-4 w-4\" />,\n                    label: t('analytics.request.metadata.responsible'),\n                    value: `${request.responsible.firstName} ${request.responsible.lastName}`,\n                    section: 'main'\n                  });\n                }\n                \n                // Rechts: Zeit\n                if (visibleColumnIds.includes('time')) {\n                  metadata.push({\n                    icon: <ClockIcon className=\"h-4 w-4\" />,\n                    label: t('analytics.request.metadata.time'),\n                    value: format(new Date(request.createdAt), 'HH:mm'),\n                    section: 'right'\n                  });\n                }\n\n                return (\n                  <DataCard\n                    key={request.id}\n                    title={\n                      <span>\n                        <span className=\"text-xs text-gray-600 dark:text-gray-400\">{request.id}:</span>{' '}\n                        <span>{request.title}</span>\n                      </span>\n                    }\n                    status={{\n                      label: getStatusLabel(request.status),\n                      color: getStatusColor(request.status)\n                    }}\n                    metadata={metadata}\n                  />\n                );\n              })}\n            </CardGrid>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default RequestAnalyticsTab;\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport axiosInstance from '../../config/axios.ts';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../../config/api.ts';\r\nimport { useAuth } from '../../hooks/useAuth.tsx';\r\nimport { logger } from '../../utils/logger.ts';\r\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\r\nimport { format } from 'date-fns';\r\n\r\ninterface ShiftTemplate {\r\n  id: number;\r\n  name: string;\r\n  startTime: string;\r\n  endTime: string;\r\n  branchId: number;\r\n  roleId: number;\r\n  isActive: boolean;\r\n  branch?: {\r\n    id: number;\r\n    name: string;\r\n  };\r\n  role?: {\r\n    id: number;\r\n    name: string;\r\n  };\r\n}\r\n\r\ninterface User {\r\n  id: number;\r\n  firstName: string;\r\n  lastName: string;\r\n}\r\n\r\ninterface Role {\r\n  id: number;\r\n  name: string;\r\n}\r\n\r\ninterface Branch {\r\n  id: number;\r\n  name: string;\r\n}\r\n\r\ninterface CreateShiftModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onShiftCreated: (newShift: any) => void;\r\n  initialDate?: Date;\r\n  initialBranchId?: number;\r\n  initialRoleId?: number;\r\n}\r\n\r\nconst CreateShiftModal = ({ \r\n  isOpen, \r\n  onClose, \r\n  onShiftCreated,\r\n  initialDate,\r\n  initialBranchId,\r\n  initialRoleId\r\n}: CreateShiftModalProps) => {\r\n  const { t } = useTranslation();\r\n  const { user } = useAuth();\r\n  const { openSidepane, closeSidepane } = useSidepane();\r\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\r\n  \r\n  const [shiftTemplateId, setShiftTemplateId] = useState<number | ''>('');\r\n  const [branchId, setBranchId] = useState<number | ''>(initialBranchId || '');\r\n  const [roleId, setRoleId] = useState<number | ''>(initialRoleId || '');\r\n  const [userId, setUserId] = useState<number | ''>('');\r\n  const [date, setDate] = useState(initialDate ? format(initialDate, 'yyyy-MM-dd') : format(new Date(), 'yyyy-MM-dd'));\r\n  const [notes, setNotes] = useState('');\r\n  \r\n  const [templates, setTemplates] = useState<ShiftTemplate[]>([]);\r\n  const [users, setUsers] = useState<User[]>([]);\r\n  const [roles, setRoles] = useState<Role[]>([]);\r\n  const [branches, setBranches] = useState<Branch[]>([]);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [loadingData, setLoadingData] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const checkScreenSize = () => {\r\n      setIsMobile(window.innerWidth < 640);\r\n      setIsLargeScreen(window.innerWidth > 1070);\r\n    };\r\n    \r\n    checkScreenSize();\r\n    window.addEventListener('resize', checkScreenSize);\r\n    \r\n    return () => {\r\n      window.removeEventListener('resize', checkScreenSize);\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      openSidepane();\r\n      fetchData();\r\n    } else {\r\n      closeSidepane();\r\n    }\r\n    \r\n    return () => {\r\n      closeSidepane();\r\n    };\r\n  }, [isOpen, openSidepane, closeSidepane]);\r\n\r\n  // Lade Templates neu, wenn Branch oder Rolle gendert wird\r\n  useEffect(() => {\r\n    if (isOpen && branchId && roleId) {\r\n      fetchTemplates();\r\n    }\r\n  }, [isOpen, branchId, roleId]);\r\n\r\n  // Setze erste Branch/Role, wenn geladen\r\n  useEffect(() => {\r\n    if (branches.length > 0 && branchId === '') {\r\n      const defaultBranch = initialBranchId \r\n        ? branches.find(b => b.id === initialBranchId) || branches[0]\r\n        : branches[0];\r\n      setBranchId(defaultBranch.id);\r\n    }\r\n  }, [branches, branchId, initialBranchId]);\r\n\r\n  useEffect(() => {\r\n    if (roles.length > 0 && roleId === '') {\r\n      const defaultRole = initialRoleId\r\n        ? roles.find(r => r.id === initialRoleId) || roles[0]\r\n        : roles[0];\r\n      setRoleId(defaultRole.id);\r\n    }\r\n  }, [roles, roleId, initialRoleId]);\r\n\r\n  const fetchData = async () => {\r\n    setLoadingData(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        setError('Nicht authentifiziert');\r\n        setLoadingData(false);\r\n        return;\r\n      }\r\n\r\n      const [branchesResponse, rolesResponse, usersResponse] = await Promise.all([\r\n        axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE),\r\n        axiosInstance.get(API_ENDPOINTS.ROLES.BASE),\r\n        axiosInstance.get(API_ENDPOINTS.USERS.DROPDOWN)\r\n      ]);\r\n\r\n      setBranches(branchesResponse.data || []);\r\n      setRoles(rolesResponse.data || []);\r\n      setUsers(usersResponse.data || []);\r\n\r\n      // Lade Templates, wenn Branch und Role bereits gesetzt sind\r\n      if (branchId && roleId) {\r\n        await fetchTemplates();\r\n      }\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Laden der Daten:', err);\r\n      setError(err.response?.data?.message || err.message || t('teamWorktime.shifts.modal.errors.loadDataError'));\r\n    } finally {\r\n      setLoadingData(false);\r\n    }\r\n  };\r\n\r\n  const fetchTemplates = async () => {\r\n    if (!branchId || !roleId) return;\r\n\r\n    try {\r\n      setError(null);\r\n      const response = await axiosInstance.get(API_ENDPOINTS.SHIFTS.TEMPLATES.BASE, {\r\n        params: {\r\n          branchId: Number(branchId),\r\n          roleId: Number(roleId),\r\n          includeInactive: false\r\n        }\r\n      });\r\n\r\n      const templatesData = response.data.data || response.data || [];\r\n      setTemplates(templatesData);\r\n\r\n      // Setze erstes Template, wenn nur eins vorhanden\r\n      if (templatesData.length === 1 && !shiftTemplateId) {\r\n        setShiftTemplateId(templatesData[0].id);\r\n      }\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Laden der Templates:', err);\r\n      setError(err.response?.data?.message || err.message || t('teamWorktime.shifts.modal.errors.loadTemplatesError'));\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError(null);\r\n    setLoading(true);\r\n\r\n    try {\r\n      // Validierung\r\n      if (!shiftTemplateId || !branchId || !roleId || !date) {\r\n        setError(t('teamWorktime.shifts.modal.errors.fillRequiredFields'));\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        setError('Nicht authentifiziert');\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      const shiftData: any = {\r\n        shiftTemplateId: Number(shiftTemplateId),\r\n        branchId: Number(branchId),\r\n        roleId: Number(roleId),\r\n        date: date,\r\n        notes: notes || null\r\n      };\r\n\r\n      // User optional hinzufgen\r\n      if (userId) {\r\n        shiftData.userId = Number(userId);\r\n      }\r\n\r\n      const response = await axiosInstance.post(API_ENDPOINTS.SHIFTS.BASE, shiftData);\r\n\r\n      logger.log('Schicht erfolgreich erstellt:', response.data);\r\n      onShiftCreated(response.data.data || response.data);\r\n      handleClose();\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Erstellen der Schicht:', err);\r\n      const errorMessage = err.response?.data?.message || err.message || t('teamWorktime.shifts.modal.errors.createError');\r\n      setError(errorMessage);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setError(null);\r\n    setShiftTemplateId('');\r\n    setBranchId(initialBranchId || '');\r\n    setRoleId(initialRoleId || '');\r\n    setUserId('');\r\n    setDate(initialDate ? format(initialDate, 'yyyy-MM-dd') : format(new Date(), 'yyyy-MM-dd'));\r\n    setNotes('');\r\n    onClose();\r\n  };\r\n\r\n  const selectedTemplate = templates.find(t => t.id === Number(shiftTemplateId));\r\n\r\n  // Mobile (unter 640px) - Modal\r\n  if (isMobile) {\r\n    return (\r\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\r\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n        \r\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n          <Dialog.Panel className=\"mx-auto max-w-sm w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden\">\r\n            {/* Header */}\r\n            <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\r\n                  {t('teamWorktime.shifts.modal.create.title')}\r\n                </Dialog.Title>\r\n                <button\r\n                  onClick={handleClose}\r\n                  className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n                >\r\n                  <XMarkIcon className=\"h-6 w-6\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Form */}\r\n            <form onSubmit={handleSubmit} className=\"flex flex-col flex-1 min-h-0\">\r\n              <div className=\"p-6 overflow-y-auto flex-1 min-h-0\">\r\n                {error && (\r\n                  <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded\">\r\n                    {error}\r\n                  </div>\r\n                )}\r\n\r\n                {loadingData ? (\r\n                  <div className=\"text-center py-8 text-gray-600 dark:text-gray-400\">\r\n                    {t('common.loading')}\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"space-y-4\">\r\n                    {/* Branch */}\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                        {t('teamWorktime.shifts.modal.create.branch')} *\r\n                      </label>\r\n                      <select\r\n                        value={branchId}\r\n                        onChange={(e) => {\r\n                          setBranchId(Number(e.target.value));\r\n                          setShiftTemplateId(''); // Reset Template bei Branch-nderung\r\n                        }}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                        required\r\n                      >\r\n                        <option value=\"\">{t('teamWorktime.shifts.modal.create.selectBranch')}</option>\r\n                        {branches.map((branch) => (\r\n                          <option key={branch.id} value={branch.id}>\r\n                            {branch.name}\r\n                          </option>\r\n                        ))}\r\n                      </select>\r\n                    </div>\r\n\r\n                    {/* Role */}\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                        {t('teamWorktime.shifts.modal.create.role')} *\r\n                      </label>\r\n                      <select\r\n                        value={roleId}\r\n                        onChange={(e) => {\r\n                          setRoleId(Number(e.target.value));\r\n                          setShiftTemplateId(''); // Reset Template bei Role-nderung\r\n                        }}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                        required\r\n                      >\r\n                        <option value=\"\">{t('teamWorktime.shifts.modal.create.selectRole')}</option>\r\n                        {roles.map((role) => (\r\n                          <option key={role.id} value={role.id}>\r\n                            {role.name}\r\n                          </option>\r\n                        ))}\r\n                      </select>\r\n                    </div>\r\n\r\n                    {/* Template */}\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                        {t('teamWorktime.shifts.modal.create.template')} *\r\n                      </label>\r\n                      <select\r\n                        value={shiftTemplateId}\r\n                        onChange={(e) => setShiftTemplateId(Number(e.target.value))}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                        required\r\n                        disabled={!branchId || !roleId}\r\n                      >\r\n                        <option value=\"\">{t('teamWorktime.shifts.modal.create.selectTemplate')}</option>\r\n                        {templates.map((template) => (\r\n                          <option key={template.id} value={template.id}>\r\n                            {template.name} ({template.startTime} - {template.endTime})\r\n                          </option>\r\n                        ))}\r\n                      </select>\r\n                      {(!branchId || !roleId) && (\r\n                        <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n                          {t('teamWorktime.shifts.modal.create.selectBranchRoleFirst')}\r\n                        </p>\r\n                      )}\r\n                    </div>\r\n\r\n                    {/* Date */}\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                        {t('teamWorktime.shifts.modal.create.date')} *\r\n                      </label>\r\n                      <input\r\n                        type=\"date\"\r\n                        value={date}\r\n                        onChange={(e) => setDate(e.target.value)}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                        required\r\n                      />\r\n                    </div>\r\n\r\n                    {/* User (optional) */}\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                        {t('teamWorktime.shifts.modal.create.user')}\r\n                      </label>\r\n                      <select\r\n                        value={userId}\r\n                        onChange={(e) => setUserId(e.target.value ? Number(e.target.value) : '')}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                      >\r\n                        <option value=\"\">{t('teamWorktime.shifts.modal.create.selectUser')}</option>\r\n                        {users.map((user) => (\r\n                          <option key={user.id} value={user.id}>\r\n                            {user.firstName} {user.lastName}\r\n                          </option>\r\n                        ))}\r\n                      </select>\r\n                    </div>\r\n\r\n                    {/* Notes */}\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                        {t('teamWorktime.shifts.modal.create.notes')}\r\n                      </label>\r\n                      <textarea\r\n                        value={notes}\r\n                        onChange={(e) => setNotes(e.target.value)}\r\n                        rows={3}\r\n                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                        placeholder={t('teamWorktime.shifts.modal.create.notesPlaceholder')}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {/* Footer */}\r\n              <div className=\"px-6 py-4 border-t dark:border-gray-700 flex-shrink-0 flex justify-end gap-2\">\r\n                <div className=\"relative group\">\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={handleClose}\r\n                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\r\n                    title={t('common.cancel')}\r\n                  >\r\n                    <XMarkIcon className=\"h-5 w-5\" />\r\n                  </button>\r\n                  <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n                    {t('common.cancel')}\r\n                  </div>\r\n                </div>\r\n                <div className=\"relative group\">\r\n                  <button\r\n                    type=\"submit\"\r\n                    disabled={loading || loadingData}\r\n                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                    title={loading ? t('common.saving') : t('common.save')}\r\n                  >\r\n                    {loading ? (\r\n                      <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\r\n                    ) : (\r\n                      <CheckIcon className=\"h-5 w-5\" />\r\n                    )}\r\n                  </button>\r\n                  <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n                    {loading ? t('common.saving') : t('common.save')}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </form>\r\n          </Dialog.Panel>\r\n        </div>\r\n      </Dialog>\r\n    );\r\n  }\r\n\r\n  // Desktop (ab 640px) - Sidepane\r\n  return (\r\n    <>\r\n      {/* Backdrop - nur wenn offen und <= 1070px */}\r\n      {isOpen && !isLargeScreen && (\r\n        <div \r\n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \r\n          aria-hidden=\"true\" \r\n          onClick={handleClose}\r\n          style={{\r\n            opacity: isOpen ? 1 : 0,\r\n            transition: 'opacity 300ms ease-out'\r\n          }}\r\n        />\r\n      )}\r\n      \r\n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\r\n      <div \r\n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\r\n        style={{\r\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n          pointerEvents: isOpen ? 'auto' : 'none'\r\n        }}\r\n        aria-hidden={!isOpen}\r\n        role=\"dialog\"\r\n        aria-modal={isOpen}\r\n      >\r\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n          <h2 className=\"text-lg font-semibold dark:text-white\">\r\n            {t('teamWorktime.shifts.modal.create.title')}\r\n          </h2>\r\n          <button\r\n            onClick={handleClose}\r\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n          >\r\n            <XMarkIcon className=\"h-6 w-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit} className=\"flex flex-col flex-1 min-h-0\">\r\n          <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\r\n            {error && (\r\n              <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded\">\r\n                {error}\r\n              </div>\r\n            )}\r\n\r\n            {loadingData ? (\r\n              <div className=\"text-center py-8 text-gray-600 dark:text-gray-400\">\r\n                {t('common.loading')}\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-4\">\r\n                {/* Branch */}\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                    {t('teamWorktime.shifts.modal.create.branch')} *\r\n                  </label>\r\n                  <select\r\n                    value={branchId}\r\n                    onChange={(e) => {\r\n                      setBranchId(Number(e.target.value));\r\n                      setShiftTemplateId(''); // Reset Template bei Branch-nderung\r\n                    }}\r\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    required\r\n                  >\r\n                    <option value=\"\">{t('teamWorktime.shifts.modal.create.selectBranch')}</option>\r\n                    {branches.map((branch) => (\r\n                      <option key={branch.id} value={branch.id}>\r\n                        {branch.name}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                </div>\r\n\r\n                {/* Role */}\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                    {t('teamWorktime.shifts.modal.create.role')} *\r\n                  </label>\r\n                  <select\r\n                    value={roleId}\r\n                    onChange={(e) => {\r\n                      setRoleId(Number(e.target.value));\r\n                      setShiftTemplateId(''); // Reset Template bei Role-nderung\r\n                    }}\r\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    required\r\n                  >\r\n                    <option value=\"\">{t('teamWorktime.shifts.modal.create.selectRole')}</option>\r\n                    {roles.map((role) => (\r\n                      <option key={role.id} value={role.id}>\r\n                        {role.name}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                </div>\r\n\r\n                {/* Template */}\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                    {t('teamWorktime.shifts.modal.create.template')} *\r\n                  </label>\r\n                  <select\r\n                    value={shiftTemplateId}\r\n                    onChange={(e) => setShiftTemplateId(Number(e.target.value))}\r\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    required\r\n                    disabled={!branchId || !roleId}\r\n                  >\r\n                    <option value=\"\">{t('teamWorktime.shifts.modal.create.selectTemplate')}</option>\r\n                    {templates.map((template) => (\r\n                      <option key={template.id} value={template.id}>\r\n                        {template.name} ({template.startTime} - {template.endTime})\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                  {(!branchId || !roleId) && (\r\n                    <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n                      {t('teamWorktime.shifts.modal.create.selectBranchRoleFirst')}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Date */}\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                    {t('teamWorktime.shifts.modal.create.date')} *\r\n                  </label>\r\n                  <input\r\n                    type=\"date\"\r\n                    value={date}\r\n                    onChange={(e) => setDate(e.target.value)}\r\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    required\r\n                  />\r\n                </div>\r\n\r\n                {/* User (optional) */}\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                    {t('teamWorktime.shifts.modal.create.user')}\r\n                  </label>\r\n                  <select\r\n                    value={userId}\r\n                    onChange={(e) => setUserId(e.target.value ? Number(e.target.value) : '')}\r\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                  >\r\n                    <option value=\"\">{t('teamWorktime.shifts.modal.create.selectUser')}</option>\r\n                    {users.map((user) => (\r\n                      <option key={user.id} value={user.id}>\r\n                        {user.firstName} {user.lastName}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                </div>\r\n\r\n                {/* Notes */}\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                    {t('teamWorktime.shifts.modal.create.notes')}\r\n                  </label>\r\n                  <textarea\r\n                    value={notes}\r\n                    onChange={(e) => setNotes(e.target.value)}\r\n                    rows={3}\r\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                    placeholder={t('teamWorktime.shifts.modal.create.notesPlaceholder')}\r\n                  />\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Footer */}\r\n          <div className=\"p-4 border-t dark:border-gray-700 flex-shrink-0 flex justify-end gap-2\">\r\n            <div className=\"relative group\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleClose}\r\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\r\n                title={t('common.cancel')}\r\n              >\r\n                <XMarkIcon className=\"h-5 w-5\" />\r\n              </button>\r\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n                {t('common.cancel')}\r\n              </div>\r\n            </div>\r\n            <div className=\"relative group\">\r\n              <button\r\n                type=\"submit\"\r\n                disabled={loading || loadingData}\r\n                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                title={loading ? t('common.saving') : t('common.save')}\r\n              >\r\n                {loading ? (\r\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\r\n                ) : (\r\n                  <CheckIcon className=\"h-5 w-5\" />\r\n                )}\r\n              </button>\r\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n                {loading ? t('common.saving') : t('common.save')}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default CreateShiftModal;\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport axiosInstance from '../../config/axios.ts';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../../config/api.ts';\r\nimport { useAuth } from '../../hooks/useAuth.tsx';\r\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\r\nimport { format } from 'date-fns';\r\n\r\ninterface Shift {\r\n  id: number;\r\n  date: string;\r\n  startTime: string;\r\n  endTime: string;\r\n  status: 'scheduled' | 'confirmed' | 'cancelled' | 'swapped';\r\n  shiftTemplate?: {\r\n    id: number;\r\n    name: string;\r\n    startTime: string;\r\n    endTime: string;\r\n  };\r\n  branch?: {\r\n    id: number;\r\n    name: string;\r\n  };\r\n  role?: {\r\n    id: number;\r\n    name: string;\r\n  };\r\n  user?: {\r\n    id: number;\r\n    firstName: string;\r\n    lastName: string;\r\n  };\r\n}\r\n\r\ninterface SwapRequestModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onSwapRequestCreated: () => void;\r\n  originalShift: Shift;\r\n}\r\n\r\nconst SwapRequestModal = ({ \r\n  isOpen, \r\n  onClose, \r\n  onSwapRequestCreated,\r\n  originalShift\r\n}: SwapRequestModalProps) => {\r\n  const { t } = useTranslation();\r\n  const { user } = useAuth();\r\n  const { openSidepane, closeSidepane } = useSidepane();\r\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\r\n  \r\n  const [targetShiftId, setTargetShiftId] = useState<number | ''>('');\r\n  const [message, setMessage] = useState('');\r\n  const [availableShifts, setAvailableShifts] = useState<Shift[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [loadingShifts, setLoadingShifts] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [submitting, setSubmitting] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const checkScreenSize = () => {\r\n      setIsMobile(window.innerWidth < 640);\r\n      setIsLargeScreen(window.innerWidth > 1070);\r\n    };\r\n    \r\n    checkScreenSize();\r\n    window.addEventListener('resize', checkScreenSize);\r\n    \r\n    return () => {\r\n      window.removeEventListener('resize', checkScreenSize);\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      openSidepane();\r\n      fetchAvailableShifts();\r\n    } else {\r\n      closeSidepane();\r\n      setTargetShiftId('');\r\n      setMessage('');\r\n      setError(null);\r\n    }\r\n    \r\n    return () => {\r\n      closeSidepane();\r\n    };\r\n  }, [isOpen, openSidepane, closeSidepane, originalShift]);\r\n\r\n  const fetchAvailableShifts = async () => {\r\n    if (!originalShift) return;\r\n    \r\n    setLoadingShifts(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      // Lade alle Schichten der aktuellen Woche\r\n      const weekStart = new Date(originalShift.date);\r\n      weekStart.setDate(weekStart.getDate() - weekStart.getDay() + 1); // Montag\r\n      const weekEnd = new Date(weekStart);\r\n      weekEnd.setDate(weekEnd.getDate() + 6); // Sonntag\r\n      \r\n      const response = await axiosInstance.get(API_ENDPOINTS.SHIFTS.BASE, {\r\n        params: {\r\n          startDate: format(weekStart, 'yyyy-MM-dd'),\r\n          endDate: format(weekEnd, 'yyyy-MM-dd')\r\n        }\r\n      });\r\n      \r\n      const allShifts = response.data?.data || response.data || [];\r\n      \r\n      // Filtere verfgbare Schichten:\r\n      // - Muss einen User haben\r\n      // - Nicht die eigene Schicht\r\n      // - Gleiche Rolle und Branch (optional, aber sinnvoll)\r\n      // - Status nicht cancelled oder swapped\r\n      const filtered = allShifts.filter((shift: Shift) => {\r\n        return shift.id !== originalShift.id &&\r\n               shift.userId !== null &&\r\n               shift.status !== 'cancelled' &&\r\n               shift.status !== 'swapped' &&\r\n               shift.roleId === originalShift.roleId &&\r\n               shift.branchId === originalShift.branchId;\r\n      });\r\n      \r\n      setAvailableShifts(filtered);\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Laden der verfgbaren Schichten:', err);\r\n      setError(err.response?.data?.message || err.message || t('teamWorktime.shifts.swap.errors.loadShiftsError'));\r\n    } finally {\r\n      setLoadingShifts(false);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError(null);\r\n    setSubmitting(true);\r\n\r\n    try {\r\n      if (!targetShiftId) {\r\n        setError(t('teamWorktime.shifts.swap.errors.selectTargetShift'));\r\n        setSubmitting(false);\r\n        return;\r\n      }\r\n\r\n      const response = await axiosInstance.post(API_ENDPOINTS.SHIFTS.SWAPS.BASE, {\r\n        originalShiftId: originalShift.id,\r\n        targetShiftId: Number(targetShiftId),\r\n        message: message.trim() || null\r\n      });\r\n\r\n      if (response.data && response.data.success !== false) {\r\n        onSwapRequestCreated();\r\n        onClose();\r\n      } else {\r\n        const errorMsg = response.data?.message || t('teamWorktime.shifts.swap.errors.createError');\r\n        setError(errorMsg);\r\n      }\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Erstellen der Tausch-Anfrage:', err);\r\n      const errorMessage = err.response?.data?.message || err.message || t('teamWorktime.shifts.swap.errors.createError');\r\n      setError(errorMessage);\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setError(null);\r\n    setTargetShiftId('');\r\n    setMessage('');\r\n    onClose();\r\n  };\r\n\r\n  const renderForm = () => (\r\n    <div className=\"space-y-4\">\r\n      {/* Original-Schicht Info */}\r\n      <div className=\"p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md\">\r\n        <h3 className=\"text-sm font-semibold text-blue-900 dark:text-blue-300 mb-2\">\r\n          {t('teamWorktime.shifts.swap.form.yourShift')}\r\n        </h3>\r\n        <div className=\"text-sm text-blue-800 dark:text-blue-400\">\r\n          <div>{originalShift.shiftTemplate?.name || t('teamWorktime.shifts.swap.form.shift')}</div>\r\n          <div>{format(new Date(originalShift.date), 'dd.MM.yyyy')}</div>\r\n          <div>\r\n            {format(new Date(originalShift.startTime), 'HH:mm')} - {format(new Date(originalShift.endTime), 'HH:mm')}\r\n          </div>\r\n          {originalShift.branch && (\r\n            <div>{originalShift.branch.name}</div>\r\n          )}\r\n          {originalShift.role && (\r\n            <div>{originalShift.role.name}</div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Ziel-Schicht auswhlen */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.swap.form.targetShift')} *\r\n        </label>\r\n        {loadingShifts ? (\r\n          <div className=\"p-3 bg-gray-50 dark:bg-gray-700 rounded-md text-sm text-gray-500 dark:text-gray-400\">\r\n            {t('common.loading')}\r\n          </div>\r\n        ) : availableShifts.length === 0 ? (\r\n          <div className=\"p-3 bg-gray-50 dark:bg-gray-700 rounded-md text-sm text-gray-500 dark:text-gray-400\">\r\n            {t('teamWorktime.shifts.swap.form.noShiftsAvailable')}\r\n          </div>\r\n        ) : (\r\n          <select\r\n            value={targetShiftId}\r\n            onChange={(e) => setTargetShiftId(Number(e.target.value))}\r\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            required\r\n          >\r\n            <option value=\"\">{t('teamWorktime.shifts.swap.form.selectTargetShift')}</option>\r\n            {availableShifts.map((shift) => (\r\n              <option key={shift.id} value={shift.id}>\r\n                {format(new Date(shift.date), 'dd.MM.yyyy')} - {format(new Date(shift.startTime), 'HH:mm')} - {format(new Date(shift.endTime), 'HH:mm')} \r\n                {shift.user && ` (${shift.user.firstName} ${shift.user.lastName})`}\r\n              </option>\r\n            ))}\r\n          </select>\r\n        )}\r\n      </div>\r\n\r\n      {/* Nachricht (optional) */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.swap.form.message')}\r\n        </label>\r\n        <textarea\r\n          value={message}\r\n          onChange={(e) => setMessage(e.target.value)}\r\n          rows={3}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          placeholder={t('teamWorktime.shifts.swap.form.messagePlaceholder')}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  // Mobile (unter 640px) - Modal\r\n  if (isMobile) {\r\n    return (\r\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\r\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n        \r\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n          <Dialog.Panel className=\"mx-auto max-w-sm w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden\">\r\n            {/* Header */}\r\n            <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\r\n                  {t('teamWorktime.shifts.swap.title')}\r\n                </Dialog.Title>\r\n                <button\r\n                  onClick={handleClose}\r\n                  className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n                >\r\n                  <XMarkIcon className=\"h-6 w-6\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Form */}\r\n            <form onSubmit={handleSubmit} className=\"flex flex-col flex-1 min-h-0\">\r\n              <div className=\"p-6 overflow-y-auto flex-1 min-h-0\">\r\n                {error && (\r\n                  <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded\">\r\n                    {error}\r\n                  </div>\r\n                )}\r\n\r\n                {renderForm()}\r\n              </div>\r\n\r\n              {/* Footer */}\r\n              <div className=\"px-6 py-4 border-t dark:border-gray-700 flex-shrink-0 flex justify-end gap-2\">\r\n                <div className=\"relative group\">\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={handleClose}\r\n                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\r\n                    title={t('common.cancel')}\r\n                  >\r\n                    <XMarkIcon className=\"h-5 w-5\" />\r\n                  </button>\r\n                  <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n                    {t('common.cancel')}\r\n                  </div>\r\n                </div>\r\n                <div className=\"relative group\">\r\n                  <button\r\n                    type=\"submit\"\r\n                    disabled={submitting || loadingShifts || !targetShiftId}\r\n                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                    title={submitting ? t('teamWorktime.shifts.swap.submitting') : t('teamWorktime.shifts.swap.submit')}\r\n                  >\r\n                    {submitting ? (\r\n                      <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\r\n                    ) : (\r\n                      <CheckIcon className=\"h-5 w-5\" />\r\n                    )}\r\n                  </button>\r\n                  <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n                    {submitting ? t('teamWorktime.shifts.swap.submitting') : t('teamWorktime.shifts.swap.submit')}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </form>\r\n          </Dialog.Panel>\r\n        </div>\r\n      </Dialog>\r\n    );\r\n  }\r\n\r\n  // Desktop (ab 640px) - Sidepane\r\n  return (\r\n    <>\r\n      {/* Backdrop - nur wenn offen und <= 1070px */}\r\n      {isOpen && !isLargeScreen && (\r\n        <div \r\n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \r\n          aria-hidden=\"true\" \r\n          onClick={handleClose}\r\n          style={{\r\n            opacity: isOpen ? 1 : 0,\r\n            transition: 'opacity 300ms ease-out'\r\n          }}\r\n        />\r\n      )}\r\n      \r\n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\r\n      <div \r\n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\r\n        style={{\r\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n          pointerEvents: isOpen ? 'auto' : 'none'\r\n        }}\r\n        aria-hidden={!isOpen}\r\n        role=\"dialog\"\r\n        aria-modal={isOpen}\r\n      >\r\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n          <h2 className=\"text-lg font-semibold dark:text-white\">\r\n            {t('teamWorktime.shifts.swap.title')}\r\n          </h2>\r\n          <button\r\n            onClick={handleClose}\r\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n          >\r\n            <XMarkIcon className=\"h-6 w-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit} className=\"flex flex-col flex-1 min-h-0\">\r\n          <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\r\n            {error && (\r\n              <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded\">\r\n                {error}\r\n              </div>\r\n            )}\r\n\r\n            {renderForm()}\r\n          </div>\r\n\r\n          {/* Footer */}\r\n          <div className=\"p-4 border-t dark:border-gray-700 flex-shrink-0 flex justify-end gap-2\">\r\n            <div className=\"relative group\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleClose}\r\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\r\n                title={t('common.cancel')}\r\n              >\r\n                <XMarkIcon className=\"h-5 w-5\" />\r\n              </button>\r\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n                {t('common.cancel')}\r\n              </div>\r\n            </div>\r\n            <div className=\"relative group\">\r\n              <button\r\n                type=\"submit\"\r\n                disabled={submitting || loadingShifts || !targetShiftId}\r\n                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                title={submitting ? t('teamWorktime.shifts.swap.submitting') : t('teamWorktime.shifts.swap.submit')}\r\n              >\r\n                {submitting ? (\r\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\r\n                ) : (\r\n                  <CheckIcon className=\"h-5 w-5\" />\r\n                )}\r\n              </button>\r\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n                {submitting ? t('teamWorktime.shifts.swap.submitting') : t('teamWorktime.shifts.swap.submit')}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default SwapRequestModal;\r\n\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport axiosInstance from '../../config/axios.ts';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, TrashIcon, ArrowsRightLeftIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../../config/api.ts';\r\nimport { useAuth } from '../../hooks/useAuth.tsx';\r\nimport { logger } from '../../utils/logger.ts';\r\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\r\nimport { format } from 'date-fns';\r\nimport SwapRequestModal from './SwapRequestModal.tsx';\r\n\r\ninterface Shift {\r\n  id: number;\r\n  shiftTemplateId: number;\r\n  branchId: number;\r\n  roleId: number;\r\n  userId: number | null;\r\n  date: string;\r\n  startTime: string;\r\n  endTime: string;\r\n  status: 'scheduled' | 'confirmed' | 'cancelled' | 'swapped';\r\n  notes?: string;\r\n  shiftTemplate?: {\r\n    id: number;\r\n    name: string;\r\n    startTime: string;\r\n    endTime: string;\r\n  };\r\n  branch?: {\r\n    id: number;\r\n    name: string;\r\n  };\r\n  role?: {\r\n    id: number;\r\n    name: string;\r\n  };\r\n  user?: {\r\n    id: number;\r\n    firstName: string;\r\n    lastName: string;\r\n  };\r\n}\r\n\r\ninterface ShiftTemplate {\r\n  id: number;\r\n  name: string;\r\n  startTime: string;\r\n  endTime: string;\r\n  branchId: number;\r\n  roleId: number;\r\n  isActive: boolean;\r\n}\r\n\r\ninterface User {\r\n  id: number;\r\n  firstName: string;\r\n  lastName: string;\r\n}\r\n\r\ninterface Role {\r\n  id: number;\r\n  name: string;\r\n}\r\n\r\ninterface Branch {\r\n  id: number;\r\n  name: string;\r\n}\r\n\r\ninterface EditShiftModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onShiftUpdated: (updatedShift: Shift) => void;\r\n  onShiftDeleted: (shiftId: number) => void;\r\n  shift: Shift;\r\n}\r\n\r\nconst EditShiftModal: React.FC<EditShiftModalProps> = ({ \r\n  isOpen, \r\n  onClose, \r\n  onShiftUpdated,\r\n  onShiftDeleted,\r\n  shift \r\n}) => {\r\n  const { t } = useTranslation();\r\n  const { user } = useAuth();\r\n  const { openSidepane, closeSidepane } = useSidepane();\r\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\r\n  \r\n  const [shiftTemplateId, setShiftTemplateId] = useState<number>(shift.shiftTemplateId);\r\n  const [branchId, setBranchId] = useState<number>(shift.branchId);\r\n  const [roleId, setRoleId] = useState<number>(shift.roleId);\r\n  const [userId, setUserId] = useState<number | ''>(shift.userId || '');\r\n  const [date, setDate] = useState(format(new Date(shift.date), 'yyyy-MM-dd'));\r\n  const [notes, setNotes] = useState(shift.notes || '');\r\n  const [status, setStatus] = useState<Shift['status']>(shift.status);\r\n  \r\n  const [templates, setTemplates] = useState<ShiftTemplate[]>([]);\r\n  const [users, setUsers] = useState<User[]>([]);\r\n  const [roles, setRoles] = useState<Role[]>([]);\r\n  const [branches, setBranches] = useState<Branch[]>([]);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [loadingData, setLoadingData] = useState(false);\r\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\r\n  const [isSwapModalOpen, setIsSwapModalOpen] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const checkScreenSize = () => {\r\n      setIsMobile(window.innerWidth < 640);\r\n      setIsLargeScreen(window.innerWidth > 1070);\r\n    };\r\n    \r\n    checkScreenSize();\r\n    window.addEventListener('resize', checkScreenSize);\r\n    \r\n    return () => {\r\n      window.removeEventListener('resize', checkScreenSize);\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      openSidepane();\r\n      // Setze initiale Werte\r\n      setShiftTemplateId(shift.shiftTemplateId);\r\n      setBranchId(shift.branchId);\r\n      setRoleId(shift.roleId);\r\n      setUserId(shift.userId || '');\r\n      setDate(format(new Date(shift.date), 'yyyy-MM-dd'));\r\n      setNotes(shift.notes || '');\r\n      setStatus(shift.status);\r\n      setError(null);\r\n      fetchData();\r\n    } else {\r\n      closeSidepane();\r\n      setShowDeleteConfirm(false);\r\n    }\r\n    \r\n    return () => {\r\n      closeSidepane();\r\n    };\r\n  }, [isOpen, shift, openSidepane, closeSidepane]);\r\n\r\n  // Lade Templates neu, wenn Branch oder Rolle gendert wird\r\n  useEffect(() => {\r\n    if (isOpen && branchId && roleId) {\r\n      fetchTemplates();\r\n    }\r\n  }, [isOpen, branchId, roleId]);\r\n\r\n  const fetchData = async () => {\r\n    setLoadingData(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        setError('Nicht authentifiziert');\r\n        setLoadingData(false);\r\n        return;\r\n      }\r\n\r\n      const [branchesResponse, rolesResponse, usersResponse] = await Promise.all([\r\n        axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE),\r\n        axiosInstance.get(API_ENDPOINTS.ROLES.BASE),\r\n        axiosInstance.get(API_ENDPOINTS.USERS.DROPDOWN)\r\n      ]);\r\n\r\n      setBranches(branchesResponse.data || []);\r\n      setRoles(rolesResponse.data || []);\r\n      setUsers(usersResponse.data || []);\r\n\r\n      // Lade Templates fr aktuelle Branch/Role\r\n      if (branchId && roleId) {\r\n        await fetchTemplates();\r\n      }\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Laden der Daten:', err);\r\n      setError(err.response?.data?.message || err.message || t('teamWorktime.shifts.modal.errors.loadDataError'));\r\n    } finally {\r\n      setLoadingData(false);\r\n    }\r\n  };\r\n\r\n  const fetchTemplates = async () => {\r\n    if (!branchId || !roleId) return;\r\n\r\n    try {\r\n      setError(null);\r\n      const response = await axiosInstance.get(API_ENDPOINTS.SHIFTS.TEMPLATES.BASE, {\r\n        params: {\r\n          branchId: Number(branchId),\r\n          roleId: Number(roleId),\r\n          includeInactive: true // Erlaube auch inaktive Templates fr bestehende Schichten\r\n        }\r\n      });\r\n\r\n      const templatesData = response.data.data || response.data || [];\r\n      setTemplates(templatesData);\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Laden der Templates:', err);\r\n      setError(err.response?.data?.message || err.message || t('teamWorktime.shifts.modal.errors.loadTemplatesError'));\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError(null);\r\n    setLoading(true);\r\n\r\n    try {\r\n      if (!shiftTemplateId || !branchId || !roleId || !date) {\r\n        setError(t('teamWorktime.shifts.modal.errors.fillRequiredFields'));\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        setError('Nicht authentifiziert');\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      const updateData: any = {\r\n        userId: userId ? Number(userId) : null,\r\n        date: date,\r\n        notes: notes || null,\r\n        status: status\r\n      };\r\n\r\n      const response = await axiosInstance.put(API_ENDPOINTS.SHIFTS.BY_ID(shift.id), updateData);\r\n\r\n      logger.log('Schicht erfolgreich aktualisiert:', response.data);\r\n      onShiftUpdated(response.data.data || response.data);\r\n      handleClose();\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Aktualisieren der Schicht:', err);\r\n      const errorMessage = err.response?.data?.message || err.message || t('teamWorktime.shifts.modal.errors.updateError');\r\n      setError(errorMessage);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async () => {\r\n    setError(null);\r\n    setLoading(true);\r\n\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        setError('Nicht authentifiziert');\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      await axiosInstance.delete(API_ENDPOINTS.SHIFTS.BY_ID(shift.id));\r\n\r\n      logger.log('Schicht erfolgreich gelscht');\r\n      onShiftDeleted(shift.id);\r\n      handleClose();\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Lschen der Schicht:', err);\r\n      const errorMessage = err.response?.data?.message || err.message || t('teamWorktime.shifts.modal.errors.deleteError');\r\n      setError(errorMessage);\r\n    } finally {\r\n      setLoading(false);\r\n      setShowDeleteConfirm(false);\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setError(null);\r\n    setShowDeleteConfirm(false);\r\n    onClose();\r\n  };\r\n\r\n  const renderForm = () => (\r\n    <div className=\"space-y-4\">\r\n      {/* Branch (read-only, da nicht nderbar) */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.modal.edit.branch')}\r\n        </label>\r\n        <input\r\n          type=\"text\"\r\n          value={branches.find(b => b.id === branchId)?.name || ''}\r\n          disabled\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed\"\r\n        />\r\n      </div>\r\n\r\n      {/* Role (read-only, da nicht nderbar) */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.modal.edit.role')}\r\n        </label>\r\n        <input\r\n          type=\"text\"\r\n          value={roles.find(r => r.id === roleId)?.name || ''}\r\n          disabled\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed\"\r\n        />\r\n      </div>\r\n\r\n      {/* Template (read-only, da nicht nderbar) */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.modal.edit.template')}\r\n        </label>\r\n        <input\r\n          type=\"text\"\r\n          value={shift.shiftTemplate?.name || ''}\r\n          disabled\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed\"\r\n        />\r\n      </div>\r\n\r\n      {/* Date */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.modal.edit.date')} *\r\n        </label>\r\n        <input\r\n          type=\"date\"\r\n          value={date}\r\n          onChange={(e) => setDate(e.target.value)}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          required\r\n        />\r\n      </div>\r\n\r\n      {/* User */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.modal.edit.user')}\r\n        </label>\r\n        <select\r\n          value={userId}\r\n          onChange={(e) => setUserId(e.target.value ? Number(e.target.value) : '')}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n        >\r\n          <option value=\"\">{t('teamWorktime.shifts.modal.edit.selectUser')}</option>\r\n          {users.map((user) => (\r\n            <option key={user.id} value={user.id}>\r\n              {user.firstName} {user.lastName}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      {/* Status */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.modal.edit.status')} *\r\n        </label>\r\n        <select\r\n          value={status}\r\n          onChange={(e) => setStatus(e.target.value as Shift['status'])}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          required\r\n        >\r\n          <option value=\"scheduled\">{t('teamWorktime.shifts.status.scheduled')}</option>\r\n          <option value=\"confirmed\">{t('teamWorktime.shifts.status.confirmed')}</option>\r\n          <option value=\"cancelled\">{t('teamWorktime.shifts.status.cancelled')}</option>\r\n          <option value=\"swapped\">{t('teamWorktime.shifts.status.swapped')}</option>\r\n        </select>\r\n      </div>\r\n\r\n      {/* Notes */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.modal.edit.notes')}\r\n        </label>\r\n        <textarea\r\n          value={notes}\r\n          onChange={(e) => setNotes(e.target.value)}\r\n          rows={3}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          placeholder={t('teamWorktime.shifts.modal.edit.notesPlaceholder')}\r\n        />\r\n      </div>\r\n\r\n      {/* Swap Button - nur wenn Schicht dem aktuellen User gehrt */}\r\n      {shift.userId === user?.id && shift.status !== 'cancelled' && shift.status !== 'swapped' && (\r\n        <div className=\"pt-4 border-t dark:border-gray-700\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => setIsSwapModalOpen(true)}\r\n            className=\"w-full px-4 py-2 text-sm font-medium text-blue-700 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md hover:bg-blue-100 dark:hover:bg-blue-900/30 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 flex items-center justify-center gap-2\"\r\n          >\r\n            <ArrowsRightLeftIcon className=\"h-5 w-5\" />\r\n            {t('teamWorktime.shifts.actions.swap')}\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Delete Button */}\r\n      <div className=\"pt-4 border-t dark:border-gray-700\">\r\n        <button\r\n          type=\"button\"\r\n          onClick={() => setShowDeleteConfirm(true)}\r\n          className=\"w-full p-2 text-red-700 dark:text-red-400 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md hover:bg-red-100 dark:hover:bg-red-900/30 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 flex items-center justify-center\"\r\n          title={t('teamWorktime.shifts.modal.edit.delete')}\r\n        >\r\n          <TrashIcon className=\"h-5 w-5\" />\r\n        </button>\r\n      </div>\r\n\r\n      {/* Delete Confirmation */}\r\n      {showDeleteConfirm && (\r\n        <div className=\"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md\">\r\n          <p className=\"text-sm text-red-700 dark:text-red-400 mb-3\">\r\n            {t('teamWorktime.shifts.modal.edit.deleteConfirm')}\r\n          </p>\r\n          <div className=\"flex gap-2\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleDelete}\r\n              disabled={loading}\r\n              className=\"flex-1 p-2 text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50\"\r\n              title={t('common.yes')}\r\n            >\r\n              <CheckIcon className=\"h-5 w-5\" />\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setShowDeleteConfirm(false)}\r\n              className=\"flex-1 p-2 text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600\"\r\n              title={t('common.no')}\r\n            >\r\n              <XMarkIcon className=\"h-5 w-5\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  // Mobile (unter 640px) - Modal\r\n  if (isMobile) {\r\n    return (\r\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\r\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n        \r\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n          <Dialog.Panel className=\"mx-auto max-w-sm w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden\">\r\n            {/* Header */}\r\n            <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\r\n                  {t('teamWorktime.shifts.modal.edit.title')}\r\n                </Dialog.Title>\r\n                <button\r\n                  onClick={handleClose}\r\n                  className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n                >\r\n                  <XMarkIcon className=\"h-6 w-6\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Form */}\r\n            <form onSubmit={handleSubmit} className=\"flex flex-col flex-1 min-h-0\">\r\n              <div className=\"p-6 overflow-y-auto flex-1 min-h-0\">\r\n                {error && (\r\n                  <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded\">\r\n                    {error}\r\n                  </div>\r\n                )}\r\n\r\n                {loadingData ? (\r\n                  <div className=\"text-center py-8 text-gray-600 dark:text-gray-400\">\r\n                    {t('common.loading')}\r\n                  </div>\r\n                ) : (\r\n                  renderForm()\r\n                )}\r\n              </div>\r\n\r\n              {/* Footer */}\r\n              <div className=\"px-6 py-4 border-t dark:border-gray-700 flex-shrink-0 flex justify-end gap-2\">\r\n                <div className=\"relative group\">\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={handleClose}\r\n                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\r\n                    title={t('common.cancel')}\r\n                  >\r\n                    <XMarkIcon className=\"h-5 w-5\" />\r\n                  </button>\r\n                  <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n                    {t('common.cancel')}\r\n                  </div>\r\n                </div>\r\n                <div className=\"relative group\">\r\n                  <button\r\n                    type=\"submit\"\r\n                    disabled={loading || loadingData}\r\n                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                    title={loading ? t('common.saving') : t('common.save')}\r\n                  >\r\n                    {loading ? (\r\n                      <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\r\n                    ) : (\r\n                      <CheckIcon className=\"h-5 w-5\" />\r\n                    )}\r\n                  </button>\r\n                  <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n                    {loading ? t('common.saving') : t('common.save')}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </form>\r\n          </Dialog.Panel>\r\n        </div>\r\n      </Dialog>\r\n    );\r\n  }\r\n\r\n  // Desktop (ab 640px) - Sidepane\r\n  return (\r\n    <>\r\n      {/* Backdrop - nur wenn offen und <= 1070px */}\r\n      {isOpen && !isLargeScreen && (\r\n        <div \r\n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \r\n          aria-hidden=\"true\" \r\n          onClick={handleClose}\r\n          style={{\r\n            opacity: isOpen ? 1 : 0,\r\n            transition: 'opacity 300ms ease-out'\r\n          }}\r\n        />\r\n      )}\r\n      \r\n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\r\n      <div \r\n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\r\n        style={{\r\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n          pointerEvents: isOpen ? 'auto' : 'none'\r\n        }}\r\n        aria-hidden={!isOpen}\r\n        role=\"dialog\"\r\n        aria-modal={isOpen}\r\n      >\r\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n          <h2 className=\"text-lg font-semibold dark:text-white\">\r\n            {t('teamWorktime.shifts.modal.edit.title')}\r\n          </h2>\r\n          <button\r\n            onClick={handleClose}\r\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n          >\r\n            <XMarkIcon className=\"h-6 w-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit} className=\"flex flex-col flex-1 min-h-0\">\r\n          <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\r\n            {error && (\r\n              <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded\">\r\n                {error}\r\n              </div>\r\n            )}\r\n\r\n            {loadingData ? (\r\n              <div className=\"text-center py-8 text-gray-600 dark:text-gray-400\">\r\n                {t('common.loading')}\r\n              </div>\r\n            ) : (\r\n              renderForm()\r\n            )}\r\n          </div>\r\n\r\n          {/* Footer */}\r\n          <div className=\"p-4 border-t dark:border-gray-700 flex-shrink-0 flex justify-end gap-2\">\r\n            <div className=\"relative group\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleClose}\r\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\r\n                title={t('common.cancel')}\r\n              >\r\n                <XMarkIcon className=\"h-5 w-5\" />\r\n              </button>\r\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n                {t('common.cancel')}\r\n              </div>\r\n            </div>\r\n            <div className=\"relative group\">\r\n              <button\r\n                type=\"submit\"\r\n                disabled={loading || loadingData}\r\n                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                title={loading ? t('common.saving') : t('common.save')}\r\n              >\r\n                {loading ? (\r\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\r\n                ) : (\r\n                  <CheckIcon className=\"h-5 w-5\" />\r\n                )}\r\n              </button>\r\n              <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n                {loading ? t('common.saving') : t('common.save')}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </div>\r\n      \r\n      {/* Swap Request Modal */}\r\n      {shift.userId === user?.id && (\r\n        <SwapRequestModal\r\n          isOpen={isSwapModalOpen}\r\n          onClose={() => setIsSwapModalOpen(false)}\r\n          onSwapRequestCreated={() => {\r\n            setIsSwapModalOpen(false);\r\n            onShiftUpdated(shift); // Aktualisiere Schicht (Status knnte sich gendert haben)\r\n          }}\r\n          originalShift={shift}\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default EditShiftModal;\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport axiosInstance from '../../config/axios.ts';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, CheckCircleIcon, ExclamationTriangleIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../../config/api.ts';\r\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\r\nimport { format, startOfWeek, endOfWeek } from 'date-fns';\r\n\r\ninterface Role {\r\n  id: number;\r\n  name: string;\r\n}\r\n\r\ninterface Branch {\r\n  id: number;\r\n  name: string;\r\n}\r\n\r\ninterface GenerateShiftPlanModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onPlanGenerated: () => void;\r\n  initialStartDate?: Date;\r\n  initialEndDate?: Date;\r\n}\r\n\r\ninterface GenerationResult {\r\n  shifts: any[];\r\n  summary: {\r\n    total: number;\r\n    assigned: number;\r\n    unassigned: number;\r\n    conflicts: number;\r\n  };\r\n  conflicts: Array<{\r\n    date: string;\r\n    roleId: number;\r\n    templateId: number;\r\n    reason: string;\r\n  }>;\r\n}\r\n\r\nconst GenerateShiftPlanModal = ({ \r\n  isOpen, \r\n  onClose, \r\n  onPlanGenerated,\r\n  initialStartDate,\r\n  initialEndDate\r\n}: GenerateShiftPlanModalProps) => {\r\n  const { t } = useTranslation();\r\n  const { openSidepane, closeSidepane } = useSidepane();\r\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\r\n  \r\n  // Formular-Felder\r\n  const [startDate, setStartDate] = useState(\r\n    initialStartDate \r\n      ? format(initialStartDate, 'yyyy-MM-dd')\r\n      : format(startOfWeek(new Date(), { weekStartsOn: 1 }), 'yyyy-MM-dd')\r\n  );\r\n  const [endDate, setEndDate] = useState(\r\n    initialEndDate\r\n      ? format(initialEndDate, 'yyyy-MM-dd')\r\n      : format(endOfWeek(new Date(), { weekStartsOn: 1 }), 'yyyy-MM-dd')\r\n  );\r\n  const [branchId, setBranchId] = useState<number | ''>('');\r\n  const [selectedRoleIds, setSelectedRoleIds] = useState<number[]>([]);\r\n  \r\n  // Daten\r\n  const [branches, setBranches] = useState<Branch[]>([]);\r\n  const [roles, setRoles] = useState<Role[]>([]);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [loadingData, setLoadingData] = useState(false);\r\n  const [generating, setGenerating] = useState(false);\r\n  \r\n  // Ergebnis\r\n  const [result, setResult] = useState<GenerationResult | null>(null);\r\n  const [showResult, setShowResult] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const checkScreenSize = () => {\r\n      setIsMobile(window.innerWidth < 640);\r\n      setIsLargeScreen(window.innerWidth > 1070);\r\n    };\r\n    \r\n    checkScreenSize();\r\n    window.addEventListener('resize', checkScreenSize);\r\n    \r\n    return () => {\r\n      window.removeEventListener('resize', checkScreenSize);\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      openSidepane();\r\n      fetchData();\r\n      setResult(null);\r\n      setShowResult(false);\r\n    } else {\r\n      closeSidepane();\r\n    }\r\n    \r\n    return () => {\r\n      closeSidepane();\r\n    };\r\n  }, [isOpen, openSidepane, closeSidepane]);\r\n\r\n  // Lade Rollen, wenn Branch gendert wird\r\n  useEffect(() => {\r\n    if (isOpen && branchId) {\r\n      fetchRoles();\r\n    } else {\r\n      setRoles([]);\r\n      setSelectedRoleIds([]);\r\n    }\r\n  }, [isOpen, branchId]);\r\n\r\n  // Setze erste Branch, wenn geladen\r\n  useEffect(() => {\r\n    if (branches.length > 0 && branchId === '') {\r\n      setBranchId(branches[0].id);\r\n    }\r\n  }, [branches, branchId]);\r\n\r\n  const fetchData = async () => {\r\n    setLoadingData(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        setError('Nicht authentifiziert');\r\n        setLoadingData(false);\r\n        return;\r\n      }\r\n\r\n      const response = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\r\n      setBranches(response.data || []);\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Laden der Branches:', err);\r\n      setError(err.response?.data?.message || err.message || t('teamWorktime.shifts.generate.errors.loadBranchesError'));\r\n    } finally {\r\n      setLoadingData(false);\r\n    }\r\n  };\r\n\r\n  const fetchRoles = async () => {\r\n    if (!branchId) return;\r\n\r\n    try {\r\n      setError(null);\r\n      // Lade alle Rollen - das Backend filtert dann basierend auf Branch\r\n      const response = await axiosInstance.get(API_ENDPOINTS.ROLES.BASE);\r\n      const allRoles = response.data || [];\r\n      \r\n      // Filtere Rollen, die fr diese Branch verfgbar sind\r\n      // (Das Backend sollte das eigentlich machen, aber wir filtern hier zustzlich)\r\n      setRoles(allRoles);\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Laden der Rollen:', err);\r\n      setError(err.response?.data?.message || err.message || t('teamWorktime.shifts.generate.errors.loadRolesError'));\r\n    }\r\n  };\r\n\r\n  const handleRoleToggle = (roleId: number) => {\r\n    setSelectedRoleIds(prev => \r\n      prev.includes(roleId)\r\n        ? prev.filter(id => id !== roleId)\r\n        : [...prev, roleId]\r\n    );\r\n  };\r\n\r\n  const handleSelectAllRoles = () => {\r\n    if (selectedRoleIds.length === roles.length) {\r\n      setSelectedRoleIds([]);\r\n    } else {\r\n      setSelectedRoleIds(roles.map(r => r.id));\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError(null);\r\n    setGenerating(true);\r\n    setResult(null);\r\n    setShowResult(false);\r\n\r\n    try {\r\n      if (!startDate || !endDate || !branchId) {\r\n        setError(t('teamWorktime.shifts.generate.errors.fillRequiredFields'));\r\n        setGenerating(false);\r\n        return;\r\n      }\r\n\r\n      const start = new Date(startDate);\r\n      const end = new Date(endDate);\r\n\r\n      if (isNaN(start.getTime()) || isNaN(end.getTime())) {\r\n        setError(t('teamWorktime.shifts.generate.errors.invalidDates'));\r\n        setGenerating(false);\r\n        return;\r\n      }\r\n\r\n      if (start >= end) {\r\n        setError(t('teamWorktime.shifts.generate.errors.startDateAfterEndDate'));\r\n        setGenerating(false);\r\n        return;\r\n      }\r\n\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        setError('Nicht authentifiziert');\r\n        setGenerating(false);\r\n        return;\r\n      }\r\n\r\n      const requestData: any = {\r\n        startDate: start.toISOString().split('T')[0],\r\n        endDate: end.toISOString().split('T')[0],\r\n        branchId: Number(branchId)\r\n      };\r\n\r\n      // Nur roleIds hinzufgen, wenn welche ausgewhlt wurden\r\n      if (selectedRoleIds.length > 0) {\r\n        requestData.roleIds = selectedRoleIds;\r\n      }\r\n\r\n      const response = await axiosInstance.post(API_ENDPOINTS.SHIFTS.GENERATE, requestData);\r\n      \r\n      const resultData = response.data.data || response.data;\r\n      setResult(resultData);\r\n      setShowResult(true);\r\n      \r\n      // Rufe Callback auf, damit Daten neu geladen werden\r\n      onPlanGenerated();\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Generieren des Schichtplans:', err);\r\n      const errorMessage = err.response?.data?.message || err.message || t('teamWorktime.shifts.generate.errors.generateError');\r\n      setError(errorMessage);\r\n    } finally {\r\n      setGenerating(false);\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setError(null);\r\n    setResult(null);\r\n    setShowResult(false);\r\n    setSelectedRoleIds([]);\r\n    onClose();\r\n  };\r\n\r\n  const renderForm = () => (\r\n    <div className=\"space-y-4\">\r\n      {/* Start Date */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.generate.form.startDate')} *\r\n        </label>\r\n        <input\r\n          type=\"date\"\r\n          value={startDate}\r\n          onChange={(e) => setStartDate(e.target.value)}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          required\r\n        />\r\n      </div>\r\n\r\n      {/* End Date */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.generate.form.endDate')} *\r\n        </label>\r\n        <input\r\n          type=\"date\"\r\n          value={endDate}\r\n          onChange={(e) => setEndDate(e.target.value)}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          required\r\n        />\r\n      </div>\r\n\r\n      {/* Branch */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.generate.form.branch')} *\r\n        </label>\r\n        <select\r\n          value={branchId}\r\n          onChange={(e) => {\r\n            setBranchId(Number(e.target.value));\r\n            setSelectedRoleIds([]); // Reset Rollen bei Branch-nderung\r\n          }}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          required\r\n        >\r\n          <option value=\"\">{t('teamWorktime.shifts.generate.form.selectBranch')}</option>\r\n          {branches.map((branch) => (\r\n            <option key={branch.id} value={branch.id}>\r\n              {branch.name}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      {/* Roles (Multi-Select) */}\r\n      <div>\r\n        <div className=\"flex items-center justify-between mb-2\">\r\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n            {t('teamWorktime.shifts.generate.form.roles')}\r\n          </label>\r\n          {roles.length > 0 && (\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleSelectAllRoles}\r\n              className=\"text-xs text-blue-600 dark:text-blue-400 hover:underline\"\r\n            >\r\n              {selectedRoleIds.length === roles.length \r\n                ? t('teamWorktime.shifts.generate.form.deselectAll')\r\n                : t('teamWorktime.shifts.generate.form.selectAll')\r\n              }\r\n            </button>\r\n          )}\r\n        </div>\r\n        <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-2\">\r\n          {t('teamWorktime.shifts.generate.form.rolesHint')}\r\n        </p>\r\n        {!branchId ? (\r\n          <div className=\"p-3 bg-gray-50 dark:bg-gray-700 rounded-md text-sm text-gray-500 dark:text-gray-400\">\r\n            {t('teamWorktime.shifts.generate.form.selectBranchFirst')}\r\n          </div>\r\n        ) : roles.length === 0 ? (\r\n          <div className=\"p-3 bg-gray-50 dark:bg-gray-700 rounded-md text-sm text-gray-500 dark:text-gray-400\">\r\n            {t('teamWorktime.shifts.generate.form.noRolesAvailable')}\r\n          </div>\r\n        ) : (\r\n          <div className=\"max-h-48 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-2 space-y-2\">\r\n            {roles.map((role) => (\r\n              <label key={role.id} className=\"flex items-center cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 p-2 rounded\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={selectedRoleIds.includes(role.id)}\r\n                  onChange={() => handleRoleToggle(role.id)}\r\n                  className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\r\n                />\r\n                <span className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">\r\n                  {role.name}\r\n                </span>\r\n              </label>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const renderResult = () => {\r\n    if (!result) return null;\r\n\r\n    return (\r\n      <div className=\"space-y-4\">\r\n        {/* Zusammenfassung */}\r\n        <div className=\"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md\">\r\n          <h3 className=\"text-sm font-semibold text-blue-900 dark:text-blue-300 mb-3\">\r\n            {t('teamWorktime.shifts.generate.result.summary')}\r\n          </h3>\r\n          <div className=\"grid grid-cols-2 gap-3\">\r\n            <div>\r\n              <div className=\"text-xs text-blue-700 dark:text-blue-400\">{t('teamWorktime.shifts.generate.result.total')}</div>\r\n              <div className=\"text-lg font-semibold text-blue-900 dark:text-blue-300\">{result.summary.total}</div>\r\n            </div>\r\n            <div>\r\n              <div className=\"text-xs text-green-700 dark:text-green-400\">{t('teamWorktime.shifts.generate.result.assigned')}</div>\r\n              <div className=\"text-lg font-semibold text-green-900 dark:text-green-300\">{result.summary.assigned}</div>\r\n            </div>\r\n            <div>\r\n              <div className=\"text-xs text-orange-700 dark:text-orange-400\">{t('teamWorktime.shifts.generate.result.unassigned')}</div>\r\n              <div className=\"text-lg font-semibold text-orange-900 dark:text-orange-300\">{result.summary.unassigned}</div>\r\n            </div>\r\n            <div>\r\n              <div className=\"text-xs text-red-700 dark:text-red-400\">{t('teamWorktime.shifts.generate.result.conflicts')}</div>\r\n              <div className=\"text-lg font-semibold text-red-900 dark:text-red-300\">{result.summary.conflicts}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Konflikte */}\r\n        {result.conflicts && result.conflicts.length > 0 && (\r\n          <div className=\"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-md\">\r\n            <div className=\"flex items-start gap-2 mb-2\">\r\n              <ExclamationTriangleIcon className=\"h-5 w-5 text-yellow-600 dark:text-yellow-400 flex-shrink-0 mt-0.5\" />\r\n              <h3 className=\"text-sm font-semibold text-yellow-900 dark:text-yellow-300\">\r\n                {t('teamWorktime.shifts.generate.result.conflictsTitle')} ({result.conflicts.length})\r\n              </h3>\r\n            </div>\r\n            <div className=\"max-h-40 overflow-y-auto space-y-1\">\r\n              {result.conflicts.map((conflict, index) => (\r\n                <div key={index} className=\"text-xs text-yellow-800 dark:text-yellow-400\">\r\n                  {format(new Date(conflict.date), 'dd.MM.yyyy')}: {conflict.reason}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Erfolg */}\r\n        {result.summary.conflicts === 0 && result.summary.unassigned === 0 && (\r\n          <div className=\"p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-md\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <CheckCircleIcon className=\"h-5 w-5 text-green-600 dark:text-green-400\" />\r\n              <span className=\"text-sm font-medium text-green-900 dark:text-green-300\">\r\n                {t('teamWorktime.shifts.generate.result.success')}\r\n              </span>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // Mobile (unter 640px) - Modal\r\n  if (isMobile) {\r\n    return (\r\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\r\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n        \r\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n          <Dialog.Panel className=\"mx-auto max-w-sm w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden\">\r\n            {/* Header */}\r\n            <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\r\n                  {t('teamWorktime.shifts.generate.title')}\r\n                </Dialog.Title>\r\n                <button\r\n                  onClick={handleClose}\r\n                  className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n                >\r\n                  <XMarkIcon className=\"h-6 w-6\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Form */}\r\n            <form onSubmit={handleSubmit} className=\"flex flex-col flex-1 min-h-0\">\r\n              <div className=\"p-6 overflow-y-auto flex-1 min-h-0\">\r\n                {error && (\r\n                  <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded\">\r\n                    {error}\r\n                  </div>\r\n                )}\r\n\r\n                {showResult && result ? (\r\n                  renderResult()\r\n                ) : loadingData ? (\r\n                  <div className=\"text-center py-8 text-gray-600 dark:text-gray-400\">\r\n                    {t('common.loading')}\r\n                  </div>\r\n                ) : (\r\n                  renderForm()\r\n                )}\r\n              </div>\r\n\r\n              {/* Footer */}\r\n              <div className=\"px-6 py-4 border-t dark:border-gray-700 flex-shrink-0 flex justify-end gap-2\">\r\n                {showResult ? (\r\n                  <div className=\"relative group\">\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={handleClose}\r\n                      className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors\"\r\n                      title={t('common.close')}\r\n                    >\r\n                      <XMarkIcon className=\"h-5 w-5\" />\r\n                    </button>\r\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n                      {t('common.close')}\r\n                    </div>\r\n                  </div>\r\n                ) : (\r\n                  <>\r\n                    <div className=\"relative group\">\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={handleClose}\r\n                        className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\r\n                        title={t('common.cancel')}\r\n                      >\r\n                        <XMarkIcon className=\"h-5 w-5\" />\r\n                      </button>\r\n                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n                        {t('common.cancel')}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"relative group\">\r\n                      <button\r\n                        type=\"submit\"\r\n                        disabled={generating || loadingData}\r\n                        className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                        title={generating ? t('teamWorktime.shifts.generate.generating') : t('teamWorktime.shifts.generate.generate')}\r\n                      >\r\n                        {generating ? (\r\n                          <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\r\n                        ) : (\r\n                          <CheckIcon className=\"h-5 w-5\" />\r\n                        )}\r\n                      </button>\r\n                      <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n                        {generating ? t('teamWorktime.shifts.generate.generating') : t('teamWorktime.shifts.generate.generate')}\r\n                      </div>\r\n                    </div>\r\n                  </>\r\n                )}\r\n              </div>\r\n            </form>\r\n          </Dialog.Panel>\r\n        </div>\r\n      </Dialog>\r\n    );\r\n  }\r\n\r\n  // Desktop (ab 640px) - Sidepane\r\n  return (\r\n    <>\r\n      {/* Backdrop - nur wenn offen und <= 1070px */}\r\n      {isOpen && !isLargeScreen && (\r\n        <div \r\n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \r\n          aria-hidden=\"true\" \r\n          onClick={handleClose}\r\n          style={{\r\n            opacity: isOpen ? 1 : 0,\r\n            transition: 'opacity 300ms ease-out'\r\n          }}\r\n        />\r\n      )}\r\n      \r\n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\r\n      <div \r\n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\r\n        style={{\r\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n          pointerEvents: isOpen ? 'auto' : 'none'\r\n        }}\r\n        aria-hidden={!isOpen}\r\n        role=\"dialog\"\r\n        aria-modal={isOpen}\r\n      >\r\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n          <h2 className=\"text-lg font-semibold dark:text-white\">\r\n            {t('teamWorktime.shifts.generate.title')}\r\n          </h2>\r\n          <button\r\n            onClick={handleClose}\r\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n          >\r\n            <XMarkIcon className=\"h-6 w-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        <form onSubmit={handleSubmit} className=\"flex flex-col flex-1 min-h-0\">\r\n          <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\r\n            {error && (\r\n              <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded\">\r\n                {error}\r\n              </div>\r\n            )}\r\n\r\n            {showResult && result ? (\r\n              renderResult()\r\n            ) : loadingData ? (\r\n              <div className=\"text-center py-8 text-gray-600 dark:text-gray-400\">\r\n                {t('common.loading')}\r\n              </div>\r\n            ) : (\r\n              renderForm()\r\n            )}\r\n          </div>\r\n\r\n          {/* Footer */}\r\n          <div className=\"p-4 border-t dark:border-gray-700 flex-shrink-0 flex justify-end gap-2\">\r\n            {showResult ? (\r\n              <div className=\"relative group\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={handleClose}\r\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors\"\r\n                  title={t('common.close')}\r\n                >\r\n                  <XMarkIcon className=\"h-5 w-5\" />\r\n                </button>\r\n                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n                  {t('common.close')}\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <>\r\n                <div className=\"relative group\">\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={handleClose}\r\n                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\r\n                    title={t('common.cancel')}\r\n                  >\r\n                    <XMarkIcon className=\"h-5 w-5\" />\r\n                  </button>\r\n                  <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n                    {t('common.cancel')}\r\n                  </div>\r\n                </div>\r\n                <div className=\"relative group\">\r\n                  <button\r\n                    type=\"submit\"\r\n                    disabled={generating || loadingData}\r\n                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n                    title={generating ? t('teamWorktime.shifts.generate.generating') : t('teamWorktime.shifts.generate.generate')}\r\n                  >\r\n                    {generating ? (\r\n                      <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\r\n                    ) : (\r\n                      <CheckIcon className=\"h-5 w-5\" />\r\n                    )}\r\n                  </button>\r\n                  <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n                    {generating ? t('teamWorktime.shifts.generate.generating') : t('teamWorktime.shifts.generate.generate')}\r\n                  </div>\r\n                </div>\r\n              </>\r\n            )}\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default GenerateShiftPlanModal;\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport axiosInstance from '../../config/axios.ts';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, CheckIcon, XCircleIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../../config/api.ts';\r\nimport { useAuth } from '../../hooks/useAuth.tsx';\r\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\r\nimport { format } from 'date-fns';\r\n\r\ninterface SwapRequest {\r\n  id: number;\r\n  originalShiftId: number;\r\n  targetShiftId: number;\r\n  requestedBy: number;\r\n  requestedFrom: number;\r\n  status: 'pending' | 'approved' | 'rejected';\r\n  message?: string;\r\n  responseMessage?: string;\r\n  createdAt: string;\r\n  respondedAt?: string;\r\n  originalShift: {\r\n    id: number;\r\n    date: string;\r\n    startTime: string;\r\n    endTime: string;\r\n    shiftTemplate?: {\r\n      name: string;\r\n    };\r\n    branch?: {\r\n      name: string;\r\n    };\r\n    role?: {\r\n      name: string;\r\n    };\r\n    user?: {\r\n      id: number;\r\n      firstName: string;\r\n      lastName: string;\r\n    };\r\n  };\r\n  targetShift: {\r\n    id: number;\r\n    date: string;\r\n    startTime: string;\r\n    endTime: string;\r\n    shiftTemplate?: {\r\n      name: string;\r\n    };\r\n    branch?: {\r\n      name: string;\r\n    };\r\n    role?: {\r\n      name: string;\r\n    };\r\n    user?: {\r\n      id: number;\r\n      firstName: string;\r\n      lastName: string;\r\n    };\r\n  };\r\n  requester: {\r\n    id: number;\r\n    firstName: string;\r\n    lastName: string;\r\n  };\r\n  requestee: {\r\n    id: number;\r\n    firstName: string;\r\n    lastName: string;\r\n  };\r\n}\r\n\r\ninterface SwapRequestListProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onSwapRequestUpdated: () => void;\r\n}\r\n\r\nconst SwapRequestList = ({ \r\n  isOpen, \r\n  onClose,\r\n  onSwapRequestUpdated\r\n}: SwapRequestListProps) => {\r\n  const { t } = useTranslation();\r\n  const { user } = useAuth();\r\n  const { openSidepane, closeSidepane } = useSidepane();\r\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\r\n  \r\n  const [swapRequests, setSwapRequests] = useState<SwapRequest[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [processingId, setProcessingId] = useState<number | null>(null);\r\n  const [filterStatus, setFilterStatus] = useState<'all' | 'pending' | 'approved' | 'rejected'>('all');\r\n\r\n  useEffect(() => {\r\n    const checkScreenSize = () => {\r\n      setIsMobile(window.innerWidth < 640);\r\n      setIsLargeScreen(window.innerWidth > 1070);\r\n    };\r\n    \r\n    checkScreenSize();\r\n    window.addEventListener('resize', checkScreenSize);\r\n    \r\n    return () => {\r\n      window.removeEventListener('resize', checkScreenSize);\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      openSidepane();\r\n      fetchSwapRequests();\r\n    } else {\r\n      closeSidepane();\r\n    }\r\n    \r\n    return () => {\r\n      closeSidepane();\r\n    };\r\n  }, [isOpen, openSidepane, closeSidepane]);\r\n\r\n  const fetchSwapRequests = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      const response = await axiosInstance.get(API_ENDPOINTS.SHIFTS.SWAPS.BASE, {\r\n        params: user?.id ? { userId: user.id } : {}\r\n      });\r\n      \r\n      const data = response.data?.data || response.data || [];\r\n      setSwapRequests(Array.isArray(data) ? data : []);\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Laden der Tausch-Anfragen:', err);\r\n      setError(err.response?.data?.message || err.message || t('teamWorktime.shifts.swapList.errors.loadError'));\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleApprove = async (swapRequest: SwapRequest) => {\r\n    if (!user) return;\r\n    \r\n    setProcessingId(swapRequest.id);\r\n    setError(null);\r\n    \r\n    try {\r\n      await axiosInstance.put(API_ENDPOINTS.SHIFTS.SWAPS.APPROVE(swapRequest.id), {\r\n        responseMessage: null\r\n      });\r\n      \r\n      await fetchSwapRequests();\r\n      onSwapRequestUpdated();\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Genehmigen der Tausch-Anfrage:', err);\r\n      setError(err.response?.data?.message || err.message || t('teamWorktime.shifts.swapList.errors.approveError'));\r\n    } finally {\r\n      setProcessingId(null);\r\n    }\r\n  };\r\n\r\n  const handleReject = async (swapRequest: SwapRequest) => {\r\n    if (!user) return;\r\n    \r\n    setProcessingId(swapRequest.id);\r\n    setError(null);\r\n    \r\n    try {\r\n      await axiosInstance.put(API_ENDPOINTS.SHIFTS.SWAPS.REJECT(swapRequest.id), {\r\n        responseMessage: null\r\n      });\r\n      \r\n      await fetchSwapRequests();\r\n      onSwapRequestUpdated();\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Ablehnen der Tausch-Anfrage:', err);\r\n      setError(err.response?.data?.message || err.message || t('teamWorktime.shifts.swapList.errors.rejectError'));\r\n    } finally {\r\n      setProcessingId(null);\r\n    }\r\n  };\r\n\r\n  const filteredRequests = swapRequests.filter(req => {\r\n    if (filterStatus === 'all') return true;\r\n    return req.status === filterStatus;\r\n  });\r\n\r\n  const ownRequests = filteredRequests.filter(req => req.requestedBy === user?.id);\r\n  const receivedRequests = filteredRequests.filter(req => req.requestedFrom === user?.id);\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'pending':\r\n        return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300';\r\n      case 'approved':\r\n        return 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300';\r\n      case 'rejected':\r\n        return 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\r\n    }\r\n  };\r\n\r\n  const getStatusText = (status: string) => {\r\n    switch (status) {\r\n      case 'pending':\r\n        return t('teamWorktime.shifts.swapList.status.pending');\r\n      case 'approved':\r\n        return t('teamWorktime.shifts.swapList.status.approved');\r\n      case 'rejected':\r\n        return t('teamWorktime.shifts.swapList.status.rejected');\r\n      default:\r\n        return status;\r\n    }\r\n  };\r\n\r\n  const renderSwapRequest = (request: SwapRequest, isReceived: boolean) => (\r\n    <div key={request.id} className=\"p-4 border border-gray-200 dark:border-gray-700 rounded-lg mb-4\">\r\n      <div className=\"flex items-start justify-between mb-3\">\r\n        <div className=\"flex-1\">\r\n          <div className=\"flex items-center gap-2 mb-2\">\r\n            <span className={`px-2 py-1 text-xs font-semibold rounded-full ${getStatusColor(request.status)}`}>\r\n              {getStatusText(request.status)}\r\n            </span>\r\n            <span className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n              {format(new Date(request.createdAt), 'dd.MM.yyyy HH:mm')}\r\n            </span>\r\n          </div>\r\n          \r\n          {isReceived ? (\r\n            <p className=\"text-sm text-gray-700 dark:text-gray-300\">\r\n              <span className=\"font-medium\">{request.requester.firstName} {request.requester.lastName}</span> {t('teamWorktime.shifts.swapList.wantsToSwap')}\r\n            </p>\r\n          ) : (\r\n            <p className=\"text-sm text-gray-700 dark:text-gray-300\">\r\n              {t('teamWorktime.shifts.swapList.youRequestedSwap')} <span className=\"font-medium\">{request.requestee.firstName} {request.requestee.lastName}</span>\r\n            </p>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Schicht-Details */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3\">\r\n        {/* Original-Schicht */}\r\n        <div className=\"p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md\">\r\n          <h4 className=\"text-xs font-semibold text-blue-900 dark:text-blue-300 mb-1\">\r\n            {isReceived ? t('teamWorktime.shifts.swapList.theirShift') : t('teamWorktime.shifts.swapList.yourShift')}\r\n          </h4>\r\n          <div className=\"text-xs text-blue-800 dark:text-blue-400\">\r\n            <div>{request.originalShift.shiftTemplate?.name || t('teamWorktime.shifts.swap.form.shift')}</div>\r\n            <div>{format(new Date(request.originalShift.date), 'dd.MM.yyyy')}</div>\r\n            <div>\r\n              {format(new Date(request.originalShift.startTime), 'HH:mm')} - {format(new Date(request.originalShift.endTime), 'HH:mm')}\r\n            </div>\r\n            {request.originalShift.branch && (\r\n              <div>{request.originalShift.branch.name}</div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Ziel-Schicht */}\r\n        <div className=\"p-3 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-md\">\r\n          <h4 className=\"text-xs font-semibold text-green-900 dark:text-green-300 mb-1\">\r\n            {isReceived ? t('teamWorktime.shifts.swapList.theirShift') : t('teamWorktime.shifts.swapList.yourShift')}\r\n          </h4>\r\n          <div className=\"text-xs text-green-800 dark:text-green-400\">\r\n            <div>{request.targetShift.shiftTemplate?.name || t('teamWorktime.shifts.swap.form.shift')}</div>\r\n            <div>{format(new Date(request.targetShift.date), 'dd.MM.yyyy')}</div>\r\n            <div>\r\n              {format(new Date(request.targetShift.startTime), 'HH:mm')} - {format(new Date(request.targetShift.endTime), 'HH:mm')}\r\n            </div>\r\n            {request.targetShift.branch && (\r\n              <div>{request.targetShift.branch.name}</div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Nachricht */}\r\n      {request.message && (\r\n        <div className=\"mb-3 p-2 bg-gray-50 dark:bg-gray-700 rounded text-sm text-gray-700 dark:text-gray-300\">\r\n          <span className=\"font-medium\">{t('teamWorktime.shifts.swapList.message')}:</span> {request.message}\r\n        </div>\r\n      )}\r\n\r\n      {/* Response Message */}\r\n      {request.responseMessage && (\r\n        <div className=\"mb-3 p-2 bg-blue-50 dark:bg-blue-900/20 rounded text-sm text-blue-700 dark:text-blue-300\">\r\n          <span className=\"font-medium\">{t('teamWorktime.shifts.swapList.response')}:</span> {request.responseMessage}\r\n        </div>\r\n      )}\r\n\r\n      {/* Actions - nur fr erhaltene Anfragen mit Status pending */}\r\n      {isReceived && request.status === 'pending' && (\r\n        <div className=\"flex gap-2 mt-3\">\r\n          <button\r\n            onClick={() => handleApprove(request)}\r\n            disabled={processingId === request.id}\r\n            className=\"flex-1 px-3 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\r\n          >\r\n            {processingId === request.id ? (\r\n              <>\r\n                <ArrowPathIcon className=\"h-4 w-4 animate-spin\" />\r\n                {t('teamWorktime.shifts.swapList.approving')}\r\n              </>\r\n            ) : (\r\n              <>\r\n                <CheckIcon className=\"h-4 w-4\" />\r\n                {t('teamWorktime.shifts.swapList.approve')}\r\n              </>\r\n            )}\r\n          </button>\r\n          <button\r\n            onClick={() => handleReject(request)}\r\n            disabled={processingId === request.id}\r\n            className=\"flex-1 px-3 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\r\n          >\r\n            {processingId === request.id ? (\r\n              <>\r\n                <ArrowPathIcon className=\"h-4 w-4 animate-spin\" />\r\n                {t('teamWorktime.shifts.swapList.rejecting')}\r\n              </>\r\n            ) : (\r\n              <>\r\n                <XCircleIcon className=\"h-4 w-4\" />\r\n                {t('teamWorktime.shifts.swapList.reject')}\r\n              </>\r\n            )}\r\n          </button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  const renderContent = () => (\r\n    <div className=\"space-y-4\">\r\n      {/* Filter */}\r\n      <div className=\"flex gap-2\">\r\n        <button\r\n          onClick={() => setFilterStatus('all')}\r\n          className={`px-3 py-1 text-sm rounded-md ${\r\n            filterStatus === 'all'\r\n              ? 'bg-blue-600 text-white'\r\n              : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300'\r\n          }`}\r\n        >\r\n          {t('teamWorktime.shifts.swapList.filter.all')}\r\n        </button>\r\n        <button\r\n          onClick={() => setFilterStatus('pending')}\r\n          className={`px-3 py-1 text-sm rounded-md ${\r\n            filterStatus === 'pending'\r\n              ? 'bg-blue-600 text-white'\r\n              : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300'\r\n          }`}\r\n        >\r\n          {t('teamWorktime.shifts.swapList.filter.pending')}\r\n        </button>\r\n        <button\r\n          onClick={() => setFilterStatus('approved')}\r\n          className={`px-3 py-1 text-sm rounded-md ${\r\n            filterStatus === 'approved'\r\n              ? 'bg-blue-600 text-white'\r\n              : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300'\r\n          }`}\r\n        >\r\n          {t('teamWorktime.shifts.swapList.filter.approved')}\r\n        </button>\r\n        <button\r\n          onClick={() => setFilterStatus('rejected')}\r\n          className={`px-3 py-1 text-sm rounded-md ${\r\n            filterStatus === 'rejected'\r\n              ? 'bg-blue-600 text-white'\r\n              : 'bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300'\r\n          }`}\r\n        >\r\n          {t('teamWorktime.shifts.swapList.filter.rejected')}\r\n        </button>\r\n      </div>\r\n\r\n      {error && (\r\n        <div className=\"p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded\">\r\n          {error}\r\n        </div>\r\n      )}\r\n\r\n      {loading ? (\r\n        <div className=\"text-center py-8 text-gray-600 dark:text-gray-400\">\r\n          {t('common.loading')}\r\n        </div>\r\n      ) : (\r\n        <>\r\n          {/* Erhaltene Anfragen */}\r\n          {receivedRequests.length > 0 && (\r\n            <div>\r\n              <h3 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-3\">\r\n                {t('teamWorktime.shifts.swapList.receivedRequests')} ({receivedRequests.length})\r\n              </h3>\r\n              {receivedRequests.map(req => renderSwapRequest(req, true))}\r\n            </div>\r\n          )}\r\n\r\n          {/* Eigene Anfragen */}\r\n          {ownRequests.length > 0 && (\r\n            <div>\r\n              <h3 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-3\">\r\n                {t('teamWorktime.shifts.swapList.yourRequests')} ({ownRequests.length})\r\n              </h3>\r\n              {ownRequests.map(req => renderSwapRequest(req, false))}\r\n            </div>\r\n          )}\r\n\r\n          {filteredRequests.length === 0 && (\r\n            <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\r\n              {t('teamWorktime.shifts.swapList.noRequests')}\r\n            </div>\r\n          )}\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  // Mobile (unter 640px) - Modal\r\n  if (isMobile) {\r\n    return (\r\n      <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n        \r\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden\">\r\n            {/* Header */}\r\n            <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\r\n                  {t('teamWorktime.shifts.swapList.title')}\r\n                </Dialog.Title>\r\n                <button\r\n                  onClick={onClose}\r\n                  className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n                >\r\n                  <XMarkIcon className=\"h-6 w-6\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            {/* Content */}\r\n            <div className=\"p-6 overflow-y-auto flex-1 min-h-0\">\r\n              {renderContent()}\r\n            </div>\r\n          </Dialog.Panel>\r\n        </div>\r\n      </Dialog>\r\n    );\r\n  }\r\n\r\n  // Desktop (ab 640px) - Sidepane\r\n  return (\r\n    <>\r\n      {/* Backdrop - nur wenn offen und <= 1070px */}\r\n      {isOpen && !isLargeScreen && (\r\n        <div \r\n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \r\n          aria-hidden=\"true\" \r\n          onClick={onClose}\r\n          style={{\r\n            opacity: isOpen ? 1 : 0,\r\n            transition: 'opacity 300ms ease-out'\r\n          }}\r\n        />\r\n      )}\r\n      \r\n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\r\n      <div \r\n        className={`fixed top-16 bottom-0 right-0 max-w-2xl w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\r\n        style={{\r\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n          pointerEvents: isOpen ? 'auto' : 'none'\r\n        }}\r\n        aria-hidden={!isOpen}\r\n        role=\"dialog\"\r\n        aria-modal={isOpen}\r\n      >\r\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n          <h2 className=\"text-lg font-semibold dark:text-white\">\r\n            {t('teamWorktime.shifts.swapList.title')}\r\n          </h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n          >\r\n            <XMarkIcon className=\"h-6 w-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\r\n          {renderContent()}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default SwapRequestList;\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport axiosInstance from '../../config/axios.ts';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, PencilIcon, TrashIcon, PlusIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../../config/api.ts';\r\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\r\n\r\ninterface ShiftTemplate {\r\n  id: number;\r\n  name: string;\r\n  startTime: string;\r\n  endTime: string;\r\n  duration: number | null;\r\n  isActive: boolean;\r\n  roleId: number;\r\n  branchId: number;\r\n  role?: {\r\n    id: number;\r\n    name: string;\r\n  };\r\n  branch?: {\r\n    id: number;\r\n    name: string;\r\n  };\r\n}\r\n\r\ninterface Role {\r\n  id: number;\r\n  name: string;\r\n}\r\n\r\ninterface Branch {\r\n  id: number;\r\n  name: string;\r\n}\r\n\r\ninterface ShiftTemplateManagementProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n}\r\n\r\nconst ShiftTemplateManagement = ({ isOpen, onClose }: ShiftTemplateManagementProps) => {\r\n  const { t } = useTranslation();\r\n  const { openSidepane, closeSidepane } = useSidepane();\r\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\r\n  \r\n  const [templates, setTemplates] = useState<ShiftTemplate[]>([]);\r\n  const [roles, setRoles] = useState<Role[]>([]);\r\n  const [branches, setBranches] = useState<Branch[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [loadingData, setLoadingData] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  \r\n  const [isFormOpen, setIsFormOpen] = useState(false);\r\n  const [editingTemplate, setEditingTemplate] = useState<ShiftTemplate | null>(null);\r\n  const [formData, setFormData] = useState({\r\n    name: '',\r\n    roleId: '' as number | '',\r\n    branchId: '' as number | '',\r\n    startTime: '',\r\n    endTime: '',\r\n    duration: '' as number | '',\r\n    isActive: true\r\n  });\r\n\r\n  useEffect(() => {\r\n    const checkScreenSize = () => {\r\n      setIsMobile(window.innerWidth < 640);\r\n      setIsLargeScreen(window.innerWidth > 1070);\r\n    };\r\n    \r\n    checkScreenSize();\r\n    window.addEventListener('resize', checkScreenSize);\r\n    \r\n    return () => {\r\n      window.removeEventListener('resize', checkScreenSize);\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      openSidepane();\r\n      fetchData();\r\n    } else {\r\n      closeSidepane();\r\n      setIsFormOpen(false);\r\n      setEditingTemplate(null);\r\n      resetForm();\r\n    }\r\n    \r\n    return () => {\r\n      closeSidepane();\r\n    };\r\n  }, [isOpen, openSidepane, closeSidepane]);\r\n\r\n  const fetchData = async () => {\r\n    setLoadingData(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      const [templatesRes, rolesRes, branchesRes] = await Promise.all([\r\n        axiosInstance.get(API_ENDPOINTS.SHIFTS.TEMPLATES.BASE, {\r\n          params: { includeInactive: true }\r\n        }),\r\n        axiosInstance.get(API_ENDPOINTS.ROLES.BASE),\r\n        axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE)\r\n      ]);\r\n      \r\n      setTemplates(templatesRes.data?.data || templatesRes.data || []);\r\n      setRoles(rolesRes.data || []);\r\n      setBranches(branchesRes.data || []);\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Laden der Daten:', err);\r\n      setError(err.response?.data?.message || err.message || t('teamWorktime.shifts.templates.errors.loadError'));\r\n    } finally {\r\n      setLoadingData(false);\r\n    }\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setFormData({\r\n      name: '',\r\n      roleId: '',\r\n      branchId: '',\r\n      startTime: '',\r\n      endTime: '',\r\n      duration: '',\r\n      isActive: true\r\n    });\r\n    setEditingTemplate(null);\r\n  };\r\n\r\n  const handleEdit = (template: ShiftTemplate) => {\r\n    setEditingTemplate(template);\r\n    setFormData({\r\n      name: template.name,\r\n      roleId: template.roleId,\r\n      branchId: template.branchId,\r\n      startTime: template.startTime,\r\n      endTime: template.endTime,\r\n      duration: template.duration || '',\r\n      isActive: template.isActive\r\n    });\r\n    setIsFormOpen(true);\r\n  };\r\n\r\n  const handleDelete = async (templateId: number) => {\r\n    if (!window.confirm(t('teamWorktime.shifts.templates.deleteConfirm'))) {\r\n      return;\r\n    }\r\n\r\n    setError(null);\r\n    setLoading(true);\r\n\r\n    try {\r\n      await axiosInstance.delete(API_ENDPOINTS.SHIFTS.TEMPLATES.BY_ID(templateId));\r\n      await fetchData();\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Lschen des Templates:', err);\r\n      setError(err.response?.data?.message || err.message || t('teamWorktime.shifts.templates.errors.deleteError'));\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError(null);\r\n    setLoading(true);\r\n\r\n    try {\r\n      if (!formData.name || !formData.roleId || !formData.branchId || !formData.startTime || !formData.endTime) {\r\n        setError(t('teamWorktime.shifts.templates.errors.fillRequiredFields'));\r\n        setLoading(false);\r\n        return;\r\n      }\r\n\r\n      const templateData: any = {\r\n        name: formData.name.trim(),\r\n        roleId: Number(formData.roleId),\r\n        branchId: Number(formData.branchId),\r\n        startTime: formData.startTime,\r\n        endTime: formData.endTime,\r\n        duration: formData.duration ? Number(formData.duration) : null,\r\n        isActive: formData.isActive\r\n      };\r\n\r\n      if (editingTemplate) {\r\n        await axiosInstance.put(API_ENDPOINTS.SHIFTS.TEMPLATES.BY_ID(editingTemplate.id), templateData);\r\n      } else {\r\n        await axiosInstance.post(API_ENDPOINTS.SHIFTS.TEMPLATES.BASE, templateData);\r\n      }\r\n\r\n      await fetchData();\r\n      setIsFormOpen(false);\r\n      resetForm();\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Speichern des Templates:', err);\r\n      setError(err.response?.data?.message || err.message || t('teamWorktime.shifts.templates.errors.saveError'));\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const renderForm = () => (\r\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n      {/* Name */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.templates.form.name')} *\r\n        </label>\r\n        <input\r\n          type=\"text\"\r\n          value={formData.name}\r\n          onChange={(e) => setFormData({ ...formData, name: e.target.value })}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          required\r\n        />\r\n      </div>\r\n\r\n      {/* Branch */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.templates.form.branch')} *\r\n        </label>\r\n        <select\r\n          value={formData.branchId}\r\n          onChange={(e) => setFormData({ ...formData, branchId: Number(e.target.value) })}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          required\r\n          disabled={!!editingTemplate}\r\n        >\r\n          <option value=\"\">{t('teamWorktime.shifts.templates.form.selectBranch')}</option>\r\n          {branches.map((branch) => (\r\n            <option key={branch.id} value={branch.id}>\r\n              {branch.name}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      {/* Role */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.templates.form.role')} *\r\n        </label>\r\n        <select\r\n          value={formData.roleId}\r\n          onChange={(e) => setFormData({ ...formData, roleId: Number(e.target.value) })}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          required\r\n          disabled={!!editingTemplate}\r\n        >\r\n          <option value=\"\">{t('teamWorktime.shifts.templates.form.selectRole')}</option>\r\n          {roles.map((role) => (\r\n            <option key={role.id} value={role.id}>\r\n              {role.name}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      {/* Start Time */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.templates.form.startTime')} *\r\n        </label>\r\n        <input\r\n          type=\"time\"\r\n          value={formData.startTime}\r\n          onChange={(e) => setFormData({ ...formData, startTime: e.target.value })}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          required\r\n        />\r\n      </div>\r\n\r\n      {/* End Time */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.templates.form.endTime')} *\r\n        </label>\r\n        <input\r\n          type=\"time\"\r\n          value={formData.endTime}\r\n          onChange={(e) => setFormData({ ...formData, endTime: e.target.value })}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          required\r\n        />\r\n      </div>\r\n\r\n      {/* Duration (optional) */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.templates.form.duration')}\r\n        </label>\r\n        <input\r\n          type=\"number\"\r\n          value={formData.duration}\r\n          onChange={(e) => setFormData({ ...formData, duration: e.target.value ? Number(e.target.value) : '' })}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          placeholder={t('teamWorktime.shifts.templates.form.durationPlaceholder')}\r\n          min=\"0\"\r\n        />\r\n      </div>\r\n\r\n      {/* Is Active */}\r\n      <div className=\"flex items-center\">\r\n        <input\r\n          type=\"checkbox\"\r\n          id=\"isActive\"\r\n          checked={formData.isActive}\r\n          onChange={(e) => setFormData({ ...formData, isActive: e.target.checked })}\r\n          className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\r\n        />\r\n        <label htmlFor=\"isActive\" className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">\r\n          {t('teamWorktime.shifts.templates.form.isActive')}\r\n        </label>\r\n      </div>\r\n\r\n      {/* Buttons */}\r\n      <div className=\"flex gap-2 pt-4\">\r\n        <div className=\"relative group\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => {\r\n              setIsFormOpen(false);\r\n              resetForm();\r\n            }}\r\n            className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\r\n            title={t('common.cancel')}\r\n          >\r\n            <XMarkIcon className=\"h-5 w-5\" />\r\n          </button>\r\n          <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n            {t('common.cancel')}\r\n          </div>\r\n        </div>\r\n        <div className=\"relative group\">\r\n          <button\r\n            type=\"submit\"\r\n            disabled={loading}\r\n            className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n            title={loading ? t('common.saving') : t('common.save')}\r\n          >\r\n            {loading ? (\r\n              <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\r\n            ) : (\r\n              <CheckIcon className=\"h-5 w-5\" />\r\n            )}\r\n          </button>\r\n          <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n            {loading ? t('common.saving') : t('common.save')}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  );\r\n\r\n  const renderContent = () => (\r\n    <div className=\"space-y-4\">\r\n      {error && (\r\n        <div className=\"p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded\">\r\n          {error}\r\n        </div>\r\n      )}\r\n\r\n      {isFormOpen ? (\r\n        <div>\r\n          <div className=\"flex items-center justify-between mb-4\">\r\n            <h3 className=\"text-lg font-semibold dark:text-white\">\r\n              {editingTemplate ? t('teamWorktime.shifts.templates.editTitle') : t('teamWorktime.shifts.templates.createTitle')}\r\n            </h3>\r\n            <button\r\n              onClick={() => {\r\n                setIsFormOpen(false);\r\n                resetForm();\r\n              }}\r\n              className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n            >\r\n              <XMarkIcon className=\"h-6 w-6\" />\r\n            </button>\r\n          </div>\r\n          {renderForm()}\r\n        </div>\r\n      ) : (\r\n        <>\r\n          <div className=\"flex items-center justify-between mb-4\">\r\n            <h3 className=\"text-lg font-semibold dark:text-white\">\r\n              {t('teamWorktime.shifts.templates.title')}\r\n            </h3>\r\n            <button\r\n              onClick={() => setIsFormOpen(true)}\r\n              className=\"p-2 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700\"\r\n            >\r\n              <PlusIcon className=\"h-5 w-5\" />\r\n            </button>\r\n          </div>\r\n\r\n          {loadingData ? (\r\n            <div className=\"text-center py-8 text-gray-600 dark:text-gray-400\">\r\n              {t('common.loading')}\r\n            </div>\r\n          ) : templates.length === 0 ? (\r\n            <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\r\n              {t('teamWorktime.shifts.templates.noTemplates')}\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-2\">\r\n              {templates.map((template) => (\r\n                <div\r\n                  key={template.id}\r\n                  className=\"p-4 border border-gray-200 dark:border-gray-700 rounded-lg flex items-center justify-between\"\r\n                >\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <h4 className=\"font-medium text-gray-900 dark:text-white\">{template.name}</h4>\r\n                      {!template.isActive && (\r\n                        <span className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded\">\r\n                          {t('teamWorktime.shifts.templates.inactive')}\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">\r\n                      {template.branch?.name} - {template.role?.name}\r\n                    </div>\r\n                    <div className=\"text-sm text-gray-500 dark:text-gray-500 mt-1\">\r\n                      {template.startTime} - {template.endTime}\r\n                      {template.duration && ` (${template.duration} ${t('teamWorktime.shifts.templates.minutes')})`}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex gap-2\">\r\n                    <button\r\n                      onClick={() => handleEdit(template)}\r\n                      className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded\"\r\n                    >\r\n                      <PencilIcon className=\"h-5 w-5\" />\r\n                    </button>\r\n                    <button\r\n                      onClick={() => handleDelete(template.id)}\r\n                      className=\"p-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded\"\r\n                    >\r\n                      <TrashIcon className=\"h-5 w-5\" />\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  // Mobile (unter 640px) - Modal\r\n  if (isMobile) {\r\n    return (\r\n      <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n        \r\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden\">\r\n            <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\r\n                  {t('teamWorktime.shifts.templates.title')}\r\n                </Dialog.Title>\r\n                <button\r\n                  onClick={onClose}\r\n                  className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n                >\r\n                  <XMarkIcon className=\"h-6 w-6\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"p-6 overflow-y-auto flex-1 min-h-0\">\r\n              {renderContent()}\r\n            </div>\r\n          </Dialog.Panel>\r\n        </div>\r\n      </Dialog>\r\n    );\r\n  }\r\n\r\n  // Desktop (ab 640px) - Sidepane\r\n  return (\r\n    <>\r\n      {isOpen && !isLargeScreen && (\r\n        <div \r\n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \r\n          aria-hidden=\"true\" \r\n          onClick={onClose}\r\n          style={{\r\n            opacity: isOpen ? 1 : 0,\r\n            transition: 'opacity 300ms ease-out'\r\n          }}\r\n        />\r\n      )}\r\n      \r\n      <div \r\n        className={`fixed top-16 bottom-0 right-0 max-w-2xl w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\r\n        style={{\r\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n          pointerEvents: isOpen ? 'auto' : 'none'\r\n        }}\r\n        aria-hidden={!isOpen}\r\n        role=\"dialog\"\r\n        aria-modal={isOpen}\r\n      >\r\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n          <h2 className=\"text-lg font-semibold dark:text-white\">\r\n            {t('teamWorktime.shifts.templates.title')}\r\n          </h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n          >\r\n            <XMarkIcon className=\"h-6 w-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\r\n          {renderContent()}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ShiftTemplateManagement;\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport axiosInstance from '../../config/axios.ts';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, PencilIcon, TrashIcon, PlusIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../../config/api.ts';\r\nimport { useAuth } from '../../hooks/useAuth.tsx';\r\nimport { usePermissions } from '../../hooks/usePermissions.ts';\r\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\r\nimport { format } from 'date-fns';\r\n\r\ninterface UserAvailability {\r\n  id: number;\r\n  userId: number;\r\n  branchId: number | null;\r\n  roleId: number | null;\r\n  dayOfWeek: number | null; // 0=Sonntag, 6=Samstag, null=alle Tage\r\n  startTime: string | null;\r\n  endTime: string | null;\r\n  startDate: string | null;\r\n  endDate: string | null;\r\n  type: 'available' | 'preferred' | 'unavailable';\r\n  priority: number;\r\n  notes: string | null;\r\n  isActive: boolean;\r\n  user?: {\r\n    id: number;\r\n    firstName: string;\r\n    lastName: string;\r\n  };\r\n  branch?: {\r\n    id: number;\r\n    name: string;\r\n  };\r\n  role?: {\r\n    id: number;\r\n    name: string;\r\n  };\r\n}\r\n\r\ninterface Role {\r\n  id: number;\r\n  name: string;\r\n}\r\n\r\ninterface Branch {\r\n  id: number;\r\n  name: string;\r\n}\r\n\r\ninterface AvailabilityManagementProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n}\r\n\r\ninterface User {\r\n  id: number;\r\n  firstName: string;\r\n  lastName: string;\r\n}\r\n\r\nconst AvailabilityManagement = ({ isOpen, onClose }: AvailabilityManagementProps) => {\r\n  const { t } = useTranslation();\r\n  const { user } = useAuth();\r\n  const { hasPermission } = usePermissions();\r\n  const { openSidepane, closeSidepane } = useSidepane();\r\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\r\n  \r\n  // Prfe, ob User Verfgbarkeiten fr andere User verwalten darf\r\n  const canManageAllAvailabilities = hasPermission('availability_management', 'write', 'page');\r\n  \r\n  const [availabilities, setAvailabilities] = useState<UserAvailability[]>([]);\r\n  const [roles, setRoles] = useState<Role[]>([]);\r\n  const [branches, setBranches] = useState<Branch[]>([]);\r\n  const [allUsers, setAllUsers] = useState<User[]>([]);\r\n  const [selectedUserId, setSelectedUserId] = useState<number | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [loadingData, setLoadingData] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  \r\n  const [isFormOpen, setIsFormOpen] = useState(false);\r\n  const [editingAvailability, setEditingAvailability] = useState<UserAvailability | null>(null);\r\n  const [formData, setFormData] = useState({\r\n    userId: null as number | null,\r\n    branchId: '' as number | '',\r\n    roleId: '' as number | '',\r\n    dayOfWeek: '' as number | '' | null,\r\n    startTime: '',\r\n    endTime: '',\r\n    startDate: '',\r\n    endDate: '',\r\n    type: 'available' as 'available' | 'preferred' | 'unavailable',\r\n    priority: 5,\r\n    notes: '',\r\n    isActive: true\r\n  });\r\n\r\n  const dayOfWeekOptions = [\r\n    { value: '', label: t('teamWorktime.shifts.availabilities.form.allDays') },\r\n    { value: 0, label: t('teamWorktime.shifts.availabilities.form.sunday') },\r\n    { value: 1, label: t('teamWorktime.shifts.availabilities.form.monday') },\r\n    { value: 2, label: t('teamWorktime.shifts.availabilities.form.tuesday') },\r\n    { value: 3, label: t('teamWorktime.shifts.availabilities.form.wednesday') },\r\n    { value: 4, label: t('teamWorktime.shifts.availabilities.form.thursday') },\r\n    { value: 5, label: t('teamWorktime.shifts.availabilities.form.friday') },\r\n    { value: 6, label: t('teamWorktime.shifts.availabilities.form.saturday') }\r\n  ];\r\n\r\n  useEffect(() => {\r\n    const checkScreenSize = () => {\r\n      setIsMobile(window.innerWidth < 640);\r\n      setIsLargeScreen(window.innerWidth > 1070);\r\n    };\r\n    \r\n    checkScreenSize();\r\n    window.addEventListener('resize', checkScreenSize);\r\n    \r\n    return () => {\r\n      window.removeEventListener('resize', checkScreenSize);\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      openSidepane();\r\n      fetchData();\r\n    } else {\r\n      closeSidepane();\r\n      setIsFormOpen(false);\r\n      setEditingAvailability(null);\r\n      resetForm();\r\n      setSelectedUserId(null);\r\n    }\r\n    \r\n    return () => {\r\n      closeSidepane();\r\n    };\r\n  }, [isOpen, openSidepane, closeSidepane, selectedUserId, canManageAllAvailabilities]);\r\n\r\n  const fetchData = async () => {\r\n    setLoadingData(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      // Lade User (wenn Permission vorhanden)\r\n      if (canManageAllAvailabilities) {\r\n        try {\r\n          const usersRes = await axiosInstance.get(API_ENDPOINTS.USERS.DROPDOWN);\r\n          setAllUsers(usersRes.data || []);\r\n        } catch (err) {\r\n          console.error('Fehler beim Laden der User:', err);\r\n        }\r\n      }\r\n\r\n      // Bestimme userId fr API-Request\r\n      const params: any = { includeInactive: true };\r\n      if (canManageAllAvailabilities && selectedUserId) {\r\n        // Admin hat User ausgewhlt\r\n        params.userId = selectedUserId;\r\n      } else if (canManageAllAvailabilities && !selectedUserId) {\r\n        // Admin, aber kein User ausgewhlt  zeige alle (kein userId Parameter)\r\n        // params bleibt ohne userId\r\n      } else if (user?.id) {\r\n        // Normaler User: nur eigene Verfgbarkeiten\r\n        params.userId = user.id;\r\n      }\r\n\r\n      const [availabilitiesRes, rolesRes, branchesRes] = await Promise.all([\r\n        axiosInstance.get(API_ENDPOINTS.SHIFTS.AVAILABILITIES.BASE, { params }),\r\n        axiosInstance.get(API_ENDPOINTS.ROLES.BASE),\r\n        axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE)\r\n      ]);\r\n      \r\n      setAvailabilities(availabilitiesRes.data?.data || availabilitiesRes.data || []);\r\n      setRoles(rolesRes.data || []);\r\n      setBranches(branchesRes.data || []);\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Laden der Daten:', err);\r\n      setError(err.response?.data?.message || err.message || t('teamWorktime.shifts.availabilities.errors.loadError'));\r\n    } finally {\r\n      setLoadingData(false);\r\n    }\r\n  };\r\n\r\n  const resetForm = () => {\r\n    setFormData({\r\n      userId: null,\r\n      branchId: '',\r\n      roleId: '',\r\n      dayOfWeek: '',\r\n      startTime: '',\r\n      endTime: '',\r\n      startDate: '',\r\n      endDate: '',\r\n      type: 'available',\r\n      priority: 5,\r\n      notes: '',\r\n      isActive: true\r\n    });\r\n    setEditingAvailability(null);\r\n  };\r\n\r\n  const handleEdit = (availability: UserAvailability) => {\r\n    setEditingAvailability(availability);\r\n    setFormData({\r\n      userId: availability.userId, // Beim Bearbeiten: userId setzen (read-only)\r\n      branchId: availability.branchId || '',\r\n      roleId: availability.roleId || '',\r\n      dayOfWeek: availability.dayOfWeek !== null ? availability.dayOfWeek : '',\r\n      startTime: availability.startTime || '',\r\n      endTime: availability.endTime || '',\r\n      startDate: availability.startDate ? format(new Date(availability.startDate), 'yyyy-MM-dd') : '',\r\n      endDate: availability.endDate ? format(new Date(availability.endDate), 'yyyy-MM-dd') : '',\r\n      type: availability.type,\r\n      priority: availability.priority,\r\n      notes: availability.notes || '',\r\n      isActive: availability.isActive\r\n    });\r\n    setIsFormOpen(true);\r\n  };\r\n\r\n  const handleDelete = async (availabilityId: number) => {\r\n    if (!window.confirm(t('teamWorktime.shifts.availabilities.deleteConfirm'))) {\r\n      return;\r\n    }\r\n\r\n    setError(null);\r\n    setLoading(true);\r\n\r\n    try {\r\n      await axiosInstance.delete(API_ENDPOINTS.SHIFTS.AVAILABILITIES.BY_ID(availabilityId));\r\n      await fetchData();\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Lschen der Verfgbarkeit:', err);\r\n      setError(err.response?.data?.message || err.message || t('teamWorktime.shifts.availabilities.errors.deleteError'));\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError(null);\r\n    setLoading(true);\r\n\r\n    try {\r\n      const availabilityData: any = {\r\n        branchId: formData.branchId ? Number(formData.branchId) : null,\r\n        roleId: formData.roleId ? Number(formData.roleId) : null,\r\n        dayOfWeek: formData.dayOfWeek === '' ? null : (formData.dayOfWeek === null ? null : Number(formData.dayOfWeek)),\r\n        startTime: formData.startTime || null,\r\n        endTime: formData.endTime || null,\r\n        startDate: formData.startDate || null,\r\n        endDate: formData.endDate || null,\r\n        type: formData.type,\r\n        priority: formData.priority,\r\n        notes: formData.notes.trim() || null,\r\n        isActive: formData.isActive\r\n      };\r\n\r\n      // Nur userId senden, wenn Permission vorhanden und User ausgewhlt\r\n      if (canManageAllAvailabilities && formData.userId) {\r\n        availabilityData.userId = formData.userId;\r\n      }\r\n\r\n      if (editingAvailability) {\r\n        await axiosInstance.put(API_ENDPOINTS.SHIFTS.AVAILABILITIES.BY_ID(editingAvailability.id), availabilityData);\r\n      } else {\r\n        await axiosInstance.post(API_ENDPOINTS.SHIFTS.AVAILABILITIES.BASE, availabilityData);\r\n      }\r\n\r\n      await fetchData();\r\n      setIsFormOpen(false);\r\n      resetForm();\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Speichern der Verfgbarkeit:', err);\r\n      setError(err.response?.data?.message || err.message || t('teamWorktime.shifts.availabilities.errors.saveError'));\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const getDayOfWeekLabel = (dayOfWeek: number | null) => {\r\n    if (dayOfWeek === null) return t('teamWorktime.shifts.availabilities.form.allDays');\r\n    const days = [\r\n      t('teamWorktime.shifts.availabilities.form.sunday'),\r\n      t('teamWorktime.shifts.availabilities.form.monday'),\r\n      t('teamWorktime.shifts.availabilities.form.tuesday'),\r\n      t('teamWorktime.shifts.availabilities.form.wednesday'),\r\n      t('teamWorktime.shifts.availabilities.form.thursday'),\r\n      t('teamWorktime.shifts.availabilities.form.friday'),\r\n      t('teamWorktime.shifts.availabilities.form.saturday')\r\n    ];\r\n    return days[dayOfWeek];\r\n  };\r\n\r\n  const getTypeLabel = (type: string) => {\r\n    switch (type) {\r\n      case 'available':\r\n        return t('teamWorktime.shifts.availabilities.type.available');\r\n      case 'preferred':\r\n        return t('teamWorktime.shifts.availabilities.type.preferred');\r\n      case 'unavailable':\r\n        return t('teamWorktime.shifts.availabilities.type.unavailable');\r\n      default:\r\n        return type;\r\n    }\r\n  };\r\n\r\n  const getTypeColor = (type: string) => {\r\n    switch (type) {\r\n      case 'available':\r\n        return 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300';\r\n      case 'preferred':\r\n        return 'bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300';\r\n      case 'unavailable':\r\n        return 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300';\r\n    }\r\n  };\r\n\r\n  const renderForm = () => (\r\n    <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n      {/* User (nur fr Admins) */}\r\n      {canManageAllAvailabilities && (\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n            {t('teamWorktime.shifts.availabilities.form.user')}\r\n          </label>\r\n          <select\r\n            value={formData.userId || ''}\r\n            onChange={(e) => setFormData({ ...formData, userId: e.target.value ? Number(e.target.value) : null })}\r\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n            disabled={!!editingAvailability} // Read-only beim Bearbeiten\r\n          >\r\n            <option value=\"\">{t('teamWorktime.shifts.availabilities.form.selectUser')}</option>\r\n            {allUsers.map((u) => (\r\n              <option key={u.id} value={u.id}>\r\n                {u.firstName} {u.lastName}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          {editingAvailability && (\r\n            <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\r\n              {t('teamWorktime.shifts.availabilities.form.userReadOnly')}\r\n            </p>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Branch (optional) */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.availabilities.form.branch')}\r\n        </label>\r\n        <select\r\n          value={formData.branchId}\r\n          onChange={(e) => setFormData({ ...formData, branchId: e.target.value ? Number(e.target.value) : '' })}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n        >\r\n          <option value=\"\">{t('teamWorktime.shifts.availabilities.form.selectBranch')}</option>\r\n          {branches.map((branch) => (\r\n            <option key={branch.id} value={branch.id}>\r\n              {branch.name}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      {/* Role (optional) */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.availabilities.form.role')}\r\n        </label>\r\n        <select\r\n          value={formData.roleId}\r\n          onChange={(e) => setFormData({ ...formData, roleId: e.target.value ? Number(e.target.value) : '' })}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n        >\r\n          <option value=\"\">{t('teamWorktime.shifts.availabilities.form.selectRole')}</option>\r\n          {roles.map((role) => (\r\n            <option key={role.id} value={role.id}>\r\n              {role.name}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      {/* Day of Week */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.availabilities.form.dayOfWeek')}\r\n        </label>\r\n        <select\r\n          value={formData.dayOfWeek === null ? '' : formData.dayOfWeek}\r\n          onChange={(e) => setFormData({ ...formData, dayOfWeek: e.target.value === '' ? null : Number(e.target.value) })}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n        >\r\n          {dayOfWeekOptions.map((option) => (\r\n            <option key={option.value} value={option.value}>\r\n              {option.label}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      {/* Start Time (optional) */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.availabilities.form.startTime')}\r\n        </label>\r\n        <input\r\n          type=\"time\"\r\n          value={formData.startTime}\r\n          onChange={(e) => setFormData({ ...formData, startTime: e.target.value })}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n        />\r\n        <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\r\n          {t('teamWorktime.shifts.availabilities.form.startTimeHint')}\r\n        </p>\r\n      </div>\r\n\r\n      {/* End Time (optional) */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.availabilities.form.endTime')}\r\n        </label>\r\n        <input\r\n          type=\"time\"\r\n          value={formData.endTime}\r\n          onChange={(e) => setFormData({ ...formData, endTime: e.target.value })}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n        />\r\n        <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\r\n          {t('teamWorktime.shifts.availabilities.form.endTimeHint')}\r\n        </p>\r\n      </div>\r\n\r\n      {/* Start Date (optional) */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.availabilities.form.startDate')}\r\n        </label>\r\n        <input\r\n          type=\"date\"\r\n          value={formData.startDate}\r\n          onChange={(e) => setFormData({ ...formData, startDate: e.target.value })}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n        />\r\n        <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\r\n          {t('teamWorktime.shifts.availabilities.form.startDateHint')}\r\n        </p>\r\n      </div>\r\n\r\n      {/* End Date (optional) */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.availabilities.form.endDate')}\r\n        </label>\r\n        <input\r\n          type=\"date\"\r\n          value={formData.endDate}\r\n          onChange={(e) => setFormData({ ...formData, endDate: e.target.value })}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n        />\r\n        <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\r\n          {t('teamWorktime.shifts.availabilities.form.endDateHint')}\r\n        </p>\r\n      </div>\r\n\r\n      {/* Type */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.availabilities.form.type')}\r\n        </label>\r\n        <select\r\n          value={formData.type}\r\n          onChange={(e) => setFormData({ ...formData, type: e.target.value as 'available' | 'preferred' | 'unavailable' })}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n        >\r\n          <option value=\"available\">{t('teamWorktime.shifts.availabilities.type.available')}</option>\r\n          <option value=\"preferred\">{t('teamWorktime.shifts.availabilities.type.preferred')}</option>\r\n          <option value=\"unavailable\">{t('teamWorktime.shifts.availabilities.type.unavailable')}</option>\r\n        </select>\r\n      </div>\r\n\r\n      {/* Priority */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.availabilities.form.priority')} (1-10)\r\n        </label>\r\n        <input\r\n          type=\"number\"\r\n          value={formData.priority}\r\n          onChange={(e) => setFormData({ ...formData, priority: Number(e.target.value) })}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          min=\"1\"\r\n          max=\"10\"\r\n        />\r\n      </div>\r\n\r\n      {/* Notes (optional) */}\r\n      <div>\r\n        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n          {t('teamWorktime.shifts.availabilities.form.notes')}\r\n        </label>\r\n        <textarea\r\n          value={formData.notes}\r\n          onChange={(e) => setFormData({ ...formData, notes: e.target.value })}\r\n          rows={3}\r\n          className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          placeholder={t('teamWorktime.shifts.availabilities.form.notesPlaceholder')}\r\n        />\r\n      </div>\r\n\r\n      {/* Is Active */}\r\n      <div className=\"flex items-center\">\r\n        <input\r\n          type=\"checkbox\"\r\n          id=\"isActive\"\r\n          checked={formData.isActive}\r\n          onChange={(e) => setFormData({ ...formData, isActive: e.target.checked })}\r\n          className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\r\n        />\r\n        <label htmlFor=\"isActive\" className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\">\r\n          {t('teamWorktime.shifts.availabilities.form.isActive')}\r\n        </label>\r\n      </div>\r\n\r\n      {/* Buttons */}\r\n      <div className=\"flex gap-2 pt-4\">\r\n        <div className=\"relative group\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => {\r\n              setIsFormOpen(false);\r\n              resetForm();\r\n            }}\r\n            className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\r\n            title={t('common.cancel')}\r\n          >\r\n            <XMarkIcon className=\"h-5 w-5\" />\r\n          </button>\r\n          <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n            {t('common.cancel')}\r\n          </div>\r\n        </div>\r\n        <div className=\"relative group\">\r\n          <button\r\n            type=\"submit\"\r\n            disabled={loading}\r\n            className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n            title={loading ? t('common.saving') : t('common.save')}\r\n          >\r\n            {loading ? (\r\n              <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\r\n            ) : (\r\n              <CheckIcon className=\"h-5 w-5\" />\r\n            )}\r\n          </button>\r\n          <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\r\n            {loading ? t('common.saving') : t('common.save')}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  );\r\n\r\n  const renderContent = () => (\r\n    <div className=\"space-y-4\">\r\n      {error && (\r\n        <div className=\"p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 rounded\">\r\n          {error}\r\n        </div>\r\n      )}\r\n\r\n      {/* User-Filter (nur fr Admins) */}\r\n      {canManageAllAvailabilities && !isFormOpen && (\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n            {t('teamWorktime.shifts.availabilities.filter.user')}\r\n          </label>\r\n          <select\r\n            value={selectedUserId || ''}\r\n            onChange={(e) => {\r\n              const userId = e.target.value ? parseInt(e.target.value, 10) : null;\r\n              setSelectedUserId(userId);\r\n            }}\r\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          >\r\n            <option value=\"\">{t('teamWorktime.shifts.availabilities.filter.allUsers')}</option>\r\n            {allUsers.map((u) => (\r\n              <option key={u.id} value={u.id}>\r\n                {u.firstName} {u.lastName}\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </div>\r\n      )}\r\n\r\n      {isFormOpen ? (\r\n        <div>\r\n          <div className=\"flex items-center justify-between mb-4\">\r\n            <h3 className=\"text-lg font-semibold dark:text-white\">\r\n              {editingAvailability ? t('teamWorktime.shifts.availabilities.editTitle') : t('teamWorktime.shifts.availabilities.createTitle')}\r\n            </h3>\r\n            <button\r\n              onClick={() => {\r\n                setIsFormOpen(false);\r\n                resetForm();\r\n              }}\r\n              className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n            >\r\n              <XMarkIcon className=\"h-6 w-6\" />\r\n            </button>\r\n          </div>\r\n          {renderForm()}\r\n        </div>\r\n      ) : (\r\n        <>\r\n          <div className=\"flex items-center justify-between mb-4\">\r\n            <h3 className=\"text-lg font-semibold dark:text-white\">\r\n              {t('teamWorktime.shifts.availabilities.title')}\r\n            </h3>\r\n            <button\r\n              onClick={() => setIsFormOpen(true)}\r\n              className=\"p-2 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700\"\r\n            >\r\n              <PlusIcon className=\"h-5 w-5\" />\r\n            </button>\r\n          </div>\r\n\r\n          {loadingData ? (\r\n            <div className=\"text-center py-8 text-gray-600 dark:text-gray-400\">\r\n              {t('common.loading')}\r\n            </div>\r\n          ) : availabilities.length === 0 ? (\r\n            <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\r\n              {t('teamWorktime.shifts.availabilities.noAvailabilities')}\r\n            </div>\r\n          ) : (\r\n            <div className=\"space-y-2\">\r\n              {availabilities.map((availability) => (\r\n                <div\r\n                  key={availability.id}\r\n                  className=\"p-4 border border-gray-200 dark:border-gray-700 rounded-lg\"\r\n                >\r\n                  <div className=\"flex items-start justify-between\">\r\n                    <div className=\"flex-1\">\r\n                      <div className=\"flex items-center gap-2 mb-2\">\r\n                        <span className={`px-2 py-1 text-xs font-semibold rounded-full ${getTypeColor(availability.type)}`}>\r\n                          {getTypeLabel(availability.type)}\r\n                        </span>\r\n                        {!availability.isActive && (\r\n                          <span className=\"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded\">\r\n                            {t('teamWorktime.shifts.availabilities.inactive')}\r\n                          </span>\r\n                        )}\r\n                        {availability.priority && (\r\n                          <span className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                            {t('teamWorktime.shifts.availabilities.priority')}: {availability.priority}\r\n                          </span>\r\n                        )}\r\n                      </div>\r\n                      \r\n                      <div className=\"text-sm text-gray-700 dark:text-gray-300 space-y-1\">\r\n                        {availability.user && canManageAllAvailabilities && (\r\n                          <div>\r\n                            <span className=\"font-medium\">{t('teamWorktime.shifts.availabilities.userLabel')}:</span> {availability.user.firstName} {availability.user.lastName}\r\n                          </div>\r\n                        )}\r\n                        <div>\r\n                          <span className=\"font-medium\">{t('teamWorktime.shifts.availabilities.form.dayOfWeek')}:</span> {getDayOfWeekLabel(availability.dayOfWeek)}\r\n                        </div>\r\n                        {availability.startTime && availability.endTime && (\r\n                          <div>\r\n                            <span className=\"font-medium\">{t('teamWorktime.shifts.availabilities.form.startTime')} - {t('teamWorktime.shifts.availabilities.form.endTime')}:</span> {availability.startTime} - {availability.endTime}\r\n                          </div>\r\n                        )}\r\n                        {availability.startDate && availability.endDate && (\r\n                          <div>\r\n                            <span className=\"font-medium\">{t('teamWorktime.shifts.availabilities.form.startDate')} - {t('teamWorktime.shifts.availabilities.form.endDate')}:</span> {format(new Date(availability.startDate), 'dd.MM.yyyy')} - {format(new Date(availability.endDate), 'dd.MM.yyyy')}\r\n                          </div>\r\n                        )}\r\n                        {availability.branch && (\r\n                          <div>\r\n                            <span className=\"font-medium\">{t('teamWorktime.shifts.availabilities.form.branch')}:</span> {availability.branch.name}\r\n                          </div>\r\n                        )}\r\n                        {availability.role && (\r\n                          <div>\r\n                            <span className=\"font-medium\">{t('teamWorktime.shifts.availabilities.form.role')}:</span> {availability.role.name}\r\n                          </div>\r\n                        )}\r\n                        {availability.notes && (\r\n                          <div className=\"mt-2 p-2 bg-gray-50 dark:bg-gray-700 rounded text-xs\">\r\n                            {availability.notes}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex gap-2\">\r\n                      <button\r\n                        onClick={() => handleEdit(availability)}\r\n                        className=\"p-2 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded\"\r\n                      >\r\n                        <PencilIcon className=\"h-5 w-5\" />\r\n                      </button>\r\n                      <button\r\n                        onClick={() => handleDelete(availability.id)}\r\n                        className=\"p-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded\"\r\n                      >\r\n                        <TrashIcon className=\"h-5 w-5\" />\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n\r\n  // Mobile (unter 640px) - Modal\r\n  if (isMobile) {\r\n    return (\r\n      <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n        \r\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[calc(100vh-2rem)] flex flex-col overflow-hidden\">\r\n            <div className=\"px-6 py-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\r\n                  {t('teamWorktime.shifts.availabilities.title')}\r\n                </Dialog.Title>\r\n                <button\r\n                  onClick={onClose}\r\n                  className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n                >\r\n                  <XMarkIcon className=\"h-6 w-6\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"p-6 overflow-y-auto flex-1 min-h-0\">\r\n              {renderContent()}\r\n            </div>\r\n          </Dialog.Panel>\r\n        </div>\r\n      </Dialog>\r\n    );\r\n  }\r\n\r\n  // Desktop (ab 640px) - Sidepane\r\n  return (\r\n    <>\r\n      {isOpen && !isLargeScreen && (\r\n        <div \r\n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \r\n          aria-hidden=\"true\" \r\n          onClick={onClose}\r\n          style={{\r\n            opacity: isOpen ? 1 : 0,\r\n            transition: 'opacity 300ms ease-out'\r\n          }}\r\n        />\r\n      )}\r\n      \r\n      <div \r\n        className={`fixed top-16 bottom-0 right-0 max-w-2xl w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\r\n        style={{\r\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n          pointerEvents: isOpen ? 'auto' : 'none'\r\n        }}\r\n        aria-hidden={!isOpen}\r\n        role=\"dialog\"\r\n        aria-modal={isOpen}\r\n      >\r\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n          <h2 className=\"text-lg font-semibold dark:text-white\">\r\n            {t('teamWorktime.shifts.availabilities.title')}\r\n          </h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n          >\r\n            <XMarkIcon className=\"h-6 w-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\r\n          {renderContent()}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default AvailabilityManagement;\r\n\r\n","/**\r\n * Farb-Palette fr Standorte (Branch)\r\n * 15 verschiedene Farben fr gute Unterscheidung\r\n */\r\nexport const BRANCH_COLORS = [\r\n  '#3b82f6', // Blau\r\n  '#10b981', // Grn\r\n  '#f59e0b', // Orange\r\n  '#ef4444', // Rot\r\n  '#8b5cf6', // Lila\r\n  '#ec4899', // Pink\r\n  '#06b6d4', // Cyan\r\n  '#84cc16', // Limette\r\n  '#f97316', // Orange-Rot\r\n  '#6366f1', // Indigo\r\n  '#14b8a6', // Trkis\r\n  '#a855f7', // Violett\r\n  '#eab308', // Gelb\r\n  '#22c55e', // Grn-Hell\r\n  '#64748b'  // Grau\r\n];\r\n\r\n/**\r\n * Farb-Palette fr Rollen\r\n * 15 verschiedene Farben (etwas heller als Branch-Farben)\r\n */\r\nexport const ROLE_COLORS = [\r\n  '#60a5fa', // Blau-Hell\r\n  '#34d399', // Grn-Hell\r\n  '#fbbf24', // Orange-Hell\r\n  '#f87171', // Rot-Hell\r\n  '#a78bfa', // Lila-Hell\r\n  '#f472b6', // Pink-Hell\r\n  '#22d3ee', // Cyan-Hell\r\n  '#a3e635', // Limette-Hell\r\n  '#fb923c', // Orange-Rot-Hell\r\n  '#818cf8', // Indigo-Hell\r\n  '#2dd4bf', // Trkis-Hell\r\n  '#c084fc', // Violett-Hell\r\n  '#fde047', // Gelb-Hell\r\n  '#4ade80', // Grn-Hell-2\r\n  '#94a3b8'  // Grau-Hell\r\n];\r\n\r\n/**\r\n * Status-Farben (fr Rand)\r\n */\r\nexport const STATUS_COLORS = {\r\n  scheduled: '#3b82f6', // Blau\r\n  confirmed: '#10b981', // Grn\r\n  cancelled: '#ef4444', // Rot\r\n  swapped: '#f59e0b'    // Orange\r\n};\r\n\r\n/**\r\n * Gibt eine Farbe fr einen Standort zurck (basierend auf ID)\r\n */\r\nexport function getBranchColor(branchId: number | null | undefined): string {\r\n  if (!branchId) {\r\n    return '#64748b'; // Grau fr keine Branch\r\n  }\r\n  return BRANCH_COLORS[branchId % BRANCH_COLORS.length];\r\n}\r\n\r\n/**\r\n * Gibt eine Farbe fr eine Rolle zurck (basierend auf ID)\r\n */\r\nexport function getRoleColor(roleId: number | null | undefined): string {\r\n  if (!roleId) {\r\n    return '#94a3b8'; // Grau-Hell fr keine Rolle\r\n  }\r\n  return ROLE_COLORS[roleId % ROLE_COLORS.length];\r\n}\r\n\r\n/**\r\n * Gibt eine Farbe fr einen Status zurck\r\n */\r\nexport function getStatusColor(status: string): string {\r\n  return STATUS_COLORS[status as keyof typeof STATUS_COLORS] || '#64748b';\r\n}\r\n\r\n","import React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { CalendarIcon, PlusIcon, ArrowPathIcon, ChevronLeftIcon, ChevronRightIcon, Squares2X2Icon, FunnelIcon, XMarkIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../../config/axios.ts';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { format, startOfWeek, endOfWeek, addWeeks, subWeeks, parse } from 'date-fns';\nimport { useAuth } from '../../hooks/useAuth.tsx';\nimport { logger } from '../../utils/logger.ts';\nimport FullCalendar from '@fullcalendar/react';\nimport timeGridPlugin from '@fullcalendar/timegrid';\nimport dayGridPlugin from '@fullcalendar/daygrid';\nimport interactionPlugin from '@fullcalendar/interaction';\nimport { EventInput } from '@fullcalendar/core';\nimport CreateShiftModal from './CreateShiftModal.tsx';\nimport EditShiftModal from './EditShiftModal.tsx';\nimport GenerateShiftPlanModal from './GenerateShiftPlanModal.tsx';\nimport SwapRequestList from './SwapRequestList.tsx';\nimport ShiftTemplateManagement from './ShiftTemplateManagement.tsx';\nimport AvailabilityManagement from './AvailabilityManagement.tsx';\nimport { getBranchColor, getStatusColor } from '../../utils/colorPalette.ts';\n// FullCalendar v6 CSS - Import ber CDN in index.html oder direkt hier\n\ninterface ShiftPlannerTabProps {\n  selectedDate?: string;\n}\n\ninterface Shift {\n  id: number;\n  shiftTemplateId: number;\n  branchId: number;\n  roleId: number;\n  userId: number | null;\n  date: string;\n  startTime: string;\n  endTime: string;\n  status: 'scheduled' | 'confirmed' | 'cancelled' | 'swapped';\n  notes?: string;\n  shiftTemplate?: {\n    id: number;\n    name: string;\n    startTime: string;\n    endTime: string;\n  };\n  branch?: {\n    id: number;\n    name: string;\n  };\n  role?: {\n    id: number;\n    name: string;\n  };\n  user?: {\n    id: number;\n    firstName: string;\n    lastName: string;\n    email: string;\n  };\n}\n\nconst ShiftPlannerTab: React.FC<ShiftPlannerTabProps> = ({ selectedDate }) => {\n  const { t } = useTranslation();\n  const { user } = useAuth();\n  \n  const [shifts, setShifts] = useState<Shift[]>([]);\n  const [allShifts, setAllShifts] = useState<Shift[]>([]); // Alle geladenen Schichten (vor Filterung)\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [currentWeek, setCurrentWeek] = useState<Date>(new Date());\n  const [calendarView, setCalendarView] = useState<'timeGridWeek' | 'dayGridMonth'>('timeGridWeek');\n  const calendarRef = useRef<FullCalendar>(null);\n  const isProgrammaticNavigation = useRef(false);\n  \n  // Filter States\n  const [isFilterPanelOpen, setIsFilterPanelOpen] = useState(false);\n  const [selectedBranchIds, setSelectedBranchIds] = useState<number[]>([]);\n  const [selectedRoleIds, setSelectedRoleIds] = useState<number[]>([]);\n  const [selectedStatuses, setSelectedStatuses] = useState<string[]>([]);\n  const [selectedUserIds, setSelectedUserIds] = useState<number[]>([]);\n  const [branches, setBranches] = useState<Array<{ id: number; name: string }>>([]);\n  const [roles, setRoles] = useState<Array<{ id: number; name: string }>>([]);\n  const [users, setUsers] = useState<Array<{ id: number; firstName: string; lastName: string }>>([]);\n  \n  // Modal States\n  const [isCreateModalOpen, setIsCreateModalOpen] = useState(false);\n  const [isEditModalOpen, setIsEditModalOpen] = useState(false);\n  const [isGenerateModalOpen, setIsGenerateModalOpen] = useState(false);\n  const [isSwapListOpen, setIsSwapListOpen] = useState(false);\n  const [isTemplateManagementOpen, setIsTemplateManagementOpen] = useState(false);\n  const [isAvailabilityManagementOpen, setIsAvailabilityManagementOpen] = useState(false);\n  const [selectedShift, setSelectedShift] = useState<Shift | null>(null);\n  const [createModalInitialDate, setCreateModalInitialDate] = useState<Date | undefined>(undefined);\n  \n  // Lade Schichten fr die aktuelle Woche\n  const fetchShifts = useCallback(async (week: Date) => {\n    try {\n      setLoading(true);\n      setError(null);\n      \n      const weekStart = startOfWeek(week, { weekStartsOn: 1 }); // Montag\n      const weekEnd = endOfWeek(week, { weekStartsOn: 1 }); // Sonntag\n      \n      const url = API_ENDPOINTS.SHIFTS.BASE;\n      const params = {\n        startDate: format(weekStart, 'yyyy-MM-dd'),\n        endDate: format(weekEnd, 'yyyy-MM-dd')\n      };\n      \n      logger.log('[ShiftPlanner] Fetching shifts from:', url);\n      logger.log('[ShiftPlanner] Params:', params);\n      logger.log('[ShiftPlanner] Full URL:', `${axiosInstance.defaults.baseURL}${url}`);\n      \n      const response = await axiosInstance.get(url, { params });\n      \n      logger.log('[ShiftPlanner] Response status:', response.status);\n      logger.log('[ShiftPlanner] Response data:', response.data);\n      \n      // Prfe verschiedene Response-Formate\n      if (response.data && response.data.success !== false) {\n        // Wenn success: true oder success nicht vorhanden, aber data vorhanden\n        const shiftsData = response.data.data || response.data || [];\n        const shiftsArray = Array.isArray(shiftsData) ? shiftsData : [];\n        setAllShifts(shiftsArray); // Speichere alle Schichten\n        logger.log('[ShiftPlanner] Loaded shifts:', shiftsArray.length);\n      } else {\n        const errorMsg = response.data?.message || t('teamWorktime.shifts.messages.loadError');\n        console.error('[ShiftPlanner] Error in response:', errorMsg);\n        setError(errorMsg);\n      }\n    } catch (error: any) {\n      console.error('[ShiftPlanner] Fehler beim Laden der Schichten:', error);\n      console.error('[ShiftPlanner] Error details:', {\n        message: error.message,\n        response: error.response,\n        status: error.response?.status,\n        statusText: error.response?.statusText,\n        data: error.response?.data,\n        url: error.config?.url,\n        baseURL: error.config?.baseURL,\n        fullURL: error.config ? `${error.config.baseURL}${error.config.url}` : 'unknown'\n      });\n      \n      // Detaillierte Fehlerbehandlung\n      if (error.response) {\n        const status = error.response.status;\n        const data = error.response.data;\n        \n        if (status === 404) {\n          console.error('[ShiftPlanner] 404 - Route nicht gefunden. URL:', error.config?.url);\n          setError(t('teamWorktime.shifts.messages.routeNotFound'));\n        } else if (status === 401) {\n          console.error('[ShiftPlanner] 401 - Nicht authentifiziert');\n          setError(t('teamWorktime.shifts.messages.unauthorized'));\n        } else if (status === 403) {\n          console.error('[ShiftPlanner] 403 - Keine Berechtigung');\n          setError(t('teamWorktime.shifts.messages.forbidden'));\n        } else {\n          const errorMsg = data?.message || error.message || t('teamWorktime.shifts.messages.loadError');\n          console.error('[ShiftPlanner] Anderer Fehler:', status, errorMsg);\n          setError(errorMsg);\n        }\n      } else if (error.request) {\n        console.error('[ShiftPlanner] Keine Response erhalten. Request:', error.request);\n        setError(t('teamWorktime.shifts.messages.loadError') + ' (Keine Verbindung zum Server)');\n      } else {\n        console.error('[ShiftPlanner] Fehler beim Setup der Request:', error.message);\n        setError(error.message || t('teamWorktime.shifts.messages.loadError'));\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, [t]); // currentWeek NICHT als Dependency - wird als Parameter bergeben\n  \n  useEffect(() => {\n    fetchShifts(currentWeek);\n  }, [currentWeek, fetchShifts]);\n  \n  // Lade Branches, Rollen und User fr Filter\n  useEffect(() => {\n    const fetchFilterData = async () => {\n      try {\n        const [branchesRes, rolesRes, usersRes] = await Promise.all([\n          axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE),\n          axiosInstance.get(API_ENDPOINTS.ROLES.BASE),\n          axiosInstance.get(API_ENDPOINTS.USERS.DROPDOWN)\n        ]);\n        \n        setBranches(branchesRes.data || []);\n        setRoles(rolesRes.data || []);\n        setUsers(usersRes.data || []);\n      } catch (err) {\n        console.error('Fehler beim Laden der Filter-Daten:', err);\n      }\n    };\n    \n    fetchFilterData();\n  }, []);\n  \n  // Filtere Schichten basierend auf ausgewhlten Filtern\n  useEffect(() => {\n    let filtered = [...allShifts];\n    \n    if (selectedBranchIds.length > 0) {\n      filtered = filtered.filter(shift => selectedBranchIds.includes(shift.branchId));\n    }\n    \n    if (selectedRoleIds.length > 0) {\n      filtered = filtered.filter(shift => selectedRoleIds.includes(shift.roleId));\n    }\n    \n    if (selectedStatuses.length > 0) {\n      filtered = filtered.filter(shift => selectedStatuses.includes(shift.status));\n    }\n    \n    if (selectedUserIds.length > 0) {\n      filtered = filtered.filter(shift => shift.userId && selectedUserIds.includes(shift.userId));\n    }\n    \n    setShifts(filtered);\n  }, [allShifts, selectedBranchIds, selectedRoleIds, selectedStatuses, selectedUserIds]);\n  \n  const handlePreviousWeek = () => {\n    isProgrammaticNavigation.current = true;\n    setCurrentWeek(subWeeks(currentWeek, 1));\n  };\n  \n  const handleNextWeek = () => {\n    isProgrammaticNavigation.current = true;\n    setCurrentWeek(addWeeks(currentWeek, 1));\n  };\n  \n  const handleToday = () => {\n    isProgrammaticNavigation.current = true;\n    setCurrentWeek(new Date());\n  };\n  \n  const weekStart = startOfWeek(currentWeek, { weekStartsOn: 1 });\n  const weekEnd = endOfWeek(currentWeek, { weekStartsOn: 1 });\n  \n  // Konvertiere Schichten zu FullCalendar-Events\n  const calendarEvents = useMemo<EventInput[]>(() => {\n    return shifts.map((shift) => {\n      // startTime und endTime sind bereits vollstndige DateTime-Objekte\n      const startDateTime = new Date(shift.startTime);\n      const endDateTime = new Date(shift.endTime);\n      \n      // Farben: Hintergrund = Standort, Rand = Status\n      const branchColor = getBranchColor(shift.branchId);\n      const statusColor = getStatusColor(shift.status);\n      \n      // Text-Farbe fr besseren Kontrast (heller Text auf dunklem Hintergrund)\n      const textColor = '#ffffff'; // Wei fr guten Kontrast\n      \n      return {\n        id: shift.id.toString(),\n        title: shift.user \n          ? `${shift.shiftTemplate?.name || 'Schicht'} - ${shift.user.firstName} ${shift.user.lastName}`\n          : `${shift.shiftTemplate?.name || 'Schicht'} - Nicht zugewiesen`,\n        start: startDateTime.toISOString(),\n        end: endDateTime.toISOString(),\n        backgroundColor: branchColor, // Hauptfarbe = Standort\n        borderColor: statusColor, // Rand = Status\n        borderWidth: 3, // Dicker Rand fr bessere Sichtbarkeit\n        textColor: textColor, // Text-Farbe\n        extendedProps: {\n          shift,\n        },\n      };\n    });\n  }, [shifts]);\n  \n  // Handler fr Event-Klicks\n  const handleEventClick = (clickInfo: any) => {\n    const shift = clickInfo.event.extendedProps.shift;\n    logger.log('Shift clicked:', shift);\n    setSelectedShift(shift);\n    setIsEditModalOpen(true);\n  };\n  \n  // Handler fr Datum-Klicks (neue Schicht erstellen)\n  const handleDateClick = (dateClickInfo: any) => {\n    logger.log('Date clicked:', dateClickInfo.date);\n    setCreateModalInitialDate(dateClickInfo.date);\n    setIsCreateModalOpen(true);\n  };\n  \n  // Handler fr Add-Button\n  const handleAddClick = () => {\n    setCreateModalInitialDate(currentWeek);\n    setIsCreateModalOpen(true);\n  };\n  \n  // Handler fr Schicht erstellt\n  const handleShiftCreated = (newShift: Shift) => {\n    // Fge neue Schicht zur Liste hinzu\n    setShifts(prev => [...prev, newShift]);\n    // Optional: Daten neu laden fr Konsistenz\n    fetchShifts(currentWeek);\n  };\n  \n  // Handler fr Schicht aktualisiert\n  const handleShiftUpdated = (updatedShift: Shift) => {\n    // Aktualisiere Schicht in der Liste\n    setShifts(prev => prev.map(s => s.id === updatedShift.id ? updatedShift : s));\n    // Optional: Daten neu laden fr Konsistenz\n    fetchShifts(currentWeek);\n  };\n  \n  // Handler fr Schicht gelscht\n  const handleShiftDeleted = (shiftId: number) => {\n    // Entferne Schicht aus der Liste\n    setShifts(prev => prev.filter(s => s.id !== shiftId));\n    // Optional: Daten neu laden fr Konsistenz\n    fetchShifts(currentWeek);\n  };\n  \n  // Handler fr Schichtplan generiert\n  const handlePlanGenerated = () => {\n    // Lade Daten neu, um generierte Schichten anzuzeigen\n    fetchShifts(currentWeek);\n  };\n  \n  // Handler fr Generate-Button\n  const handleGenerateClick = () => {\n    setIsGenerateModalOpen(true);\n  };\n  \n  // Handler fr View-nderung\n  const handleDatesSet = (dateInfo: any) => {\n    const currentView = calendarRef.current?.getApi().view.type;\n    \n    // Aktualisiere calendarView, falls der Benutzer die View im Kalender selbst ndert\n    if (currentView && currentView !== calendarView) {\n      setCalendarView(currentView as 'timeGridWeek' | 'dayGridMonth');\n    }\n    \n    // Aktualisiere currentWeek nur bei timeGridWeek-View, nur wenn sich die Woche wirklich gendert hat,\n    // und nur wenn die Navigation NICHT programmatisch war (z.B. von unseren Buttons)\n    if (currentView === 'timeGridWeek' && !isProgrammaticNavigation.current) {\n      const newWeekStart = startOfWeek(dateInfo.start, { weekStartsOn: 1 });\n      const currentWeekStart = startOfWeek(currentWeek, { weekStartsOn: 1 });\n      \n      // Nur aktualisieren, wenn sich die Woche wirklich gendert hat (verhindert Loop)\n      if (newWeekStart.getTime() !== currentWeekStart.getTime()) {\n        setCurrentWeek(dateInfo.start);\n      }\n    }\n    \n    // Ref zurcksetzen nach jeder datesSet-Event\n    isProgrammaticNavigation.current = false;\n  };\n  \n  const getActiveFilterCount = () => {\n    return selectedBranchIds.length + selectedRoleIds.length + selectedStatuses.length + selectedUserIds.length;\n  };\n  \n  const resetFilters = () => {\n    setSelectedBranchIds([]);\n    setSelectedRoleIds([]);\n    setSelectedStatuses([]);\n    setSelectedUserIds([]);\n  };\n  \n  const statusOptions = [\n    { value: 'scheduled', label: t('teamWorktime.shifts.status.scheduled') },\n    { value: 'confirmed', label: t('teamWorktime.shifts.status.confirmed') },\n    { value: 'cancelled', label: t('teamWorktime.shifts.status.cancelled') },\n    { value: 'swapped', label: t('teamWorktime.shifts.status.swapped') }\n  ];\n  \n  return (\n    <div>\n      {/* Header mit Woche-Navigation */}\n      <div className=\"flex items-center justify-between mb-4 px-3 sm:px-4 md:px-6\">\n        {/* Linke Seite: Add-Button */}\n        <div className=\"flex items-center\">\n          <div className=\"relative group\">\n            <button\n              type=\"button\"\n              onClick={handleAddClick}\n              className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n              style={{ width: '30.19px', height: '30.19px' }}\n              aria-label={t('teamWorktime.shifts.actions.add')}\n            >\n              <PlusIcon className=\"h-4 w-4\" />\n            </button>\n            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n              {t('teamWorktime.shifts.actions.add')}\n            </div>\n          </div>\n        </div>\n        \n        {/* Mitte: Woche-Navigation */}\n        <div className=\"flex items-center gap-0.5\">\n          {/* Links-Pfeil (zurck) */}\n          <div className=\"relative group\">\n            <button\n              type=\"button\"\n              onClick={handlePreviousWeek}\n              className=\"p-1 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 19l-7-7 7-7\" />\n              </svg>\n            </button>\n            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n              {t('common.previousDay')}\n            </div>\n          </div>\n          \n          {/* Woche-Anzeige */}\n          <div className=\"text-base sm:text-lg font-semibold text-gray-900 dark:text-white px-2 sm:px-3\">\n            {format(weekStart, 'dd.MM.yyyy')} - {format(weekEnd, 'dd.MM.yyyy')}\n          </div>\n          \n          {/* Rechts-Pfeil (vorwrts) */}\n          <div className=\"relative group\">\n            <button\n              type=\"button\"\n              onClick={handleNextWeek}\n              className=\"p-1 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\n              </svg>\n            </button>\n            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n              {t('common.nextDay')}\n            </div>\n          </div>\n          \n          {/* Heute-Button */}\n          <div className=\"relative group ml-1\">\n            <button\n              type=\"button\"\n              onClick={handleToday}\n              className=\"p-1 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <CalendarIcon className=\"h-4 w-4\" />\n            </button>\n            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n              {t('common.today')}\n            </div>\n          </div>\n        </div>\n        \n        {/* Rechte Seite: Filter, Availabilities, Templates, Swap List, Generate & Refresh Buttons */}\n        <div className=\"flex items-center gap-1\">\n          {/* Filter Button */}\n          <div className=\"relative group\">\n            <button\n              type=\"button\"\n              onClick={() => setIsFilterPanelOpen(!isFilterPanelOpen)}\n              className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700'} focus:outline-none focus:ring-2 focus:ring-blue-500 relative`}\n            >\n              <FunnelIcon className=\"h-5 w-5\" />\n              {getActiveFilterCount() > 0 && (\n                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center z-10\">\n                  {getActiveFilterCount()}\n                </span>\n              )}\n            </button>\n            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n              {t('common.filter')}\n            </div>\n          </div>\n          \n          {/* Availabilities Button */}\n          <div className=\"relative group\">\n            <button\n              type=\"button\"\n              onClick={() => setIsAvailabilityManagementOpen(true)}\n              className=\"p-2 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <svg className=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4\" />\n              </svg>\n            </button>\n            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n              {t('teamWorktime.shifts.availabilities.title')}\n            </div>\n          </div>\n          \n          {/* Templates Button */}\n          <div className=\"relative group\">\n            <button\n              type=\"button\"\n              onClick={() => setIsTemplateManagementOpen(true)}\n              className=\"p-2 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <svg className=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\" />\n              </svg>\n            </button>\n            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n              {t('teamWorktime.shifts.templates.title')}\n            </div>\n          </div>\n          \n          {/* Swap List Button */}\n          <div className=\"relative group\">\n            <button\n              type=\"button\"\n              onClick={() => setIsSwapListOpen(true)}\n              className=\"p-2 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <svg className=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4\" />\n              </svg>\n            </button>\n            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n              {t('teamWorktime.shifts.swapList.title')}\n            </div>\n          </div>\n          \n          {/* Generate Button */}\n          <div className=\"relative group\">\n            <button\n              type=\"button\"\n              onClick={handleGenerateClick}\n              className=\"p-2 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <svg className=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\n              </svg>\n            </button>\n            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n              {t('teamWorktime.shifts.actions.generate')}\n            </div>\n          </div>\n          \n          {/* Refresh Button */}\n          <div className=\"relative group\">\n            <button\n              type=\"button\"\n              onClick={() => fetchShifts(currentWeek)}\n              className=\"p-2 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <ArrowPathIcon className=\"h-5 w-5\" />\n            </button>\n            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n              {t('common.refresh')}\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      {/* Fehlermeldung */}\n      {error && (\n        <div className=\"bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 px-4 py-3 rounded mb-4\">\n          {error}\n        </div>\n      )}\n      \n      {/* Legende */}\n      {!loading && shifts.length > 0 && (() => {\n        // Erstelle Legende-Daten\n        const branchMap = new Map<number, { id: number; name: string; color: string }>();\n        const statusMap = new Map<string, { status: string; label: string; color: string }>();\n\n        // Sammle alle eindeutigen Branches und Status\n        shifts.forEach(shift => {\n          if (shift.branch && !branchMap.has(shift.branch.id)) {\n            branchMap.set(shift.branch.id, {\n              id: shift.branch.id,\n              name: shift.branch.name,\n              color: getBranchColor(shift.branch.id)\n            });\n          }\n          \n          if (!statusMap.has(shift.status)) {\n            const statusLabels: Record<string, string> = {\n              scheduled: t('teamWorktime.shifts.status.scheduled'),\n              confirmed: t('teamWorktime.shifts.status.confirmed'),\n              cancelled: t('teamWorktime.shifts.status.cancelled'),\n              swapped: t('teamWorktime.shifts.status.swapped')\n            };\n            \n            statusMap.set(shift.status, {\n              status: shift.status,\n              label: statusLabels[shift.status] || shift.status,\n              color: getStatusColor(shift.status)\n            });\n          }\n        });\n\n        const legendBranches = Array.from(branchMap.values());\n        const legendStatuses = Array.from(statusMap.values());\n\n        if (legendBranches.length === 0 && legendStatuses.length === 0) {\n          return null;\n        }\n\n        return (\n          <div className=\"mb-4 p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700\">\n            <div className=\"flex flex-wrap gap-6\">\n              {/* Standort-Legende */}\n              {legendBranches.length > 0 && (\n                <div>\n                  <h3 className=\"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2\">\n                    {t('teamWorktime.shifts.legend.branches')}\n                  </h3>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {legendBranches.map(branch => (\n                      <div key={branch.id} className=\"flex items-center gap-2\">\n                        <div \n                          className=\"w-4 h-4 rounded\"\n                          style={{ backgroundColor: branch.color }}\n                        />\n                        <span className=\"text-xs text-gray-600 dark:text-gray-400\">\n                          {branch.name}\n                        </span>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n\n              {/* Status-Legende */}\n              {legendStatuses.length > 0 && (\n                <div>\n                  <h3 className=\"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2\">\n                    {t('teamWorktime.shifts.legend.statuses')}\n                  </h3>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {legendStatuses.map(status => (\n                      <div key={status.status} className=\"flex items-center gap-2\">\n                        <div \n                          className=\"w-4 h-4 rounded border-2\"\n                          style={{ \n                            backgroundColor: 'transparent',\n                            borderColor: status.color\n                          }}\n                        />\n                        <span className=\"text-xs text-gray-600 dark:text-gray-400\">\n                          {status.label}\n                        </span>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        );\n      })()}\n\n      {/* Kalender-Ansicht */}\n      {loading ? (\n        <div className=\"flex items-center justify-center py-12\">\n          <div className=\"text-gray-600 dark:text-gray-400\">{t('teamWorktime.shifts.messages.loading')}</div>\n        </div>\n      ) : (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4\">\n          {/* View-Toggle */}\n          <div className=\"flex justify-end mb-4\">\n            <div className=\"inline-flex rounded-md shadow-sm gap-1\" role=\"group\">\n              <button\n                onClick={() => {\n                  setCalendarView('timeGridWeek');\n                  calendarRef.current?.getApi().changeView('timeGridWeek');\n                }}\n                className={`p-2 rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${\n                  calendarView === 'timeGridWeek'\n                    ? 'bg-blue-600 text-white'\n                    : 'bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600'\n                }`}\n                title={t('common.week', 'Woche')}\n              >\n                <CalendarIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                onClick={() => {\n                  setCalendarView('dayGridMonth');\n                  calendarRef.current?.getApi().changeView('dayGridMonth');\n                }}\n                className={`p-2 rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${\n                  calendarView === 'dayGridMonth'\n                    ? 'bg-blue-600 text-white'\n                    : 'bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600'\n                }`}\n                title={t('common.month', 'Monat')}\n              >\n                <Squares2X2Icon className=\"h-5 w-5\" />\n              </button>\n        </div>\n      </div>\n      \n      {/* Filter-Panel */}\n      {isFilterPanelOpen && (\n        <div className=\"mb-4 px-3 sm:px-4 md:px-6\">\n          <div className=\"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <h3 className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                {t('teamWorktime.shifts.filters.title')}\n              </h3>\n              <button\n                onClick={() => setIsFilterPanelOpen(false)}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n            </div>\n            \n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n              {/* Branch Filter */}\n              <div>\n                <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('teamWorktime.shifts.filters.branch')}\n                </label>\n                <div className=\"max-h-32 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-2 bg-white dark:bg-gray-700\">\n                  {branches.map((branch) => (\n                    <label key={branch.id} className=\"flex items-center space-x-2 py-1\">\n                      <input\n                        type=\"checkbox\"\n                        checked={selectedBranchIds.includes(branch.id)}\n                        onChange={(e) => {\n                          if (e.target.checked) {\n                            setSelectedBranchIds([...selectedBranchIds, branch.id]);\n                          } else {\n                            setSelectedBranchIds(selectedBranchIds.filter(id => id !== branch.id));\n                          }\n                        }}\n                        className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                      />\n                      <span className=\"text-sm text-gray-700 dark:text-gray-300\">{branch.name}</span>\n                    </label>\n                  ))}\n                </div>\n              </div>\n              \n              {/* Role Filter */}\n              <div>\n                <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('teamWorktime.shifts.filters.role')}\n                </label>\n                <div className=\"max-h-32 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-2 bg-white dark:bg-gray-700\">\n                  {roles.map((role) => (\n                    <label key={role.id} className=\"flex items-center space-x-2 py-1\">\n                      <input\n                        type=\"checkbox\"\n                        checked={selectedRoleIds.includes(role.id)}\n                        onChange={(e) => {\n                          if (e.target.checked) {\n                            setSelectedRoleIds([...selectedRoleIds, role.id]);\n                          } else {\n                            setSelectedRoleIds(selectedRoleIds.filter(id => id !== role.id));\n                          }\n                        }}\n                        className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                      />\n                      <span className=\"text-sm text-gray-700 dark:text-gray-300\">{role.name}</span>\n                    </label>\n                  ))}\n                </div>\n              </div>\n              \n              {/* Status Filter */}\n              <div>\n                <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('teamWorktime.shifts.filters.status')}\n                </label>\n                <div className=\"max-h-32 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-2 bg-white dark:bg-gray-700\">\n                  {statusOptions.map((status) => (\n                    <label key={status.value} className=\"flex items-center space-x-2 py-1\">\n                      <input\n                        type=\"checkbox\"\n                        checked={selectedStatuses.includes(status.value)}\n                        onChange={(e) => {\n                          if (e.target.checked) {\n                            setSelectedStatuses([...selectedStatuses, status.value]);\n                          } else {\n                            setSelectedStatuses(selectedStatuses.filter(s => s !== status.value));\n                          }\n                        }}\n                        className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                      />\n                      <span className=\"text-sm text-gray-700 dark:text-gray-300\">{status.label}</span>\n                    </label>\n                  ))}\n                </div>\n              </div>\n              \n              {/* User Filter */}\n              <div>\n                <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('teamWorktime.shifts.filters.user')}\n                </label>\n                <div className=\"max-h-32 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-2 bg-white dark:bg-gray-700\">\n                  {users.map((user) => (\n                    <label key={user.id} className=\"flex items-center space-x-2 py-1\">\n                      <input\n                        type=\"checkbox\"\n                        checked={selectedUserIds.includes(user.id)}\n                        onChange={(e) => {\n                          if (e.target.checked) {\n                            setSelectedUserIds([...selectedUserIds, user.id]);\n                          } else {\n                            setSelectedUserIds(selectedUserIds.filter(id => id !== user.id));\n                          }\n                        }}\n                        className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                      />\n                      <span className=\"text-sm text-gray-700 dark:text-gray-300\">{user.firstName} {user.lastName}</span>\n                    </label>\n                  ))}\n                </div>\n              </div>\n            </div>\n            \n            {/* Filter Actions */}\n            <div className=\"flex justify-end gap-2 mt-4\">\n              <button\n                onClick={resetFilters}\n                className=\"px-3 py-1.5 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600\"\n              >\n                {t('teamWorktime.shifts.filters.reset')}\n              </button>\n              <button\n                onClick={() => setIsFilterPanelOpen(false)}\n                className=\"px-3 py-1.5 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700\"\n              >\n                {t('common.apply')}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n      \n      {/* FullCalendar */}\n          <div className=\"fullcalendar-container\">\n            <FullCalendar\n              ref={calendarRef}\n              plugins={[timeGridPlugin, dayGridPlugin, interactionPlugin]}\n              initialView={calendarView}\n              initialDate={currentWeek}\n              headerToolbar={{\n                left: 'prev,next today',\n                center: 'title',\n                right: '',\n              }}\n              locale=\"de\"\n              firstDay={1} // Montag\n              weekNumbers={true}\n              weekNumberCalculation=\"ISO\"\n              slotMinTime=\"00:00:00\"\n              slotMaxTime=\"24:00:00\"\n              slotDuration=\"01:00:00\"\n              slotLabelInterval=\"01:00:00\"\n              allDaySlot={false}\n              height=\"auto\"\n              events={calendarEvents}\n              eventClick={handleEventClick}\n              dateClick={handleDateClick}\n              datesSet={handleDatesSet}\n              eventDisplay=\"block\"\n              eventTimeFormat={{\n                hour: '2-digit',\n                minute: '2-digit',\n                hour12: false,\n              }}\n              slotLabelFormat={{\n                hour: '2-digit',\n                minute: '2-digit',\n                hour12: false,\n              }}\n              eventClassNames=\"cursor-pointer\"\n              eventContent={(eventInfo) => {\n                const shift = eventInfo.event.extendedProps.shift;\n                return (\n                  <div className=\"p-1 text-xs\">\n                    <div className=\"font-semibold truncate\">\n                      {shift.shiftTemplate?.name || 'Schicht'}\n                    </div>\n                    {shift.user && (\n                      <div className=\"truncate text-gray-600 dark:text-gray-300\">\n                        {shift.user.firstName} {shift.user.lastName}\n                      </div>\n                    )}\n                    {!shift.user && (\n                      <div className=\"text-gray-500 dark:text-gray-400 italic\">\n                        {t('teamWorktime.shifts.legend.unassigned')}\n                      </div>\n                    )}\n                  </div>\n                );\n              }}\n            />\n          </div>\n          \n          {/* Legende */}\n          <div className=\"mt-4 flex flex-wrap gap-4 text-sm\">\n            <div className=\"flex items-center\">\n              <div className=\"w-4 h-4 bg-blue-500 rounded mr-2\"></div>\n              <span className=\"text-gray-700 dark:text-gray-300\">{t('teamWorktime.shifts.legend.scheduled')}</span>\n            </div>\n            <div className=\"flex items-center\">\n              <div className=\"w-4 h-4 bg-green-500 rounded mr-2\"></div>\n              <span className=\"text-gray-700 dark:text-gray-300\">{t('teamWorktime.shifts.legend.confirmed')}</span>\n            </div>\n            <div className=\"flex items-center\">\n              <div className=\"w-4 h-4 bg-red-500 rounded mr-2\"></div>\n              <span className=\"text-gray-700 dark:text-gray-300\">{t('teamWorktime.shifts.legend.cancelled')}</span>\n            </div>\n            <div className=\"flex items-center\">\n              <div className=\"w-4 h-4 bg-orange-500 rounded mr-2\"></div>\n              <span className=\"text-gray-700 dark:text-gray-300\">{t('teamWorktime.shifts.legend.swapped')}</span>\n            </div>\n          </div>\n        </div>\n      )}\n      \n      {/* Modals */}\n      <CreateShiftModal\n        isOpen={isCreateModalOpen}\n        onClose={() => {\n          setIsCreateModalOpen(false);\n          setCreateModalInitialDate(undefined);\n        }}\n        onShiftCreated={handleShiftCreated}\n        initialDate={createModalInitialDate}\n      />\n      \n      {selectedShift && (\n        <EditShiftModal\n          isOpen={isEditModalOpen}\n          onClose={() => {\n            setIsEditModalOpen(false);\n            setSelectedShift(null);\n          }}\n          onShiftUpdated={handleShiftUpdated}\n          onShiftDeleted={handleShiftDeleted}\n          shift={selectedShift}\n        />\n      )}\n      \n      {/* Generate Shift Plan Modal */}\n      <GenerateShiftPlanModal\n        isOpen={isGenerateModalOpen}\n        onClose={() => setIsGenerateModalOpen(false)}\n        onPlanGenerated={handlePlanGenerated}\n        initialStartDate={startOfWeek(currentWeek, { weekStartsOn: 1 })}\n        initialEndDate={endOfWeek(currentWeek, { weekStartsOn: 1 })}\n      />\n      \n      {/* Swap Request List */}\n      <SwapRequestList\n        isOpen={isSwapListOpen}\n        onClose={() => setIsSwapListOpen(false)}\n        onSwapRequestUpdated={() => {\n          fetchShifts(currentWeek); // Lade Schichten neu, da sich Status gendert haben knnte\n        }}\n      />\n      \n      {/* Template Management */}\n      <ShiftTemplateManagement\n        isOpen={isTemplateManagementOpen}\n        onClose={() => setIsTemplateManagementOpen(false)}\n      />\n      \n      {/* Availability Management */}\n      <AvailabilityManagement\n        isOpen={isAvailabilityManagementOpen}\n        onClose={() => setIsAvailabilityManagementOpen(false)}\n      />\n    </div>\n  );\n};\n\nexport default ShiftPlannerTab;\n\n","import React, { useState, useEffect, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { UsersIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { format } from 'date-fns';\nimport ActiveUsersList from '../components/teamWorktime/ActiveUsersList.tsx';\nimport TodoAnalyticsTab from '../components/teamWorktime/TodoAnalyticsTab.tsx';\nimport RequestAnalyticsTab from '../components/teamWorktime/RequestAnalyticsTab.tsx';\nimport ShiftPlannerTab from '../components/teamWorktime/ShiftPlannerTab.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\n\ntype TabType = 'worktimes' | 'shifts' | 'todos' | 'requests';\n\nconst TeamWorktimeControl: React.FC = () => {\n  const { t } = useTranslation();\n  const { hasPermission } = usePermissions();\n  \n  // Prfe Berechtigungen - beide werden bentigt\n  const hasPagePermission = hasPermission('team_worktime_control', 'read', 'page');\n  const hasTablePermission = hasPermission('team_worktime', 'read', 'table');\n  const hasRequiredPermissions = hasPagePermission && hasTablePermission;\n  \n  // State fr aktive Benutzer und Zeiterfassungen\n  const [activeUsers, setActiveUsers] = useState<any[]>([]);\n  const [allWorktimes, setAllWorktimes] = useState<any[]>([]);\n  const [selectedDate, setSelectedDate] = useState<string>(format(new Date(), 'yyyy-MM-dd'));\n  const [activeTab, setActiveTab] = useState<TabType>('worktimes');\n  \n  // State fr Lade- und Fehlerzustnde\n  const [loading, setLoading] = useState<boolean>(false);\n  const [error, setError] = useState<string | null>(null);\n  \n  //  MEMORY: Cleanup - Alle groen Arrays beim Unmount lschen\n  useEffect(() => {\n    return () => {\n      setActiveUsers([]);\n      setAllWorktimes([]);\n    };\n  }, []); // Nur beim Unmount ausfhren\n  \n  // Funktion zum Abrufen der aktiven Benutzer\n  const fetchActiveUsers = useCallback(async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      \n      const response = await axiosInstance.get(API_ENDPOINTS.TEAM_WORKTIME.ACTIVE);\n      setActiveUsers(response.data);\n    } catch (error: any) {\n      console.error('Fehler beim Laden der aktiven Benutzer:', error);\n      \n      // Spezifische Fehlerbehandlung\n      let errorMessage = t('teamWorktime.messages.loadActiveUsersError');\n      \n      if (error.response) {\n        const status = error.response.status;\n        const backendMessage = error.response.data?.message;\n        \n        if (status === 403) {\n          // Berechtigungsfehler - zeige spezifische Nachricht\n          errorMessage = backendMessage || t('teamWorktime.permissions.insufficientShort');\n        } else if (status === 401) {\n          errorMessage = t('teamWorktime.messages.unauthorized', { defaultValue: 'Nicht autorisiert' });\n        } else if (status === 500) {\n          errorMessage = t('teamWorktime.messages.serverError', { defaultValue: 'Serverfehler' });\n        } else if (backendMessage) {\n          errorMessage = backendMessage;\n        }\n      } else if (error.message) {\n        errorMessage = error.message;\n      }\n      \n      setError(errorMessage);\n      \n      console.error('Fehlerdetails:', {\n        status: error.response?.status,\n        statusText: error.response?.statusText,\n        data: error.response?.data,\n        message: error.message\n      });\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  // Funktion zum Abrufen aller Zeiterfassungen fr ein Datum\n  const fetchAllWorktimes = useCallback(async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      \n      const response = await axiosInstance.get(`${API_ENDPOINTS.TEAM_WORKTIME.USER_DAY}?date=${selectedDate}`);\n      setAllWorktimes(response.data);\n    } catch (error) {\n      console.error('Fehler beim Laden der Zeiterfassungen:', error);\n      setError(t('teamWorktime.messages.loadWorktimesError'));\n    } finally {\n      setLoading(false);\n    }\n  }, [selectedDate]);\n  \n  // Stoppe die Zeiterfassung eines Benutzers\n  const stopUserWorktime = async (userId: number, endTime: string) => {\n    try {\n      setLoading(true);\n      setError(null);\n      \n      await axiosInstance.post(API_ENDPOINTS.TEAM_WORKTIME.STOP_USER, {\n        userId,\n        endTime: new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000)\n      });\n      \n      // Aktualisiere die Liste der aktiven Benutzer\n      fetchActiveUsers();\n    } catch (error) {\n      console.error('Fehler beim Stoppen der Benutzer-Zeiterfassung:', error);\n      setError(t('teamWorktime.messages.stopWorktimeError'));\n    } finally {\n      setLoading(false);\n    }\n  };\n  \n  // Lade aktive Benutzer und Zeiterfassungen beim ersten Rendern\n  useEffect(() => {\n    // Nur API-Calls machen, wenn Berechtigungen vorhanden sind\n    if (!hasRequiredPermissions) {\n      setError(t('teamWorktime.permissions.insufficientDetails'));\n      return;\n    }\n    \n    fetchActiveUsers();\n    fetchAllWorktimes();\n    \n    //  MEMORY: Polling nur wenn Seite sichtbar ist (Page Visibility API)\n    let intervalId: ReturnType<typeof setInterval> | null = null;\n    \n    const startPolling = () => {\n      if (intervalId) return; // Bereits gestartet\n      intervalId = setInterval(() => {\n        // Prfe nochmal, ob Seite sichtbar ist\n        if (!document.hidden) {\n          fetchActiveUsers();\n        }\n      }, 30000);\n    };\n    \n    const stopPolling = () => {\n      if (intervalId) {\n        clearInterval(intervalId);\n        intervalId = null;\n      }\n    };\n    \n    // Starte Polling wenn Seite sichtbar ist\n    if (!document.hidden) {\n      startPolling();\n    }\n    \n    // Event-Listener fr Page Visibility\n    const handleVisibilityChange = () => {\n      if (document.hidden) {\n        stopPolling();\n      } else {\n        // Seite ist wieder sichtbar - sofort prfen und Polling starten\n        fetchActiveUsers();\n        startPolling();\n      }\n    };\n    \n    document.addEventListener('visibilitychange', handleVisibilityChange);\n    \n    return () => {\n      stopPolling();\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\n    };\n  }, [fetchActiveUsers, fetchAllWorktimes, hasRequiredPermissions]);\n\n  // Lade Zeiterfassungen neu, wenn sich das Datum ndert\n  useEffect(() => {\n    fetchAllWorktimes();\n  }, [selectedDate, fetchAllWorktimes]);\n  \n  return (\n    <div className=\"min-h-screen dark:bg-gray-900\">\n      <div className=\"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6\">\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n            {/* Header mit Icon */}\n            <div className=\"flex items-center justify-between mb-6\">\n              <div className=\"flex items-center pl-2 sm:pl-0\">\n                <UsersIcon className=\"h-6 w-6 text-gray-900 dark:text-white mr-2\" />\n                <h2 className=\"text-xl font-semibold text-gray-900 dark:text-white\">{t('teamWorktime.title')}</h2>\n              </div>\n            </div>\n            \n            {/* Berechtigungsfehler */}\n            {!hasRequiredPermissions && (\n              <div className=\"bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 px-4 py-3 rounded mb-4\">\n                <p className=\"font-medium mb-2\">{t('teamWorktime.permissions.insufficient')}</p>\n                <ul className=\"list-disc list-inside text-sm space-y-1\">\n                  {!hasPagePermission && (\n                    <li>{t('teamWorktime.permissions.missingPage')}</li>\n                  )}\n                  {!hasTablePermission && (\n                    <li>{t('teamWorktime.permissions.missingTable')}</li>\n                  )}\n                </ul>\n                <p className=\"text-sm mt-2\">{t('teamWorktime.permissions.contactAdmin')}</p>\n              </div>\n            )}\n            \n            {/* Fehlermeldung */}\n            {error && (\n              <div className=\"bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 px-4 py-3 rounded mb-4\">\n                {error}\n              </div>\n            )}\n            \n            {/* Tab-Navigation */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700 mb-6\">\n              <nav className=\"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto overflow-y-hidden\">\n                <button\n                  onClick={() => setActiveTab('worktimes')}\n                  className={`py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 ${\n                    activeTab === 'worktimes'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  {t('teamWorktime.tabs.worktimes')}\n                </button>\n                <button\n                  onClick={() => setActiveTab('shifts')}\n                  className={`py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 ${\n                    activeTab === 'shifts'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  {t('teamWorktime.tabs.shifts')}\n                </button>\n                <button\n                  onClick={() => setActiveTab('todos')}\n                  className={`py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 ${\n                    activeTab === 'todos'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  {t('teamWorktime.tabs.todos')}\n                </button>\n                <button\n                  onClick={() => setActiveTab('requests')}\n                  className={`py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 ${\n                    activeTab === 'requests'\n                      ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                      : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                  }`}\n                >\n                  {t('teamWorktime.tabs.requests')}\n                </button>\n              </nav>\n            </div>\n            \n            {/* Tab-Content */}\n            {activeTab === 'worktimes' && (\n              <ActiveUsersList\n                activeUsers={activeUsers}\n                allWorktimes={allWorktimes}\n                loading={loading}\n                selectedDate={selectedDate}\n                onDateChange={setSelectedDate}\n                onStopWorktime={stopUserWorktime}\n                onRefresh={fetchActiveUsers}\n                showTodos={true}\n                showRequests={true}\n              />\n            )}\n            {activeTab === 'shifts' && (\n              <ShiftPlannerTab selectedDate={selectedDate} />\n            )}\n            {activeTab === 'todos' && (\n              <TodoAnalyticsTab />\n            )}\n            {activeTab === 'requests' && (\n              <RequestAnalyticsTab />\n            )}\n          </div>\n      </div>\n    </div>\n  );\n};\n\nexport default TeamWorktimeControl; ","/**\r\n * Zentrale Filter-Logik zur Eliminierung von Code-Duplikation\r\n * \r\n * Diese Datei konsolidiert die Filter-Logik, die zuvor in mehreren Komponenten\r\n * dupliziert war (Requests.tsx, Worktracker.tsx, InvoiceManagementTab.tsx, etc.)\r\n * \r\n * WICHTIG: Die Logik ist exakt identisch mit der vorherigen Implementierung.\r\n * Nur die Code-Duplikation wurde entfernt, keine Funktionalittsnderung!\r\n */\r\n\r\nimport { startOfWeek, endOfWeek, startOfMonth, endOfMonth, startOfYear, endOfYear } from 'date-fns';\r\n\r\nexport interface FilterCondition {\r\n  column: string;\r\n  operator: string;\r\n  value: string | number | Date | null;\r\n}\r\n\r\n/**\r\n * Evaluates a single filter condition against a field value\r\n * @param fieldValue - The value to test against\r\n * @param condition - The filter condition to apply\r\n * @returns true if condition is met, false otherwise\r\n */\r\nexport const evaluateCondition = (\r\n  fieldValue: any,\r\n  condition: FilterCondition\r\n): boolean => {\r\n  const { operator, value } = condition;\r\n  \r\n  // Sicherstellen, dass value definiert ist\r\n  if (value === undefined) {\r\n    console.error('evaluateCondition: value ist undefined', condition);\r\n    return false;\r\n  }\r\n  \r\n  // Handle null/undefined values\r\n  if (fieldValue == null && value == null) {\r\n    return operator === 'equals';\r\n  }\r\n  if (fieldValue == null || value == null) {\r\n    if (operator === 'notEquals') return true;\r\n    return false;\r\n  }\r\n\r\n  // String operations\r\n  // Sicherstellen, dass fieldValue und value Strings sind, bevor toLowerCase() aufgerufen wird\r\n  let strField: string = '';\r\n  let strValue: string = '';\r\n  \r\n  try {\r\n    // Konvertiere fieldValue zu String, auch wenn es ein Objekt ist\r\n    const fieldValueStr = fieldValue == null ? '' : (typeof fieldValue === 'string' ? fieldValue : String(fieldValue));\r\n    if (typeof fieldValueStr !== 'string') {\r\n      return false;\r\n    }\r\n    const lowerField = fieldValueStr.toLowerCase();\r\n    if (lowerField === undefined || lowerField === null || typeof lowerField !== 'string') {\r\n      return false;\r\n    }\r\n    strField = lowerField;\r\n    \r\n    // Konvertiere value zu String, auch wenn es ein Objekt ist\r\n    const valueStr = value == null ? '' : (typeof value === 'string' ? value : String(value));\r\n    if (typeof valueStr !== 'string') {\r\n      return false;\r\n    }\r\n    const lowerValue = valueStr.toLowerCase();\r\n    if (lowerValue === undefined || lowerValue === null || typeof lowerValue !== 'string') {\r\n      return false;\r\n    }\r\n    strValue = lowerValue;\r\n  } catch (error) {\r\n    // Falls toLowerCase() fehlschlgt, gebe false zurck\r\n    return false;\r\n  }\r\n\r\n  // Sicherstellen, dass strField und strValue Strings sind und nicht undefined\r\n  if (typeof strField !== 'string' || typeof strValue !== 'string' || strField === undefined || strValue === undefined || strField === null || strValue === null) {\r\n    return false;\r\n  }\r\n\r\n  switch (operator) {\r\n    case 'equals':\r\n      return strField === strValue;\r\n    case 'notEquals':\r\n      return strField !== strValue;\r\n    case 'contains':\r\n      return strField.includes(strValue);\r\n    case 'startsWith':\r\n      return strField.startsWith(strValue);\r\n    case 'endsWith':\r\n      // Explizite Prfung, dass strField und strValue Strings sind, bevor endsWith aufgerufen wird\r\n      if (strField === undefined || strField === null) {\r\n        console.error('endsWith: strField ist undefined/null', { strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      if (strValue === undefined || strValue === null) {\r\n        console.error('endsWith: strValue ist undefined/null', { strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      if (typeof strField !== 'string') {\r\n        console.error('endsWith: strField ist kein String', { strField, typeof: typeof strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      if (typeof strValue !== 'string') {\r\n        console.error('endsWith: strValue ist kein String', { strField, strValue, typeof: typeof strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n      try {\r\n        return strField.endsWith(strValue);\r\n      } catch (error) {\r\n        console.error('endsWith: Fehler bei endsWith-Aufruf', error, { strField, strValue, fieldValue, value, condition });\r\n        return false;\r\n      }\r\n    case 'before':\r\n    case 'after': {\r\n      // Date operations\r\n      const fieldDate = new Date(fieldValue);\r\n      const valueDate = new Date(value as string);\r\n      if (isNaN(fieldDate.getTime()) || isNaN(valueDate.getTime())) {\r\n        return false;\r\n      }\r\n      return operator === 'before' \r\n        ? fieldDate < valueDate \r\n        : fieldDate > valueDate;\r\n    }\r\n    case 'greaterThan':\r\n    case 'lessThan': {\r\n      // Numeric operations\r\n      const fieldNum = parseFloat(String(fieldValue));\r\n      const valueNum = parseFloat(String(value));\r\n      if (isNaN(fieldNum) || isNaN(valueNum)) {\r\n        return false;\r\n      }\r\n      return operator === 'greaterThan'\r\n        ? fieldNum > valueNum\r\n        : fieldNum < valueNum;\r\n    }\r\n    default:\r\n      return true;\r\n  }\r\n};\r\n\r\n/**\r\n * Type for getting field values from items\r\n */\r\nexport type GetFieldValue<T> = (item: T, columnId: string) => any;\r\n\r\n/**\r\n * Type for column-specific evaluation handlers\r\n * Returns true if condition is met, false otherwise\r\n */\r\nexport type ColumnEvaluator<T> = (item: T, condition: FilterCondition) => boolean | null;\r\n\r\n/**\r\n * Applies filter conditions to an array of items\r\n * \r\n * @param items - Array of items to filter\r\n * @param conditions - Array of filter conditions\r\n * @param operators - Array of logical operators ('AND' | 'OR') between conditions\r\n * @param getFieldValue - Function to extract field values from items\r\n * @param columnEvaluators - Optional map of column-specific evaluators for custom logic\r\n * @returns Filtered array of items\r\n * \r\n * @example\r\n * // Standard usage with getFieldValue\r\n * const filtered = applyFilters(items, conditions, operators, (item, col) => item[col]);\r\n * \r\n * // With custom column evaluators\r\n * const filtered = applyFilters(\r\n *   items,\r\n *   conditions,\r\n *   operators,\r\n *   (item, col) => item[col],\r\n *   {\r\n *     'responsible': (item, condition) => {\r\n *       // Custom logic for responsible column\r\n *       return evaluateUserRoleCondition(item.responsible?.id, item.role?.id, condition);\r\n *     }\r\n *   }\r\n * );\r\n */\r\nexport const applyFilters = <T>(\r\n  items: T[],\r\n  conditions: FilterCondition[],\r\n  operators: ('AND' | 'OR')[],\r\n  getFieldValue: GetFieldValue<T>,\r\n  columnEvaluators?: Record<string, ColumnEvaluator<T>>\r\n): T[] => {\r\n  if (conditions.length === 0) {\r\n    return items;\r\n  }\r\n\r\n  return items.filter(item => {\r\n    let result = true;\r\n\r\n    for (let i = 0; i < conditions.length; i++) {\r\n      const condition = conditions[i];\r\n      let conditionMet = false;\r\n\r\n      // Check if there's a custom evaluator for this column\r\n      if (columnEvaluators && columnEvaluators[condition.column]) {\r\n        const customResult = columnEvaluators[condition.column](item, condition);\r\n        if (customResult !== null) {\r\n          conditionMet = customResult;\r\n        } else {\r\n          // Fallback to standard evaluation if custom evaluator returns null\r\n          const fieldValue = getFieldValue(item, condition.column);\r\n          conditionMet = evaluateCondition(fieldValue, condition);\r\n        }\r\n      } else {\r\n        // Standard evaluation\r\n        const fieldValue = getFieldValue(item, condition.column);\r\n        conditionMet = evaluateCondition(fieldValue, condition);\r\n      }\r\n\r\n      // Apply logical operators\r\n      if (i === 0) {\r\n        result = conditionMet;\r\n      } else {\r\n        const operator = operators[i - 1] || 'AND';\r\n        result = operator === 'AND' \r\n          ? (result && conditionMet) \r\n          : (result || conditionMet);\r\n      }\r\n    }\r\n\r\n    return result;\r\n  });\r\n};\r\n\r\n/**\r\n * Helper function to evaluate date conditions with proper date comparison\r\n * Supports __TODAY__ as a dynamic date value\r\n * \r\n * WICHTIG: Extrahiert nur den Datumsteil (Jahr, Monat, Tag) ohne Zeitzone,\r\n * um Zeitzone-Konvertierungsprobleme zu vermeiden (verhindert Tag-Versatz)\r\n */\r\nexport const evaluateDateCondition = (\r\n  dateValue: Date | string | null | undefined,\r\n  condition: FilterCondition\r\n): boolean => {\r\n  if (!dateValue) {\r\n    return false;\r\n  }\r\n\r\n  const date = new Date(dateValue);\r\n  if (isNaN(date.getTime())) {\r\n    return false;\r\n  }\r\n\r\n  // Extrahiere nur den Datumsteil (Jahr, Monat, Tag) mit UTC-Methoden\r\n  // Dies verhindert Zeitzone-Konvertierung, die zu einem Tag-Versatz fhrt\r\n  const dateYear = date.getUTCFullYear();\r\n  const dateMonth = date.getUTCMonth();\r\n  const dateDay = date.getUTCDate();\r\n  // Erstelle lokales Date-Objekt aus den UTC-Werten (ohne Zeitzone)\r\n  const normalizedDate = new Date(dateYear, dateMonth, dateDay);\r\n\r\n  //  PHASE 5: Handle Zeitraum-Platzhalter (__THIS_WEEK__, __THIS_MONTH__, __THIS_YEAR__)\r\n  // Diese funktionieren analog zu __TODAY__, aber fr Zeitrume\r\n  try {\r\n    if (condition.value === '__THIS_WEEK__') {\r\n      if (condition.operator === 'equals') {\r\n        const weekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\r\n        weekStart.setHours(0, 0, 0, 0);\r\n        const weekEnd = endOfWeek(new Date(), { weekStartsOn: 1 });\r\n        weekEnd.setHours(23, 59, 59, 999);\r\n        // Prfe, ob normalizedDate innerhalb des Zeitraums liegt\r\n        return normalizedDate >= weekStart && normalizedDate <= weekEnd;\r\n      }\r\n      // Fr andere Operatoren (before, after) verwende Woche als einzelnes Datum\r\n      const weekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekStart.setHours(0, 0, 0, 0);\r\n      const weekEnd = endOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekEnd.setHours(23, 59, 59, 999);\r\n      if (condition.operator === 'before') {\r\n        return normalizedDate < weekEnd;\r\n      } else if (condition.operator === 'after') {\r\n        return normalizedDate > weekStart;\r\n      }\r\n      return false;\r\n    } else if (condition.value === '__THIS_MONTH__') {\r\n      if (condition.operator === 'equals') {\r\n        const monthStart = startOfMonth(new Date());\r\n        monthStart.setHours(0, 0, 0, 0);\r\n        const monthEnd = endOfMonth(new Date());\r\n        monthEnd.setHours(23, 59, 59, 999);\r\n        // Prfe, ob normalizedDate innerhalb des Zeitraums liegt\r\n        return normalizedDate >= monthStart && normalizedDate <= monthEnd;\r\n      }\r\n      // Fr andere Operatoren (before, after) verwende Monat als einzelnes Datum\r\n      const monthStart = startOfMonth(new Date());\r\n      monthStart.setHours(0, 0, 0, 0);\r\n      const monthEnd = endOfMonth(new Date());\r\n      monthEnd.setHours(23, 59, 59, 999);\r\n      if (condition.operator === 'before') {\r\n        return normalizedDate < monthEnd;\r\n      } else if (condition.operator === 'after') {\r\n        return normalizedDate > monthStart;\r\n      }\r\n      return false;\r\n    } else if (condition.value === '__THIS_YEAR__') {\r\n      if (condition.operator === 'equals') {\r\n        const yearStart = startOfYear(new Date());\r\n        yearStart.setHours(0, 0, 0, 0);\r\n        const yearEnd = endOfYear(new Date());\r\n        yearEnd.setHours(23, 59, 59, 999);\r\n        // Prfe, ob normalizedDate innerhalb des Zeitraums liegt\r\n        return normalizedDate >= yearStart && normalizedDate <= yearEnd;\r\n      }\r\n      // Fr andere Operatoren (before, after) verwende Jahr als einzelnes Datum\r\n      const yearStart = startOfYear(new Date());\r\n      yearStart.setHours(0, 0, 0, 0);\r\n      const yearEnd = endOfYear(new Date());\r\n      yearEnd.setHours(23, 59, 59, 999);\r\n      if (condition.operator === 'before') {\r\n        return normalizedDate < yearEnd;\r\n      } else if (condition.operator === 'after') {\r\n        return normalizedDate > yearStart;\r\n      }\r\n      return false;\r\n    }\r\n\r\n    // Handle __TODAY__, __WEEK_START__, __WEEK_END__, __MONTH_START__, __MONTH_END__, __YEAR_START__, __YEAR_END__ dynamic dates\r\n    let conditionDate: Date;\r\n    if (condition.value === '__TODAY__') {\r\n      // Get today's date in local timezone (set to midnight)\r\n      const localToday = new Date();\r\n      localToday.setHours(0, 0, 0, 0);\r\n      conditionDate = localToday;\r\n    } else if (condition.value === '__WEEK_START__') {\r\n      const weekStart = startOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekStart.setHours(0, 0, 0, 0);\r\n      conditionDate = weekStart;\r\n    } else if (condition.value === '__WEEK_END__') {\r\n      const weekEnd = endOfWeek(new Date(), { weekStartsOn: 1 });\r\n      weekEnd.setHours(23, 59, 59, 999);\r\n      conditionDate = weekEnd;\r\n    } else if (condition.value === '__MONTH_START__') {\r\n      const monthStart = startOfMonth(new Date());\r\n      monthStart.setHours(0, 0, 0, 0);\r\n      conditionDate = monthStart;\r\n    } else if (condition.value === '__MONTH_END__') {\r\n      const monthEnd = endOfMonth(new Date());\r\n      monthEnd.setHours(23, 59, 59, 999);\r\n      conditionDate = monthEnd;\r\n    } else if (condition.value === '__YEAR_START__') {\r\n      const yearStart = startOfYear(new Date());\r\n      yearStart.setHours(0, 0, 0, 0);\r\n      conditionDate = yearStart;\r\n    } else if (condition.value === '__YEAR_END__') {\r\n      const yearEnd = endOfYear(new Date());\r\n      yearEnd.setHours(23, 59, 59, 999);\r\n      conditionDate = yearEnd;\r\n    } else {\r\n      const conditionDateRaw = new Date(condition.value as string);\r\n      if (isNaN(conditionDateRaw.getTime())) {\r\n        return false;\r\n      }\r\n      // Extrahiere nur den Datumsteil (Jahr, Monat, Tag) mit UTC-Methoden\r\n      // Dies verhindert Zeitzone-Konvertierung, die zu einem Tag-Versatz fhrt\r\n      const conditionYear = conditionDateRaw.getUTCFullYear();\r\n      const conditionMonth = conditionDateRaw.getUTCMonth();\r\n      const conditionDay = conditionDateRaw.getUTCDate();\r\n      // Erstelle lokales Date-Objekt aus den UTC-Werten (ohne Zeitzone)\r\n      conditionDate = new Date(conditionYear, conditionMonth, conditionDay);\r\n    }\r\n\r\n    switch (condition.operator) {\r\n      case 'equals':\r\n        return normalizedDate.getTime() === conditionDate.getTime();\r\n      case 'before':\r\n        return normalizedDate < conditionDate;\r\n      case 'after':\r\n        return normalizedDate > conditionDate;\r\n      default:\r\n        return true;\r\n    }\r\n  } catch (error) {\r\n    //  PHASE 5: Error Handling fr ungltige Platzhalter-Werte\r\n    console.error(`[evaluateDateCondition] Error with placeholder ${condition.value}:`, error);\r\n    return false; // Fallback: Filter schliet Datensatz aus\r\n  }\r\n};\r\n\r\n/**\r\n * Helper function to evaluate user/role conditions with user-{id} or role-{id} format\r\n * Supports both user-{id} and role-{id} formats, plus text fallback for legacy support\r\n */\r\nexport const evaluateUserRoleCondition = (\r\n  userId: number | null | undefined,\r\n  roleId: number | null | undefined,\r\n  condition: FilterCondition,\r\n  textValue?: string  // Optional: text representation for fallback (e.g. \"John Doe\")\r\n): boolean => {\r\n  const value = condition.value as string || '';\r\n  \r\n  // Handle user-{id} format\r\n  if (value.startsWith('user-')) {\r\n    const targetUserId = parseInt(value.replace('user-', ''), 10);\r\n    if (isNaN(targetUserId)) return false;\r\n    const matches = userId === targetUserId;\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Handle role-{id} format\r\n  if (value.startsWith('role-')) {\r\n    const targetRoleId = parseInt(value.replace('role-', ''), 10);\r\n    if (isNaN(targetRoleId)) return false;\r\n    const matches = roleId === targetRoleId;\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Empty value matches all\r\n  if (value === '') {\r\n    return true;\r\n  }\r\n  \r\n  // Fallback to text comparison (legacy support)\r\n  if (textValue !== undefined) {\r\n    const textValueLower = textValue.toLowerCase();\r\n    const valueLower = value.toLowerCase();\r\n    if (condition.operator === 'equals') {\r\n      return textValueLower === valueLower;\r\n    } else if (condition.operator === 'notEquals') {\r\n      return textValueLower !== valueLower;\r\n    } else if (condition.operator === 'contains') {\r\n      return textValueLower.includes(valueLower);\r\n    }\r\n  }\r\n  \r\n  return false;\r\n};\r\n\r\n/**\r\n * Helper function for combined responsible/qualityControl filter (specific to Tasks)\r\n */\r\nexport const evaluateResponsibleAndQualityControl = (\r\n  responsibleId: number | null | undefined,\r\n  responsibleRoleId: number | null | undefined,\r\n  qualityControlId: number | null | undefined,\r\n  condition: FilterCondition,\r\n  responsibleText?: string,\r\n  qualityControlText?: string\r\n): boolean => {\r\n  const value = condition.value as string || '';\r\n  \r\n  // Handle user-{id} format - matches either responsible OR qualityControl\r\n  if (value.startsWith('user-')) {\r\n    const targetUserId = parseInt(value.replace('user-', ''), 10);\r\n    if (isNaN(targetUserId)) return false;\r\n    const matches = (responsibleId === targetUserId) || (qualityControlId === targetUserId);\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Handle role-{id} format - only matches with responsible role\r\n  if (value.startsWith('role-')) {\r\n    const targetRoleId = parseInt(value.replace('role-', ''), 10);\r\n    if (isNaN(targetRoleId)) return false;\r\n    const matches = responsibleRoleId === targetRoleId;\r\n    // Untersttze notEquals Operator\r\n    if (condition.operator === 'notEquals') {\r\n      return !matches;\r\n    }\r\n    return matches;\r\n  }\r\n  \r\n  // Empty value matches all\r\n  if (value === '') {\r\n    return true;\r\n  }\r\n  \r\n  // Fallback to text comparison (legacy support)\r\n  const valueLower = value.toLowerCase();\r\n  if (condition.operator === 'equals') {\r\n    return (responsibleText?.toLowerCase() === valueLower) || (qualityControlText?.toLowerCase() === valueLower);\r\n  } else if (condition.operator === 'notEquals') {\r\n    return (responsibleText?.toLowerCase() !== valueLower) && (qualityControlText?.toLowerCase() !== valueLower);\r\n  } else if (condition.operator === 'contains') {\r\n    return (responsibleText?.toLowerCase()?.includes(valueLower) ?? false) || (qualityControlText?.toLowerCase()?.includes(valueLower) ?? false);\r\n  }\r\n  \r\n  return false;\r\n};\r\n\r\n"],"names":["_ref","isOpen","onClose","onConfirm","userName","t","useTranslation","now","Date","formattedDate","format","formattedTime","date","setDate","useState","time","setTime","loading","setLoading","_jsx","Transition","appear","show","as","Fragment","children","_jsxs","Dialog","className","Child","enter","enterFrom","enterTo","leave","leaveFrom","leaveTo","Panel","Title","type","onClick","XMarkIcon","htmlFor","id","value","onChange","e","target","step","disabled","title","async","endTime","concat","error","console","ArrowPathIcon","CheckIcon","onSave","entries","selectedDate","openSidepane","closeSidepane","useSidepane","editedEntries","setEditedEntries","setError","isMobile","setIsMobile","window","innerWidth","isLargeScreen","setIsLargeScreen","useEffect","handleResize","addEventListener","removeEventListener","length","formattedEntries","map","entry","datePart","startTime","split","startTimePart","substring","endTimePart","startDateTime","endDateTime","_objectSpread","startTimeTime","endTimeTime","isDeleted","isModified","validateEntries","entriesToValidate","activeEntries","filter","i","entry1","start1","end1","j","entry2","start2","end2","handleSave","updatedEntries","startTimeStr","endTimeStr","renderForm","reverse","join","style","tableLayout","scope","minWidth","width","colSpan","index","handleStartDateTimeChange","newEntries","timePart","timeWithSeconds","handleEndDateTimeChange","handleToggleDelete","TrashIcon","Boolean","open","_Fragment","opacity","transition","pointerEvents","role","defaultColumnOrder","tableToCardMapping","cardToTableMapping","WORKCENTER_TABLE_ID","activeUsers","allWorktimes","onDateChange","onStopWorktime","onRefresh","showTodos","showRequests","availableColumns","useMemo","label","showStopModal","setShowStopModal","showEditModal","setShowEditModal","selectedUser","setSelectedUser","searchTerm","setSearchTerm","isFilterOpen","setIsFilterOpen","draggedColumn","setDraggedColumn","isColumnConfigOpen","setIsColumnConfigOpen","displayLimit","setDisplayLimit","filterConditions","setFilterConditions","filterLogicalOperators","setFilterLogicalOperators","activeFilterName","setActiveFilterName","selectedFilterId","setSelectedFilterId","userTodos","setUserTodos","userRequests","setUserRequests","expandedUsers","setExpandedUsers","Set","loadingTodos","setLoadingTodos","loadingRequests","setLoadingRequests","hasPermission","usePermissions","response","axiosInstance","get","API_ENDPOINTS","TEAM_WORKTIME","ANALYTICS","TODOS_BY_USER","params","todosMap","data","forEach","item","userId","todos","loadUserTodos","REQUESTS_BY_USER","requestsMap","requests","loadUserRequests","toggleExpand","prev","next","has","delete","add","settings","updateColumnOrder","updateHiddenColumns","isColumnVisible","updateViewMode","updateSortConfig","useTableSettings","defaultHiddenColumns","defaultViewMode","columnOrder","hiddenColumns","viewMode","sortConfig","key","direction","cardMetadataOrder","cardMetadata","tableCol","cardMeta","push","getCardMetadataFromColumnOrder","hiddenCardMetadata","hiddenTableColumns","getHiddenCardMetadata","visibleCardMetadata","meta","document","querySelectorAll","wrapper","classList","remove","handleOpenStopModal","user","handleCloseStopModal","handleOpenEditModal","handleCloseEditModal","handleDragStart","columnId","handleDragOver","useCallback","preventDefault","handleDrop","targetColumnId","newOrder","draggedIndex","indexOf","targetIndex","splice","handleDragEnd","getActiveFilterCount","filteredAndSortedUsers","allEntries","worktime","activeEntry","find","userGroups","reduce","groups","branch","createLocalDate","totalDuration","hasActiveWorktime","group","entryStartTime","entryEndTime","duration","getTime","filtered","Object","values","searchTermLower","toLowerCase","username","includes","name","firstName","lastName","columnEvaluators","cond","fullName","operator","startsWith","endsWith","branchName","isActive","minDuration","parseInt","tolerance","Math","abs","getFieldValue","applyFilters","getSortValue","sort","a","b","valueA","valueB","comparison","strA","String","strB","localeCompare","renderSortableHeader","isSorted","newDirection","handleSort","draggable","onDragStart","onDragOver","onDrop","onDragEnd","ArrowsUpDownIcon","React","token","localStorage","getItem","existingFilters","SAVED_FILTERS","BY_TABLE","headers","Authorization","aktiveFilterExists","some","alleFilterExists","aktiveFilter","tableId","conditions","column","operators","post","BASE","alleFilter","process","createStandardFilters","filterContext","useFilterContext","loadFilters","applyFilterConditions","resetFilterConditions","handleFilterChange","defaultFilter","initialize","isDateBeforeToday","today","setHours","year","month","day","Number","selected","handlePreviousDay","previousDate","subDays","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","handleNextDay","nextDate","addDays","placeholder","Squares2X2Icon","TableCellsIcon","FunnelIcon","position","top","right","TableColumnConfig","columns","visibleColumns","Array","from","onToggleColumnVisibility","tableColumn","newHiddenColumns","onMoveColumn","handleMoveColumn","dragIndex","hoverIndex","newCardOrder","dragged","newTableOrder","usedTableColumns","col","newColumnOrder","draggedItem","mainSortConfig","onMainSortChange","showMainSort","buttonTitle","modalTitle","FilterPane","onApply","onReset","savedConditions","savedOperators","SavedFilterTags","onSelectFilter","onFilterChange","defaultFilterName","slice","totalPauseTime","userTodosData","userRequestsData","isExpanded","hasActivities","total","formatDistanceToNow","locale","de","addSuffix","StopIcon","PencilIcon","completed","inProgress","details","todo","status","updatedAt","approved","pending","request","createdAt","CardGrid","gap","metadata","firstRowMetadata","secondRowMetadata","icon","UserIcon","ClockIcon","BuildingOfficeIcon","actions","expandableContent","DataCard","expandable","content","onToggle","undefined","prevLimit","ChevronDownIcon","StopWorktimeModal","latest","current","latestDate","EditWorktimeModal","entriesToUpdate","entriesToDelete","updatePromises","put","deletePromises","Promise","all","success","worktimeApi","alert","errorMessage","message","TODO_ANALYTICS_TABLE_ID","useAuth","setTodos","isFilterPanelOpen","setIsFilterPanelOpen","isLoading","isLoadingSettings","toggleColumnVisibility","visibleColumnIds","savedViewMode","setViewMode","expandedTodos","setExpandedTodos","toggleTodoExpand","todoId","frequencyData","setFrequencyData","loadingFrequency","setLoadingFrequency","showFrequencyAnalysis","setShowFrequencyAnalysis","shiftData","setShiftData","loadingShifts","setLoadingShifts","showShiftAnalysis","setShowShiftAnalysis","expandedShifts","setExpandedShifts","defaultValue","filterConditionsKey","JSON","stringify","filterOperatorsKey","abortController","AbortController","period","filterId","TODOS_CHRONOLOGICAL","signal","code","aborted","fetchTodos","abort","TODOS_FREQUENCY","fetchFrequencyAnalysis","TODOS_SHIFTS","fetchShiftAnalysis","filters","userFilterName","trim","f","c","getStatusColor","getStatusLabel","done","in_progress","quality_control","improval","filteredTodos","searchLower","responsible","condition","stats","qualityControl","ClipboardDocumentListIcon","newMode","ChartBarIcon","summary","totalTasks","completedTasks","neverCompletedTasks","completionRate","userStats","stat","completedCount","lastCompletedAt","taskStats","neverCompleted","currentStatus","taskId","statusAverages","keys","_ref2","averageHours","toFixed","taskCount","height","round","minHeight","totalShifts","totalTasksInShifts","totalDurationHours","averageDurationHours","shifts","shift","workTimeId","durationHours","linkedTasksCount","toggleShiftExpand","ChevronUpIcon","linkedTasks","task","tasksWithShifts","shiftCount","hasStatusHistory","statusHistory","createdBy","deletedAt","deletedBy","historyItem","idx","changedAt","oldStatus","newStatus","section","color","REQUEST_ANALYTICS_TABLE_ID","setRequests","expandedRequests","setExpandedRequests","REQUESTS_CHRONOLOGICAL","fetchRequests","approval","denied","to_improve","filteredRequests","requester","r","toImprove","DocumentTextIcon","toggleRequestExpand","requestId","onShiftCreated","initialDate","initialBranchId","initialRoleId","shiftTemplateId","setShiftTemplateId","branchId","setBranchId","roleId","setRoleId","setUserId","notes","setNotes","templates","setTemplates","users","setUsers","roles","setRoles","branches","setBranches","loadingData","setLoadingData","checkScreenSize","fetchData","fetchTemplates","defaultBranch","defaultRole","branchesResponse","rolesResponse","usersResponse","BRANCHES","ROLES","USERS","DROPDOWN","err","_err$response","_err$response$data","SHIFTS","TEMPLATES","includeInactive","templatesData","_err$response2","_err$response2$data","handleSubmit","logger","log","handleClose","_err$response3","_err$response3$data","onSubmit","required","template","rows","onSwapRequestCreated","originalShift","targetShiftId","setTargetShiftId","setMessage","availableShifts","setAvailableShifts","submitting","setSubmitting","fetchAvailableShifts","_response$data","weekStart","getDate","getDay","weekEnd","startDate","endDate","SWAPS","originalShiftId","_response$data2","errorMsg","_originalShift$shiftT","shiftTemplate","onShiftUpdated","onShiftDeleted","setStatus","showDeleteConfirm","setShowDeleteConfirm","isSwapModalOpen","setIsSwapModalOpen","updateData","BY_ID","handleDelete","_err$response4","_err$response4$data","_branches$find","_roles$find","_shift$shiftTemplate","ArrowsRightLeftIcon","SwapRequestModal","onPlanGenerated","initialStartDate","initialEndDate","setStartDate","startOfWeek","weekStartsOn","setEndDate","endOfWeek","selectedRoleIds","setSelectedRoleIds","generating","setGenerating","result","setResult","showResult","setShowResult","fetchRoles","allRoles","handleSelectAllRoles","start","end","isNaN","requestData","toISOString","roleIds","GENERATE","resultData","checked","handleRoleToggle","renderResult","assigned","unassigned","conflicts","ExclamationTriangleIcon","conflict","reason","CheckCircleIcon","onSwapRequestUpdated","swapRequests","setSwapRequests","processingId","setProcessingId","filterStatus","setFilterStatus","fetchSwapRequests","isArray","req","ownRequests","requestedBy","receivedRequests","requestedFrom","getStatusText","renderSwapRequest","isReceived","_request$originalShif","_request$targetShift$","requestee","targetShift","responseMessage","swapRequest","APPROVE","handleApprove","REJECT","handleReject","XCircleIcon","renderContent","isFormOpen","setIsFormOpen","editingTemplate","setEditingTemplate","formData","setFormData","resetForm","_templatesRes$data","templatesRes","rolesRes","branchesRes","templateData","min","PlusIcon","_template$branch","_template$role","handleEdit","confirm","templateId","canManageAllAvailabilities","availabilities","setAvailabilities","allUsers","setAllUsers","selectedUserId","setSelectedUserId","editingAvailability","setEditingAvailability","dayOfWeek","priority","dayOfWeekOptions","_availabilitiesRes$da","usersRes","availabilitiesRes","AVAILABILITIES","availabilityData","getDayOfWeekLabel","getTypeLabel","getTypeColor","u","option","max","availability","availabilityId","BRANCH_COLORS","STATUS_COLORS","scheduled","confirmed","cancelled","swapped","getBranchColor","setShifts","allShifts","setAllShifts","currentWeek","setCurrentWeek","calendarView","setCalendarView","calendarRef","useRef","isProgrammaticNavigation","selectedBranchIds","setSelectedBranchIds","selectedStatuses","setSelectedStatuses","selectedUserIds","setSelectedUserIds","isCreateModalOpen","setIsCreateModalOpen","isEditModalOpen","setIsEditModalOpen","isGenerateModalOpen","setIsGenerateModalOpen","isSwapListOpen","setIsSwapListOpen","isTemplateManagementOpen","setIsTemplateManagementOpen","isAvailabilityManagementOpen","setIsAvailabilityManagementOpen","selectedShift","setSelectedShift","createModalInitialDate","setCreateModalInitialDate","fetchShifts","week","url","defaults","baseURL","shiftsData","shiftsArray","_error$response","_error$response2","_error$response3","_error$config","_error$config2","statusText","config","fullURL","_error$config3","fetchFilterData","calendarEvents","_shift$shiftTemplate2","branchColor","statusColor","toString","backgroundColor","borderColor","borderWidth","textColor","extendedProps","statusOptions","handleAddClick","handlePreviousWeek","subWeeks","handleNextWeek","addWeeks","handleToday","CalendarIcon","handleGenerateClick","branchMap","Map","statusMap","set","statusLabels","legendBranches","legendStatuses","_calendarRef$current2","getApi","changeView","_calendarRef$current3","s","resetFilters","FullCalendar","ref","plugins","timeGridPlugin","dayGridPlugin","interactionPlugin","initialView","headerToolbar","left","center","firstDay","weekNumbers","weekNumberCalculation","slotMinTime","slotMaxTime","slotDuration","slotLabelInterval","allDaySlot","events","eventClick","clickInfo","event","dateClick","dateClickInfo","datesSet","dateInfo","_calendarRef$current","currentView","view","newWeekStart","currentWeekStart","eventDisplay","eventTimeFormat","hour","minute","hour12","slotLabelFormat","eventClassNames","eventContent","eventInfo","_shift$shiftTemplate3","CreateShiftModal","newShift","EditShiftModal","updatedShift","shiftId","GenerateShiftPlanModal","handlePlanGenerated","SwapRequestList","ShiftTemplateManagement","AvailabilityManagement","TeamWorktimeControl","hasPagePermission","hasTablePermission","hasRequiredPermissions","setActiveUsers","setAllWorktimes","setSelectedDate","activeTab","setActiveTab","fetchActiveUsers","ACTIVE","_error$response$data","backendMessage","fetchAllWorktimes","USER_DAY","intervalId","startPolling","setInterval","hidden","stopPolling","clearInterval","handleVisibilityChange","UsersIcon","ActiveUsersList","STOP_USER","getTimezoneOffset","ShiftPlannerTab","TodoAnalyticsTab","RequestAnalyticsTab","evaluateCondition","fieldValue","strField","strValue","fieldValueStr","lowerField","valueStr","lowerValue","typeof","fieldDate","valueDate","fieldNum","parseFloat","valueNum","items","conditionMet","customResult","evaluateDateCondition","dateValue","dateYear","getUTCFullYear","dateMonth","getUTCMonth","dateDay","getUTCDate","normalizedDate","monthStart","startOfMonth","monthEnd","endOfMonth","yearStart","startOfYear","yearEnd","endOfYear","conditionDate","localToday","conditionDateRaw","conditionYear","conditionMonth","conditionDay","evaluateUserRoleCondition","textValue","targetUserId","replace","matches","targetRoleId","textValueLower","valueLower"],"sourceRoot":""}