"use strict";(self.webpackChunkintranet_frontend=self.webpackChunkintranet_frontend||[]).push([[727],{1663:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(45),r=a(5043);const l=["title","titleId"];function i(e,t){let{title:a,titleId:i}=e,n=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},n),a?r.createElement("title",{id:i},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125M3.375 19.5h7.5c.621 0 1.125-.504 1.125-1.125m-9.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-7.5A1.125 1.125 0 0 1 12 18.375m9.75-12.75c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125m19.5 0v1.5c0 .621-.504 1.125-1.125 1.125M2.25 5.625v1.5c0 .621.504 1.125 1.125 1.125m0 0h17.25m-17.25 0h7.5c.621 0 1.125.504 1.125 1.125M3.375 8.25c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m17.25-3.75h-7.5c-.621 0-1.125.504-1.125 1.125m8.625-1.125c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h7.5m-7.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M12 10.875v-1.5m0 1.5c0 .621-.504 1.125-1.125 1.125M12 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125M13.125 12h7.5m-7.5 0c-.621 0-1.125.504-1.125 1.125M20.625 12c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h7.5M12 14.625v-1.5m0 1.5c0 .621-.504 1.125-1.125 1.125M12 14.625c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m0 1.5v-1.5m0 0c0-.621.504-1.125 1.125-1.125m0 0h7.5"}))}const n=r.forwardRef(i)},1909:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(45),r=a(5043);const l=["title","titleId"];function i(e,t){let{title:a,titleId:i}=e,n=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},n),a?r.createElement("title",{id:i},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 7.5 7.5 3m0 0L12 7.5M7.5 3v13.5m13.5 0L16.5 21m0 0L12 16.5m4.5 4.5V7.5"}))}const n=r.forwardRef(i)},2302:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(45),r=a(5043);const l=["title","titleId"];function i(e,t){let{title:a,titleId:i}=e,n=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},n),a?r.createElement("title",{id:i},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25 2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z"}))}const n=r.forwardRef(i)},2704:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(45),r=a(5043);const l=["title","titleId"];function i(e,t){let{title:a,titleId:i}=e,n=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},n),a?r.createElement("title",{id:i},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const n=r.forwardRef(i)},3315:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(45),r=a(5043);const l=["title","titleId"];function i(e,t){let{title:a,titleId:i}=e,n=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},n),a?r.createElement("title",{id:i},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const n=r.forwardRef(i)},4041:(e,t,a)=>{a.r(t),a.d(t,{default:()=>re});var s=a(5043),r=a(4117),l=a(5590),i=a(1923),n=a(1801),d=a(9837),o=a(9379),c=a(6981);function m(e,t,a){return(0,c.f)(e,-t,a)}var x=a(4399),u=a(887),p=a(1909),g=a(4850),h=a(1663),y=a(8010),b=a(2302),v=a(2811),f=a(4129),k=a(7012),j=a(6238),w=a(6018),N=a(6443),T=a(7591),A=a(1816),C=a(9422),S=a(579);const W=e=>{let{isOpen:t,onClose:a,onConfirm:l,userName:i}=e;const{t:n}=(0,r.Bd)(),o=new Date,c=(0,d.GP)(o,"yyyy-MM-dd"),m=(0,d.GP)(o,"HH:mm:ss"),[x,u]=(0,s.useState)(c),[p,g]=(0,s.useState)(m),[h,y]=(0,s.useState)(!1);return(0,S.jsx)(w.e,{appear:!0,show:t,as:s.Fragment,children:(0,S.jsxs)(N.lG,{as:"div",className:"relative z-10",onClose:a,children:[(0,S.jsx)(w.e.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,S.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,S.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,S.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,S.jsx)(w.e.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,S.jsxs)(N.lG.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white dark:bg-gray-800 p-6 text-left align-middle shadow-xl transition-all",children:[(0,S.jsxs)("div",{className:"flex justify-between items-start",children:[(0,S.jsx)(N.lG.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 dark:text-white",children:n("teamWorktime.modal.stopTracking.title")}),(0,S.jsxs)("button",{type:"button",className:"bg-white dark:bg-gray-800 rounded-md text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:a,children:[(0,S.jsx)("span",{className:"sr-only",children:n("common.close")}),(0,S.jsx)(T.A,{className:"h-6 w-6","aria-hidden":"true"})]})]}),(0,S.jsx)("div",{className:"mt-2",children:(0,S.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n("teamWorktime.modal.stopTracking.description",{userName:i})})}),(0,S.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:n("teamWorktime.modal.stopTracking.date")}),(0,S.jsx)("input",{type:"date",id:"date",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",value:x,onChange:e=>u(e.target.value)})]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("label",{htmlFor:"time",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:n("teamWorktime.modal.stopTracking.time")}),(0,S.jsx)("input",{type:"time",id:"time",step:"1",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white",value:p,onChange:e=>g(e.target.value)})]})]}),(0,S.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,S.jsx)("button",{type:"button",className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",onClick:a,disabled:h,title:n("common.cancel"),children:(0,S.jsx)(T.A,{className:"h-5 w-5"})}),(0,S.jsx)("button",{type:"button",className:"p-2 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",onClick:async()=>{try{y(!0);const e="".concat(x,"T").concat(p);await l(e)}catch(e){console.error("Fehler beim Stoppen der Zeiterfassung:",e)}finally{y(!1)}},disabled:h,title:n(h?"teamWorktime.modal.stopTracking.stopping":"teamWorktime.modal.stopTracking.stop"),children:h?(0,S.jsx)(A.A,{className:"h-5 w-5 animate-spin"}):(0,S.jsx)(C.A,{className:"h-5 w-5"})})]})]})})})})]})})};var E=a(9248);const D=e=>{let{isOpen:t,onClose:a,onSave:l,userName:i,entries:n,selectedDate:d}=e;const{t:c}=(0,r.Bd)(),[m,x]=(0,s.useState)([]),[u,p]=(0,s.useState)(!1),[g,h]=(0,s.useState)(null);(0,s.useEffect)((()=>{if(n&&n.length>0){const e=n.map((e=>{const t=e.startTime.split("T")[0],a=e.startTime.split("T")[1].substring(0,8),s=e.endTime?e.endTime.split("T")[1].substring(0,8):null;return(0,o.A)((0,o.A)({},e),{},{date:t,startTimeTime:a,endTimeTime:s,isDeleted:!1,isModified:!1})}));x(e)}else x([])}),[n]);const y=e=>{const t=e.filter((e=>!e.isDeleted));for(let a=0;a<t.length;a++){const e=t[a],s=e.startTimeTime,r=e.endTimeTime;if(r&&s>=r)return h("Eintrag ".concat(a+1,": Die Endzeit muss nach der Startzeit liegen.")),!1;for(let l=a+1;l<t.length;l++){const e=t[l],i=e.startTimeTime,n=e.endTimeTime;if(r&&n&&s<n&&r>i||r&&!n&&r>i||n&&!r&&n>s)return h("Es gibt eine \xdcberlappung zwischen Eintrag ".concat(a+1," und Eintrag ").concat(l+1,".")),!1}}return h(null),!0};return(0,S.jsx)(w.e,{appear:!0,show:t,as:s.Fragment,children:(0,S.jsxs)(N.lG,{as:"div",className:"relative z-10",onClose:a,children:[(0,S.jsx)(w.e.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,S.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,S.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,S.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,S.jsx)(w.e.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,S.jsxs)(N.lG.Panel,{className:"w-full max-w-xl transform overflow-hidden rounded-2xl bg-white dark:bg-gray-800 p-6 text-left align-middle shadow-xl transition-all",children:[(0,S.jsxs)("div",{className:"flex justify-between items-start",children:[(0,S.jsx)(N.lG.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 dark:text-white",children:c("teamWorktime.modal.editWorktimes.title")}),(0,S.jsxs)("button",{type:"button",className:"bg-white dark:bg-gray-800 rounded-md text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:a,children:[(0,S.jsx)("span",{className:"sr-only",children:c("common.close")}),(0,S.jsx)(T.A,{className:"h-6 w-6","aria-hidden":"true"})]})]}),(0,S.jsx)("div",{className:"mt-2",children:(0,S.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:c("teamWorktime.modal.editWorktimes.description",{userName:i,date:d.split("-").reverse().join(".")})})}),g&&(0,S.jsx)("div",{className:"mt-2 p-2 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-300 rounded",children:g}),(0,S.jsx)("div",{className:"mt-4",children:(0,S.jsx)("div",{className:"overflow-hidden border dark:border-gray-700 rounded-lg",children:(0,S.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,S.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:c("teamWorktime.modal.editWorktimes.columns.number")}),(0,S.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:c("teamWorktime.modal.editWorktimes.columns.startTime")}),(0,S.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:c("teamWorktime.modal.editWorktimes.columns.endTime")}),(0,S.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:c("common.actions")})]})}),(0,S.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:0===m.length?(0,S.jsx)("tr",{children:(0,S.jsx)("td",{colSpan:4,className:"px-4 py-4 text-center text-sm text-gray-500 dark:text-gray-400",children:c("teamWorktime.modal.editWorktimes.noEntries")})}):m.map(((e,t)=>(0,S.jsxs)("tr",{className:e.isDeleted?"bg-red-50 dark:bg-red-900":"",children:[(0,S.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:t+1}),(0,S.jsx)("td",{className:"px-4 py-2 whitespace-nowrap",children:(0,S.jsx)("input",{type:"time",step:"1",className:"rounded-md border ".concat(e.isDeleted?"border-red-300 bg-red-50 dark:border-red-700 dark:bg-red-900":"border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"," shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"),value:e.startTimeTime.substring(0,5),onChange:e=>((e,t)=>{const a=[...m];a[e].startTimeTime!==t&&(a[e].startTimeTime=t,a[e].isModified=!0,x(a),y(a))})(t,e.target.value+":00"),disabled:e.isDeleted})}),(0,S.jsx)("td",{className:"px-4 py-2 whitespace-nowrap",children:(0,S.jsx)("input",{type:"time",step:"1",className:"rounded-md border ".concat(e.isDeleted?"border-red-300 bg-red-50 dark:border-red-700 dark:bg-red-900":"border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"," shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"),value:e.endTimeTime?e.endTimeTime.substring(0,5):"",onChange:e=>{const a=e.target.value?e.target.value+":00":null;((e,t)=>{const a=[...m];a[e].endTimeTime!==t&&(a[e].endTimeTime=t,a[e].isModified=!0,x(a),y(a))})(t,a)},disabled:e.isDeleted})}),(0,S.jsx)("td",{className:"px-4 py-2 whitespace-nowrap text-right text-sm font-medium",children:(0,S.jsx)("button",{type:"button",onClick:()=>(e=>{const t=[...m];t[e].isDeleted=!t[e].isDeleted,t[e].isModified=!0,x(t)})(t),className:"p-1 rounded ".concat(e.isDeleted?"text-green-600 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300":"text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300"),title:e.isDeleted?c("teamWorktime.modal.editWorktimes.restore"):c("teamWorktime.modal.editWorktimes.markForDelete"),children:(0,S.jsx)(E.A,{className:"h-5 w-5"})})})]},e.id)))})]})})}),(0,S.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,S.jsx)("button",{type:"button",className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",onClick:a,disabled:u,title:c("common.cancel"),children:(0,S.jsx)(T.A,{className:"h-5 w-5"})}),(0,S.jsx)("button",{type:"button",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",onClick:async()=>{if(y(m))try{p(!0);const e=m.filter((e=>e.isModified||e.isDeleted)).map((e=>{const t="".concat(e.date,"T").concat(e.startTimeTime),a=e.endTimeTime?"".concat(e.date,"T").concat(e.endTimeTime):null;return(0,o.A)((0,o.A)({},e),{},{startTime:t,endTime:a})}));e.length>0&&await l(e),a()}catch(g){console.error("Fehler beim Speichern der Zeiterfassungen:",g),h(c("teamWorktime.modal.editWorktimes.saveError"))}finally{p(!1)}},disabled:u||Boolean(g),title:c(u?"common.saving":"common.save"),children:u?(0,S.jsx)(A.A,{className:"h-5 w-5 animate-spin"}):(0,S.jsx)(C.A,{className:"h-5 w-5"})})]})]})})})})]})})};var q=a(4426),M=a(7829),I=a(6400),L=a(2023),F=a(2760),H=a(1713);var O=a(8897),R=a(957),_=a(637);const P=["name","startTime","duration","pauseTime","branch","actions"],z={name:"asc",startTime:"asc",duration:"asc",pauseTime:"asc",branch:"asc"},B={name:["name"],startTime:["startTime"],duration:["duration"],pauseTime:["pauseTime"],branch:["branch"],actions:[]},V={name:"name",startTime:"startTime",duration:"duration",pauseTime:"pauseTime",branch:"branch"},G="workcenter-table",Z=e=>{let{activeUsers:t,allWorktimes:a,loading:l,selectedDate:w,onDateChange:N,onStopWorktime:T,onRefresh:A,showTodos:C=!1,showRequests:E=!1}=e;const{t:Z}=(0,r.Bd)(),K=(0,s.useMemo)((()=>[{id:"name",label:Z("teamWorktime.columns.name")},{id:"startTime",label:Z("teamWorktime.columns.startTime")},{id:"duration",label:Z("teamWorktime.columns.duration")},{id:"pauseTime",label:Z("teamWorktime.columns.pauseTime")},{id:"branch",label:Z("teamWorktime.columns.branch")},{id:"actions",label:Z("teamWorktime.columns.actions")}]),[Z]),[Y,U]=(0,s.useState)(!1),[Q,J]=(0,s.useState)(!1),[X,$]=(0,s.useState)(null),[ee,te]=(0,s.useState)(""),[ae,se]=(0,s.useState)({key:"startTime",direction:"asc"}),[re,le]=(0,s.useState)(!1),[ie,ne]=(0,s.useState)(null),[de,oe]=(0,s.useState)(!1),[ce,me]=(0,s.useState)(10),[xe,ue]=(0,s.useState)([]),[pe,ge]=(0,s.useState)([]),[he,ye]=(0,s.useState)(Z("teamWorktime.filters.active")),[be,ve]=(0,s.useState)(null),[fe,ke]=(0,s.useState)({}),[je,we]=(0,s.useState)({}),[Ne,Te]=(0,s.useState)(new Set),[Ae,Ce]=(0,s.useState)(!1),[Se,We]=(0,s.useState)(!1),{hasPermission:Ee}=(0,F.S)();(0,s.useEffect)((()=>{(async()=>{if(C&&w)try{Ce(!0);const e=await i.A.get(n.Sn.TEAM_WORKTIME.ANALYTICS.TODOS_BY_USER,{params:{date:w}}),t={};e.data.forEach((e=>{t[e.userId]=e.todos})),ke(t)}catch(e){console.error("Fehler beim Laden der To-Dos:",e)}finally{Ce(!1)}})()}),[C,w]),(0,s.useEffect)((()=>{(async()=>{if(E&&w)try{We(!0);const e=await i.A.get(n.Sn.TEAM_WORKTIME.ANALYTICS.REQUESTS_BY_USER,{params:{date:w}}),t={};e.data.forEach((e=>{t[e.userId]=e.requests})),we(t)}catch(e){console.error("Fehler beim Laden der Requests:",e)}finally{We(!1)}})()}),[E,w]);const De=e=>{Te((t=>{const a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a}))},{settings:qe,updateColumnOrder:Me,updateHiddenColumns:Ie,isColumnVisible:Le,updateViewMode:Fe}=(0,L.F)("team_worktime_active",{defaultColumnOrder:P,defaultHiddenColumns:[],defaultViewMode:"cards"}),He=qe.columnOrder,Oe=qe.hiddenColumns,Re=qe.viewMode||"cards",[_e,Pe]=(0,s.useState)((()=>z)),ze=(0,s.useMemo)((()=>(e=>{const t=[];return e.forEach((e=>{const a=B[e];a&&a.length>0&&t.push(...a)})),t})(qe.columnOrder||P)),[qe.columnOrder]),Be=(0,s.useMemo)((()=>(e=>{const t=new Set;return e.forEach((e=>{(B[e]||[]).forEach((e=>t.add(e)))})),t})(qe.hiddenColumns||[])),[qe.hiddenColumns]),Ve=(0,s.useMemo)((()=>new Set(ze.filter((e=>!Be.has(e))))),[ze,Be]);(0,s.useEffect)((()=>{document.querySelectorAll(".dashboard-workcenter-wrapper").forEach((e=>{"cards"===Re?e.classList.add("cards-mode"):e.classList.remove("cards-mode")}))}),[Re]);const Ge=e=>{$(e),U(!0)},Ze=()=>{U(!1),$(null)},Ke=e=>{$(e),J(!0)},Ye=()=>{J(!1),$(null)},Ue=e=>{ne(e)},Qe=(0,s.useCallback)((e=>{e.preventDefault()}),[]),Je=(0,s.useCallback)(((e,t)=>{if(e.preventDefault(),!ie||ie===t)return;const a=[...He],s=a.indexOf(ie),r=a.indexOf(t);a.splice(s,1),a.splice(r,0,ie),Me(a)}),[ie,He,Me]),Xe=()=>{ne(null)},$e=()=>xe.length,et=(0,s.useMemo)((()=>{const e=[...a];t.filter((e=>e.startTime.split("T")[0]===w)).forEach((t=>{e.find((e=>e.id===t.id))||e.push(t)}));const s=e.reduce(((e,t)=>{const a=t.user.id;e[a]||(e[a]={user:t.user,branch:t.branch,entries:[],startTime:(0,H.IF)(t.startTime),endTime:t.endTime?(0,H.IF)(t.endTime):null,totalDuration:0,activeEntries:[],hasActiveWorktime:!1});const s=e[a];s.entries.push(t);const r=(0,H.IF)(t.startTime);if(r<s.startTime&&(s.startTime=r),t.endTime){const e=(0,H.IF)(t.endTime);(!s.endTime||e>s.endTime)&&(s.endTime=e)}else s.hasActiveWorktime=!0,s.activeEntries.push(t);if(t.endTime){const e=(0,H.IF)(t.endTime).getTime()-(0,H.IF)(t.startTime).getTime();s.totalDuration+=e}return e}),{});let r=Object.values(s).filter((e=>{const t="".concat(e.user.firstName," ").concat(e.user.lastName).toLowerCase(),a=e.user.username.toLowerCase(),s=e.branch.name.toLowerCase(),l=ee.toLowerCase();if(ee&&!(t.includes(l)||a.includes(l)||s.includes(l)))return!1;if(xe.length>0){const e={name:(e,t)=>{const a="".concat(e.user.firstName," ").concat(e.user.lastName).toLowerCase(),s=(t.value||"").toLowerCase();return"equals"===t.operator?a===s:"contains"===t.operator?a.includes(s):"startsWith"===t.operator?a.startsWith(s):"endsWith"===t.operator?a.endsWith(s):null},branch:(e,t)=>{const a=e.branch.name.toLowerCase(),s=(t.value||"").toLowerCase();return"equals"===t.operator?a===s:"contains"===t.operator?a.includes(s):"startsWith"===t.operator?a.startsWith(s):"endsWith"===t.operator?a.endsWith(s):null},hasActiveWorktime:(e,t)=>{if("equals"===t.operator){const a="true"===t.value||!0===t.value;return e.hasActiveWorktime===a}return null},duration:(e,t)=>{const a=60*parseInt(t.value||"0")*60*1e3;if("greaterThan"===t.operator)return e.totalDuration>a;if("lessThan"===t.operator)return e.totalDuration<a;if("equals"===t.operator){const t=18e5;return Math.abs(e.totalDuration-a)<=t}return null}},t=(e,t)=>{switch(t){case"name":return"".concat(e.user.firstName," ").concat(e.user.lastName);case"branch":return e.branch.name;case"hasActiveWorktime":return e.hasActiveWorktime;case"duration":return e.totalDuration;case"startTime":return e.startTime;case"endTime":return e.endTime;default:return e[t]}};r=(0,I.W5)(r,xe,pe,t,e)}return!0}));if("cards"===Re){const e=ze.filter((e=>Ve.has(e)));r.sort(((t,a)=>{for(const s of e){const e=_e[s]||"asc";let r,l;switch(s){case"name":r="".concat(t.user.firstName," ").concat(t.user.lastName).toLowerCase(),l="".concat(a.user.firstName," ").concat(a.user.lastName).toLowerCase();break;case"startTime":r=t.startTime.getTime(),l=a.startTime.getTime();break;case"duration":r=t.totalDuration,l=a.totalDuration;break;case"pauseTime":r=t.endTime?t.endTime.getTime()-t.startTime.getTime()-t.totalDuration:0,l=a.endTime?a.endTime.getTime()-a.startTime.getTime()-a.totalDuration:0;break;case"branch":r=t.branch.name.toLowerCase(),l=a.branch.name.toLowerCase();break;default:continue}let i=0;if(i="number"===typeof r&&"number"===typeof l?r-l:String(r).localeCompare(String(l)),"desc"===e&&(i=-i),0!==i)return i}return 0}))}else ae.key&&r.sort(((e,t)=>{let a,s;return"name"===ae.key?(a="".concat(e.user.firstName," ").concat(e.user.lastName),s="".concat(t.user.firstName," ").concat(t.user.lastName)):"startTime"===ae.key?(a=e.startTime.getTime(),s=t.startTime.getTime()):"duration"===ae.key?(a=e.totalDuration,s=t.totalDuration):"branch"===ae.key?(a=e.branch.name,s=t.branch.name):(a=e[ae.key],s=t[ae.key]),a<s?"asc"===ae.direction?-1:1:a>s?"asc"===ae.direction?1:-1:0}));return r}),[a,t,ee,ae,w,xe,pe,Re,ze,Ve,_e]),tt=(e,t)=>{const a=(null===ae||void 0===ae?void 0:ae.key)===e;return(0,S.jsx)("th",{scope:"col",className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-pointer group relative",onClick:()=>{return t=e,void se((e=>({key:t,direction:e.key===t&&"asc"===e.direction?"desc":"asc"})));var t},draggable:!0,onDragStart:()=>Ue(e),onDragOver:Qe,onDrop:t=>Je(t,e),onDragEnd:Xe,children:(0,S.jsxs)("div",{className:"flex items-center ".concat(ie===e?"opacity-50":""),children:[(0,S.jsx)(p.A,{className:"h-3 w-3 mr-1 text-gray-400 dark:text-gray-500"}),t," ",a&&("asc"===ae.direction?"\u2191":"\u2193")]})},e)};s.useEffect((()=>{(async()=>{try{const e=localStorage.getItem("token");if(!e)return void console.error("Nicht authentifiziert");const t=(await i.A.get("".concat(n.Sn.SAVED_FILTERS.BY_TABLE(G)),{headers:{Authorization:"Bearer ".concat(e)}})).data||[],a=t.some((e=>"Aktive"===e.name||e.name===Z("teamWorktime.filters.active")||"Active"===e.name||"Activo"===e.name)),s=t.some((e=>"Alle"===e.name||e.name===Z("teamWorktime.filters.all")||"All"===e.name||"Todos"===e.name));if(!a){const t={tableId:G,name:Z("teamWorktime.filters.active"),conditions:[{column:"hasActiveWorktime",operator:"equals",value:"true"}],operators:[]};await i.A.post("".concat(n.Sn.SAVED_FILTERS.BASE),t,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}),console.log("Aktive-Filter f\xfcr Workcenter erstellt")}if(!s){const t={tableId:G,name:Z("teamWorktime.filters.all"),conditions:[],operators:[]};await i.A.post("".concat(n.Sn.SAVED_FILTERS.BASE),t,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}),console.log("Alle-Filter f\xfcr Workcenter erstellt")}}catch(e){console.error("Fehler beim Erstellen der Standard-Filter:",e)}})()}),[Z]),s.useEffect((()=>{(async()=>{try{const e=await i.A.get(n.Sn.SAVED_FILTERS.BY_TABLE(G)),t=e.data.find((e=>e.name===Z("teamWorktime.filters.active")||"Aktive"===e.name||"Active"===e.name||"Activo"===e.name));t&&(ye(Z("teamWorktime.filters.active")),ve(t.id),at(t.conditions,t.operators))}catch(e){console.error("Fehler beim Setzen des initialen Filters:",e)}})()}),[Z]);const at=(e,t)=>{ue(e),ge(t)},st=()=>{ue([]),ge([]),ye(""),ve(null)},rt=(0,s.useMemo)((()=>{const e=new Date;e.setHours(0,0,0,0);const[t,a,s]=w.split("-").map(Number),r=new Date(t,a-1,s);return r.setHours(0,0,0,0),r.getTime()<e.getTime()}),[w]);return(0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-4 px-3 sm:px-4 md:px-6",children:[(0,S.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,S.jsxs)("div",{className:"relative group",children:[(0,S.jsx)("button",{type:"button",onClick:()=>{const[e,t,a]=w.split("-").map(Number),s=m(new Date(e,t-1,a),1);N((0,d.GP)(s,"yyyy-MM-dd"))},className:"p-1 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:(0,S.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,S.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,S.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:Z("common.previousDay")})]}),(0,S.jsx)("div",{className:"relative w-[180px]",children:(0,S.jsx)("input",{type:"date",id:"date-select",className:"block w-full pl-3 pr-8 py-2 text-base border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white",value:w,onChange:e=>N(e.target.value)})}),rt&&(0,S.jsxs)("div",{className:"relative group",children:[(0,S.jsx)("button",{type:"button",onClick:()=>{const[e,t,a]=w.split("-").map(Number),s=new Date(e,t-1,a),r=(0,c.f)(s,1);N((0,d.GP)(r,"yyyy-MM-dd"))},className:"p-1 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:(0,S.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,S.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),(0,S.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:Z("common.nextDay")})]})]}),(0,S.jsxs)("div",{className:"flex items-center",children:[(0,S.jsx)("input",{type:"text",className:"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white",placeholder:Z("common.searchPlaceholder"),value:ee,onChange:e=>te(e.target.value)}),(0,S.jsxs)("div",{className:"relative group ml-1",children:[(0,S.jsx)("button",{type:"button",className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ".concat("cards"===Re?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":""),onClick:()=>Fe("table"===Re?"cards":"table"),children:"table"===Re?(0,S.jsx)(g.A,{className:"h-5 w-5"}):(0,S.jsx)(h.A,{className:"h-5 w-5"})}),(0,S.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:Z("table"===Re?"common.viewAsCards":"common.viewAsTable")})]}),(0,S.jsxs)("div",{className:"relative group ml-1",children:[(0,S.jsxs)("button",{type:"button",className:"p-2 rounded-md ".concat($e()>0?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"hover:bg-gray-100 dark:hover:bg-gray-700"," relative"),onClick:()=>le(!re),children:[(0,S.jsx)(y.A,{className:"h-5 w-5"}),$e()>0&&(0,S.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center z-10",style:{position:"absolute",top:"-0.25rem",right:"-0.25rem"},children:$e()})]}),(0,S.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:Z("common.showFilter")})]}),(0,S.jsx)("div",{className:"ml-1",children:(0,S.jsx)(O.A,{columns:"cards"===Re?[{id:"name",label:Z("teamWorktime.columns.name")},{id:"startTime",label:Z("teamWorktime.columns.startTime")},{id:"duration",label:Z("teamWorktime.columns.duration")},{id:"pauseTime",label:Z("teamWorktime.columns.pauseTime")},{id:"branch",label:Z("teamWorktime.columns.branch")}]:K,visibleColumns:"cards"===Re?Array.from(Ve):He.filter((e=>!Oe.includes(e))),columnOrder:"cards"===Re?ze:He,onToggleColumnVisibility:e=>{if("cards"===Re){const t=V[e];if(t){const e=Oe.includes(t)?Oe.filter((e=>e!==t)):[...Oe,t];Ie(e)}}else{const t=Oe.includes(e)?Oe.filter((t=>t!==e)):[...Oe,e];Ie(t)}},onMoveColumn:(e,t)=>{if("cards"===Re){const a=[...ze],s=a[e];a.splice(e,1),a.splice(t,0,s);const r=[],l=new Set;a.forEach((e=>{const t=V[e];t&&!l.has(t)&&(l.add(t),r.push(t))})),K.forEach((e=>{r.includes(e.id)||"actions"===e.id||r.push(e.id)})),Me(r)}else{const a=[...He],s=a[e];a.splice(e,1),a.splice(t,0,s),Me(a)}},sortDirections:"cards"===Re?_e:void 0,onSortDirectionChange:"cards"===Re?(e,t)=>{Pe((a=>(0,o.A)((0,o.A)({},a),{},{[e]:t})))}:void 0,showSortDirection:"cards"===Re,buttonTitle:Z("cards"===Re?"teamWorktime.sortAndDisplay":"teamWorktime.configureColumns"),modalTitle:Z("cards"===Re?"teamWorktime.sortAndDisplay":"teamWorktime.configureColumns"),onClose:()=>{}})})]})]}),re&&(0,S.jsx)("div",{className:"cards"===Re?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,S.jsx)(q.A,{columns:[{id:"name",label:Z("teamWorktime.columns.name")},{id:"branch",label:Z("teamWorktime.columns.branch")},{id:"hasActiveWorktime",label:Z("worktime.active")},{id:"duration",label:Z("teamWorktime.columns.duration")}],onApply:at,onReset:st,savedConditions:xe,savedOperators:pe,tableId:G})}),(0,S.jsx)("div",{className:"cards"===Re?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,S.jsx)(M.A,{tableId:G,onSelectFilter:at,onReset:st,activeFilterName:he,selectedFilterId:be,onFilterChange:(e,t,a,s)=>{ye(e),ve(t),at(a,s)},defaultFilterName:Z("teamWorktime.filters.active")})}),"table"===Re?(0,S.jsx)("div",{className:"dashboard-workcenter-wrapper border-0 rounded-lg overflow-hidden -mx-3 sm:-mx-4 md:-mx-6",children:(0,S.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,S.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,S.jsx)("tr",{children:He.filter((e=>!Oe.includes(e))).map((e=>{const t=K.find((t=>t.id===e));return t?"actions"===e?(0,S.jsx)("th",{scope:"col",className:"px-3 sm:px-4 md:px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",draggable:!0,onDragStart:()=>Ue(e),onDragOver:Qe,onDrop:t=>Je(t,e),onDragEnd:Xe,children:t.label},e):tt(e,t.label):null}))})}),(0,S.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:0===et.length?(0,S.jsx)("tr",{children:(0,S.jsx)("td",{colSpan:He.filter((e=>!Oe.includes(e))).length,className:"px-3 sm:px-4 md:px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400",children:"Keine Zeiterfassungen gefunden"})}):et.slice(0,ce).map((e=>{const t=e.endTime?e.endTime.getTime()-e.startTime.getTime()-e.totalDuration:0,a=fe[e.user.id]||null,r=je[e.user.id]||null,l=Ne.has(e.user.id),i=C&&a&&a.total>0||E&&r&&r.total>0;return(0,S.jsxs)(s.Fragment,{children:[(0,S.jsx)("tr",{children:He.filter((e=>!Oe.includes(e))).map((a=>"name"===a?(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,S.jsx)("div",{className:"flex items-center",children:(0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[e.user.firstName," ",e.user.lastName]}),(0,S.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.user.username})]})})},a):"startTime"===a?(0,S.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,S.jsx)("div",{className:"text-sm text-gray-900 dark:text-white",children:(0,d.GP)(e.startTime,"dd.MM.yyyy")}),(0,S.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:(0,d.GP)(e.startTime,"HH:mm:ss")})]},a):"duration"===a?(0,S.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,S.jsx)("div",{className:"text-sm text-gray-900 dark:text-white",children:(0,x.m)(new Date(Date.now()-e.totalDuration),{locale:u.de,addSuffix:!1})})},a):"pauseTime"===a?(0,S.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,S.jsx)("div",{className:"text-sm text-gray-900 dark:text-white",children:t>0?(0,x.m)(new Date(Date.now()-t),{locale:u.de,addSuffix:!1}):"-"})},a):"branch"===a?(0,S.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.branch.name},a):"actions"===a?(0,S.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,S.jsxs)("div",{className:"flex flex-row space-x-2 justify-end items-center",children:[e.hasActiveWorktime&&(0,S.jsxs)("div",{className:"relative group",children:[(0,S.jsx)("button",{onClick:()=>Ge(e),className:"p-1 bg-red-600 text-white rounded hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600",children:(0,S.jsx)(b.A,{className:"h-5 w-5 text-white fill-white"})}),(0,S.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:Z("teamWorktime.actions.stopTracking")})]}),Ee("team_worktime_control","both","page")&&Ee("team_worktime","both","table")&&(0,S.jsxs)("div",{className:"relative group",children:[(0,S.jsx)("button",{onClick:()=>Ke(e),className:"text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 edit-button",children:(0,S.jsx)(v.A,{className:"h-5 w-5"})}),(0,S.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:Z("teamWorktime.actions.editWorktimes")})]})]})},a):null))}),(C||E)&&i&&(0,S.jsx)("tr",{className:"bg-gray-50 dark:bg-gray-800/50",children:(0,S.jsx)("td",{colSpan:He.filter((e=>!Oe.includes(e))).length,className:"px-3 sm:px-4 md:px-6 py-3",children:(0,S.jsxs)("div",{className:"ml-4 border-l-2 border-blue-200 dark:border-blue-700 pl-4",children:[C&&a&&a.total>0&&(0,S.jsxs)("div",{className:"mb-3",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,S.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["To-Dos (",w,"): ",a.completed," erledigt | ",a.open," offen | ",a.inProgress," in Bearbeitung"]}),(0,S.jsx)("button",{onClick:()=>De(e.user.id),className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300",children:l?"Weniger anzeigen \u25b2":"Details anzeigen \u25bc"})]}),l&&a.details&&a.details.length>0&&(0,S.jsx)("div",{className:"mt-2 space-y-1",children:a.details.map((e=>(0,S.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 flex items-center gap-2",children:[(0,S.jsx)("span",{className:"done"===e.status?"text-green-600 dark:text-green-400":"text-gray-400",children:"done"===e.status?"\u2713":"\u25cb"}),(0,S.jsx)("span",{className:"font-medium",children:e.title}),(0,S.jsxs)("span",{className:"text-gray-400",children:["(",e.status,")"]}),(0,S.jsxs)("span",{className:"text-gray-400",children:["- ",(0,d.GP)(new Date(e.updatedAt),"HH:mm")]})]},e.id)))})]}),E&&r&&r.total>0&&(0,S.jsxs)("div",{children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,S.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Requests (",w,"): ",r.approved," genehmigt | ",r.pending," offen"]}),!C&&(0,S.jsx)("button",{onClick:()=>De(e.user.id),className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300",children:l?"Weniger anzeigen \u25b2":"Details anzeigen \u25bc"})]}),l&&r.details&&r.details.length>0&&(0,S.jsx)("div",{className:"mt-2 space-y-1",children:r.details.map((e=>(0,S.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 flex items-center gap-2",children:[(0,S.jsx)("span",{className:"approved"===e.status?"text-green-600 dark:text-green-400":"text-gray-400",children:"approved"===e.status?"\u2713":"\u25cb"}),(0,S.jsx)("span",{className:"font-medium",children:e.title}),(0,S.jsxs)("span",{className:"text-gray-400",children:["(",e.status,")"]}),(0,S.jsxs)("span",{className:"text-gray-400",children:["- ",(0,d.GP)(new Date(e.createdAt),"HH:mm")]})]},e.id)))})]})]})})})]},e.user.id)}))})]})}):(0,S.jsx)("div",{className:"dashboard-workcenter-wrapper -mx-3 sm:-mx-4 md:-mx-6",children:0===et.length?(0,S.jsx)("div",{className:"text-center py-8 text-sm text-gray-500 dark:text-gray-400",children:"Keine Zeiterfassungen gefunden"}):(0,S.jsx)(_.A,{gap:"md",children:et.slice(0,ce).map((e=>{const t=e.endTime?e.endTime.getTime()-e.startTime.getTime()-e.totalDuration:0,a=fe[e.user.id]||null,s=je[e.user.id]||null,r=Ne.has(e.user.id),l=C&&a&&a.total>0||E&&s&&s.total>0,i=[],n=[],o=[];Ve.has("name")&&n.push({label:"Name",value:"".concat(e.user.firstName," ").concat(e.user.lastName," (").concat(e.user.username,")"),icon:(0,S.jsx)(f.A,{className:"h-4 w-4"})}),Ve.has("startTime")&&n.push({label:"Startzeit",value:"".concat((0,d.GP)(e.startTime,"dd.MM.yyyy")," ").concat((0,d.GP)(e.startTime,"HH:mm:ss")),icon:(0,S.jsx)(k.A,{className:"h-4 w-4"})}),Ve.has("duration")&&o.push({label:"Arbeitszeit",value:(0,x.m)(new Date(Date.now()-e.totalDuration),{locale:u.de,addSuffix:!1}),icon:(0,S.jsx)(k.A,{className:"h-4 w-4"})}),Ve.has("pauseTime")&&o.push({label:"Pausen",value:t>0?(0,x.m)(new Date(Date.now()-t),{locale:u.de,addSuffix:!1}):"-",icon:(0,S.jsx)(k.A,{className:"h-4 w-4"})}),Ve.has("branch")&&i.push({label:"Niederlassung",value:e.branch.name,icon:(0,S.jsx)(j.A,{className:"h-4 w-4"})});const c=(0,S.jsxs)("div",{className:"flex flex-row space-x-2 justify-end items-center",children:[e.hasActiveWorktime&&(0,S.jsxs)("div",{className:"relative group",children:[(0,S.jsx)("button",{onClick:()=>Ge(e),className:"p-1 bg-red-600 text-white rounded hover:bg-red-700 dark:bg-red-500 dark:hover:bg-red-600",children:(0,S.jsx)(b.A,{className:"h-5 w-5 text-white fill-white"})}),(0,S.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:Z("teamWorktime.actions.stopTracking")})]}),Ee("team_worktime_control","both","page")&&Ee("team_worktime","both","table")&&(0,S.jsxs)("div",{className:"relative group",children:[(0,S.jsx)("button",{onClick:()=>Ke(e),className:"text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300",children:(0,S.jsx)(v.A,{className:"h-5 w-5"})}),(0,S.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:Z("teamWorktime.actions.editWorktimes")})]})]}),m=l?(0,S.jsxs)("div",{children:[C&&a&&a.total>0&&(0,S.jsxs)("div",{className:"mb-3",children:[(0,S.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["To-Dos (",w,"): ",a.completed," erledigt | ",a.open," offen | ",a.inProgress," in Bearbeitung"]}),a.details&&a.details.length>0&&(0,S.jsx)("div",{className:"mt-2 space-y-1",children:a.details.map((e=>(0,S.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 flex items-center gap-2",children:[(0,S.jsx)("span",{className:"done"===e.status?"text-green-600 dark:text-green-400":"text-gray-400",children:"done"===e.status?"\u2713":"\u25cb"}),(0,S.jsx)("span",{className:"font-medium",children:e.title}),(0,S.jsxs)("span",{className:"text-gray-400",children:["(",e.status,")"]}),(0,S.jsxs)("span",{className:"text-gray-400",children:["- ",(0,d.GP)(new Date(e.updatedAt),"HH:mm")]})]},e.id)))})]}),E&&s&&s.total>0&&(0,S.jsxs)("div",{children:[(0,S.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Requests (",w,"): ",s.approved," genehmigt | ",s.pending," offen"]}),s.details&&s.details.length>0&&(0,S.jsx)("div",{className:"mt-2 space-y-1",children:s.details.map((e=>(0,S.jsxs)("div",{className:"text-xs text-gray-600 dark:text-gray-400 flex items-center gap-2",children:[(0,S.jsx)("span",{className:"approved"===e.status?"text-green-600 dark:text-green-400":"text-gray-400",children:"approved"===e.status?"\u2713":"\u25cb"}),(0,S.jsx)("span",{className:"font-medium",children:e.title}),(0,S.jsxs)("span",{className:"text-gray-400",children:["(",e.status,")"]}),(0,S.jsxs)("span",{className:"text-gray-400",children:["- ",(0,d.GP)(new Date(e.createdAt),"HH:mm")]})]},e.id)))})]})]}):null;return(0,S.jsxs)(R.A,{title:"".concat(e.user.firstName," ").concat(e.user.lastName),metadata:i,actions:c,expandable:m?{isExpanded:r,content:m,onToggle:()=>De(e.user.id)}:void 0,children:[n.length>0&&(0,S.jsx)("div",{className:"flex flex-wrap items-center gap-3 sm:gap-4 mb-3 sm:mb-4",children:n.map(((e,t)=>(0,S.jsxs)("div",{className:"flex items-center gap-1 sm:gap-1.5 text-xs sm:text-sm md:text-base lg:text-lg xl:text-xl 2xl:text-2xl text-gray-600 dark:text-gray-400",children:[e.icon&&(0,S.jsx)("span",{className:"flex-shrink-0",children:e.icon}),(0,S.jsxs)("span",{className:"font-medium mr-1 whitespace-nowrap",children:[e.label,":"]}),(0,S.jsx)("span",{className:e.className||"text-gray-900 dark:text-white",children:(e.value,e.value)})]},t)))}),o.length>0&&(0,S.jsx)("div",{className:"flex flex-col gap-2 mb-3 sm:mb-4",children:o.map(((e,t)=>(0,S.jsxs)("div",{className:"flex items-center gap-1 sm:gap-1.5 text-xs sm:text-sm md:text-base lg:text-lg xl:text-xl 2xl:text-2xl text-gray-600 dark:text-gray-400",children:[e.icon&&(0,S.jsx)("span",{className:"flex-shrink-0",children:e.icon}),(0,S.jsxs)("span",{className:"font-medium mr-1 whitespace-nowrap",children:[e.label,":"]}),(0,S.jsx)("span",{className:e.className||"text-gray-900 dark:text-white",children:(e.value,e.value)})]},t)))})]},e.user.id)}))})}),et.length>ce&&(0,S.jsx)("div",{className:"mt-4 flex justify-center",children:(0,S.jsxs)("button",{className:"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-700 border border-blue-300 dark:border-blue-600 rounded-md hover:bg-blue-50 dark:hover:bg-gray-600",onClick:()=>me((e=>e+10)),children:["Mehr anzeigen (",et.length-ce," verbleibend)"]})}),Y&&X&&(0,S.jsx)(W,{isOpen:Y,onClose:Ze,onConfirm:async e=>{if(!X)return;const t=X.activeEntries.length>0?X.activeEntries.reduce(((e,t)=>{const a=(0,H.IF)(e.startTime);return(0,H.IF)(t.startTime)>a?t:e}),X.activeEntries[0]):null;t?await T(t.user.id,e):await T(X.user.id,e),Ze()},userName:"".concat(X.user.firstName," ").concat(X.user.lastName)}),Q&&X&&(0,S.jsx)(D,{isOpen:Q,onClose:Ye,onSave:async e=>{try{await(async e=>{try{const t=e.filter((e=>!e.isDeleted)),a=e.filter((e=>e.isDeleted)).map((e=>e.id)),s=t.map((e=>i.A.put("/worktime/".concat(e.id),{startTime:e.startTime,endTime:e.endTime}))),r=a.map((e=>i.A.delete("/worktime/".concat(e))));return await Promise.all([...s,...r]),{success:!0}}catch(t){throw console.error("Fehler beim Aktualisieren der Zeiterfassungen:",t),t}})(e),A(),alert(Z("teamWorktime.messages.saveSuccess")),Ye()}catch(t){console.error("Fehler beim Aktualisieren der Zeiterfassungen:",t);let e=Z("teamWorktime.messages.unknownError");t.response?401===t.response.status?e=Z("teamWorktime.messages.unauthorized"):403===t.response.status?e=Z("teamWorktime.messages.forbidden"):404===t.response.status?e=Z("teamWorktime.messages.notFound"):500===t.response.status?e=Z("teamWorktime.messages.serverError"):t.response.data&&t.response.data.message&&(e=t.response.data.message):e=t.request?Z("teamWorktime.messages.noResponse"):t.message||Z("teamWorktime.messages.error"),alert(Z("teamWorktime.messages.saveError")+" "+e)}},userName:"".concat(X.user.firstName," ").concat(X.user.lastName),entries:X.entries,selectedDate:w})]})};var K=a(1369),Y=a(3332),U=a(2517),Q=a(3315);const J="todo-analytics-table",X=["time","title","status","responsible","qualityControl","branch"],$=e=>{let{selectedDate:t}=e;const{t:a}=(0,r.Bd)(),[l,o]=(0,s.useState)([]),[c,m]=(0,s.useState)(!1),[x,u]=(0,s.useState)(null),[p,b]=(0,s.useState)(""),[v,w]=(0,s.useState)([]),[N,T]=(0,s.useState)([]),[C,W]=(0,s.useState)(""),[E,D]=(0,s.useState)(null),[I,F]=(0,s.useState)(!1),{settings:H,isLoading:O,updateColumnOrder:P,updateHiddenColumns:z,toggleColumnVisibility:B,isColumnVisible:V,updateViewMode:G}=(0,L.F)(J,{defaultColumnOrder:X,defaultViewMode:"table"}),Z=(null===H||void 0===H?void 0:H.columnOrder)||X,$=(null===H||void 0===H?void 0:H.hiddenColumns)||[],ee=Z.filter((e=>!$.includes(e))),te=(null===H||void 0===H?void 0:H.viewMode)||"table",[ae,se]=(0,s.useState)(te);(0,s.useEffect)((()=>{null!==H&&void 0!==H&&H.viewMode&&H.viewMode!==ae&&se(H.viewMode)}),[null===H||void 0===H?void 0:H.viewMode]);const[re,le]=(0,s.useState)(new Set),ie=e=>{le((t=>{const a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a}))},[ne,de]=(0,s.useState)(null),[oe,ce]=(0,s.useState)(!1),[me,xe]=(0,s.useState)(!1),[ue,pe]=(0,s.useState)(null),[ge,he]=(0,s.useState)(!1),[ye,be]=(0,s.useState)(!1),[ve,fe]=(0,s.useState)(new Set),ke=(0,s.useMemo)((()=>[{id:"time",label:a("analytics.todo.columns.time")},{id:"title",label:a("analytics.todo.columns.title")},{id:"status",label:a("analytics.todo.columns.status")},{id:"responsible",label:a("analytics.todo.columns.responsible")},{id:"qualityControl",label:a("analytics.todo.columns.qualityControl")},{id:"branch",label:a("analytics.todo.columns.branch")}]),[a]);(0,s.useEffect)((()=>{t&&(async()=>{try{m(!0),u(null);const e={date:t};v.forEach((t=>{"branch"===t.column&&t.value&&(e.branchId=t.value),"responsible"===t.column&&t.value&&(e.userId=t.value),"status"===t.column&&t.value}));const a=await i.A.get(n.Sn.TEAM_WORKTIME.ANALYTICS.TODOS_CHRONOLOGICAL,{params:e});o(a.data||[])}catch(x){console.error("Fehler beim Laden der To-Dos:",x),u(a("analytics.todo.loadError"))}finally{m(!1)}})()}),[t,v]),(0,s.useEffect)((()=>{(async()=>{if(t&&me)try{ce(!0);const e=await i.A.get(n.Sn.TEAM_WORKTIME.ANALYTICS.TODOS_FREQUENCY,{params:{date:t}});de(e.data)}catch(x){console.error("Fehler beim Laden der H\xe4ufigkeitsanalyse:",x)}finally{ce(!1)}})()}),[t,me]),(0,s.useEffect)((()=>{(async()=>{if(t&&ye)try{he(!0);const e=await i.A.get(n.Sn.TEAM_WORKTIME.ANALYTICS.TODOS_SHIFTS,{params:{date:t}});pe(e.data)}catch(x){console.error("Fehler beim Laden der Schicht-Analyse:",x)}finally{he(!1)}})()}),[t,ye]);const je=(0,s.useCallback)(((e,t)=>{w(e),T(t),F(!1)}),[]),we=(0,s.useCallback)((()=>{w([]),T([]),W(""),D(null)}),[]),Ne=(0,s.useCallback)(((e,t,a,s)=>{W(e),D(t),je(a,s)}),[je]),Te=(0,s.useCallback)((()=>v.filter((e=>""!==e.column&&null!==e.value)).length),[v]),Ae=e=>{switch(e){case"done":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400";case"in_progress":return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400";case"quality_control":return"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400";case"open":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400";case"improval":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},Ce=e=>({done:"Erledigt",in_progress:"In Bearbeitung",quality_control:"Qualit\xe4tskontrolle",open:"Offen",improval:"Nachbesserung"}[e]||e),Se=(0,s.useMemo)((()=>{let e=[...l];if(p){const t=p.toLowerCase();e=e.filter((e=>e.title.toLowerCase().includes(t)||e.branch.name.toLowerCase().includes(t)||e.responsible&&"".concat(e.responsible.firstName," ").concat(e.responsible.lastName).toLowerCase().includes(t)))}return v.forEach(((t,a)=>{if(""===t.column||null===t.value)return;const s=t.operator||"equals",r=t.value;e=e.filter((e=>{switch(t.column){case"status":return"equals"!==s||e.status===r;case"title":return"contains"!==s||e.title.toLowerCase().includes(String(r).toLowerCase());default:return!0}}))})),e}),[l,p,v]),We=(0,s.useMemo)((()=>({total:Se.length,done:Se.filter((e=>"done"===e.status)).length,inProgress:Se.filter((e=>"in_progress"===e.status)).length,open:Se.filter((e=>"open"===e.status)).length,qualityControl:Se.filter((e=>"quality_control"===e.status)).length,improval:Se.filter((e=>"improval"===e.status)).length})),[Se]);return x?(0,S.jsx)("div",{className:"bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 px-4 py-3 rounded",children:x}):(0,S.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 todo-analytics-wrapper",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-4 px-3 sm:px-4 md:px-6",children:[(0,S.jsxs)("div",{className:"flex items-center",children:[(0,S.jsx)(K.A,{className:"h-6 w-6 mr-2 dark:text-white"}),(0,S.jsx)("h2",{className:"text-xl font-semibold dark:text-white",children:a("analytics.todo.title")})]}),(0,S.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,S.jsx)("input",{type:"text",placeholder:a("common.searchPlaceholder"),className:"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",value:p,onChange:e=>b(e.target.value)}),(0,S.jsxs)("div",{className:"relative group",children:[(0,S.jsx)("button",{className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ".concat("cards"===ae?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":""),onClick:()=>{const e="table"===ae?"cards":"table";se(e),G&&G(e)},children:"table"===ae?(0,S.jsx)(g.A,{className:"h-5 w-5"}):(0,S.jsx)(h.A,{className:"h-5 w-5"})}),(0,S.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:a("table"===ae?"common.viewAsCards":"common.viewAsTable")})]}),(0,S.jsxs)("div",{className:"relative group ml-1",children:[(0,S.jsxs)("button",{className:"p-2 rounded-md ".concat(Te()>0?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"hover:bg-gray-100 dark:hover:bg-gray-700"," relative"),onClick:()=>F(!I),style:{position:"relative"},children:[(0,S.jsx)(y.A,{className:"h-5 w-5"}),Te()>0&&(0,S.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center z-10",children:Te()})]}),(0,S.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:a("common.filter")})]})]})]}),I&&(0,S.jsx)("div",{className:"cards"===ae?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,S.jsx)(q.A,{columns:ke,onApply:je,onReset:we,savedConditions:v,savedOperators:N,tableId:J})}),(0,S.jsx)("div",{className:"cards"===ae?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,S.jsx)(M.A,{tableId:J,onSelectFilter:je,onReset:we,activeFilterName:C,selectedFilterId:E,onFilterChange:Ne,defaultFilterName:a("teamWorktime.filters.all")})}),(0,S.jsxs)("div",{className:"mb-4 flex items-center gap-2",children:[(0,S.jsxs)("button",{onClick:()=>xe(!me),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,S.jsx)(A.A,{className:"h-4 w-4 transition-transform ".concat(me?"rotate-180":"")}),a("analytics.todo.frequencyAnalysis")," ",a(me?"common.collapse":"common.expand")]}),(0,S.jsxs)("button",{onClick:()=>be(!ye),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,S.jsx)(k.A,{className:"h-4 w-4 transition-transform ".concat(ye?"rotate-180":"")}),a("analytics.todo.shiftAnalysis")," ",a(ye?"common.collapse":"common.expand")]})]}),me&&(0,S.jsxs)("div",{className:"mb-6 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,S.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[(0,S.jsx)(A.A,{className:"h-5 w-5"}),a("analytics.todo.frequencyAnalysis")]}),oe?(0,S.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,S.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:a("analytics.todo.loadingAnalysis")})}):ne?(0,S.jsxs)("div",{className:"space-y-6",children:[(0,S.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,S.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800",children:[(0,S.jsx)("div",{className:"text-sm text-blue-600 dark:text-blue-400",children:a("analytics.todo.frequency.totalTodos")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-blue-700 dark:text-blue-300",children:ne.summary.totalTasks})]}),(0,S.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-green-200 dark:border-green-800",children:[(0,S.jsx)("div",{className:"text-sm text-green-600 dark:text-green-400",children:a("analytics.todo.frequency.completed")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:ne.summary.completedTasks})]}),(0,S.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 border border-yellow-200 dark:border-yellow-800",children:[(0,S.jsx)("div",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:a("analytics.todo.frequency.neverCompleted")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-yellow-700 dark:text-yellow-300",children:ne.summary.neverCompletedTasks})]}),(0,S.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4 border border-purple-200 dark:border-purple-800",children:[(0,S.jsx)("div",{className:"text-sm text-purple-600 dark:text-purple-400",children:a("analytics.todo.frequency.completionRate")}),(0,S.jsxs)("div",{className:"text-2xl font-bold text-purple-700 dark:text-purple-300",children:[ne.summary.completionRate,"%"]})]})]}),ne.userStats&&ne.userStats.length>0&&(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-3",children:a("analytics.todo.frequency.completionsPerUser")}),(0,S.jsx)("div",{className:"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6",children:(0,S.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,S.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.frequency.user")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.frequency.completed")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.frequency.lastCompletion")})]})}),(0,S.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800",children:ne.userStats.slice(0,10).map((e=>(0,S.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:e.user?"".concat(e.user.firstName," ").concat(e.user.lastName):a("analytics.todo.unknown")}),(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.completedCount}),(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.lastCompletedAt?(0,d.GP)(new Date(e.lastCompletedAt),"HH:mm"):"-"})]},e.userId)))})]})})]}),ne.taskStats&&ne.taskStats.length>0&&(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-3",children:a("analytics.todo.frequency.frequentCompleted")}),(0,S.jsx)("div",{className:"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6",children:(0,S.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,S.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.columns.title")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.columns.status")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.columns.branch")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.frequency.completed")})]})}),(0,S.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800",children:ne.taskStats.slice(0,20).map((e=>(0,S.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800 ".concat(e.neverCompleted?"bg-red-50 dark:bg-red-900/10":""),children:[(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 text-sm font-medium text-gray-900 dark:text-white",children:e.title}),(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,S.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat(Ae(e.currentStatus)),children:Ce(e.currentStatus)})}),(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.branch.name}),(0,S.jsxs)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[e.completedCount,"x ",e.neverCompleted&&(0,S.jsx)("span",{className:"text-red-600 dark:text-red-400",children:a("analytics.todo.never")})]})]},e.taskId)))})]})})]}),ne.statusAverages&&Object.keys(ne.statusAverages).length>0&&(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-3",children:a("analytics.todo.frequency.averageTimePerStatus")}),(0,S.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:Object.entries(ne.statusAverages).map((e=>{let[t,a]=e;return(0,S.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:[(0,S.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:Ce(t)}),(0,S.jsxs)("div",{className:"text-xl font-bold text-gray-900 dark:text-white",children:[a.averageHours.toFixed(1),"h"]}),(0,S.jsxs)("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:[a.taskCount," To-Do(s)"]})]},t)}))})]}),ne.summary&&(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-3",children:a("analytics.todo.frequency.statusDistribution")}),(0,S.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:(0,S.jsxs)("div",{className:"relative",style:{height:"200px"},children:[(0,S.jsxs)("div",{className:"absolute right-0 h-full flex flex-col justify-between text-xs text-gray-500 dark:text-gray-400 pr-1",children:[(0,S.jsx)("span",{children:ne.summary.totalTasks}),(0,S.jsx)("span",{children:Math.round(.75*ne.summary.totalTasks)}),(0,S.jsx)("span",{children:Math.round(.5*ne.summary.totalTasks)}),(0,S.jsx)("span",{children:Math.round(.25*ne.summary.totalTasks)}),(0,S.jsx)("span",{children:"0"})]}),(0,S.jsxs)("div",{className:"absolute inset-0 flex flex-col justify-between pointer-events-none pr-8",children:[(0,S.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,S.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,S.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,S.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,S.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"})]}),(0,S.jsxs)("div",{className:"absolute inset-0 flex items-end justify-around gap-2 pr-8 pb-1",children:[(0,S.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,S.jsxs)("div",{className:"relative group w-full",children:[(0,S.jsx)("div",{className:"w-full bg-green-500 dark:bg-green-600 rounded-t",style:{height:"".concat(ne.summary.completedTasks>0?ne.summary.completedTasks/ne.summary.totalTasks*100:0,"%"),minHeight:ne.summary.completedTasks>0?"4px":"0px"}}),(0,S.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"".concat(a("analytics.todo.frequency.completed"),": ").concat(ne.summary.completedTasks)})]}),(0,S.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium",children:a("analytics.todo.frequency.completed")}),(0,S.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:ne.summary.completedTasks})]}),(0,S.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,S.jsxs)("div",{className:"relative group w-full",children:[(0,S.jsx)("div",{className:"w-full bg-yellow-500 dark:bg-yellow-600 rounded-t",style:{height:"".concat(ne.summary.totalTasks-ne.summary.completedTasks-ne.summary.neverCompletedTasks>0?(ne.summary.totalTasks-ne.summary.completedTasks-ne.summary.neverCompletedTasks)/ne.summary.totalTasks*100:0,"%"),minHeight:ne.summary.totalTasks-ne.summary.completedTasks-ne.summary.neverCompletedTasks>0?"4px":"0px"}}),(0,S.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"".concat(a("tasks.status.open"),": ").concat(ne.summary.totalTasks-ne.summary.completedTasks-ne.summary.neverCompletedTasks)})]}),(0,S.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium",children:a("tasks.status.open")}),(0,S.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:ne.summary.totalTasks-ne.summary.completedTasks-ne.summary.neverCompletedTasks})]}),(0,S.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,S.jsxs)("div",{className:"relative group w-full",children:[(0,S.jsx)("div",{className:"w-full bg-red-500 dark:bg-red-600 rounded-t",style:{height:"".concat(ne.summary.neverCompletedTasks>0?ne.summary.neverCompletedTasks/ne.summary.totalTasks*100:0,"%"),minHeight:ne.summary.neverCompletedTasks>0?"4px":"0px"}}),(0,S.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"".concat(a("analytics.todo.frequency.neverCompleted"),": ").concat(ne.summary.neverCompletedTasks)})]}),(0,S.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium",children:a("analytics.todo.frequency.neverCompleted")}),(0,S.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:ne.summary.neverCompletedTasks})]})]})]})})]})]}):(0,S.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:a("analytics.todo.noData")})]}),ye&&(0,S.jsxs)("div",{className:"mb-6 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,S.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[(0,S.jsx)(k.A,{className:"h-5 w-5"}),a("analytics.todo.shift.shiftBased")]}),ge?(0,S.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,S.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:a("analytics.todo.loadingAnalysis")})}):ue?(0,S.jsxs)("div",{className:"space-y-6",children:[(0,S.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,S.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800",children:[(0,S.jsx)("div",{className:"text-sm text-blue-600 dark:text-blue-400",children:a("analytics.todo.shift.totalShifts")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-blue-700 dark:text-blue-300",children:ue.summary.totalShifts})]}),(0,S.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-green-200 dark:border-green-800",children:[(0,S.jsx)("div",{className:"text-sm text-green-600 dark:text-green-400",children:a("analytics.todo.shift.todosInShifts")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:ue.summary.totalTasksInShifts})]}),(0,S.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4 border border-purple-200 dark:border-purple-800",children:[(0,S.jsx)("div",{className:"text-sm text-purple-600 dark:text-purple-400",children:a("analytics.todo.shift.totalHours")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-purple-700 dark:text-purple-300",children:ue.summary.totalDurationHours||"0.00"})]}),(0,S.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 border border-yellow-200 dark:border-yellow-800",children:[(0,S.jsx)("div",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:a("analytics.todo.shift.averageDuration")}),(0,S.jsxs)("div",{className:"text-2xl font-bold text-yellow-700 dark:text-yellow-300",children:[ue.summary.averageDurationHours||"-","h"]})]}),(0,S.jsxs)("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 rounded-lg p-4 border border-indigo-200 dark:border-indigo-800",children:[(0,S.jsx)("div",{className:"text-sm text-indigo-600 dark:text-indigo-400",children:a("analytics.todo.shift.averageTodosPerShift")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-indigo-700 dark:text-indigo-300",children:ue.summary.totalShifts>0?(ue.summary.totalTasksInShifts/ue.summary.totalShifts).toFixed(1):"0"})]})]}),ue.shifts&&ue.shifts.length>0&&(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-3",children:a("analytics.todo.shift.shiftsWithTodos")}),(0,S.jsx)("div",{className:"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6",children:(0,S.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,S.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.frequency.user")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.columns.branch")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.shift.time")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.shift.duration")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.columns.title")})]})}),(0,S.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800",children:ue.shifts.map((e=>{const t=ve.has(e.workTimeId);return(0,S.jsxs)(s.Fragment,{children:[(0,S.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,S.jsxs)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:[e.user.firstName," ",e.user.lastName]}),(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.branch.name}),(0,S.jsxs)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[(0,d.GP)(new Date(e.startTime),"HH:mm"),e.endTime&&" - ".concat((0,d.GP)(new Date(e.endTime),"HH:mm"))]}),(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.durationHours?"".concat(e.durationHours,"h"):a("worktime.running")}),(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:(0,S.jsxs)("div",{className:"flex items-center gap-2",children:[(0,S.jsx)("span",{children:e.linkedTasksCount}),e.linkedTasksCount>0&&(0,S.jsxs)("div",{className:"relative group",children:[(0,S.jsx)("button",{onClick:()=>{return t=e.workTimeId,void fe((e=>{const a=new Set(e);return a.has(t)?a.delete(t):a.add(t),a}));var t},className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:t?(0,S.jsx)(Y.A,{className:"h-4 w-4"}):(0,S.jsx)(U.A,{className:"h-4 w-4"})}),(0,S.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:a("analytics.todo.shift.showTodos")})]})]})})]}),t&&e.linkedTasksCount>0&&(0,S.jsx)("tr",{className:"bg-gray-50 dark:bg-gray-800/50",children:(0,S.jsx)("td",{colSpan:5,className:"px-3 sm:px-4 md:px-6 py-4",children:(0,S.jsxs)("div",{className:"ml-4 border-l-2 border-blue-200 dark:border-blue-700 pl-4",children:[(0,S.jsx)("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:a("analytics.todo.shift.linkedTasks")}),(0,S.jsx)("div",{className:"space-y-2",children:e.linkedTasks.map((e=>(0,S.jsxs)("div",{className:"flex items-center gap-3 text-xs text-gray-600 dark:text-gray-400",children:[(0,S.jsx)("span",{className:"px-2 py-1 rounded-full ".concat(Ae(e.status)),children:Ce(e.status)}),(0,S.jsx)("span",{className:"font-medium",children:e.title}),e.responsible&&(0,S.jsxs)("span",{className:"text-gray-400",children:["(",e.responsible.firstName," ",e.responsible.lastName,")"]})]},e.id)))})]})})})]},e.workTimeId)}))})]})})]}),ue.tasksWithShifts&&ue.tasksWithShifts.length>0&&(0,S.jsxs)("div",{children:[(0,S.jsx)("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-3",children:a("analytics.todo.shift.tasksWithShiftDistribution")}),(0,S.jsx)("div",{className:"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6",children:(0,S.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,S.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,S.jsxs)("tr",{children:[(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.columns.title")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.columns.status")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.shift.totalShifts")}),(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:a("analytics.todo.shift.totalTime")})]})}),(0,S.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800",children:ue.tasksWithShifts.slice(0,30).map((e=>(0,S.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:[(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 text-sm font-medium text-gray-900 dark:text-white",children:e.task.title}),(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,S.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat(Ae(e.task.status)),children:Ce(e.task.status)})}),(0,S.jsxs)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[e.shiftCount,"x"]}),(0,S.jsxs)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[e.totalDurationHours,"h"]})]},e.task.id)))})]})})]})]}):(0,S.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:a("analytics.todo.noShiftData")})]}),(0,S.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-6",children:[(0,S.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:[(0,S.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("analytics.todo.stats.total")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:We.total})]}),(0,S.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-green-200 dark:border-green-800",children:[(0,S.jsx)("div",{className:"text-sm text-green-600 dark:text-green-400",children:a("analytics.todo.frequency.completed")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:We.done})]}),(0,S.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800",children:[(0,S.jsx)("div",{className:"text-sm text-blue-600 dark:text-blue-400",children:a("analytics.todo.stats.inProgress")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-blue-700 dark:text-blue-300",children:We.inProgress})]}),(0,S.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4 border border-purple-200 dark:border-purple-800",children:[(0,S.jsx)("div",{className:"text-sm text-purple-600 dark:text-purple-400",children:a("analytics.todo.stats.qualityControl")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-purple-700 dark:text-purple-300",children:We.qualityControl})]}),(0,S.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 border border-yellow-200 dark:border-yellow-800",children:[(0,S.jsx)("div",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:a("tasks.status.open")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-yellow-700 dark:text-yellow-300",children:We.open})]}),(0,S.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-4 border border-red-200 dark:border-red-800",children:[(0,S.jsx)("div",{className:"text-sm text-red-600 dark:text-red-400",children:a("tasks.status.improval")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-red-700 dark:text-red-300",children:We.improval})]})]}),Se.length>0&&(0,S.jsxs)("div",{className:"mb-6 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,S.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[(0,S.jsx)(Q.A,{className:"h-5 w-5"}),a("analytics.todo.statusDistribution")]}),(0,S.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:(0,S.jsxs)("div",{className:"relative",style:{height:"200px"},children:[(0,S.jsxs)("div",{className:"absolute right-0 h-full flex flex-col justify-between text-xs text-gray-500 dark:text-gray-400 pr-1",children:[(0,S.jsx)("span",{children:We.total}),(0,S.jsx)("span",{children:Math.round(.75*We.total)}),(0,S.jsx)("span",{children:Math.round(.5*We.total)}),(0,S.jsx)("span",{children:Math.round(.25*We.total)}),(0,S.jsx)("span",{children:"0"})]}),(0,S.jsxs)("div",{className:"absolute inset-0 flex flex-col justify-between pointer-events-none pr-8",children:[(0,S.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,S.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,S.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,S.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"}),(0,S.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"})]}),(0,S.jsxs)("div",{className:"absolute inset-0 flex items-end justify-around gap-1 sm:gap-2 pr-8 pb-1",children:[(0,S.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,S.jsxs)("div",{className:"relative group w-full",children:[(0,S.jsx)("div",{className:"w-full bg-green-500 dark:bg-green-600 rounded-t transition-all hover:opacity-80",style:{height:"".concat(We.total>0?We.done/We.total*100:0,"%"),minHeight:We.done>0?"4px":"0px"}}),(0,S.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"".concat(a("analytics.todo.frequency.completed"),": ").concat(We.done)})]}),(0,S.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium text-center",children:a("analytics.todo.frequency.completed")}),(0,S.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:We.done})]}),(0,S.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,S.jsxs)("div",{className:"relative group w-full",children:[(0,S.jsx)("div",{className:"w-full bg-blue-500 dark:bg-blue-600 rounded-t transition-all hover:opacity-80",style:{height:"".concat(We.total>0?We.inProgress/We.total*100:0,"%"),minHeight:We.inProgress>0?"4px":"0px"}}),(0,S.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"".concat(a("analytics.todo.stats.inProgress"),": ").concat(We.inProgress)})]}),(0,S.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium text-center",children:a("analytics.todo.stats.inProgress")}),(0,S.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:We.inProgress})]}),(0,S.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,S.jsxs)("div",{className:"relative group w-full",children:[(0,S.jsx)("div",{className:"w-full bg-purple-500 dark:bg-purple-600 rounded-t transition-all hover:opacity-80",style:{height:"".concat(We.total>0?We.qualityControl/We.total*100:0,"%"),minHeight:We.qualityControl>0?"4px":"0px"}}),(0,S.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"".concat(a("analytics.todo.stats.qualityControl"),": ").concat(We.qualityControl)})]}),(0,S.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium text-center",children:a("analytics.todo.columns.qualityControl")}),(0,S.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:We.qualityControl})]}),(0,S.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,S.jsxs)("div",{className:"relative group w-full",children:[(0,S.jsx)("div",{className:"w-full bg-yellow-500 dark:bg-yellow-600 rounded-t transition-all hover:opacity-80",style:{height:"".concat(We.total>0?We.open/We.total*100:0,"%"),minHeight:We.open>0?"4px":"0px"}}),(0,S.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"".concat(a("tasks.status.open"),": ").concat(We.open)})]}),(0,S.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium text-center",children:a("tasks.status.open")}),(0,S.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:We.open})]}),(0,S.jsxs)("div",{className:"flex flex-col items-center gap-1 flex-1",children:[(0,S.jsxs)("div",{className:"relative group w-full",children:[(0,S.jsx)("div",{className:"w-full bg-red-500 dark:bg-red-600 rounded-t transition-all hover:opacity-80",style:{height:"".concat(We.total>0?We.improval/We.total*100:0,"%"),minHeight:We.improval>0?"4px":"0px"}}),(0,S.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"".concat(a("tasks.status.improval"),": ").concat(We.improval)})]}),(0,S.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium text-center",children:a("tasks.status.improval")}),(0,S.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-500",children:We.improval})]})]})]})})]}),c?(0,S.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,S.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:a("common.loading")})}):"table"===ae?(0,S.jsx)("div",{className:"overflow-x-auto",children:(0,S.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,S.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,S.jsx)("tr",{children:Z.filter((e=>ee.includes(e))).map((e=>{const t=ke.find((t=>t.id===e));return t?(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:t.label},e):null}))})}),(0,S.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800",children:0===Se.length?(0,S.jsx)("tr",{children:(0,S.jsx)("td",{colSpan:Z.filter((e=>ee.includes(e))).length,className:"px-3 sm:px-4 md:px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"Keine To-Dos f\xfcr dieses Datum gefunden"})}):Se.map((e=>{const t=re.has(e.id),a=e.statusHistory&&e.statusHistory.length>0;return(0,S.jsxs)(s.Fragment,{children:[(0,S.jsx)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:Z.filter((e=>ee.includes(e))).map((s=>{switch(s){case"time":return(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:(0,d.GP)(new Date(e.updatedAt),"HH:mm")},s);case"title":return(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 text-sm font-medium text-gray-900 dark:text-white",children:(0,S.jsxs)("div",{className:"flex items-center gap-2",children:[a&&(0,S.jsxs)("div",{className:"relative group",children:[(0,S.jsx)("button",{onClick:()=>ie(e.id),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:t?(0,S.jsx)(Y.A,{className:"h-4 w-4"}):(0,S.jsx)(U.A,{className:"h-4 w-4"})}),(0,S.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:"Status-Historie anzeigen"})]}),(0,S.jsx)("span",{children:e.title})]})},s);case"status":return(0,S.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,S.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat(Ae(e.status)),children:Ce(e.status)})},s);case"responsible":return(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.responsible?"".concat(e.responsible.firstName," ").concat(e.responsible.lastName):"-"},s);case"qualityControl":return(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.qualityControl?"".concat(e.qualityControl.firstName," ").concat(e.qualityControl.lastName):"-"},s);case"branch":return(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.branch.name},s);default:return null}}))}),t&&a&&(0,S.jsx)("tr",{className:"bg-gray-50 dark:bg-gray-800/50",children:(0,S.jsx)("td",{colSpan:Z.filter((e=>ee.includes(e))).length,className:"px-3 sm:px-4 md:px-6 py-4",children:(0,S.jsxs)("div",{className:"ml-4 border-l-2 border-blue-200 dark:border-blue-700 pl-4",children:[(0,S.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2",children:[(0,S.jsx)(A.A,{className:"h-4 w-4"}),"Status-Wechsel"]}),(0,S.jsx)("div",{className:"space-y-2",children:e.statusHistory.map(((e,t)=>(0,S.jsxs)("div",{className:"flex items-center gap-3 text-xs text-gray-600 dark:text-gray-400",children:[(0,S.jsx)("span",{className:"font-medium",children:(0,d.GP)(new Date(e.changedAt),"HH:mm:ss")}),(0,S.jsx)("span",{className:"text-gray-400",children:"\u2192"}),(0,S.jsx)("span",{className:"px-2 py-1 rounded-full ".concat(Ae(e.oldStatus||"open")),children:Ce(e.oldStatus||"open")}),(0,S.jsx)("span",{className:"text-gray-400",children:"\u2192"}),(0,S.jsx)("span",{className:"px-2 py-1 rounded-full ".concat(Ae(e.newStatus)),children:Ce(e.newStatus)}),(0,S.jsx)("span",{className:"text-gray-400",children:"von"}),(0,S.jsxs)("span",{className:"font-medium",children:[e.user.firstName," ",e.user.lastName]})]},e.id)))})]})})})]},e.id)}))})]})}):(0,S.jsx)("div",{className:"-mx-3 sm:-mx-4 md:-mx-6",children:0===Se.length?(0,S.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400",children:[(0,S.jsx)(K.A,{className:"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500"}),(0,S.jsx)("div",{className:"text-sm",children:"Keine To-Dos gefunden"})]}):(0,S.jsx)(_.A,{children:Se.map((e=>{const t=[];ee.includes("branch")&&t.push({icon:(0,S.jsx)(j.A,{className:"h-4 w-4"}),label:"Niederlassung",value:e.branch.name,section:"left"}),ee.includes("responsible")&&t.push({icon:(0,S.jsx)(f.A,{className:"h-4 w-4"}),label:"Verantwortlich",value:e.responsible?"".concat(e.responsible.firstName," ").concat(e.responsible.lastName):"-",section:"main"}),ee.includes("qualityControl")&&t.push({icon:(0,S.jsx)(f.A,{className:"h-4 w-4"}),label:"Qualit\xe4tskontrolle",value:e.qualityControl?"".concat(e.qualityControl.firstName," ").concat(e.qualityControl.lastName):"-",section:"main"}),ee.includes("time")&&t.push({icon:(0,S.jsx)(k.A,{className:"h-4 w-4"}),label:"Zeit",value:(0,d.GP)(new Date(e.updatedAt),"HH:mm"),section:"right"});const a=e.statusHistory&&e.statusHistory.length>0,s=re.has(e.id),r=a?(0,S.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,S.jsxs)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2",children:[(0,S.jsx)(A.A,{className:"h-4 w-4"}),"Status-Wechsel"]}),(0,S.jsx)("div",{className:"space-y-2",children:e.statusHistory.map((e=>(0,S.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400",children:[(0,S.jsx)("span",{className:"font-medium",children:(0,d.GP)(new Date(e.changedAt),"HH:mm:ss")}),(0,S.jsx)("span",{className:"text-gray-400",children:"\u2192"}),(0,S.jsx)("span",{className:"px-2 py-1 rounded-full ".concat(Ae(e.oldStatus||"open")),children:Ce(e.oldStatus||"open")}),(0,S.jsx)("span",{className:"text-gray-400",children:"\u2192"}),(0,S.jsx)("span",{className:"px-2 py-1 rounded-full ".concat(Ae(e.newStatus)),children:Ce(e.newStatus)}),(0,S.jsx)("span",{className:"text-gray-400",children:"von"}),(0,S.jsxs)("span",{className:"font-medium",children:[e.user.firstName," ",e.user.lastName]})]},e.id)))})]}):null;return(0,S.jsx)(R.A,{title:e.title,status:{label:Ce(e.status),color:Ae(e.status)},metadata:t,expandable:r?{isExpanded:s,content:r,onToggle:()=>ie(e.id)}:void 0},e.id)}))})})]})};var ee=a(2704);const te="request-analytics-table",ae=["time","title","status","requester","responsible","branch"],se=e=>{let{selectedDate:t}=e;const{t:a}=(0,r.Bd)(),[l,o]=(0,s.useState)([]),[c,m]=(0,s.useState)(!1),[x,u]=(0,s.useState)(null),[p,b]=(0,s.useState)(""),[v,w]=(0,s.useState)([]),[N,T]=(0,s.useState)([]),[A,C]=(0,s.useState)(""),[W,E]=(0,s.useState)(null),[D,I]=(0,s.useState)(!1),{settings:F,isLoading:H,updateColumnOrder:O,updateHiddenColumns:P,toggleColumnVisibility:z,isColumnVisible:B,updateViewMode:V}=(0,L.F)(te,{defaultColumnOrder:ae,defaultViewMode:"table"}),G=(null===F||void 0===F?void 0:F.columnOrder)||ae,Z=(null===F||void 0===F?void 0:F.hiddenColumns)||[],K=G.filter((e=>!Z.includes(e))),Y=(null===F||void 0===F?void 0:F.viewMode)||"table",[U,Q]=(0,s.useState)(Y);(0,s.useEffect)((()=>{null!==F&&void 0!==F&&F.viewMode&&F.viewMode!==U&&Q(F.viewMode)}),[null===F||void 0===F?void 0:F.viewMode]);const J=(0,s.useMemo)((()=>[{id:"time",label:a("analytics.request.columns.time")},{id:"title",label:a("analytics.request.columns.title")},{id:"status",label:a("analytics.request.columns.status")},{id:"requester",label:a("analytics.request.columns.requester")},{id:"responsible",label:a("analytics.request.columns.responsible")},{id:"branch",label:a("analytics.request.columns.branch")}]),[a]);(0,s.useEffect)((()=>{t&&(async()=>{try{m(!0),u(null);const e={date:t};v.forEach((t=>{"branch"===t.column&&t.value&&(e.branchId=t.value),"requester"===t.column&&t.value&&(e.userId=t.value),"status"===t.column&&t.value}));const a=await i.A.get(n.Sn.TEAM_WORKTIME.ANALYTICS.REQUESTS_CHRONOLOGICAL,{params:e});o(a.data||[])}catch(x){console.error("Fehler beim Laden der Requests:",x),u(a("analytics.request.loadError"))}finally{m(!1)}})()}),[t,v]);const X=(0,s.useCallback)(((e,t)=>{w(e),T(t),I(!1)}),[]),$=(0,s.useCallback)((()=>{w([]),T([]),C(""),E(null)}),[]),se=(0,s.useCallback)(((e,t,a,s)=>{C(e),E(t),X(a,s)}),[X]),re=(0,s.useCallback)((()=>v.filter((e=>""!==e.column&&null!==e.value)).length),[v]),le=e=>{switch(e){case"approved":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400";case"approval":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400";case"denied":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400";case"to_improve":return"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},ie=e=>({approved:a("analytics.request.status.approved"),approval:a("analytics.request.status.approval"),denied:a("analytics.request.status.denied"),to_improve:a("analytics.request.status.to_improve")}[e]||e),ne=(0,s.useMemo)((()=>{let e=[...l];if(p){const t=p.toLowerCase();e=e.filter((e=>e.title.toLowerCase().includes(t)||e.branch.name.toLowerCase().includes(t)||"".concat(e.requester.firstName," ").concat(e.requester.lastName).toLowerCase().includes(t)||"".concat(e.responsible.firstName," ").concat(e.responsible.lastName).toLowerCase().includes(t)))}return v.forEach((t=>{if(""===t.column||null===t.value)return;const a=t.operator||"equals",s=t.value;e=e.filter((e=>{switch(t.column){case"status":return"equals"!==a||e.status===s;case"title":return"contains"!==a||e.title.toLowerCase().includes(String(s).toLowerCase());default:return!0}}))})),e}),[l,p,v]),de=(0,s.useMemo)((()=>({total:ne.length,approved:ne.filter((e=>"approved"===e.status)).length,pending:ne.filter((e=>"approval"===e.status)).length,denied:ne.filter((e=>"denied"===e.status)).length,toImprove:ne.filter((e=>"to_improve"===e.status)).length})),[ne]);return x?(0,S.jsx)("div",{className:"bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 px-4 py-3 rounded",children:x}):(0,S.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 request-analytics-wrapper",children:[(0,S.jsxs)("div",{className:"flex items-center justify-between mb-4 px-3 sm:px-4 md:px-6",children:[(0,S.jsxs)("div",{className:"flex items-center",children:[(0,S.jsx)(ee.A,{className:"h-6 w-6 mr-2 dark:text-white"}),(0,S.jsx)("h2",{className:"text-xl font-semibold dark:text-white",children:a("analytics.request.title")})]}),(0,S.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,S.jsx)("input",{type:"text",placeholder:a("common.searchPlaceholder"),className:"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",value:p,onChange:e=>b(e.target.value)}),(0,S.jsx)("button",{className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ".concat("cards"===U?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":""),onClick:()=>{const e="table"===U?"cards":"table";Q(e),V&&V(e)},title:a("table"===U?"common.viewAsCards":"common.viewAsTable"),children:"table"===U?(0,S.jsx)(g.A,{className:"h-5 w-5"}):(0,S.jsx)(h.A,{className:"h-5 w-5"})}),(0,S.jsxs)("button",{className:"p-2 rounded-md ".concat(re()>0?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"hover:bg-gray-100 dark:hover:bg-gray-700"," ml-1 relative"),onClick:()=>I(!D),title:a("common.filter"),style:{position:"relative"},children:[(0,S.jsx)(y.A,{className:"h-5 w-5"}),re()>0&&(0,S.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center z-10",children:re()})]})]})]}),D&&(0,S.jsx)("div",{className:"cards"===U?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,S.jsx)(q.A,{columns:J,onApply:X,onReset:$,savedConditions:v,savedOperators:N,tableId:te})}),(0,S.jsx)("div",{className:"cards"===U?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,S.jsx)(M.A,{tableId:te,onSelectFilter:X,onReset:$,activeFilterName:A,selectedFilterId:W,onFilterChange:se,defaultFilterName:a("teamWorktime.filters.all")})}),(0,S.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[(0,S.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:[(0,S.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("analytics.request.stats.total")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:de.total})]}),(0,S.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-green-200 dark:border-green-800",children:[(0,S.jsx)("div",{className:"text-sm text-green-600 dark:text-green-400",children:a("analytics.request.status.approved")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:de.approved})]}),(0,S.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 border border-yellow-200 dark:border-yellow-800",children:[(0,S.jsx)("div",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:a("analytics.request.status.approval")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-yellow-700 dark:text-yellow-300",children:de.pending})]}),(0,S.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-4 border border-red-200 dark:border-red-800",children:[(0,S.jsx)("div",{className:"text-sm text-red-600 dark:text-red-400",children:a("analytics.request.status.denied")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-red-700 dark:text-red-300",children:de.denied})]}),(0,S.jsxs)("div",{className:"bg-orange-50 dark:bg-orange-900/20 rounded-lg p-4 border border-orange-200 dark:border-orange-800",children:[(0,S.jsx)("div",{className:"text-sm text-orange-600 dark:text-orange-400",children:a("analytics.request.status.to_improve")}),(0,S.jsx)("div",{className:"text-2xl font-bold text-orange-700 dark:text-orange-300",children:de.toImprove})]})]}),c?(0,S.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,S.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:a("analytics.request.loading")})}):"table"===U?(0,S.jsx)("div",{className:"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6",children:(0,S.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,S.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-800",children:(0,S.jsx)("tr",{children:G.filter((e=>K.includes(e))).map((e=>{const t=J.find((t=>t.id===e));return t?(0,S.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:t.label},e):null}))})}),(0,S.jsx)("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-800",children:0===ne.length?(0,S.jsx)("tr",{children:(0,S.jsx)("td",{colSpan:G.filter((e=>K.includes(e))).length,className:"px-3 sm:px-4 md:px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:a("analytics.request.noRequestsForDate")})}):ne.map((e=>(0,S.jsx)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800",children:G.filter((e=>K.includes(e))).map((t=>{switch(t){case"time":return(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:(0,d.GP)(new Date(e.createdAt),"HH:mm")},t);case"title":return(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 text-sm font-medium text-gray-900 dark:text-white",children:e.title},t);case"status":return(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap",children:(0,S.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat(le(e.status)),children:ie(e.status)})},t);case"requester":return(0,S.jsxs)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[e.requester.firstName," ",e.requester.lastName]},t);case"responsible":return(0,S.jsxs)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:[e.responsible.firstName," ",e.responsible.lastName]},t);case"branch":return(0,S.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.branch.name},t);default:return null}}))},e.id)))})]})}):(0,S.jsx)("div",{className:"-mx-3 sm:-mx-4 md:-mx-6",children:0===ne.length?(0,S.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400",children:[(0,S.jsx)(ee.A,{className:"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500"}),(0,S.jsx)("div",{className:"text-sm",children:a("analytics.request.noRequests")})]}):(0,S.jsx)(_.A,{children:ne.map((e=>{const t=[];return K.includes("branch")&&t.push({icon:(0,S.jsx)(j.A,{className:"h-4 w-4"}),label:a("analytics.request.metadata.branch"),value:e.branch.name,section:"left"}),K.includes("requester")&&t.push({icon:(0,S.jsx)(f.A,{className:"h-4 w-4"}),label:a("analytics.request.metadata.requester"),value:"".concat(e.requester.firstName," ").concat(e.requester.lastName),section:"main"}),K.includes("responsible")&&t.push({icon:(0,S.jsx)(f.A,{className:"h-4 w-4"}),label:a("analytics.request.metadata.responsible"),value:"".concat(e.responsible.firstName," ").concat(e.responsible.lastName),section:"main"}),K.includes("time")&&t.push({icon:(0,S.jsx)(k.A,{className:"h-4 w-4"}),label:a("analytics.request.metadata.time"),value:(0,d.GP)(new Date(e.createdAt),"HH:mm"),section:"right"}),(0,S.jsx)(R.A,{title:e.title,status:{label:ie(e.status),color:le(e.status)},metadata:t},e.id)}))})})]})},re=()=>{const{t:e}=(0,r.Bd)(),{hasPermission:t}=(0,F.S)(),a=t("team_worktime_control","read","page"),o=t("team_worktime","read","table"),c=a&&o,[m,x]=(0,s.useState)([]),[u,p]=(0,s.useState)([]),[g,h]=(0,s.useState)((0,d.GP)(new Date,"yyyy-MM-dd")),[y,b]=(0,s.useState)("worktimes"),[v,f]=(0,s.useState)(!1),[k,j]=(0,s.useState)(null),w=(0,s.useCallback)((async()=>{try{f(!0),j(null);const e=await i.A.get(n.Sn.TEAM_WORKTIME.ACTIVE);x(e.data)}catch(k){var t,a,s;console.error("Fehler beim Laden der aktiven Benutzer:",k);let i=e("teamWorktime.messages.loadActiveUsersError");if(k.response){var r;const t=k.response.status,a=null===(r=k.response.data)||void 0===r?void 0:r.message;403===t?i=a||e("teamWorktime.permissions.insufficientShort"):401===t?i=e("teamWorktime.messages.unauthorized",{defaultValue:"Nicht autorisiert"}):500===t?i=e("teamWorktime.messages.serverError",{defaultValue:"Serverfehler"}):a&&(i=a)}else k.message&&(i=k.message);j(i),console.error("Fehlerdetails:",{status:null===(t=k.response)||void 0===t?void 0:t.status,statusText:null===(a=k.response)||void 0===a?void 0:a.statusText,data:null===(s=k.response)||void 0===s?void 0:s.data,message:k.message})}finally{f(!1)}}),[e]),N=(0,s.useCallback)((async()=>{try{f(!0),j(null);const e=await i.A.get("".concat(n.Sn.TEAM_WORKTIME.USER_DAY,"?date=").concat(g));p(e.data)}catch(k){console.error("Fehler beim Laden der Zeiterfassungen:",k),j(e("teamWorktime.messages.loadWorktimesError"))}finally{f(!1)}}),[g,e]);return(0,s.useEffect)((()=>{if(!c)return void j(e("teamWorktime.permissions.insufficientDetails"));w(),N();const t=setInterval(w,3e4);return()=>clearInterval(t)}),[w,N,c]),(0,s.useEffect)((()=>{N()}),[g,N]),(0,S.jsx)("div",{className:"min-h-screen dark:bg-gray-900",children:(0,S.jsx)("div",{className:"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6",children:(0,S.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,S.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,S.jsxs)("div",{className:"flex items-center pl-2 sm:pl-0",children:[(0,S.jsx)(l.A,{className:"h-6 w-6 text-gray-900 dark:text-white mr-2"}),(0,S.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:e("teamWorktime.title")})]})}),!c&&(0,S.jsxs)("div",{className:"bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 px-4 py-3 rounded mb-4",children:[(0,S.jsx)("p",{className:"font-medium mb-2",children:e("teamWorktime.permissions.insufficient")}),(0,S.jsxs)("ul",{className:"list-disc list-inside text-sm space-y-1",children:[!a&&(0,S.jsx)("li",{children:e("teamWorktime.permissions.missingPage")}),!o&&(0,S.jsx)("li",{children:e("teamWorktime.permissions.missingTable")})]}),(0,S.jsx)("p",{className:"text-sm mt-2",children:e("teamWorktime.permissions.contactAdmin")})]}),k&&(0,S.jsx)("div",{className:"bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-400 px-4 py-3 rounded mb-4",children:k}),(0,S.jsx)("div",{className:"border-b border-gray-200 dark:border-gray-700 mb-6",children:(0,S.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,S.jsx)("button",{onClick:()=>b("worktimes"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("worktimes"===y?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:e("teamWorktime.tabs.worktimes")}),(0,S.jsx)("button",{onClick:()=>b("todos"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("todos"===y?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:e("teamWorktime.tabs.todos")}),(0,S.jsx)("button",{onClick:()=>b("requests"),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat("requests"===y?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:e("teamWorktime.tabs.requests")})]})}),"worktimes"===y&&(0,S.jsx)(Z,{activeUsers:m,allWorktimes:u,loading:v,selectedDate:g,onDateChange:h,onStopWorktime:async(t,a)=>{try{f(!0),j(null),await i.A.post(n.Sn.TEAM_WORKTIME.STOP_USER,{userId:t,endTime:new Date((new Date).getTime()-6e4*(new Date).getTimezoneOffset())}),w()}catch(k){console.error("Fehler beim Stoppen der Benutzer-Zeiterfassung:",k),j(e("teamWorktime.messages.stopWorktimeError"))}finally{f(!1)}},onRefresh:w,showTodos:!0,showRequests:!0}),"todos"===y&&(0,S.jsx)($,{selectedDate:g}),"requests"===y&&(0,S.jsx)(se,{selectedDate:g})]})})})}},4129:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(45),r=a(5043);const l=["title","titleId"];function i(e,t){let{title:a,titleId:i}=e,n=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},n),a?r.createElement("title",{id:i},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const n=r.forwardRef(i)},4832:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(45),r=a(5043);const l=["title","titleId"];function i(e,t){let{title:a,titleId:i}=e,n=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},n),a?r.createElement("title",{id:i},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"}))}const n=r.forwardRef(i)},4850:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(45),r=a(5043);const l=["title","titleId"];function i(e,t){let{title:a,titleId:i}=e,n=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},n),a?r.createElement("title",{id:i},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6A2.25 2.25 0 0 1 6 3.75h2.25A2.25 2.25 0 0 1 10.5 6v2.25a2.25 2.25 0 0 1-2.25 2.25H6a2.25 2.25 0 0 1-2.25-2.25V6ZM3.75 15.75A2.25 2.25 0 0 1 6 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25V18a2.25 2.25 0 0 1-2.25 2.25H6A2.25 2.25 0 0 1 3.75 18v-2.25ZM13.5 6a2.25 2.25 0 0 1 2.25-2.25H18A2.25 2.25 0 0 1 20.25 6v2.25A2.25 2.25 0 0 1 18 10.5h-2.25a2.25 2.25 0 0 1-2.25-2.25V6ZM13.5 15.75a2.25 2.25 0 0 1 2.25-2.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-2.25A2.25 2.25 0 0 1 13.5 18v-2.25Z"}))}const n=r.forwardRef(i)},6238:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(45),r=a(5043);const l=["title","titleId"];function i(e,t){let{title:a,titleId:i}=e,n=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},n),a?r.createElement("title",{id:i},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h1.5m-1.5 3h1.5m-1.5 3h1.5m3-6H15m-1.5 3H15m-1.5 3H15M9 21v-3.375c0-.621.504-1.125 1.125-1.125h3.75c.621 0 1.125.504 1.125 1.125V21"}))}const n=r.forwardRef(i)},7012:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(45),r=a(5043);const l=["title","titleId"];function i(e,t){let{title:a,titleId:i}=e,n=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},n),a?r.createElement("title",{id:i},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const n=r.forwardRef(i)},7030:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(45),r=a(5043);const l=["title","titleId"];function i(e,t){let{title:a,titleId:i}=e,n=(0,s.A)(e,l);return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":i},n),a?r.createElement("title",{id:i},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 9h16.5m-16.5 6.75h16.5"}))}const n=r.forwardRef(i)}}]);
//# sourceMappingURL=727.b1907e22.chunk.js.map