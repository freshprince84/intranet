{"version":3,"file":"static/js/862.fb9f98d1.chunk.js","mappings":"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","sources":["components/organization/RoleConfigurationTab.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../../config/axios.ts';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport { roleApi } from '../../api/apiClient.ts';\nimport { Role } from '../../types/interfaces.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\n\ninterface Organization {\n  id: number;\n  displayName?: string;\n  name?: string;\n  settings?: any;\n}\n\ninterface RoleConfigurationTabProps {\n  organization: Organization | null;\n  onSave?: () => void;\n}\n\nconst RoleConfigurationTab: React.FC<RoleConfigurationTabProps> = ({\n  organization,\n  onSave\n}) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const [roles, setRoles] = useState<Role[]>([]);\n  const [lifecycleRoles, setLifecycleRoles] = useState<{\n    adminRoleId?: number | null;\n    hrRoleId?: number | null;\n    legalRoleId?: number | null;\n    employeeRoleIds?: number[];\n  }>({});\n  const [loading, setLoading] = useState(false);\n  const [saving, setSaving] = useState(false);\n  const [loadingRoles, setLoadingRoles] = useState(false);\n\n  useEffect(() => {\n    if (organization) {\n      loadRoles();\n      loadLifecycleRoles();\n    }\n  }, [organization]);\n\n  const loadRoles = async () => {\n    setLoadingRoles(true);\n    try {\n      const response = await roleApi.getAll();\n      if (response.data && Array.isArray(response.data)) {\n        setRoles(response.data);\n      }\n    } catch (error) {\n      console.error('Fehler beim Laden der Rollen:', error);\n      showMessage(\n        t('lifecycle.loadRolesError', { defaultValue: 'Fehler beim Laden der Rollen' }),\n        'error'\n      );\n    } finally {\n      setLoadingRoles(false);\n    }\n  };\n\n  const loadLifecycleRoles = async () => {\n    setLoading(true);\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.LIFECYCLE_ROLES);\n      setLifecycleRoles(response.data.lifecycleRoles || {});\n    } catch (error: any) {\n      console.error('Fehler beim Laden der Lebenszyklus-Rollen:', error);\n      // Wenn 404, dann gibt es noch keine Konfiguration - das ist OK\n      if (error.response?.status !== 404) {\n        showMessage(\n          error.response?.data?.message || t('lifecycle.loadLifecycleRolesError', { defaultValue: 'Fehler beim Laden der Konfiguration' }),\n          'error'\n        );\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSave = async () => {\n    setSaving(true);\n    try {\n      // Konvertiere zu Number oder null (verhindert, dass 0 oder undefined als String gesendet wird)\n      const prepareRoleId = (id: number | null | undefined): number | null => {\n        if (id === null || id === undefined || id === 0) {\n          return null;\n        }\n        return Number(id);\n      };\n\n      await axiosInstance.put(API_ENDPOINTS.ORGANIZATION_LIFECYCLE.LIFECYCLE_ROLES, {\n        adminRoleId: prepareRoleId(lifecycleRoles.adminRoleId),\n        hrRoleId: prepareRoleId(lifecycleRoles.hrRoleId),\n        legalRoleId: prepareRoleId(lifecycleRoles.legalRoleId),\n        employeeRoleIds: (lifecycleRoles.employeeRoleIds || []).map(prepareRoleId).filter((id): id is number => id !== null)\n      });\n      showMessage(\n        t('lifecycle.rolesSaved', { defaultValue: 'Rollen-Konfiguration erfolgreich gespeichert' }),\n        'success'\n      );\n      if (onSave) {\n        onSave();\n      }\n    } catch (error: any) {\n      console.error('Fehler beim Speichern:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.saveError', { defaultValue: 'Fehler beim Speichern' }),\n        'error'\n      );\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const handleAssignStandardRoles = () => {\n    // Finde Standard-Rollen\n    const adminRole = roles.find(r => r.name.toLowerCase().includes('admin') || r.name.toLowerCase().includes('administrator'));\n    const hrRole = roles.find(r => r.name.toLowerCase().includes('hr') || r.name.toLowerCase().includes('human'));\n    const legalRole = roles.find(r => r.name.toLowerCase() === 'derecho' || r.name.toLowerCase().includes('legal'));\n\n    setLifecycleRoles({\n      ...lifecycleRoles,\n      adminRoleId: adminRole?.id || null,\n      hrRoleId: hrRole?.id || null,\n      legalRoleId: legalRole?.id || null\n    });\n\n    showMessage(\n      t('lifecycle.standardRolesAssigned', { defaultValue: 'Standard-Rollen zugewiesen' }),\n      'success'\n    );\n  };\n\n  if (loading && !lifecycleRoles) {\n    return (\n      <div className=\"flex items-center justify-center py-8\">\n        <ArrowPathIcon className=\"h-6 w-6 animate-spin text-gray-400\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-lg font-semibold dark:text-white\">\n            {t('organization.lifecycleRoles.title', { defaultValue: 'Lebenszyklus-Rollen' })}\n          </h3>\n          <button\n            onClick={handleAssignStandardRoles}\n            className=\"px-3 py-1.5 text-sm font-medium text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-md hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors\"\n          >\n            {t('lifecycle.assignStandardRoles', { defaultValue: 'Standard-Rollen zuweisen' })}\n          </button>\n        </div>\n        \n        <div className=\"space-y-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              {t('organization.lifecycleRoles.admin', { defaultValue: 'Admin-Rolle' })}\n            </label>\n            <select\n              value={lifecycleRoles.adminRoleId || ''}\n              onChange={(e) => {\n                const value = e.target.value;\n                setLifecycleRoles({ \n                ...lifecycleRoles, \n                  adminRoleId: (value && value !== '' && !isNaN(parseInt(value, 10))) ? parseInt(value, 10) : null \n                });\n              }}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              disabled={loadingRoles}\n            >\n              <option value=\"\">{t('common.pleaseSelect')}</option>\n              {roles.map(role => (\n                <option key={role.id} value={role.id}>\n                  {role.name}\n                </option>\n              ))}\n            </select>\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              {t('organization.lifecycleRoles.hr', { defaultValue: 'HR-Rolle' })}\n            </label>\n            <select\n              value={lifecycleRoles.hrRoleId || ''}\n              onChange={(e) => {\n                const value = e.target.value;\n                setLifecycleRoles({ \n                ...lifecycleRoles, \n                  hrRoleId: (value && value !== '' && !isNaN(parseInt(value, 10))) ? parseInt(value, 10) : null \n                });\n              }}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              disabled={loadingRoles}\n            >\n              <option value=\"\">{t('common.pleaseSelect')}</option>\n              {roles.map(role => (\n                <option key={role.id} value={role.id}>\n                  {role.name}\n                </option>\n              ))}\n            </select>\n          </div>\n          \n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n              {t('organization.lifecycleRoles.legal', { defaultValue: 'Legal-Rolle' })}\n            </label>\n            <select\n              value={lifecycleRoles.legalRoleId || ''}\n              onChange={(e) => {\n                const value = e.target.value;\n                setLifecycleRoles({ \n                ...lifecycleRoles, \n                  legalRoleId: (value && value !== '' && !isNaN(parseInt(value, 10))) ? parseInt(value, 10) : null \n                });\n              }}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              disabled={loadingRoles}\n            >\n              <option value=\"\">{t('common.pleaseSelect')}</option>\n              {roles.map(role => (\n                <option key={role.id} value={role.id}>\n                  {role.name}\n                </option>\n              ))}\n            </select>\n          </div>\n        </div>\n        \n        <div className=\"mt-6 flex justify-end\">\n          <button\n            onClick={handleSave}\n            disabled={saving || loadingRoles}\n            className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n            title={saving ? t('common.saving', { defaultValue: 'Speichere...' }) : t('common.save', { defaultValue: 'Speichern' })}\n          >\n            {saving ? (\n              <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n            ) : (\n              <CheckIcon className=\"h-5 w-5\" />\n            )}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default RoleConfigurationTab;\n\n"],"names":["_ref","organization","onSave","t","useTranslation","showMessage","useMessage","roles","setRoles","useState","lifecycleRoles","setLifecycleRoles","loading","setLoading","saving","setSaving","loadingRoles","setLoadingRoles","useEffect","loadRoles","loadLifecycleRoles","async","response","roleApi","getAll","data","Array","isArray","error","console","defaultValue","axiosInstance","get","API_ENDPOINTS","ORGANIZATION_LIFECYCLE","LIFECYCLE_ROLES","_error$response","_error$response2","_error$response2$data","status","message","_jsx","className","children","ArrowPathIcon","_jsxs","onClick","handleAssignStandardRoles","adminRole","find","r","name","toLowerCase","includes","hrRole","legalRole","_objectSpread","adminRoleId","id","hrRoleId","legalRoleId","value","onChange","e","target","isNaN","parseInt","disabled","map","role","prepareRoleId","undefined","Number","put","employeeRoleIds","filter","_error$response3","_error$response3$data","title","CheckIcon"],"sourceRoot":""}