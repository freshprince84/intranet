"use strict";(self.webpackChunkintranet_frontend=self.webpackChunkintranet_frontend||[]).push([[354],{542:(e,t,r)=>{r.d(t,{Ay:()=>d,H_:()=>c,Zj:()=>i,i$:()=>o});var n=r(1923),a=r(1801),l=r(8018);l.v.log("DEBUGAUSGABE API-Client: API_URL ist:",a.H$);const s=n.A;s.interceptors.request.use((e=>{var t;const r="".concat(e.baseURL).concat(e.url);l.v.log("DEBUGAUSGABE API-Client: Vollst\xe4ndige Request URL:",r),l.v.log("DEBUGAUSGABE API-Client: Request-Methode:",null===(t=e.method)||void 0===t?void 0:t.toUpperCase()),l.v.log("DEBUGAUSGABE API-Client: Request-Headers:",e.headers),l.v.log("DEBUGAUSGABE API-Client: Request-Daten:",e.data);const n=localStorage.getItem("token");return l.v.log("DEBUGAUSGABE API-Client: Token vorhanden:",!!n),e}),(e=>(l.v.error("DEBUGAUSGABE API-Client: Fehler im Request Interceptor:",e),Promise.reject(e)))),s.interceptors.response.use((e=>(l.v.log("DEBUGAUSGABE API-Client: Response erhalten:",e.status,e.config.url),e)),(e=>(l.v.error("DEBUGAUSGABE API-Client: Fehler im Response Interceptor:",e.message),e.response?(l.v.error("DEBUGAUSGABE API-Client: Response Status:",e.response.status),l.v.error("DEBUGAUSGABE API-Client: Response Daten:",e.response.data)):l.v.error("DEBUGAUSGABE API-Client: Keine Response erhalten"),Promise.reject(e))));const o={getAll:()=>s.get("/users"),getById:e=>s.get("/users/".concat(e)),create:e=>{l.v.log("DEBUGAUSGABE API-Client: userApi.create wird aufgerufen mit Daten:",e);try{return s.post("/users",e).then((e=>(l.v.log("DEBUGAUSGABE API-Client: userApi.create Antwort:",e),e))).catch((e=>{throw l.v.error("DEBUGAUSGABE API-Client: userApi.create Fehler:",e.response||e),e}))}catch(t){throw l.v.error("DEBUGAUSGABE API-Client: Fehler vor dem API-Aufruf in userApi.create:",t),t}},update:(e,t)=>s.put("/users/".concat(e),t),updateRoles:(e,t)=>s.put("/users/".concat(e,"/roles"),{roleIds:t}),updateBranches:(e,t)=>s.put("/users/".concat(e,"/branches"),{branchIds:t})},i={getAll:e=>{l.v.log("DEBUGAUSGABE API-Client: roleApi.getAll wird aufgerufen",e?"mit branchId=".concat(e):"");const t=e?"/roles?branchId=".concat(e):"/roles";return s.get(t).then((e=>(l.v.log("DEBUGAUSGABE API-Client: roleApi.getAll erfolgreich:",e.data.length,"Rollen geladen"),e))).catch((e=>{throw l.v.error("DEBUGAUSGABE API-Client: roleApi.getAll Fehler:",e.message),e}))},getById:e=>(l.v.log("DEBUGAUSGABE API-Client: roleApi.getById(".concat(e,") wird aufgerufen")),s.get("/roles/".concat(e))),create:e=>{l.v.log("DEBUGAUSGABE API-Client: roleApi.create wird aufgerufen mit Daten:",e);try{return s.post("/roles",e).then((e=>(l.v.log("DEBUGAUSGABE API-Client: roleApi.create Antwort:",e),e))).catch((e=>{throw l.v.error("DEBUGAUSGABE API-Client: roleApi.create Fehler:",e.response||e),e}))}catch(t){throw l.v.error("DEBUGAUSGABE API-Client: Fehler vor dem API-Aufruf in roleApi.create:",t),t}},update:(e,t)=>{l.v.log("DEBUGAUSGABE API-Client: roleApi.update f\xfcr ID ".concat(e," wird aufgerufen mit Daten:"),t);try{return s.put("/roles/".concat(e),t).then((e=>(l.v.log("DEBUGAUSGABE API-Client: roleApi.update Antwort:",e),e))).catch((e=>{throw l.v.error("DEBUGAUSGABE API-Client: roleApi.update Fehler:",e.response||e),e}))}catch(r){throw l.v.error("DEBUGAUSGABE API-Client: Fehler vor dem API-Aufruf in roleApi.update:",r),r}},delete:e=>(l.v.log("DEBUGAUSGABE API-Client: roleApi.delete(".concat(e,") wird aufgerufen")),s.delete("/roles/".concat(e))),getRoleBranches:e=>(l.v.log("DEBUGAUSGABE API-Client: roleApi.getRoleBranches(".concat(e,") wird aufgerufen")),s.get("/roles/".concat(e,"/branches"))),updateRoleBranches:(e,t)=>(l.v.log("DEBUGAUSGABE API-Client: roleApi.updateRoleBranches(".concat(e,") wird aufgerufen mit:"),t),s.put("/roles/".concat(e,"/branches"),t))},c={getAll:e=>{const t=e?"/branches?roleId=".concat(e):"/branches";return s.get(t)},getById:e=>s.get("/branches/".concat(e)),getUserBranches:()=>s.get("/branches/user"),switchBranch:e=>s.put("/branches/switch",{branchId:e}),create:e=>s.post("/branches",e),update:(e,t)=>s.put("/branches/".concat(e),t),delete:e=>s.delete("/branches/".concat(e))},d=s},1713:(e,t,r)=>{r.d(t,{DW:()=>E,I5:()=>p,IF:()=>v,M9:()=>f,P0:()=>u,Pg:()=>k,VY:()=>w,Yq:()=>c,_2:()=>g,c$:()=>y,fU:()=>d,h4:()=>b,lK:()=>x,pg:()=>h,uT:()=>m,vv:()=>A});var n=r(4653),a=r(2415),l=r(1620),s=r(6981),o=r(887),i=r(8018);const c=e=>{if(!e)return"-";try{const t=e.split("-");if(3!==t.length)return"-";const r=parseInt(t[0]),n=parseInt(t[1])-1,a=parseInt(t[2]);return new Date(r,n,a,12,0,0).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"})}catch(t){return console.error("Fehler beim Formatieren des Datums:",t),"-"}},d=e=>{if(!e)return"-";try{const t=(0,n.H)(e),r=t.getUTCHours().toString().padStart(2,"0"),a=t.getUTCMinutes().toString().padStart(2,"0");return"".concat(r,":").concat(a)}catch(t){return console.error("Fehler beim Formatieren der Zeit f\xfcr ".concat(e,":"),t),"-"}},u=(e,t)=>{if(!e||!t)return"-";try{const r=e.endsWith("Z")?e.substring(0,e.length-1):e,n=t.endsWith("Z")?t.substring(0,t.length-1):t,a=new Date(r),l=new Date(n).getTime()-a.getTime(),s=Math.floor(l/6e4),o=Math.floor(s/60),i=s%60;return"".concat(o,"h ").concat(i,"m")}catch(r){return console.error("Fehler bei der Dauerberechnung:",r),"-"}},h=e=>{try{const t=parseInt(e.substring(0,4)),r=parseInt(e.substring(6)),n=new Date(Date.UTC(t,0,1,12,0,0)).getUTCDay(),s=n<=4?4-n:11-n,c=new Date(Date.UTC(t,0,1+s,12,0,0)),d=new Date(Date.UTC(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()+7*(r-1),12,0,0)),u=new Date(Date.UTC(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()-3,12,0,0)),h=(0,a.GP)(u,"yyyy-MM-dd");if(i.v.log("Konvertierte Woche ".concat(e," zu Datum: ").concat(h," (Wochentag: ").concat((0,a.GP)(u,"EEEE",{locale:o.de}),")")),"Montag"!==(0,a.GP)(u,"EEEE",{locale:o.de})){console.warn("Berechnetes Datum ist kein Montag! Korrigiere...");const e=(0,l.k)(u,{weekStartsOn:1});return(0,a.GP)(e,"yyyy-MM-dd")}return h}catch(t){console.error("Fehler beim Konvertieren des Wochendatums:",t);const e=(0,l.k)(new Date,{weekStartsOn:1});return(0,a.GP)(e,"yyyy-MM-dd")}},m=(e,t)=>{try{if(!e||!e.startTime)return!1;return e.startTime.split("T")[0]===t}catch(r){return console.error("Fehler beim Pr\xfcfen der Relevanz eines Worktime-Eintrags:",r),!1}},g=e=>{if(!e)return[];const t=new Date(e),r=[];for(let n=0;n<7;n++){const e=(0,s.f)(t,n),l={date:(0,a.GP)(e,"yyyy-MM-dd"),day:(0,a.GP)(e,"EEEE",{locale:o.de})};r.push(l)}return r},p=e=>{if(!e)return"-";try{return new Date(e).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(t){return console.error("Fehler beim Formatieren des Datums und der Zeit:",t),"-"}},f=e=>{try{let t,r,n;if(!e.includes("-Q"))throw new Error("Ung\xfcltiges Quinzena-Format");{const a=e.split("-Q"),l=a[0];if(n=parseInt(a[1]),l.includes("-")){const e=l.split("-");t=parseInt(e[0]),r=parseInt(e[1])}else t=parseInt(l),r=Math.ceil(n/2)}const l=1===n?1:16,s=new Date(Date.UTC(t,r-1,l,12,0,0));return(0,a.GP)(s,"yyyy-MM-dd")}catch(t){console.error("Fehler beim Konvertieren der Quinzena:",t);const e=(0,l.k)(new Date,{weekStartsOn:1});return(0,a.GP)(e,"yyyy-MM-dd")}},x=e=>{if(!e)return[];const t=new Date(e),r=t.getFullYear(),n=t.getMonth();let l;if(1===t.getDate())l=15;else{l=new Date(r,n+1,0).getDate()-15}const i=[];for(let c=0;c<l;c++){const e=(0,s.f)(t,c),r={date:(0,a.GP)(e,"yyyy-MM-dd"),day:(0,a.GP)(e,"EEEE",{locale:o.de})};i.push(r)}return i},w=()=>{const e=new Date;return(e=>{try{const t=new Date(e+"T12:00:00"),r=t.getFullYear(),n=t.getMonth()+1,a=t.getDate()<=15?1:2;return"".concat(r,"-").concat(String(n).padStart(2,"0"),"-Q").concat(a)}catch(t){console.error("Fehler beim Berechnen der Quinzena:",t);const e=new Date,r=e.getFullYear(),n=e.getMonth()+1;return"".concat(r,"-").concat(String(n).padStart(2,"0"),"-Q1")}})((0,a.GP)(e,"yyyy-MM-dd"))},v=e=>{const t=new Date(e);return new Date(t.getTime()+6e4*t.getTimezoneOffset())},y=e=>{try{const t=e.reduce(((e,t)=>{if(!t.endTime)return e;const r=t.startTime.endsWith("Z")?t.startTime.substring(0,t.startTime.length-1):t.startTime,n=t.endTime.endsWith("Z")?t.endTime.substring(0,t.endTime.length-1):t.endTime,a=new Date(r),l=new Date(n).getTime()-a.getTime();return e+Math.floor(l/6e4)}),0),r=Math.floor(t/60),n=t%60;return"".concat(r,"h ").concat(n,"m")}catch(t){return console.error("Fehler bei der Formatierung der Gesamtdauer:",t),"0h 0m"}},A=e=>!!(e.invoiceItems&&e.invoiceItems.length>0),b=e=>{if(!e.invoiceItems||0===e.invoiceItems.length)return null;return e.invoiceItems[0].invoice},k=e=>({DRAFT:"Entwurf",SENT:"Gesendet",PAID:"Bezahlt",OVERDUE:"\xdcberf\xe4llig",CANCELLED:"Storniert"}[e]||e),E=e=>({DRAFT:"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",SENT:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",PAID:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",OVERDUE:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",CANCELLED:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300"}[e]||"bg-gray-100 text-gray-800")},6896:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(5043),a=r(542),l=(r(8018),r(579));const s=e=>{let{url:t,alt:r}=e;const[s,o]=(0,n.useState)(null),[i,c]=(0,n.useState)(!0),[d,u]=(0,n.useState)(!1);(0,n.useEffect)((()=>{t&&t.match(/^https?:\/\//)?(async()=>{try{c(!0),u(!1);const e=await a.Ay.get("/cerebro/links/preview?url=".concat(encodeURIComponent(t)));o(e.data)}catch(e){u(!0),o({title:r||t,thumbnail:null,type:"link"})}finally{c(!1)}})():c(!1)}),[t,r]);const h=e=>{try{return new URL(e).hostname.replace("www.","")}catch(t){return e}},m=(()=>{if(null!==s&&void 0!==s&&s.title)return s.title;return/^[\d.]+$/.test(r||"")?h(t):r||h(t)})(),g=null===s||void 0===s?void 0:s.thumbnail;return(0,l.jsxs)("div",{onClick:e=>{e.preventDefault(),window.open(t,"_blank","noopener,noreferrer")},className:"border border-gray-300 dark:border-gray-600 rounded-xl overflow-hidden bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition-all hover:shadow-md",children:[g?(0,l.jsx)("div",{className:"w-full h-48 bg-gray-200 dark:bg-gray-700 overflow-hidden relative",children:(0,l.jsx)("img",{src:g,alt:m,loading:"lazy",className:"w-full h-full object-cover",onError:e=>{const r=e.target;r.style.display="none";const n=r.parentElement;n&&(n.innerHTML='\n                  <div class="w-full h-full bg-gradient-to-br from-blue-500 to-purple-600 dark:from-blue-600 dark:to-purple-700 flex items-center justify-center">\n                    <div class="text-white text-center">\n                      <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">\n                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" />\n                      </svg>\n                      <p class="text-sm font-medium">'.concat(h(t),"</p>\n                    </div>\n                  </div>\n                "))}})}):(0,l.jsx)("div",{className:"w-full h-48 bg-gradient-to-br from-blue-500 to-purple-600 dark:from-blue-600 dark:to-purple-700 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-white text-center",children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 mx-auto mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),(0,l.jsx)("p",{className:"text-sm font-medium",children:h(t)})]})}),(0,l.jsx)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:i?(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500 mr-2"}),(0,l.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Lade Vorschau..."})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white mb-1 line-clamp-2",children:m}),(0,l.jsxs)("div",{className:"flex items-center mt-1",children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 mr-1 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),(0,l.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:h(t)})]})]})})]})},o=e=>{let{content:t,className:r="",maxHeight:a="150px",temporaryAttachments:o=[],showImagePreview:i=!1,onlyAttachments:c=!1,attachmentMetadata:d=[]}=e;const u=n.useRef(new Set);n.useEffect((()=>()=>{u.current.forEach((e=>{URL.revokeObjectURL(e)})),u.current.clear()}),[]);const h=()=>{const e=Array.from(t.matchAll(/!\[(.*?)\]\((.*?)\)/g)).map((e=>({type:"image",alt:e[1],url:e[2],isTemporary:"wird nach dem Erstellen hochgeladen"===e[2]}))),r=Array.from(t.matchAll(/\[(.*?)\]\((.*?)\)/g)).filter((e=>!e[0].startsWith("!"))).map((e=>({type:"link",alt:e[1],url:e[2],isTemporary:"wird nach dem Erstellen hochgeladen"===e[2]}))),n=[],a=new Set([...e,...r].map((e=>e.url))),l=/(?:^|[\s\n])(https?:\/\/[^\s\n\)\]\>]+)/g;let s;for(;null!==(s=l.exec(t));){const e=s[1].trim();a.has(e)||n.push({type:"link",alt:e,url:e,isTemporary:!1})}const o=/(?:^|[\s\n])((?:www\.)?[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?:\/[^\s\n\)\]\>]*)?)(?=[\s\n\)\]\>]|$)/g;let i;for(;null!==(i=o.exec(t));){const e=i[1].trim();if(!(a.has(e)||a.has("https://".concat(e))||a.has("http://".concat(e)))&&(!n.some((t=>t.url===e||t.url==="https://".concat(e)||t.url==="http://".concat(e)))&&e.includes("."))){const t=/[a-zA-Z]/.test(e),r=[".com",".org",".net",".edu",".gov",".de",".es",".fr",".it",".co",".io",".app",".dev",".tech",".info",".biz",".me",".tv",".cc",".ws"].some((t=>e.toLowerCase().endsWith(t)));if(!t&&!r)continue;if(/^(\d{1,3}\.){3}\d{1,3}(:\d+)?$/.test(e))continue;const a=e.startsWith("http://")||e.startsWith("https://")?e:"https://".concat(e);n.push({type:"link",alt:e,url:a,isTemporary:!1})}}return[...e,...r,...n].reduce(((e,t)=>{const r="".concat(t.type,"-").concat(t.alt,"-").concat(t.url);return e.some((e=>"".concat(e.type,"-").concat(e.alt,"-").concat(e.url)===r))||e.push(t),e}),[])},m=e=>{const t=o.find((t=>t.fileName===e));if(null!==t&&void 0!==t&&t.file){const e=URL.createObjectURL(t.file);return u.current.add(e),e}return null},g=(e,t)=>{const r=e.replace(/^(?:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]|\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|\uD83E[\uDC00-\uDDFF])+/,"").trim();let n=d.find((t=>t.fileName===e));if(n||r===e||(n=d.find((e=>e.fileName===r))),n||(n=d.find((t=>t.fileName.toLowerCase()===e.toLowerCase()))),n||r===e||(n=d.find((e=>e.fileName.toLowerCase()===r.toLowerCase()))),!n&&t&&d.length>0){let e=t.match(/\/(?:tasks|requests)\/\d+\/attachments\/(\d+)/);if(e){const t=parseInt(e[1],10);n=d.find((e=>e.id===t))}if(!n&&(e=t.match(/\/cerebro\/media\/(\d+)\/file/),e)){const t=parseInt(e[1],10);n=d.find((e=>e.id===t))}}return n};if(c){const e=(()=>{const e=h().filter((e=>{let t=e.url;if(e.isTemporary){const r=m(e.alt);r&&(t=r)}return t&&"wird nach dem Erstellen hochgeladen"!==t}));if(0===e.length)return null;const t=e.map(((e,t)=>{var r,n,a;let s=g(e.alt,e.url);if(!s&&e.url){let t=e.url.match(/\/attachments\/(\d+)/);if(t){const e=parseInt(t[1]);s=d.find((t=>t.id===e))}if(!s&&(t=e.url.match(/\/cerebro\/media\/(\d+)\/file/),t)){const e=parseInt(t[1]);s=d.find((t=>t.id===e))}}const o=null===(r=e.url)||void 0===r?void 0:r.includes("/cerebro/media/");let i="";if(i=null!==(n=s)&&void 0!==n&&n.url?s.url:e.url||"",e.isTemporary){const t=m(e.alt);t&&(i=t)}if(!i||"wird nach dem Erstellen hochgeladen"===i)return null;const c=e.alt.toLowerCase();let u=!1,h=!1;if(null!==(a=s)&&void 0!==a&&a.fileType&&(u=s.fileType.startsWith("image/"),h="application/pdf"===s.fileType),s||"image"!==e.type||(u=!0),!s){const e=i&&i.toLowerCase().endsWith(".pdf"),t=!(!i||!i.match(/\.pdf(\?|$)/i)),r=c.endsWith(".pdf"),n=i&&(i.includes("/api/requests/attachments/")||i.includes("/api/tasks/attachments/"))&&r,a=i&&i.includes("/cerebro/media/")&&r;h=e||t||r||n||a}const p=i&&i.match(/^https?:\/\//)&&!u&&!h;return o?(0,l.jsxs)("div",{className:"p-3 flex items-center border rounded-lg bg-gray-50 dark:bg-gray-700/50",children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2 dark:text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),(0,l.jsx)("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline",children:e.alt})]},t):(0,l.jsx)("div",{className:"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50",children:u?(0,l.jsx)("div",{children:(0,l.jsx)("img",{src:i,alt:e.alt,loading:"lazy",className:"w-full h-auto max-h-96 object-contain",style:{display:"block"}})}):h?(0,l.jsxs)("div",{className:"p-3",children:[(0,l.jsxs)("div",{className:"flex items-center mb-2",children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2 dark:text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,l.jsx)("span",{className:"text-sm font-medium dark:text-gray-200",children:e.alt}),(0,l.jsx)("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:"ml-auto text-blue-600 dark:text-blue-400 hover:underline text-sm",children:"\xd6ffnen"})]}),(0,l.jsx)("iframe",{src:"".concat(i,"#view=FitH"),className:"w-full rounded border dark:border-gray-600",style:{height:"400px"},title:e.alt})]}):p?(0,l.jsxs)("div",{className:"p-3",children:[(0,l.jsxs)("div",{className:"flex items-center mb-2",children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2 dark:text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),(0,l.jsx)("span",{className:"text-sm font-medium dark:text-gray-200 flex-grow",children:e.alt||i}),(0,l.jsx)("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:"ml-2 text-blue-600 dark:text-blue-400 hover:underline text-sm",children:"\xd6ffnen"})]}),(0,l.jsx)("iframe",{src:i,className:"w-full rounded border dark:border-gray-600",style:{height:"400px"},title:e.alt||"Web-Vorschau",sandbox:"allow-same-origin allow-scripts allow-popups allow-forms"})]}):(0,l.jsxs)("div",{className:"p-3 flex items-center",children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2 dark:text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,l.jsx)("a",{href:i,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline",children:e.alt})]})},t)})).filter((e=>null!==e));return 0===t.length?null:(0,l.jsx)("div",{className:"flex flex-col gap-3 mt-2",children:t})})();return e?(0,l.jsx)("div",{className:r,children:e}):(0,l.jsx)("div",{className:r})}if(i){const e={};"none"===a?e.overflowY="visible":(e.maxHeight="150px"!==a?a:"100%",e.overflowY="auto");const n=h(),o=n.filter((e=>{var t;if(null===(t=e.url)||void 0===t?void 0:t.includes("/cerebro/media/"))return!1;let r=g(e.alt,e.url);let n="";if(n=null!==r&&void 0!==r&&r.url?r.url:e.url||"",e.isTemporary){const t=m(e.alt);t&&(n=t)}if(!n||"wird nach dem Erstellen hochgeladen"===n)return!1;let a=!1,l=!1;if(null!==r&&void 0!==r&&r.fileType)a=r.fileType.startsWith("image/"),l="application/pdf"===r.fileType;else if("image"===e.type)a=!0;else{const t=/\.(jpg|jpeg|png|gif|webp|svg|bmp)(\?|$)/i;a=t.test(e.alt)||t.test(n)}return a&&!l}));let i=t;const c=/!\[([^\]]*)\]\(([^)]+)\)/g,d=/\[([^\]]+)\]\(([^)]+)\)/g;i=i.replace(c,(()=>"")),i=i.replace(/\n{3,}/g,"\n\n").trim();const u=n.filter((e=>{var t;if(null===(t=e.url)||void 0===t?void 0:t.includes("/cerebro/media/"))return!1;let r="",n=g(e.alt,e.url);if(r=null!==n&&void 0!==n&&n.url?n.url:e.url||"",e.isTemporary){const t=m(e.alt);t&&(r=t)}if(!r||"wird nach dem Erstellen hochgeladen"===r)return!1;const a=r.match(/^https?:\/\//);if(!a)return!1;let l=!1,s=!1;if(null!==n&&void 0!==n&&n.fileType)l=n.fileType.startsWith("image/"),s="application/pdf"===n.fileType;else if("image"===e.type)l=!0;else{const t=/\.(jpg|jpeg|png|gif|webp|svg|bmp)(\?|$)/i;l=t.test(r)||t.test(e.alt||"");const n=/\.pdf(\?|$)/i;s=n.test(r)||n.test(e.alt||"")}const o=r.includes("/api/requests/attachments/")||r.includes("/api/tasks/attachments/");return a&&!l&&!s&&!o}));i=i.replace(d,((e,t,r)=>{if(e.startsWith("!["))return e;const n=r.match(/^https?:\/\//),a=r.includes("/cerebro/media/"),l=r.includes("/api/requests/attachments/")||r.includes("/api/tasks/attachments/"),s=/\.(jpg|jpeg|png|gif|webp|svg|bmp)(\?|$)/i.test(r),o=/\.pdf(\?|$)/i.test(r),i=u.some((e=>e.url===r));return!n||a||l||s||o||!i?"".concat(t," [Link]"):""})),u.forEach((e=>{const t=e.alt,r=(e.url,t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")),n=new RegExp("(?:^|[\\s\\n])(".concat(r,")(?:[\\s\\n]|$)"),"g");i=i.replace(n,((e,t)=>{const r=e.substring(0,e.indexOf(t)),n=e.substring(e.indexOf(t)+t.length);return(r.trim()+" "+n.trim()).trim()||""}))})),i=i.replace(/\n{3,}/g,"\n\n").trim();const p=()=>{if(0===o.length)return null;const e=o.reduce(((e,t)=>{const r="".concat(t.alt,"-").concat(t.url||"");return e.some((e=>"".concat(e.alt,"-").concat(e.url||"")===r))||e.push(t),e}),[]);return(0,l.jsx)("div",{className:"flex flex-col gap-3 mt-2",children:e.map(((e,t)=>{let r=g(e.alt,e.url),n="";if(n=null!==r&&void 0!==r&&r.url?r.url:e.url||"",e.isTemporary){const t=m(e.alt);t&&(n=t)}return n&&"wird nach dem Erstellen hochgeladen"!==n?(0,l.jsx)("div",{className:"border rounded-lg overflow-hidden bg-gray-50 dark:bg-gray-700/50",children:(0,l.jsx)("img",{src:n,alt:e.alt,loading:"lazy",className:"w-full h-auto max-h-96 object-contain",style:{display:"block"}})},"img-".concat(e.alt,"-").concat(n,"-").concat(t)):null})).filter((e=>null!==e))})},f=()=>{if(0===u.length)return null;const e=u.reduce(((e,t)=>{const r=t.url||"";return e.some((e=>(e.url||"")===r))||e.push(t),e}),[]);return(0,l.jsx)("div",{className:"flex flex-col gap-3 mt-2",children:e.map(((e,t)=>{let r="",n=g(e.alt,e.url);if(r=null!==n&&void 0!==n&&n.url?n.url:e.url||"",e.isTemporary){const t=m(e.alt);t&&(r=t)}return(0,l.jsx)(s,{url:r,alt:e.alt||r||""},"link-".concat(e.alt,"-").concat(r,"-").concat(t))}))})};return(0,l.jsxs)("div",{className:"markdown-preview ".concat(r," dark:text-gray-200"),style:e,children:[i&&(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:i.replace(/\n/g,"<br/>")}}),p(),f()]})}return(0,l.jsx)("div",{className:"markdown-preview ".concat(r),children:(()=>{const e=h();return 0===e.length?null:(0,l.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:e.map(((e,t)=>{let r=e.url;if(e.isTemporary){const t=m(e.alt);t&&(r=t)}return(0,l.jsxs)("div",{className:"group relative",children:[(0,l.jsxs)("div",{className:"bg-gray-100 dark:bg-gray-700 rounded px-2 py-1 text-sm flex items-center dark:text-gray-200",children:[(0,l.jsx)("span",{className:"mr-1",children:"image"===e.type?(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}):(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}),e.alt]}),r&&"wird nach dem Erstellen hochgeladen"!==r&&(0,l.jsx)("div",{className:"absolute z-10 bg-white dark:bg-gray-800 border dark:border-gray-700 shadow-lg p-2 rounded-md -bottom-2 left-1/2 transform -translate-x-1/2 translate-y-full max-w-xs opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",children:"image"===e.type?(0,l.jsx)("img",{src:r,alt:e.alt,loading:"lazy",className:"max-w-full border rounded dark:border-gray-700",style:{maxHeight:"200px",objectFit:"contain"}}):r.match(/^(https?:\/\/|blob:)/)?(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 dark:text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),(0,l.jsx)("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline",children:e.alt})]}):(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 dark:text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,l.jsx)("span",{className:"dark:text-gray-200",children:e.alt})]})})]},t)}))})})()})}}}]);
//# sourceMappingURL=354.9b1fe2f0.chunk.js.map