"use strict";(self.webpackChunkintranet_frontend=self.webpackChunkintranet_frontend||[]).push([[786],{2786:(e,t,s)=>{s.r(t),s.d(t,{default:()=>he});var r=s(5043),a=s(4117),n=s(3216),o=s(9379),i=s(1637),l=s(1923),d=s(2672),c=s(2760),u=s(2023),m=s(1801),p=s(6443),x=s(7591),h=s(1816),g=s(9422),b=s(5657),y=s(579);const v=e=>{let{isOpen:t,onClose:s,onRequestCreated:n}=e;const{t:i}=(0,a.Bd)(),{user:c}=(0,d.As)(),{openSidepane:u,closeSidepane:v}=(0,b.N)(),[f,w]=(0,r.useState)(window.innerWidth>1070),[k,j]=(0,r.useState)([]),[N,q]=(0,r.useState)([]),[A,S]=(0,r.useState)({title:"",description:"",responsible_id:"",branch_id:"",type:"other",is_private:!1,due_date:"",create_todo:!1}),[R,C]=(0,r.useState)(null),[D,_]=(0,r.useState)(!1),[E,T]=(0,r.useState)(window.innerWidth<640),[B,z]=(0,r.useState)([]),[L,F]=(0,r.useState)(!1),M=(0,r.useRef)(null),O=(0,r.useRef)(null);(0,r.useEffect)((()=>{t&&(async()=>{try{if(C(null),!localStorage.getItem("token"))return void C(i("createRequest.errors.notAuthenticated"));console.log("Lade Daten f\xfcr CreateRequestModal...");try{const[t,s]=await Promise.all([l.A.get(m.Sn.USERS.DROPDOWN),l.A.get(m.Sn.BRANCHES.BASE)]);if(console.log("Benutzer geladen:",t.data.length),console.log("Niederlassungen geladen:",s.data.length),j(t.data||[]),q(s.data||[]),c){if(S((e=>(0,o.A)((0,o.A)({},e),{},{responsible_id:c.id.toString()}))),s.data&&s.data.length>0){var e;const t=null===(e=s.data[0])||void 0===e?void 0:e.id.toString();S((e=>(0,o.A)((0,o.A)({},e),{},{branch_id:t})))}const t=new Date;t.setDate(t.getDate()+14);const r=t.toISOString().split("T")[0];S((e=>(0,o.A)((0,o.A)({},e),{},{due_date:r})))}}catch(r){console.error("Fehler beim Laden der Daten:",r);const e=r;var t,s;"ERR_NETWORK"===e.code?C("Verbindung zum Server konnte nicht hergestellt werden. Bitte stellen Sie sicher, dass der Server l\xe4uft."):C("Fehler beim Laden der Daten: ".concat((null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||e.message))}}catch(r){console.error("Unerwarteter Fehler:",r),C("Ein unerwarteter Fehler ist aufgetreten")}})()}),[t]),(0,r.useEffect)((()=>{const e=()=>{T(window.innerWidth<640),w(window.innerWidth>1070)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,r.useEffect)((()=>(t?u():v(),()=>{v()})),[t,u,v]);const P=e=>{var t,s;const r=null===(t=e.firstName)||void 0===t?void 0:t.split(" ")[0],a=null===(s=e.username)||void 0===s?void 0:s.split(" ")[0];return r?"".concat(r," (").concat(a,")"):a||i("createRequest.errors.unknownUser")},I=async e=>{const t=e.clipboardData.items;for(let s=0;s<t.length;s++){const r=t[s];if(0===r.type.indexOf("image")){e.preventDefault();const t=r.getAsFile();return void(t&&await H(t))}}},W=async e=>{if(e.preventDefault(),e.stopPropagation(),e.dataTransfer.files&&e.dataTransfer.files.length>0){const t=e.dataTransfer.files[0];await H(t)}},U=e=>{e.preventDefault(),e.stopPropagation()},H=async e=>{F(!0),C(null);try{const t={fileName:e.name,fileType:e.type,fileSize:e.size,file:e};z((e=>[...e,t]));let s="";if(s=e.type.startsWith("image/")?"\n![".concat(e.name,"](").concat(i("createRequest.form.uploadAfterCreate"),")\n"):"\n[".concat(e.name,"](").concat(i("createRequest.form.uploadAfterCreate"),")\n"),O.current){const e=O.current.selectionStart,t=A.description.substring(0,e),r=A.description.substring(e);S((0,o.A)((0,o.A)({},A),{},{description:t+s+r})),setTimeout((()=>{if(O.current){const t=e+s.length;O.current.selectionStart=t,O.current.selectionEnd=t,O.current.focus()}}),0)}else S((0,o.A)((0,o.A)({},A),{},{description:A.description+s}))}catch(r){var t,s;console.error("Fehler beim Verarbeiten der Datei:",r);const e=r;C((null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||e.message||i("createRequest.errors.unknownError"))}finally{F(!1)}},K=async e=>{const t=e.target.files;if(!t||0===t.length)return;const s=t[0];await H(s),M.current&&(M.current.value="")},Q=async e=>{e.preventDefault(),C(null),_(!0);try{if(!localStorage.getItem("token"))throw new Error(i("createRequest.errors.notAuthenticated"));if(null===c||void 0===c||!c.id)throw new Error(i("createRequest.errors.unknownUser"));const e=parseInt(A.responsible_id),t=parseInt(A.branch_id);if(isNaN(e)||isNaN(t))throw new Error(i("createRequest.errors.invalidIds"));const r=await l.A.post(m.Sn.REQUESTS.BASE,{title:A.title,description:A.description||"",responsible_id:e,branch_id:t,requested_by_id:c.id,type:A.type,is_private:A.is_private,due_date:A.due_date||null,create_todo:A.create_todo,status:"approval"});if(201!==r.status)throw new Error(i("createRequest.errors.createError"));await(async e=>{if(0!==B.length)try{_(!0);for(const t of B){if(!t.file)continue;const s=new FormData;s.append("file",t.file),await l.A.post(m.Sn.REQUESTS.ATTACHMENTS(e),s,{headers:{"Content-Type":"multipart/form-data"}})}console.log(i("createRequest.messages.attachmentsUploaded",{count:B.length}))}catch(t){console.error("Fehler beim Hochladen der Anh\xe4nge:",t)}finally{_(!1)}})(r.data.id),n(r.data),s(),S({title:"",description:"",responsible_id:"",branch_id:"",type:"other",is_private:!1,due_date:"",create_todo:!1}),z([])}catch(a){var t,r;console.error("Create Request Error:",a);const e=a;C((null===(t=e.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||e.message||i("createRequest.errors.createError"))}finally{_(!1)}},$=()=>0===B.length?null:(0,y.jsx)("div",{className:"mt-2",children:(0,y.jsx)("ul",{className:"flex flex-wrap gap-2",children:B.map(((e,t)=>(0,y.jsxs)("li",{className:"inline-flex items-center bg-gray-100 rounded-md px-2 py-1 relative group",children:[(0,y.jsx)("span",{className:"text-sm font-medium text-gray-800",children:e.fileName}),(0,y.jsx)("div",{className:"flex ml-2",children:(0,y.jsxs)("div",{className:"relative group ml-1",children:[(0,y.jsx)("button",{type:"button",onClick:()=>(e=>{const t=B[e];if(t&&(z((t=>t.filter(((t,s)=>s!==e)))),t.fileName)){const e=i("createRequest.form.uploadAfterCreate"),s=new RegExp("!\\[".concat(t.fileName,"\\]\\(").concat(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"\\)"),"g"),r=new RegExp("\\[".concat(t.fileName,"\\]\\(").concat(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"\\)"),"g"),a=A.description.replace(s,"").replace(r,"").replace(/\n{3,}/g,"\n\n");S((0,o.A)((0,o.A)({},A),{},{description:a}))}})(t),className:"text-red-600 hover:text-red-900",children:(0,y.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("createRequest.form.remove")})]})}),e.fileType.startsWith("image/")&&e.file&&(0,y.jsx)("div",{className:"absolute z-10 bg-white p-2 rounded-md shadow-lg -top-32 left-0 border border-gray-200 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",children:(0,y.jsx)("img",{src:URL.createObjectURL(e.file),alt:e.fileName,className:"max-w-[200px] max-h-[150px] object-contain"})})]},t)))})});return t?E?(0,y.jsxs)(p.lG,{open:t,onClose:s,className:"relative z-50",children:[(0,y.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,y.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,y.jsxs)(p.lG.Panel,{className:"mx-auto max-w-xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[(0,y.jsx)(p.lG.Title,{className:"text-lg font-semibold dark:text-white",children:i("createRequest.title")}),(0,y.jsx)("button",{onClick:s,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,y.jsx)(x.A,{className:"h-6 w-6"})})]}),(0,y.jsxs)("div",{className:"p-4",children:[R&&(0,y.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:R}),(0,y.jsxs)("form",{onSubmit:Q,className:"space-y-4",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("createRequest.form.title")}),(0,y.jsx)("input",{type:"text",required:!0,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",value:A.title,onChange:e=>S((0,o.A)((0,o.A)({},A),{},{title:e.target.value}))})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{htmlFor:"description_request_create",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("createRequest.form.description")}),(0,y.jsxs)("div",{className:"relative",children:[(0,y.jsx)("textarea",{ref:O,id:"description_request_create",rows:6,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",value:A.description,onChange:e=>S((0,o.A)((0,o.A)({},A),{},{description:e.target.value})),onPaste:I,onDrop:W,onDragOver:U,placeholder:i("createRequest.form.descriptionPlaceholder")}),(0,y.jsxs)("div",{className:"relative group absolute bottom-2 left-2",children:[(0,y.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=M.current)||void 0===e?void 0:e.click()},className:"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-400 focus:outline-none",children:(0,y.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("createRequest.form.addFile")})]}),(0,y.jsx)("input",{ref:M,type:"file",onChange:K,className:"hidden"}),L&&(0,y.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-800 bg-opacity-70 dark:bg-opacity-70",children:(0,y.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:i("createRequest.form.uploading")})})]}),$()]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("createRequest.form.responsible")}),(0,y.jsxs)("select",{required:!0,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm",value:A.responsible_id,onChange:e=>S((0,o.A)((0,o.A)({},A),{},{responsible_id:e.target.value})),children:[(0,y.jsx)("option",{value:"",children:i("createRequest.form.select")}),Array.isArray(k)&&k.map((e=>(0,y.jsx)("option",{value:e.id,children:P(e)},e.id)))]})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("createRequest.form.branch")}),(0,y.jsxs)("select",{required:!0,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm",value:A.branch_id,onChange:e=>S((0,o.A)((0,o.A)({},A),{},{branch_id:e.target.value})),children:[(0,y.jsx)("option",{value:"",children:i("createRequest.form.select")}),Array.isArray(N)&&N.map((e=>(0,y.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("createRequest.form.type")}),(0,y.jsxs)("select",{required:!0,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm",value:A.type,onChange:e=>S((0,o.A)((0,o.A)({},A),{},{type:e.target.value})),children:[(0,y.jsx)("option",{value:"vacation",children:i("requests.types.vacation")}),(0,y.jsx)("option",{value:"improvement_suggestion",children:i("requests.types.improvement_suggestion")}),(0,y.jsx)("option",{value:"sick_leave",children:i("requests.types.sick_leave")}),(0,y.jsx)("option",{value:"employment_certificate",children:i("requests.types.employment_certificate")}),(0,y.jsx)("option",{value:"other",children:i("requests.types.other")})]})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("createRequest.form.dueDate")}),(0,y.jsx)("input",{type:"date",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm",value:A.due_date,onChange:e=>S((0,o.A)((0,o.A)({},A),{},{due_date:e.target.value}))})]}),(0,y.jsxs)("div",{className:"flex items-center",children:[(0,y.jsx)("input",{type:"checkbox",id:"is_private",className:"rounded border-gray-300 text-blue-600 dark:bg-gray-700 dark:text-gray-300",checked:A.is_private,onChange:e=>S((0,o.A)((0,o.A)({},A),{},{is_private:e.target.checked}))}),(0,y.jsx)("label",{htmlFor:"is_private",className:"ml-2 block text-sm text-gray-700 dark:text-gray-300",children:i("createRequest.form.isPrivate")})]}),(0,y.jsxs)("div",{className:"flex items-center",children:[(0,y.jsx)("input",{type:"checkbox",id:"create_todo",className:"rounded border-gray-300 text-blue-600 dark:bg-gray-700 dark:text-gray-300",checked:A.create_todo,onChange:e=>S((0,o.A)((0,o.A)({},A),{},{create_todo:e.target.checked}))}),(0,y.jsx)("label",{htmlFor:"create_todo",className:"ml-2 block text-sm text-gray-700 dark:text-gray-300",children:i("createRequest.form.createTodo")})]}),(0,y.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{type:"button",onClick:s,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",children:(0,y.jsx)(x.A,{className:"h-5 w-5"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("createRequest.form.cancel")})]}),(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",disabled:D,children:D?(0,y.jsx)(h.A,{className:"h-5 w-5 animate-spin"}):(0,y.jsx)(g.A,{className:"h-5 w-5"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i(D?"createRequest.form.creating":"createRequest.form.create")})]})]})]})]})]})})]}):(0,y.jsxs)(y.Fragment,{children:[t&&!f&&(0,y.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,y.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,y.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,y.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:i("createRequest.title")}),(0,y.jsx)("button",{onClick:s,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,y.jsx)(x.A,{className:"h-6 w-6"})})]}),(0,y.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[R&&(0,y.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:R}),(0,y.jsxs)("form",{onSubmit:Q,className:"space-y-4","data-onboarding":"request-form",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("createRequest.form.title")}),(0,y.jsx)("input",{type:"text",required:!0,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",value:A.title,onChange:e=>S((0,o.A)((0,o.A)({},A),{},{title:e.target.value}))})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{htmlFor:"description_request_create",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("createRequest.form.description")}),(0,y.jsxs)("div",{className:"relative",children:[(0,y.jsx)("textarea",{ref:O,id:"description_request_create",rows:6,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",value:A.description,onChange:e=>S((0,o.A)((0,o.A)({},A),{},{description:e.target.value})),onPaste:I,onDrop:W,onDragOver:U,placeholder:i("createRequest.form.descriptionPlaceholder")}),(0,y.jsxs)("div",{className:"relative group absolute bottom-2 left-2",children:[(0,y.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=M.current)||void 0===e?void 0:e.click()},className:"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-400 focus:outline-none",children:(0,y.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("createRequest.form.addFile")})]}),(0,y.jsx)("input",{ref:M,type:"file",onChange:K,className:"hidden"}),L&&(0,y.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-800 bg-opacity-70 dark:bg-opacity-70",children:(0,y.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:i("createRequest.form.uploading")})})]}),$()]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("createRequest.form.responsible")}),(0,y.jsxs)("select",{required:!0,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm",value:A.responsible_id,onChange:e=>S((0,o.A)((0,o.A)({},A),{},{responsible_id:e.target.value})),children:[(0,y.jsx)("option",{value:"",children:i("createRequest.form.select")}),Array.isArray(k)&&k.map((e=>(0,y.jsx)("option",{value:e.id,children:P(e)},e.id)))]})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("createRequest.form.branch")}),(0,y.jsxs)("select",{required:!0,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm",value:A.branch_id,onChange:e=>S((0,o.A)((0,o.A)({},A),{},{branch_id:e.target.value})),children:[(0,y.jsx)("option",{value:"",children:i("createRequest.form.select")}),Array.isArray(N)&&N.map((e=>(0,y.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("createRequest.form.type")}),(0,y.jsxs)("select",{required:!0,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm",value:A.type,onChange:e=>S((0,o.A)((0,o.A)({},A),{},{type:e.target.value})),children:[(0,y.jsx)("option",{value:"vacation",children:i("requests.types.vacation")}),(0,y.jsx)("option",{value:"improvement_suggestion",children:i("requests.types.improvement_suggestion")}),(0,y.jsx)("option",{value:"sick_leave",children:i("requests.types.sick_leave")}),(0,y.jsx)("option",{value:"employment_certificate",children:i("requests.types.employment_certificate")}),(0,y.jsx)("option",{value:"other",children:i("requests.types.other")})]})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("createRequest.form.dueDate")}),(0,y.jsx)("input",{type:"date",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm",value:A.due_date,onChange:e=>S((0,o.A)((0,o.A)({},A),{},{due_date:e.target.value}))})]}),(0,y.jsxs)("div",{className:"flex items-center",children:[(0,y.jsx)("input",{type:"checkbox",id:"is_private_sidepane",className:"rounded border-gray-300 text-blue-600 dark:bg-gray-700 dark:text-gray-300",checked:A.is_private,onChange:e=>S((0,o.A)((0,o.A)({},A),{},{is_private:e.target.checked}))}),(0,y.jsx)("label",{htmlFor:"is_private_sidepane",className:"ml-2 block text-sm text-gray-700 dark:text-gray-300",children:i("createRequest.form.isPrivate")})]}),(0,y.jsxs)("div",{className:"flex items-center",children:[(0,y.jsx)("input",{type:"checkbox",id:"create_todo_sidepane",className:"rounded border-gray-300 text-blue-600 dark:bg-gray-700 dark:text-gray-300",checked:A.create_todo,onChange:e=>S((0,o.A)((0,o.A)({},A),{},{create_todo:e.target.checked}))}),(0,y.jsx)("label",{htmlFor:"create_todo_sidepane",className:"ml-2 block text-sm text-gray-700 dark:text-gray-300",children:i("createRequest.form.createTodo")})]}),(0,y.jsxs)("div",{className:"flex justify-end pt-4 gap-2",children:[(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{type:"button",onClick:s,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md",children:(0,y.jsx)(x.A,{className:"h-5 w-5"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("createRequest.form.cancel")})]}),(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed",disabled:D,children:D?(0,y.jsx)(h.A,{className:"h-5 w-5 animate-spin"}):(0,y.jsx)(g.A,{className:"h-5 w-5"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i(D?"createRequest.form.creating":"createRequest.form.create")})]})]})]})]})]})]}):null};var f=s(9248);const w=e=>{let{isOpen:t,onClose:s,onRequestUpdated:n,request:o}=e;const{t:i,i18n:u}=(0,a.Bd)(),{user:v}=(0,d.As)(),w=e=>e?e.replace(/!\[([^\]]*)\]\([^)]+\)/g,"").trim():"";(0,r.useEffect)((()=>{0}),[u.language,i]);const{openSidepane:k,closeSidepane:j}=(0,b.N)(),[N,q]=(0,r.useState)(window.innerWidth>1070),[A,S]=(0,r.useState)(o.title),[R,C]=(0,r.useState)(w(o.description||"")),[D,_]=(0,r.useState)(o.responsible.id),[E,T]=(0,r.useState)(o.branch.id),[B,z]=(0,r.useState)(o.type||"other"),[L,F]=(0,r.useState)(o.isPrivate||!1),[M,O]=(0,r.useState)(o.dueDate?o.dueDate.split("T")[0]:""),[P,I]=(0,r.useState)(o.createTodo),[W,U]=(0,r.useState)([]),[H,K]=(0,r.useState)([]),[Q,$]=(0,r.useState)(null),[V,Y]=(0,r.useState)(!1),[G,Z]=(0,r.useState)(!1),[J,X]=(0,r.useState)(window.innerWidth<640),[ee,te]=(0,r.useState)(o.attachments||[]),[se,re]=(0,r.useState)(!1),[ae,ne]=(0,r.useState)([]),[oe,ie]=(0,r.useState)([]),le=(0,r.useRef)(null),de=(0,r.useRef)(null),{hasPermission:ce}=(0,c.S)(),ue=ce("requests","both","table");(0,r.useEffect)((()=>{if(!t&&oe.length>0){(async()=>{for(const t of oe)try{await l.A.delete(m.Sn.REQUESTS.ATTACHMENT(o.id,t)),console.log("Attachment ".concat(t," gel\xf6scht (Modal ohne Speichern geschlossen)"))}catch(e){console.error("Fehler beim L\xf6schen von Attachment ".concat(t,":"),e)}ie([])})()}}),[t,oe,o.id]),(0,r.useEffect)((()=>{const e=()=>{X(window.innerWidth<640),q(window.innerWidth>1070)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),(0,r.useEffect)((()=>(t?k():j(),()=>{j()})),[t,k,j]),(0,r.useEffect)((()=>{t&&(me(),pe(),S(o.title),C(w(o.description||"")),_(o.responsible.id),T(o.branch.id),z(o.type||"other"),F(o.isPrivate||!1),O(o.dueDate?o.dueDate.split("T")[0]:""),I(o.createTodo))}),[t,o]);const me=async()=>{try{$(null);if(!localStorage.getItem("token"))return void $(i("createRequest.editRequest.errors.notAuthenticated"));const[e,t]=await Promise.all([l.A.get(m.Sn.USERS.DROPDOWN),l.A.get(m.Sn.BRANCHES.BASE)]);U(e.data||[]),K(t.data||[])}catch(s){console.error("Unerwarteter Fehler:",s);const r=s;var e,t;if("ERR_NETWORK"===r.code)$(i("createRequest.editRequest.errors.connectionError"));else $("".concat(i("createRequest.editRequest.errors.loadError"),": ").concat((null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||r.message))}},pe=async()=>{try{$(null);const e=await l.A.get(m.Sn.REQUESTS.ATTACHMENTS(o.id));te(e.data||[])}catch(s){var e,t;console.error("Fehler beim Laden der Anh\xe4nge:",s),te([]);const r=s,a=(null===(e=r.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||r.message;console.warn("Anh\xe4nge konnten nicht geladen werden: ".concat(a))}},xe=async e=>{const t=e.clipboardData.items;for(let s=0;s<t.length;s++){const r=t[s];if(0===r.type.indexOf("image")){e.preventDefault();const t=r.getAsFile();return void(t&&await be(t))}}},he=async e=>{if(e.preventDefault(),e.stopPropagation(),e.dataTransfer.files&&e.dataTransfer.files.length>0){const t=e.dataTransfer.files[0];await be(t)}},ge=e=>{e.preventDefault(),e.stopPropagation()},be=async e=>{re(!0),$(null);try{const t=new FormData;t.append("file",e);const s=(await l.A.post(m.Sn.REQUESTS.ATTACHMENTS(o.id),t,{headers:{"Content-Type":"multipart/form-data"}})).data;if(te([...ee,s]),ie((e=>[...e,s.id])),!s.fileType.startsWith("image/")){const e="\n[".concat(s.fileName,"](").concat((0,m.S1)(o.id,s.id),")\n");if(le.current){const t=le.current.selectionStart,s=R.substring(0,t),r=R.substring(t);C(s+e+r),setTimeout((()=>{if(le.current){const s=t+e.length;le.current.selectionStart=s,le.current.selectionEnd=s,le.current.focus()}}),0)}else C(R+e)}const r=document.createElement("img");r.src=(0,m.S1)(o.id,s.id),r.alt=s.fileName,r.classList.add("hidden"),document.body.appendChild(r),r.onload=()=>{document.body.removeChild(r)}}catch(r){var t,s;console.error("Fehler beim Hochladen der Datei:",r);const e=r;$((null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||e.message||i("createRequest.editRequest.errors.unknownError"))}finally{re(!1)}},ye=async e=>{const t=e.target.files;if(!t||0===t.length)return;const s=t[0];await be(s),de.current&&(de.current.value="")},ve=async e=>{e.preventDefault(),$(null),Z(!0);try{if(!localStorage.getItem("token"))throw new Error(i("createRequest.editRequest.errors.notAuthenticated"));const e=o.description||"";let t=R||"";const r=ee.filter((e=>{var t;return(null===(t=e.fileType)||void 0===t?void 0:t.startsWith("image/"))&&e.id})),a=/!\[([^\]]*)\]\([^)]+\)/g,d=[];let c;if(e)for(;null!==(c=a.exec(e));)d.push(c[0]);for(const s of r){const e=(0,m.S1)(o.id,s.id),r="![".concat(s.fileName,"](").concat(e,")"),a=s.fileName.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");new RegExp("!\\[".concat(a,"\\]\\([^)]+\\)"),"g").test(t)||(t=t?"".concat(t,"\n").concat(r):r)}for(const s of d)t.includes(s)||(t=t?"".concat(t,"\n").concat(s):s);await l.A.put(m.Sn.REQUESTS.BY_ID(o.id),{title:A,description:t,responsible_id:D,branch_id:E,type:B,is_private:L,due_date:M||null,create_todo:P});const u=await l.A.get(m.Sn.REQUESTS.BY_ID(o.id));u.data.attachments?u.data.attachments=u.data.attachments.map((e=>({id:e.id,fileName:e.fileName,fileType:e.fileType,fileSize:e.fileSize,filePath:e.filePath,uploadedAt:e.uploadedAt,url:(0,m.S1)(o.id,e.id)}))):u.data.attachments=[],ie([]),s(),n&&n(u.data)}catch(a){var t,r;console.error("Fehler beim Aktualisieren des Requests:",a);const e=a;$((null===(t=e.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||e.message||i("createRequest.editRequest.errors.unknownError"))}finally{Z(!1)}},fe=async()=>{if(V)try{Z(!0),await l.A.delete(m.Sn.REQUESTS.BY_ID(o.id)),s()}catch(r){var e,t;console.error("Delete Error:",r);const s=r;$((null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||s.message||i("createRequest.editRequest.errors.unknownError"))}finally{Z(!1)}else Y(!0)},we=()=>0===ee.length?null:(0,y.jsx)("div",{className:"mt-2",children:(0,y.jsx)("ul",{className:"flex flex-wrap gap-2",children:ee.map((e=>(0,y.jsxs)("li",{className:"inline-flex items-center bg-gray-100 rounded-md px-2 py-1 relative group",children:[(0,y.jsx)("span",{className:"text-sm font-medium text-gray-800",children:e.fileName}),(0,y.jsxs)("div",{className:"flex ml-2",children:[(0,y.jsxs)("div",{className:"relative group mr-1",children:[(0,y.jsx)("button",{type:"button",onClick:()=>(async e=>{try{if(void 0===e.id)throw new Error("Anhang-ID fehlt");const t=await l.A.get(m.Sn.REQUESTS.ATTACHMENT(o.id,e.id),{responseType:"blob"}),s=window.URL.createObjectURL(new Blob([t.data])),r=document.createElement("a");r.href=s,r.setAttribute("download",e.fileName),document.body.appendChild(r),r.click(),r.remove()}catch(r){var t,s;console.error("Fehler beim Herunterladen des Anhangs:",r);const e=r;$((null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||e.message||i("createRequest.editRequest.errors.unknownError"))}})(e),className:"text-blue-600 hover:text-blue-900",children:(0,y.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("createRequest.editRequest.form.download")})]}),(0,y.jsxs)("div",{className:"relative group ml-1",children:[(0,y.jsx)("button",{type:"button",onClick:()=>void 0!==e.id&&(async e=>{try{$(null);const t=ee.find((t=>t.id===e));if(t&&(await l.A.delete(m.Sn.REQUESTS.ATTACHMENT(o.id,e)),te(ee.filter((t=>t.id!==e))),t.fileName)){const e=t.fileName.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),s=new RegExp("!\\[(.*?)\\]\\(".concat(e,"\\)"),"g"),r=new RegExp("\\[(.*?)\\]\\(".concat(e,"\\)"),"g"),a=R.replace(s,"").replace(r,"").replace(/\n{3,}/g,"\n\n");C(a)}}catch(r){var t,s;console.error("Fehler beim L\xf6schen des Anhangs:",r);const e=r;$((null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||e.message||i("createRequest.editRequest.errors.unknownError"))}})(e.id),className:"text-red-600 hover:text-red-900",disabled:void 0===e.id,children:(0,y.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("createRequest.editRequest.form.remove")})]})]}),e.fileType.startsWith("image/")&&e.id&&(0,y.jsx)("div",{className:"absolute z-10 bg-white p-2 rounded-md shadow-lg -top-32 left-0 border border-gray-200 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",children:(0,y.jsx)("img",{src:(0,m.S1)(o.id,e.id),alt:e.fileName,className:"max-w-[200px] max-h-[150px] object-contain"})})]},e.id||"temp-".concat(e.fileName))))})}),ke=()=>0===ae.length?null:(0,y.jsx)("div",{className:"mt-2",children:(0,y.jsx)("ul",{className:"flex flex-wrap gap-2",children:ae.map(((e,t)=>(0,y.jsxs)("li",{className:"inline-flex items-center bg-gray-100 rounded-md px-2 py-1 relative group",children:[(0,y.jsx)("span",{className:"text-sm font-medium text-gray-800",children:e.fileName}),(0,y.jsx)("div",{className:"flex ml-2",children:(0,y.jsxs)("div",{className:"relative group ml-1",children:[(0,y.jsx)("button",{type:"button",onClick:()=>(e=>{const t=ae[e];if(t&&(ne(ae.filter(((t,s)=>s!==e))),t.fileName)){const e=t.fileName.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),s=i("createRequest.editRequest.form.uploadAfterCreate"),r=new RegExp("!\\[".concat(e,"\\]\\(").concat(s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"\\)"),"g"),a=new RegExp("\\[".concat(e,"\\]\\(").concat(s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"\\)"),"g"),n=R.replace(r,"").replace(a,"").replace(/\n{3,}/g,"\n\n");C(n)}})(t),className:"text-red-600 hover:text-red-900",children:(0,y.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("createRequest.editRequest.form.remove")})]})}),e.fileType.startsWith("image/")&&e.file&&(0,y.jsx)("div",{className:"absolute z-10 bg-white p-2 rounded-md shadow-lg -top-32 left-0 border border-gray-200 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",children:(0,y.jsx)("img",{src:URL.createObjectURL(e.file),alt:e.fileName,className:"max-w-[200px] max-h-[150px] object-contain"})})]},"temp-".concat(t))))})});if(!t)return null;const je=()=>(0,y.jsxs)("form",{onSubmit:ve,className:"space-y-4",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("createRequest.editRequest.form.title")}),(0,y.jsx)("input",{type:"text",required:!0,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",value:A,onChange:e=>S(e.target.value)})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{htmlFor:"description_request_edit",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("createRequest.editRequest.form.description")}),(0,y.jsxs)("div",{className:"relative",children:[(0,y.jsx)("textarea",{ref:le,rows:J?5:10,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",value:R,onChange:e=>C(e.target.value),onPaste:xe,onDrop:he,onDragOver:ge}),(0,y.jsxs)("div",{className:"relative group absolute bottom-2 left-2",children:[(0,y.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=de.current)||void 0===e?void 0:e.click()},className:"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-400 focus:outline-none",children:(0,y.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,y.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("createRequest.editRequest.form.fileUpload")})]}),(0,y.jsx)("input",{ref:de,type:"file",onChange:ye,className:"hidden"}),se&&(0,y.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-800 bg-opacity-70 dark:bg-opacity-70",children:(0,y.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:i("createRequest.editRequest.form.uploading")})})]}),we(),ke()]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("createRequest.editRequest.form.responsible")}),(0,y.jsx)("select",{className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",value:D,onChange:e=>_(Number(e.target.value)),children:W.map((e=>(0,y.jsxs)("option",{value:e.id,children:[e.firstName," (",e.username,")"]},e.id)))})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("createRequest.editRequest.form.branch")}),(0,y.jsx)("select",{className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",value:E,onChange:e=>T(Number(e.target.value)),children:H.map((e=>(0,y.jsx)("option",{value:e.id,children:e.name},e.id)))})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("createRequest.editRequest.form.type")}),(0,y.jsxs)("select",{className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",value:B,onChange:e=>z(e.target.value),children:[(0,y.jsx)("option",{value:"vacation",children:i("requests.types.vacation")}),(0,y.jsx)("option",{value:"improvement_suggestion",children:i("requests.types.improvement_suggestion")}),(0,y.jsx)("option",{value:"sick_leave",children:i("requests.types.sick_leave")}),(0,y.jsx)("option",{value:"employment_certificate",children:i("requests.types.employment_certificate")}),(0,y.jsx)("option",{value:"other",children:i("requests.types.other")})]})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:i("createRequest.editRequest.form.dueDate")}),(0,y.jsx)("input",{type:"date",className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white",value:M,onChange:e=>O(e.target.value)})]}),(0,y.jsxs)("div",{className:"flex items-center",children:[(0,y.jsx)("input",{type:"checkbox",id:"is_private_edit",className:"rounded border-gray-300 text-blue-600 dark:bg-gray-700 dark:border-gray-600",checked:L,onChange:e=>F(e.target.checked)}),(0,y.jsx)("label",{htmlFor:"is_private_edit",className:"ml-2 block text-sm text-gray-700 dark:text-gray-300",children:i("createRequest.editRequest.form.isPrivate")})]}),(0,y.jsxs)("div",{className:"flex items-center",children:[(0,y.jsx)("input",{type:"checkbox",id:"create_todo_edit",className:"rounded border-gray-300 text-blue-600 dark:bg-gray-700 dark:border-gray-600",checked:P,onChange:e=>I(e.target.checked)}),(0,y.jsx)("label",{htmlFor:"create_todo_edit",className:"ml-2 block text-sm text-gray-700 dark:text-gray-300",children:i("createRequest.editRequest.form.createTodo")})]}),(0,y.jsxs)("div",{className:"flex justify-between pt-4",children:[ue&&(0,y.jsx)("button",{type:"button",onClick:fe,className:"p-2 rounded-md ".concat(V?"bg-red-600 text-white dark:bg-red-700 dark:text-white hover:bg-red-700 dark:hover:bg-red-600":"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"),title:i(V?"createRequest.editRequest.form.confirmDelete":"createRequest.editRequest.form.delete"),children:V?(0,y.jsx)(g.A,{className:"h-5 w-5"}):(0,y.jsx)(f.A,{className:"h-5 w-5"})}),(0,y.jsxs)("div",{className:"flex gap-2",children:[(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{type:"button",onClick:s,className:"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:(0,y.jsx)(x.A,{className:"h-5 w-5"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i("createRequest.editRequest.form.cancel")})]}),(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{type:"submit",className:"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",disabled:G,children:G?(0,y.jsx)(h.A,{className:"h-5 w-5 animate-spin"}):(0,y.jsx)(g.A,{className:"h-5 w-5"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:i(G?"createRequest.editRequest.form.saving":"createRequest.editRequest.form.save")})]})]})]})]});return J?(0,y.jsxs)(p.lG,{open:t,onClose:s,className:"relative z-50",children:[(0,y.jsx)("div",{className:"fixed inset-0 bg-black/30","aria-hidden":"true"}),(0,y.jsx)("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:(0,y.jsxs)(p.lG.Panel,{className:"mx-auto max-w-xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[(0,y.jsx)(p.lG.Title,{className:"text-lg font-semibold dark:text-white",children:i("createRequest.editRequest.title")}),(0,y.jsx)("button",{onClick:s,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,y.jsx)(x.A,{className:"h-6 w-6"})})]}),(0,y.jsxs)("div",{className:"p-4",children:[Q&&(0,y.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:Q}),je()]})]})})]}):(0,y.jsxs)(y.Fragment,{children:[t&&!N&&(0,y.jsx)("div",{className:"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40","aria-hidden":"true",onClick:s,style:{opacity:t?1:0,transition:"opacity 300ms ease-out"}}),(0,y.jsxs)("div",{className:"fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ".concat(t?"translate-x-0":"translate-x-full"),style:{transition:"transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)",pointerEvents:t?"auto":"none"},"aria-hidden":!t,role:"dialog","aria-modal":t,children:[(0,y.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0",children:[(0,y.jsx)("h2",{className:"text-lg font-semibold dark:text-white",children:i("createRequest.editRequest.title")}),(0,y.jsx)("button",{onClick:s,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,y.jsx)(x.A,{className:"h-6 w-6"})})]}),(0,y.jsxs)("div",{className:"p-4 overflow-y-auto flex-1 min-h-0",children:[Q&&(0,y.jsx)("div",{className:"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded",children:Q}),je()]})]})]})};var k=s(8897),j=s(4426),N=s(7829),q=s(1853),A=s(8662),S=s(2704),R=s(4850),C=s(1663),D=s(8010),_=s(1909),E=s(1252),T=s(9399),B=s(2811),z=s(3744),L=s(6238),F=s(4129),M=s(7988),O=s(9837),P=s(887),I=s(6896),W=s(957),U=s(637),H=s(1052);const K=e=>{switch(e){case"vacation":return"\ud83c\udfd6\ufe0f";case"improvement_suggestion":return"\ud83d\udca1";case"sick_leave":return"\ud83e\udd12";case"employment_certificate":return"\ud83d\udcc4";default:return"\ud83d\udcdd"}},Q=["title","requestedByResponsible","status","type","dueDate","branch","actions"],$="requests-table",V={title:["title"],status:["status"],type:["type"],requestedByResponsible:["requestedBy","responsible"],branch:["branch"],dueDate:["dueDate"],actions:[],description:["description"]},Y={title:"title",status:"status",type:"type",requestedBy:"requestedByResponsible",responsible:"requestedByResponsible",branch:"branch",dueDate:"dueDate",description:"description"},G=()=>{const{t:e}=(0,a.Bd)(),[t,s]=(0,r.useState)([]),[n,p]=(0,r.useState)(0),[b,f]=(0,r.useState)(!0),[G,Z]=(0,r.useState)(!0),[J,X]=(0,r.useState)(!1),[ee,te]=(0,r.useState)(null),[se,re]=(0,r.useState)(""),[ae,ne]=(0,r.useState)([]),[oe,ie]=(0,r.useState)([]),[le,de]=(0,r.useState)([]),[ce,ue]=(0,r.useState)(""),[me,pe]=(0,r.useState)(null),[xe,he]=(0,r.useState)(!1),[ge,be]=(0,r.useState)({key:"dueDate",direction:"asc"}),[ye,ve]=(0,r.useState)(!1),[fe,we]=(0,r.useState)(!1),[ke,je]=(0,r.useState)(null),{user:Ne}=(0,d.As)(),{hasPermission:qe}=(0,c.S)(),Ae=(0,r.useMemo)((()=>[{id:"title",label:e("requests.columns.title"),shortLabel:e("requests.columns.title")},{id:"status",label:e("requests.columns.status"),shortLabel:e("requests.columns.status")},{id:"type",label:e("requests.columns.type"),shortLabel:e("requests.columns.type")},{id:"requestedByResponsible",label:e("requests.columns.requestedByResponsible"),shortLabel:e("requests.columns.requestedByResponsible").split("/")[0]},{id:"branch",label:e("requests.columns.branch"),shortLabel:e("requests.columns.branch").substring(0,5)},{id:"dueDate",label:e("requests.columns.dueDate"),shortLabel:e("requests.columns.dueDate").substring(0,5)},{id:"actions",label:e("requests.columns.actions"),shortLabel:e("common.actions").substring(0,3)}]),[e]),{settings:Se,isLoading:Re,updateColumnOrder:Ce,updateHiddenColumns:De,toggleColumnVisibility:_e,isColumnVisible:Ee,updateViewMode:Te}=(0,u.F)("dashboard_requests",{defaultColumnOrder:Q,defaultHiddenColumns:[],defaultViewMode:"cards"}),[Be,ze]=(0,r.useState)(null),[Le,Fe]=(0,r.useState)(null),Me=(0,r.useRef)(!1),Oe=Se.viewMode||"cards",[Pe,Ie]=(0,r.useState)((()=>({title:"asc",status:"asc",type:"asc",requestedBy:"asc",responsible:"asc",branch:"asc",dueDate:"asc",description:"asc"}))),We=(0,r.useMemo)((()=>(e=>{const t=[];return e.forEach((e=>{const s=V[e];s&&s.length>0&&t.push(...s)})),t.includes("type")||t.push("type"),e.includes("requestedByResponsible")&&(t.includes("requestedBy")||t.push("requestedBy"),t.includes("responsible")||t.push("responsible")),t.includes("description")||t.push("description"),t})(Se.columnOrder||Q)),[Se.columnOrder]),[Ue,He]=(0,r.useState)((()=>{const e=(Se.hiddenColumns||[]).includes("requestedByResponsible");return{requestedBy:!e,responsible:!e}}));(0,r.useEffect)((()=>{if(Me.current)return void(Me.current=!1);const e=(Se.hiddenColumns||[]).includes("requestedByResponsible");He((t=>{if(e){if(!0===t.requestedBy||!0===t.responsible)return{requestedBy:!1,responsible:!1}}else if(!1===t.requestedBy&&!1===t.responsible)return{requestedBy:!0,responsible:!0};return t}))}),[Se.hiddenColumns]);const Ke=(0,r.useMemo)((()=>{const e=(e=>{const t=new Set,s=e.includes("requestedByResponsible");return e.forEach((e=>{"type"!==e&&("requestedByResponsible"!==e?(V[e]||[]).forEach((e=>{"type"!==e&&t.add(e)})):s&&(t.add("requestedBy"),t.add("responsible")))})),t})(Se.hiddenColumns||[]);return Ue.requestedBy?e.delete("requestedBy"):e.add("requestedBy"),Ue.responsible?e.delete("responsible"):e.add("responsible"),e}),[Se.hiddenColumns,Ue]),Qe=(0,r.useMemo)((()=>new Set(We.filter((e=>!Ke.has(e))))),[We,Ke]);(0,r.useEffect)((()=>{const e=document.querySelector(".dashboard-requests-wrapper");e&&("cards"===Oe?e.classList.add("cards-mode"):e.classList.remove("cards-mode"))}),[Oe]);const $e=(0,r.useCallback)((async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:20,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;try{r?X(!0):Z(!0);const i={limit:a,offset:n,includeAttachments:"false"};e?i.filterId=e:t&&t.length>0&&(i.filterConditions=JSON.stringify({conditions:t,operators:oe}));const d=(await l.A.get("/requests",{params:i})).data;console.log("[Requests] Response-Struktur:",{isObject:"object"===typeof d,hasData:void 0!==(null===d||void 0===d?void 0:d.data),dataIsArray:Array.isArray(null===d||void 0===d?void 0:d.data),responseDataIsArray:Array.isArray(d),keys:d?Object.keys(d):[],dataType:null!==d&&void 0!==d&&d.data?typeof d.data:"undefined"});let c=[],u=0,x=!1;if(!d||"object"!==typeof d)throw console.error("[Requests] \u274c FEHLER: responseData ist kein Objekt!",{responseData:d,type:typeof d}),new Error("Ung\xfcltige Response-Struktur: responseData ist kein Objekt (Typ: ".concat(typeof d,")"));if(Array.isArray(d.data))c=d.data,u=d.totalCount||c.length,x=void 0!==d.hasMore?d.hasMore:n+c.length<u;else{if(!Array.isArray(d))throw console.error("[Requests] \u274c FEHLER: responseData.data ist kein Array!",{responseData:d,data:d.data,dataType:typeof d.data}),new Error("Ung\xfcltige Response-Struktur: responseData.data ist kein Array (Typ: ".concat(typeof d.data,")"));c=d,u=c.length,x=!1}if(!Array.isArray(c))throw console.error("[Requests] \u274c FEHLER: requestsData ist kein Array!",{requestsData:c,type:typeof c}),new Error("Ung\xfcltige Response-Struktur: requestsData ist kein Array (Typ: ".concat(typeof c,")"));const h=c.map((e=>{const t=(e.attachments||[]).map((t=>({id:t.id,fileName:t.fileName,fileType:t.fileType,fileSize:t.fileSize,filePath:t.filePath,uploadedAt:t.uploadedAt,url:(0,m.S1)(e.id,t.id)})));return(0,o.A)((0,o.A)({},e),{},{attachments:t})}));s(r?e=>[...e,...h]:h),p(u),f(x),te(null)}catch(g){console.error("Request Error:",g);const e=g;if(!r)if("ERR_NETWORK"===e.code)te("Verbindung zum Server konnte nicht hergestellt werden. Bitte stellen Sie sicher, dass der Server l\xe4uft.");else{var i,d,c,u,x,h;const t=(null===(i=e.response)||void 0===i||null===(d=i.data)||void 0===d?void 0:d.message)||(null===(c=e.response)||void 0===c||null===(u=c.data)||void 0===u?void 0:u.error)||e.message||"Unbekannter Fehler";console.error("Request Error Details:",{message:t,status:null===(x=e.response)||void 0===x?void 0:x.status,data:null===(h=e.response)||void 0===h?void 0:h.data}),te("Fehler beim Laden der Requests: ".concat(t))}}finally{r?X(!1):Z(!1)}}),[oe]),Ve=(0,r.useRef)(ae);(0,r.useEffect)((()=>{Ve.current=ae}),[ae]);const Ye=(0,r.useRef)(null);(0,r.useEffect)((()=>{$e(void 0,void 0,!1,20,0)}),[]),(0,r.useEffect)((()=>()=>{s([]),ne([])}),[]);const Ge=async(e,r)=>{try{const a=t.find((t=>t.id===e));if(!a)return void te("Request nicht gefunden");s((t=>t.map((t=>t.id===e?(0,o.A)((0,o.A)({},t),{},{status:r}):t)))),await l.A.put("/requests/".concat(e),{status:r,create_todo:a.createTodo})}catch(i){var a,n;console.error("Status Update Error:",i),$e();const e=i;te("Fehler beim Aktualisieren des Status: ".concat((null===(a=e.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||e.message||"Ein unerwarteter Fehler ist aufgetreten"))}},Ze=(0,r.useCallback)(((e,t)=>{const s=[...Se.columnOrder],r=s[e];s.splice(e,1),s.splice(t,0,r),Ce(s)}),[Se.columnOrder,Ce]),Je=e=>{ze(e)},Xe=(e,t)=>{e.preventDefault(),Be&&Be!==t&&Fe(t)},et=(e,t)=>{if(e.preventDefault(),Be&&Be!==t){const e=Se.columnOrder.indexOf(Be),s=Se.columnOrder.indexOf(t);e>-1&&s>-1&&Ze(e,s)}ze(null),Fe(null)},tt=()=>{ze(null),Fe(null)},st=async(e,t,s)=>{if(ne(e),ie(t),void 0!==s){const e=Array.isArray(s)?s:[];de(e)}pe(null),ue(""),be({key:"dueDate",direction:"asc"}),e.length>0?await $e(void 0,e,!1,20,0):await $e(void 0,void 0,!1,20,0)},rt=()=>{ne([]),ie([]),de([]),ue(""),pe(null)},at=()=>ae.length,nt=(0,r.useMemo)((()=>t.filter((e=>{if(se){const t=se.toLowerCase();if(!(e.title.toLowerCase().includes(t)||"".concat(e.requestedBy.firstName," ").concat(e.requestedBy.lastName).toLowerCase().includes(t)||"".concat(e.responsible.firstName," ").concat(e.responsible.lastName).toLowerCase().includes(t)||e.branch.name.toLowerCase().includes(t)))return!1}return!0})).sort(((e,t)=>{const s=(e,t)=>{var s,r;switch(t){case"title":return e.title.toLowerCase();case"status":return null!==(s={approval:0,to_improve:1,approved:2,denied:3}[e.status])&&void 0!==s?s:999;case"type":return null!==(r={vacation:0,improvement_suggestion:1,sick_leave:2,employment_certificate:3,other:4}[e.type||"other"])&&void 0!==r?r:999;case"requestedBy":case"requestedByResponsible":return"".concat(e.requestedBy.firstName," ").concat(e.requestedBy.lastName).toLowerCase();case"responsible":return"".concat(e.responsible.firstName," ").concat(e.responsible.lastName).toLowerCase();case"branch":return e.branch.name.toLowerCase();case"dueDate":return new Date(e.dueDate).getTime();case"description":return(e.description||"").toLowerCase();default:return""}};if("table"===Oe&&ge.key){const r=s(e,ge.key),a=s(t,ge.key);let n=0;if(n="number"===typeof r&&"number"===typeof a?r-a:String(r).localeCompare(String(a)),0!==n)return"asc"===ge.direction?n:-n}if(le.length>0&&(null!==me||ae.length>0)){const r=[...le].sort(((e,t)=>e.priority-t.priority));for(const a of r){const r=s(e,a.column),n=s(t,a.column);let o=0;if(o="number"===typeof r&&"number"===typeof n?r-n:String(r).localeCompare(String(n)),"desc"===a.direction&&(o=-o),0!==o)return o}return 0}if("cards"===Oe&&null===me&&0===ae.length){const r=We.filter((e=>Qe.has(e)));for(const a of r){const r=s(e,a),n=s(t,a),o=Pe[a]||"asc";let i=0;if(i="number"===typeof r&&"number"===typeof n?r-n:String(r).localeCompare(String(n)),"desc"===o&&(i=-i),0!==i)return i}return 0}if("table"===Oe&&null===me&&0===ae.length&&ge.key){let s=e[ge.key],n=t[ge.key];if("requestedBy.firstName"===ge.key)s=e.requestedBy.firstName,n=t.requestedBy.firstName;else if("responsible.firstName"===ge.key)s=e.responsible.firstName,n=t.responsible.firstName;else if("branch.name"===ge.key)s=e.branch.name,n=t.branch.name;else if("type"===ge.key){var r,a;const o={vacation:0,improvement_suggestion:1,sick_leave:2,employment_certificate:3,other:4};s=null!==(r=o[e.type||"other"])&&void 0!==r?r:999,n=null!==(a=o[t.type||"other"])&&void 0!==a?a:999}return s<n?"asc"===ge.direction?-1:1:s>n?"asc"===ge.direction?1:-1:0}return 0}))),[t,me,se,ge,le,Oe,We,Qe,Pe]);(0,r.useEffect)((()=>{const e=new IntersectionObserver((e=>{if(e[0].isIntersecting&&b&&!J&&!G){const e=t.length;$e(me||void 0,ae.length>0?ae:void 0,!0,20,e)}}),{threshold:.1});return Ye.current&&e.observe(Ye.current),()=>{Ye.current&&e.unobserve(Ye.current)}}),[b,J,G,t.length,me,ae,$e]);const ot=async e=>{try{if(!Ne)return void te("Benutzer nicht authentifiziert");const t={title:"".concat(e.title,"-Kopie"),responsible_id:e.responsible.id,branch_id:e.branch.id,type:e.type||"other",is_private:e.isPrivate||!1,due_date:e.dueDate?e.dueDate.split("T")[0]:"",create_todo:e.createTodo,requested_by_id:Ne.id},r=await l.A.post(m.Sn.REQUESTS.BASE,t);s((e=>[r.data,...e])),je(r.data),we(!0)}catch(a){var t,r;console.error("Fehler beim Kopieren des Requests:",a);const e=a;te((null===(t=e.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||e.message||"Ein unerwarteter Fehler ist aufgetreten")}};if(G&&0===t.length)return(0,y.jsx)("div",{className:"-mx-3 sm:-mx-4 md:-mx-6",children:(0,y.jsx)(U.A,{children:Array(3).fill(null).map(((e,t)=>(0,y.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-3 sm:p-4 md:p-5 lg:p-6 shadow-sm",children:(0,y.jsxs)("div",{className:"space-y-4",children:[(0,y.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,y.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-12"}),(0,y.jsx)("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded flex-1 min-w-0"})]}),(0,y.jsx)("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-24"}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4"}),(0,y.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2"}),(0,y.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-5/6"})]})]})},"skeleton-".concat(t))))})});if(ee)return(0,y.jsx)("div",{className:"p-4 text-red-600",children:ee});const it=Se.columnOrder.filter((e=>Ee(e)));return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(v,{isOpen:ye,onClose:()=>ve(!1),onRequestCreated:e=>{s((t=>[e,...t])),we(!0),je(e)}}),ke&&(0,y.jsx)(w,{isOpen:fe,onClose:()=>{we(!1),je(null)},onRequestUpdated:e=>{s((t=>t.map((t=>t.id===e.id?e:t)))),we(!1),je(null)},request:ke}),(0,y.jsxs)("div",{className:"flex items-center mb-4 justify-between px-3 sm:px-4 md:px-6",children:[(0,y.jsx)("div",{className:"flex items-center",children:qe("requests","write","table")&&(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{onClick:()=>ve(!0),className:"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center",style:{width:"30.19px",height:"30.19px"},"aria-label":e("requests.createRequest"),"data-onboarding":"create-request-button",children:(0,y.jsx)(A.A,{className:"h-4 w-4"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("requests.createRequest")})]})}),(0,y.jsxs)("div",{className:"flex items-center",children:[(0,y.jsx)(S.A,{className:"h-6 w-6 mr-2 dark:text-white"}),(0,y.jsx)("h2",{className:"text-xl font-semibold dark:text-white",children:e("requests.title")})]}),(0,y.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,y.jsx)("input",{type:"text",placeholder:e("common.search")+"...",className:"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white",value:se,onChange:e=>re(e.target.value)}),(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{className:"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ".concat("cards"===Oe?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":""),onClick:()=>Te("table"===Oe?"cards":"table"),children:"table"===Oe?(0,y.jsx)(R.A,{className:"h-5 w-5"}):(0,y.jsx)(C.A,{className:"h-5 w-5"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("table"===Oe?"common.viewAsCards":"common.viewAsTable")})]}),(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsxs)("button",{className:"p-2 rounded-md ".concat(at()>0?"bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":"hover:bg-gray-100 dark:hover:bg-gray-700"," ml-1"),onClick:()=>he(!xe),children:[(0,y.jsx)(D.A,{className:"h-5 w-5"}),at()>0&&(0,y.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center z-10",style:{position:"absolute",top:"-0.25rem",right:"-0.25rem"},children:at()})]}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("common.filter")})]}),(0,y.jsx)("div",{className:"ml-1",children:(0,y.jsx)(k.A,{columns:"cards"===Oe?[{id:"title",label:e("requests.columns.title")},{id:"status",label:e("requests.columns.status")},{id:"type",label:e("requests.columns.type")},{id:"requestedBy",label:e("requests.columns.requestedBy")},{id:"responsible",label:e("requests.columns.responsible")},{id:"branch",label:e("requests.columns.branch")},{id:"dueDate",label:e("requests.columns.dueDate")},{id:"description",label:e("common.description")}]:Ae,visibleColumns:"cards"===Oe?Array.from(Qe):it,columnOrder:"cards"===Oe?We:Se.columnOrder,onToggleColumnVisibility:e=>{if("cards"===Oe){const t=Y[e];if(t)if("requestedByResponsible"===t){const s=(0,o.A)({},Ue);"requestedBy"===e?s.requestedBy=!s.requestedBy:"responsible"===e&&(s.responsible=!s.responsible),He(s);const r=[...Se.hiddenColumns],a=r.indexOf(t);s.requestedBy||s.responsible?-1!==a&&(r.splice(a,1),Me.current=!0,De(r)):-1===a&&(r.push(t),Me.current=!0,De(r))}else _e(t)}else _e(e)},onMoveColumn:"cards"===Oe?(e,t)=>{const s=[...We],r=s[e];s.splice(e,1),s.splice(t,0,r);const a=[],n=new Set;s.forEach((e=>{const t=Y[e];t&&!n.has(t)&&(a.push(t),n.add(t))})),Se.columnOrder.forEach((e=>{a.includes(e)||a.push(e)})),Ce(a)}:Ze,onClose:()=>{},buttonTitle:e("cards"===Oe?"tableColumn.sortAndDisplay":"tableColumn.configure"),modalTitle:e("cards"===Oe?"tableColumn.sortAndDisplay":"tableColumn.configure"),sortDirections:void 0,onSortDirectionChange:void 0,showSortDirection:!1})})]})]}),xe&&(0,y.jsx)("div",{className:"cards"===Oe?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,y.jsx)(j.A,{columns:[{id:"title",label:e("requests.columns.title")},{id:"type",label:e("requests.columns.type")},{id:"requestedBy",label:e("requests.columns.requestedBy").replace(":","")},{id:"responsible",label:e("requests.columns.responsible").replace(":","")},{id:"dueDate",label:e("requests.columns.dueDate")},{id:"status",label:e("requests.columns.status")},{id:"branch",label:e("requests.columns.branch")}],onApply:st,onReset:rt,savedConditions:ae,savedOperators:oe,savedSortDirections:le,onSortDirectionsChange:de,tableId:$})}),(0,y.jsx)("div",{className:"cards"===Oe?"-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6":"px-3 sm:px-4 md:px-6",children:(0,y.jsx)(N.A,{tableId:$,onSelectFilter:(e,t,s)=>st(e,t,s),onReset:rt,activeFilterName:ce,selectedFilterId:me,onFilterChange:(e,t,s,r,a)=>(async(e,t,s,r,a)=>{ue(e),pe(t),st(s,r,a),be({key:"dueDate",direction:"asc"}),t?await $e(t,void 0,!1,20,0):s.length>0?await $e(void 0,s,!1,20,0):await $e(void 0,void 0,!1,20,0)})(e,t,s,r,a),defaultFilterName:"Aktuell"})}),"table"===Oe?(0,y.jsx)("div",{className:"overflow-x-auto",children:(0,y.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,y.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,y.jsx)("tr",{children:it.map((e=>{const t=Ae.find((t=>t.id===e));if(!t)return null;if("requestedByResponsible"===e)return(0,y.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider cursor-move relative",draggable:!0,onDragStart:()=>Je(e),onDragOver:t=>Xe(t,e),onDrop:t=>et(t,e),onDragEnd:tt,children:(0,y.jsxs)("div",{className:"flex items-center ".concat(Le===e?"border-l-2 pl-1 border-blue-500":""," ").concat(Be===e?"opacity-50":""),children:[(0,y.jsx)(_.A,{className:"h-3 w-3 mr-1 text-gray-400 dark:text-gray-500"}),(0,y.jsx)("span",{className:"hidden sm:inline",children:t.label}),(0,y.jsx)("span",{className:"inline sm:hidden",children:t.shortLabel})]})},e);let s;return"title"===e&&(s="title"),"status"===e&&(s="status"),"type"===e&&(s="type"),"branch"===e&&(s="branch.name"),"dueDate"===e&&(s="dueDate"),(0,y.jsx)("th",{className:"px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider relative ".concat(s?"cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700":""," ").concat("actions"!==e?"cursor-move":""),onClick:s?()=>{return e=s,void be((t=>({key:e,direction:t.key===e&&"asc"===t.direction?"desc":"asc"})));var e}:void 0,draggable:"actions"!==e,onDragStart:"actions"!==e?()=>Je(e):void 0,onDragOver:"actions"!==e?t=>Xe(t,e):void 0,onDrop:"actions"!==e?t=>et(t,e):void 0,onDragEnd:"actions"!==e?tt:void 0,children:(0,y.jsxs)("div",{className:"flex items-center ".concat(Le===e?"border-l-2 pl-1 border-blue-500":""," ").concat(Be===e?"opacity-50":""),children:["actions"!==e&&(0,y.jsx)(_.A,{className:"h-3 w-3 mr-1 text-gray-400 dark:text-gray-500"}),(0,y.jsx)("span",{className:"hidden sm:inline",children:t.label}),(0,y.jsx)("span",{className:"inline sm:hidden",children:t.shortLabel}),s&&ge.key===s&&("asc"===ge.direction?"\u2191":"\u2193")]})},e)}))})}),(0,y.jsx)("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:0===nt.length?(0,y.jsx)("tr",{children:(0,y.jsx)("td",{colSpan:it.length,className:"px-3 py-4 text-center text-gray-500 dark:text-gray-400",children:(0,y.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4",children:[(0,y.jsx)(S.A,{className:"h-10 w-10 text-gray-400 dark:text-gray-500"}),(0,y.jsx)("div",{className:"text-sm",children:"Keine Requests gefunden"})]})})}):(0,y.jsx)(y.Fragment,{children:nt.map((t=>{const s=(0,H.go)(t.dueDate,"request"),r=(0,H.F2)(s);return(0,y.jsx)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 ".concat("none"!==s?"".concat(r.bgClass," ").concat(r.borderClass," border-l-4"):""),children:it.map((s=>{switch(s){case"title":return(0,y.jsx)("td",{className:"px-3 sm:px-4 md:px-6 py-4",children:(0,y.jsxs)("div",{className:"text-sm text-gray-900 dark:text-gray-200 break-words flex items-center",children:[t.title,t.description&&(0,y.jsxs)("div",{className:"ml-2 relative group",children:[(0,y.jsx)("button",{className:"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",children:(0,y.jsx)(E.A,{className:"h-5 w-5"})}),(0,y.jsx)("div",{className:"absolute left-0 mt-2 p-2 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 shadow-lg rounded-md border border-gray-200 dark:border-gray-700 w-144 max-h-96 overflow-y-auto min-w-[36rem] z-10 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none",children:(0,y.jsx)(I.A,{content:t.description,showImagePreview:!0})})]})]})},s);case"status":return(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,y.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat((0,q.qY)(t.status,"request")," dark:bg-opacity-30 status-col"),children:(r=t.status,(0,q.Iw)(r,"request",e))})},s);case"type":return(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,y.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-900 dark:text-gray-200",children:[(0,y.jsx)("span",{className:"text-lg",children:K(t.type)}),(0,y.jsx)("span",{children:t.type?e("requests.types.".concat(t.type)):e("requests.types.other")}),t.isPrivate&&(0,y.jsxs)("div",{className:"relative group inline-block ml-1",children:[(0,y.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"\ud83d\udd12"}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("createRequest.form.isPrivate")})]})]})},s);case"requestedByResponsible":return(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,y.jsxs)("div",{className:"flex flex-col",children:[(0,y.jsxs)("div",{className:"text-sm text-gray-900 dark:text-gray-200",children:[(0,y.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400 hidden sm:inline",children:[e("requests.columns.requestedBy"),":"]}),(0,y.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400 inline sm:hidden",children:[e("requests.columns.requestedBy").substring(0,5),":"]}),(0,y.jsx)("br",{}),"".concat(t.requestedBy.firstName," ").concat(t.requestedBy.lastName)]}),(0,y.jsxs)("div",{className:"text-sm text-gray-900 dark:text-gray-200 mt-1",children:[(0,y.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400 hidden sm:inline",children:[e("requests.columns.responsible"),":"]}),(0,y.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400 inline sm:hidden",children:[e("requests.columns.responsible").substring(0,4),":"]}),(0,y.jsx)("br",{}),"".concat(t.responsible.firstName," ").concat(t.responsible.lastName)]})]})},s);case"branch":return(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,y.jsx)("div",{className:"text-sm text-gray-900 dark:text-gray-200",children:t.branch.name})},s);case"dueDate":const a=(0,H.go)(t.dueDate,"request"),n=(0,H.F2)(a);return(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,y.jsxs)("div",{className:"text-sm ".concat("none"!==a?n.textClass:"text-gray-900 dark:text-gray-200"),children:[new Date(t.dueDate).toLocaleDateString(),"none"!==a&&(0,y.jsx)("span",{className:"ml-2 text-xs",children:"\u26a0"})]})},s);case"actions":return(0,y.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,y.jsxs)("div",{className:"flex space-x-2 action-buttons",children:[(0,y.jsxs)("div",{className:"status-buttons",children:["approval"===t.status&&qe("requests","write","table")&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{onClick:()=>Ge(t.id,"approved"),className:"p-1 bg-green-600 dark:bg-green-500 text-white rounded hover:bg-green-700 dark:hover:bg-green-600",children:(0,y.jsx)(g.A,{className:"h-5 w-5"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("requests.actions.approve")})]}),(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{onClick:()=>Ge(t.id,"to_improve"),className:"p-1 bg-orange-600 dark:bg-orange-500 text-white rounded hover:bg-orange-700 dark:hover:bg-orange-600",children:(0,y.jsx)(T.A,{className:"h-5 w-5"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("requests.actions.improve")})]}),(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{onClick:()=>Ge(t.id,"denied"),className:"p-1 bg-red-600 dark:bg-red-500 text-white rounded hover:bg-red-700 dark:hover:bg-red-600",children:(0,y.jsx)(x.A,{className:"h-5 w-5"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("requests.actions.deny")})]})]}),"to_improve"===t.status&&qe("requests","write","table")&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{onClick:()=>Ge(t.id,"approval"),className:"p-1 bg-yellow-600 dark:bg-yellow-500 text-white rounded hover:bg-yellow-700 dark:hover:bg-yellow-600",children:(0,y.jsx)(h.A,{className:"h-5 w-5"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("requests.actions.recheck")})]}),(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{onClick:()=>Ge(t.id,"denied"),className:"p-1 bg-red-600 dark:bg-red-500 text-white rounded hover:bg-red-700 dark:hover:bg-red-600",children:(0,y.jsx)(x.A,{className:"h-5 w-5"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("requests.actions.deny")})]})]}),("approved"===t.status||"denied"===t.status)&&qe("requests","write","table")&&(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{onClick:()=>Ge(t.id,"approval"),className:"p-1 bg-yellow-600 dark:bg-yellow-500 text-white rounded hover:bg-yellow-700 dark:hover:bg-yellow-600",children:(0,y.jsx)(h.A,{className:"h-5 w-5"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("requests.actions.recheck")})]})]}),qe("requests","write","table")&&(0,y.jsx)("button",{onClick:()=>{je(t),we(!0)},className:"text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 edit-button ml-0.5",children:(0,y.jsx)(B.A,{className:"h-5 w-5"})}),qe("requests","both","table")&&(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{onClick:()=>ot(t),className:"text-green-600 dark:text-green-400 hover:text-green-900 dark:hover:text-green-300 copy-button ml-0.5",children:(0,y.jsx)(z.A,{className:"h-5 w-5"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("requests.actions.copy")})]})]})},s);default:return null}var r}))},t.id)}))})})]})}):(0,y.jsx)("div",{className:"-mx-3 sm:-mx-4 md:-mx-6",children:0===nt.length?(0,y.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400",children:[(0,y.jsx)(S.A,{className:"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500"}),(0,y.jsx)("div",{className:"text-sm",children:e("requests.createRequest.noRequestsFound")})]}):(0,y.jsx)(U.A,{children:nt.map((t=>{const s=[];if(Qe.has("branch")&&s.push({icon:(0,y.jsx)(L.A,{className:"h-4 w-4"}),label:e("requests.columns.branch"),value:t.branch.name,section:"left"}),Qe.has("type")){const r=K(t.type),a=t.type?e("requests.types.".concat(t.type)):e("requests.types.other");s.push({label:"",value:"".concat(r," ").concat(a).concat(t.isPrivate?" \ud83d\udd12":""),section:"main"})}if(Qe.has("requestedBy")){const r="".concat(t.requestedBy.firstName," ").concat(t.requestedBy.lastName),a=r.length>4?r.substring(0,4):r;s.push({icon:(0,y.jsx)(F.A,{className:"h-4 w-4"}),label:e("requests.columns.requestedBy"),value:a,section:"main-second"})}if(Qe.has("responsible")){const r="".concat(t.responsible.firstName," ").concat(t.responsible.lastName),a=r.length>4?r.substring(0,4):r;s.push({icon:(0,y.jsx)(F.A,{className:"h-4 w-4"}),label:e("requests.columns.responsible"),value:a,section:"main-third"})}if(Qe.has("dueDate")){const r=(0,H.Rj)(t.dueDate,"request",void 0,void 0,(0,y.jsx)(M.A,{className:"h-4 w-4"}),e("requests.columns.dueDate"),(e=>(0,O.GP)(e,"dd.MM.yyyy",{locale:P.de})),!1);s.push((0,o.A)((0,o.A)({},r),{},{section:"right-inline"}))}Qe.has("description")&&t.description&&s.push({label:e("common.description"),value:"",descriptionContent:t.description,attachmentMetadata:t.attachments||[],section:"full"});const r=(0,y.jsxs)("div",{className:"flex items-center space-x-2",children:["approval"===t.status&&qe("requests","write","table")&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{onClick:e=>{e.stopPropagation(),Ge(t.id,"approved")},className:"p-1.5 bg-green-600 text-white rounded hover:bg-green-700",children:(0,y.jsx)(g.A,{className:"h-4 w-4"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("requests.actions.approve")})]}),(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{onClick:e=>{e.stopPropagation(),Ge(t.id,"to_improve")},className:"p-1.5 bg-orange-600 text-white rounded hover:bg-orange-700",children:(0,y.jsx)(T.A,{className:"h-4 w-4"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("requests.actions.improve")})]}),(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{onClick:e=>{e.stopPropagation(),Ge(t.id,"denied")},className:"p-1.5 bg-red-600 text-white rounded hover:bg-red-700",children:(0,y.jsx)(x.A,{className:"h-4 w-4"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("requests.actions.deny")})]})]}),"to_improve"===t.status&&qe("requests","write","table")&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{onClick:e=>{e.stopPropagation(),Ge(t.id,"approval")},className:"p-1.5 bg-yellow-600 text-white rounded hover:bg-yellow-700",children:(0,y.jsx)(h.A,{className:"h-4 w-4"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("requests.actions.recheck")})]}),(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{onClick:e=>{e.stopPropagation(),Ge(t.id,"denied")},className:"p-1.5 bg-red-600 text-white rounded hover:bg-red-700",children:(0,y.jsx)(x.A,{className:"h-4 w-4"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("requests.actions.deny")})]})]}),("approved"===t.status||"denied"===t.status)&&qe("requests","write","table")&&(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{onClick:e=>{e.stopPropagation(),Ge(t.id,"approval")},className:"p-1.5 bg-yellow-600 text-white rounded hover:bg-yellow-700",children:(0,y.jsx)(h.A,{className:"h-4 w-4"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("requests.actions.recheck")})]}),qe("requests","write","table")&&(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{onClick:e=>{e.stopPropagation(),je(t),we(!0)},className:"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:(0,y.jsx)(B.A,{className:"h-4 w-4"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("common.edit")})]}),qe("requests","both","table")&&(0,y.jsxs)("div",{className:"relative group",children:[(0,y.jsx)("button",{onClick:e=>{e.stopPropagation(),ot(t)},className:"p-1.5 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300",children:(0,y.jsx)(z.A,{className:"h-4 w-4"})}),(0,y.jsx)("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50",children:e("requests.actions.copy")})]})]}),a=(e=>{switch(e){case"to_improve":case"approved":case"denied":return"approval";default:return null}})(t.status),n=(e=>{switch(e){case"approval":return["approved","to_improve","denied"];case"to_improve":return["denied"];default:return[]}})(t.status),i=n.length>0?n[0]:null;return(0,y.jsx)(W.A,{title:(0,y.jsxs)("span",{children:[(0,y.jsxs)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:[t.id,":"]})," ",(0,y.jsx)("span",{children:t.title})]}),status:{label:(0,q.Iw)(t.status,"request",e),color:(0,q.qY)(t.status,"request"),onPreviousClick:a&&qe("requests","write","table")?()=>Ge(t.id,a):void 0,onNextClick:i&&qe("requests","write","table")?()=>Ge(t.id,i):void 0},metadata:s,actions:r},t.id)}))})}),b&&(0,y.jsx)("div",{ref:Ye,className:"flex justify-center py-4",children:J&&(0,y.jsx)(i.A,{size:24})})]})};var Z=s(3836),J=s(2750),X=s(1620),ee=s(4057),te=s(6511),se=s(5648),re=s(3315),ae=s(7012),ne=s(8416),oe=s(8658),ie=s(1713),le=s(2395);const de=(e,t)=>{const[s,r,a]=e.split("-").map((e=>parseInt(e))),n=new Date(s,r-1,a,12,0,0);return n.setDate(n.getDate()+t),(0,O.GP)(n,"yyyy-MM-dd")},ce=()=>{var e,t,s,n;const{t:i,i18n:c}=(0,a.Bd)(),{activeLanguage:u}=(0,se.o)(),{user:p}=(0,d.As)(),{organization:x}=(0,le.Z)(),[h,g]=(0,r.useState)(null),[b,v]=(0,r.useState)(null),[f,w]=(0,r.useState)(!0),[k,j]=(0,r.useState)(null),[N,q]=(0,r.useState)(8),[A,S]=(0,r.useState)("worktime"),[R,C]=(0,r.useState)(null),[D,_]=(0,r.useState)(!1),E=(0,r.useMemo)((()=>{const e="CO"===(null===p||void 0===p?void 0:p.country),t="CO"===(null===x||void 0===x?void 0:x.country),s=e||t;return console.log("Quinzena-Check:",{userCountry:null===p||void 0===p?void 0:p.country,orgCountry:null===x||void 0===x?void 0:x.country,isColombia:s}),s}),[null===p||void 0===p?void 0:p.country,null===x||void 0===x?void 0:x.country]),T=(0,r.useRef)(!1),[B,z]=(0,r.useState)((()=>"CO"===(null===p||void 0===p?void 0:p.country))),L=(0,r.useMemo)((()=>{switch(u||c.language||"de"){case"es":return ee.es;case"en":return te.c;default:return P.de}}),[u,c.language]),F=new Date,I=(0,r.useMemo)((()=>"".concat((0,Z.C)(F),"-W").concat(String((0,J.N)(F,{locale:L})).padStart(2,"0"))),[L]),W=(0,r.useMemo)((()=>(0,ie.VY)()),[]),[U,H]=(0,r.useState)(I),[K,Q]=(0,r.useState)(W);(0,r.useEffect)((()=>{B?Q(W):H(I)}),[I,W,B]);const $=(0,X.k)(F,{weekStartsOn:1}),V=(0,ie.M9)(W),[Y,G]=(0,r.useState)((0,O.GP)($,"yyyy-MM-dd")),[ce,ue]=(0,r.useState)(V),me=(0,r.useMemo)((()=>{const e=B?ce||(0,ie.M9)((0,ie.VY)()):Y||(0,O.GP)((0,X.k)(F,{weekStartsOn:1}),"yyyy-MM-dd");return console.log("selectedDate calculated:",{useQuinzena:B,selectedQuinzenaDate:ce,selectedWeekDate:Y,result:e}),e}),[B,ce,Y]),[pe,xe]=(0,r.useState)(!1),[he,ge]=(0,r.useState)("");(0,r.useEffect)((()=>()=>{g(null),v(null),C(null)}),[]),(0,r.useEffect)((()=>{p&&ye()}),[me,p,B]);const be=async(e,t)=>{try{if(w(!0),!e)return console.error("Kein Datum zum Senden verf\xfcgbar"),j("Kein Datum verf\xfcgbar"),void w(!1);console.log("Fetch Stats:",{isQuinzena:t,dateToSend:e});const s=t?"".concat(m.Sn.WORKTIME.STATS,"?quinzena=").concat(e):"".concat(m.Sn.WORKTIME.STATS,"?week=").concat(e);console.log("API Endpoint:",s);const r=(await l.A.get(s)).data;if(console.log("API Response:",r),r&&r.weeklyData)if(t){console.log("Quinzena-Daten vom Backend:",{totalHours:r.totalHours,weeklyDataLength:r.weeklyData.length,weeklyData:r.weeklyData});const e=(0,o.A)((0,o.A)({},r),{},{weeklyData:r.weeklyData.map((e=>(0,o.A)((0,o.A)({},e),{},{date:e.date||"",hours:e.hours||0}))).sort(((e,t)=>e.date&&t.date?e.date.localeCompare(t.date):0))});console.log("Validierte Quinzena-Daten:",e);const t=(0,o.A)((0,o.A)({},e),{},{weeklyData:e.weeklyData.slice(0,5)});g(t),v(e)}else{const t={Montag:1,Dienstag:2,Mittwoch:3,Donnerstag:4,Freitag:5,Samstag:6,Sonntag:7,[i("worktime.days.monday")]:1,[i("worktime.days.tuesday")]:2,[i("worktime.days.wednesday")]:3,[i("worktime.days.thursday")]:4,[i("worktime.days.friday")]:5,[i("worktime.days.saturday")]:6,[i("worktime.days.sunday")]:7},s=[];for(let r=0;r<7;r++)s.push(de(e,r));const a=(0,o.A)((0,o.A)({},r),{},{weeklyData:r.weeklyData.map((e=>{const r=t[e.day];if(void 0===r)return console.error("Unbekannter Wochentag: ".concat(e.day)),e;const a=s[r-1];return(0,o.A)((0,o.A)({},e),{},{date:a})}))}),n=(0,o.A)((0,o.A)({},a),{},{weeklyData:a.weeklyData.slice(0,5)});g(n),v(a)}else{const e=r.weeklyData?(0,o.A)((0,o.A)({},r),{},{weeklyData:r.weeklyData.slice(0,5)}):r;g(e),v(r)}setTimeout((()=>{null===b&&r&&r.weeklyData&&g(r)}),200),j(null)}catch(a){var s,r;console.error("Fehler beim Abrufen der Statistikdaten:",a),j((null===a||void 0===a||null===(s=a.response)||void 0===s||null===(r=s.data)||void 0===r?void 0:r.message)||"Fehler beim Laden der Daten")}finally{w(!1)}},ye=async()=>{be(me,B)},ve=e=>{let t,s;if(T.current=!0,z(e),e){const e=(0,ie.VY)();s=e,t=(0,ie.M9)(e),Q(s),ue(t)}else s=I,t=(0,ie.pg)(I),H(s),G(t);queueMicrotask((()=>{be(t,e),setTimeout((()=>{T.current=!1}),100)}))};(0,r.useEffect)((()=>{if(!T.current)if(E&&!B){const e=(0,ie.VY)();Q(e);const t=(0,ie.M9)(e);ue(t),z(!0),queueMicrotask((()=>{be(t,!0)}))}else if(!E&&B){const e=(0,ie.pg)(I);H(I),G(e),z(!1),queueMicrotask((()=>{be(e,!1)}))}}),[E,B]);const fe=e=>{e?e.match(/^\d{4}-\d{2}-\d{2}$/)?(ge(e),xe(!0)):console.error("Ung\xfcltiges Datum f\xfcr Modal: ".concat(e)):console.error("Kein Datum f\xfcr Modal angegeben")};(0,r.useEffect)((()=>{if(!f&&h&&h.weeklyData){const e=h.weeklyData.reduce(((e,t)=>{const s="number"===typeof t.hours?t.hours:parseFloat(t.hours);return s>e?s:e}),0);q(e)}}),[f,h]);const we=(0,r.useCallback)((async()=>{if(null!==p&&void 0!==p&&p.id)try{_(!0);const e=new Date((new Date).getFullYear(),0,1),t=new Date,s=await l.A.get(m.Sn.TOUR_BOOKINGS.COMMISSIONS(p.id),{params:{startDate:e.toISOString(),endDate:t.toISOString()}});s.data.success&&C(s.data.data)}catch(e){console.error("Fehler beim Laden der Kommissions-Daten:",e)}finally{_(!1)}}),[null===p||void 0===p?void 0:p.id]);if((0,r.useEffect)((()=>{"commissions"===A&&null!==p&&void 0!==p&&p.id&&we()}),[A,null===p||void 0===p?void 0:p.id,we]),f&&"worktime"===A)return(0,y.jsx)("div",{className:"p-4",children:i("common.loading")});if(k&&"worktime"===A)return(0,y.jsx)("div",{className:"p-4 text-red-600",children:k});if(!h&&"worktime"===A)return null;B?(0,ie.lK)(ce):(0,ie._2)(Y);const ke=Math.max(8,Math.ceil(1.1*N)),je=null!==(e=null===p||void 0===p?void 0:p.normalWorkingHours)&&void 0!==e?e:7.6;return(0,y.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6",children:[(0,y.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,y.jsxs)("div",{className:"flex items-center pl-2 sm:pl-0 flex-shrink min-w-0",children:[(0,y.jsx)(re.A,{className:"h-5 w-5 sm:h-6 sm:w-6 mr-2 dark:text-white flex-shrink-0"}),(0,y.jsx)("h2",{className:"text-base sm:text-lg md:text-xl font-semibold dark:text-white truncate",children:i("worktime.stats.title")})]}),(0,y.jsxs)("div",{className:"flex items-center gap-2 border-b border-gray-200 dark:border-gray-700",children:[(0,y.jsx)("button",{onClick:()=>S("worktime"),className:"py-2 px-3 border-b-2 font-medium text-sm ".concat("worktime"===A?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:i("worktime.stats.tabs.worktime","Arbeitszeit")}),(0,y.jsx)("button",{onClick:()=>S("commissions"),className:"py-2 px-3 border-b-2 font-medium text-sm ".concat("commissions"===A?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"),children:i("worktime.stats.tabs.commissions","Kommissionen")})]}),(0,y.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[E&&(0,y.jsxs)("div",{className:"flex items-center rounded-lg border border-gray-300 dark:border-gray-600 p-0.5 sm:p-1 bg-gray-50 dark:bg-gray-800",children:[(0,y.jsxs)("button",{type:"button",onClick:()=>ve(!1),className:"flex items-center gap-1 sm:gap-2 px-1.5 sm:px-3 py-1 sm:py-1.5 rounded-md text-sm font-medium transition-all duration-200 ".concat(B?"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200":"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 shadow-sm"),children:[(0,y.jsx)(M.A,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"}),(0,y.jsx)("span",{className:"hidden sm:inline whitespace-nowrap",children:i("worktime.stats.week")}),(0,y.jsx)("span",{className:"sm:hidden whitespace-nowrap",children:"7d"})]}),(0,y.jsxs)("button",{type:"button",onClick:()=>ve(!0),className:"flex items-center gap-1 sm:gap-2 px-1.5 sm:px-3 py-1 sm:py-1.5 rounded-md text-sm font-medium transition-all duration-200 ".concat(B?"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"),children:[(0,y.jsx)(ae.A,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"}),(0,y.jsx)("span",{className:"hidden sm:inline whitespace-nowrap",children:i("worktime.stats.quinzena")}),(0,y.jsx)("span",{className:"sm:hidden whitespace-nowrap",children:"15d"})]})]}),B?(0,y.jsx)("input",{type:"text",pattern:"\\d{4}-\\d{2}-Q[12]",placeholder:"YYYY-MM-Q1",value:K,onChange:e=>{const t=e.target.value;if((/^\d{4}-\d{2}-Q[12]$/.test(t)||""===t)&&(Q(t),t.match(/^\d{4}-\d{2}-Q[12]$/))){const e=(0,ie.M9)(t);ue(e),queueMicrotask((()=>{be(e,!0)}))}},className:"border border-gray-300 dark:border-gray-600 rounded-md text-sm h-7 sm:h-10 px-1.5 sm:px-3 dark:bg-gray-700 dark:text-white min-w-28 w-28 sm:w-28",title:i("worktime.stats.quinzenaFormat")}):(0,y.jsx)("input",{type:"text",pattern:"\\d{4}-W\\d{2}",placeholder:"YYYY-Www",value:U,onChange:e=>{const t=e.target.value;if((/^\d{4}-W\d{1,2}$/.test(t)||""===t)&&(H(t),t.match(/^\d{4}-W\d{2}$/))){const e=(0,ie.pg)(t);G(e),queueMicrotask((()=>{be(e,!1)}))}},className:"border border-gray-300 dark:border-gray-600 rounded-md text-sm h-7 sm:h-10 px-1.5 sm:px-3 dark:bg-gray-700 dark:text-white min-w-28 w-28 sm:w-28",title:i("worktime.stats.weekFormat")}),(0,y.jsx)("button",{onClick:async()=>{try{localStorage.getItem("token");const e=await l.A.get("".concat(m.Sn.WORKTIME.BASE,"/export?week=").concat(Y),{responseType:"blob"}),t=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),s=window.URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download=i("worktime.stats.exportFilename",{week:U.split("W")[1]}),document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(s),document.body.removeChild(r)}catch(k){console.error("Fehler beim Exportieren:",k),j(i("worktime.stats.export")+": "+i("common.error"))}},className:"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1 sm:p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center min-w-7 min-h-7 sm:min-w-8 sm:min-h-8 w-7 h-7 sm:w-8 sm:h-8",title:i("worktime.stats.export"),"aria-label":i("worktime.stats.exportTitle"),style:{marginTop:"1px",marginBottom:"1px"},children:(0,y.jsx)(ne.A,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})]})]}),"worktime"===A&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"flex flex-row gap-2 mb-8 overflow-x-auto",children:[(0,y.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/30 p-4 rounded-lg flex-1 min-w-0",children:[(0,y.jsx)("h3",{className:"text-lg font-medium text-blue-900 dark:text-blue-100 mb-2 whitespace-nowrap text-sm sm:text-base md:text-lg text-center",children:i("worktime.stats.totalHours")}),(0,y.jsxs)("p",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-blue-600 dark:text-blue-400 whitespace-nowrap text-center",children:[h.totalHours,i("worktime.stats.hourShort")]})]}),(0,y.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/30 p-4 rounded-lg flex-1 min-w-0",children:[(0,y.jsx)("h3",{className:"text-lg font-medium text-green-900 dark:text-green-100 mb-2 whitespace-nowrap text-sm sm:text-base md:text-lg text-center",children:i("worktime.stats.averagePerDay")}),(0,y.jsxs)("p",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-green-600 dark:text-green-400 whitespace-nowrap text-center",children:[h.averageHoursPerDay,i("worktime.stats.hourShort")]})]}),(0,y.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/30 p-4 rounded-lg flex-1 min-w-0",children:[(0,y.jsx)("h3",{className:"text-lg font-medium text-purple-900 dark:text-purple-100 mb-2 whitespace-nowrap text-sm sm:text-base md:text-lg text-center",children:i("worktime.stats.workDays")}),(0,y.jsx)("p",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-purple-600 dark:text-purple-400 whitespace-nowrap text-center",children:h.daysWorked})]})]}),(0,y.jsxs)("div",{className:"mt-8",children:[(0,y.jsx)("h3",{className:"text-lg font-medium mb-4 dark:text-white",children:i(B?"worktime.stats.quinzenaProgress":"worktime.stats.weeklyProgress")}),(0,y.jsxs)("div",{className:"relative",style:{height:"200px"},children:[(0,y.jsxs)("div",{className:"absolute right-0 h-full flex flex-col justify-between text-xs text-gray-500 dark:text-gray-400 pr-1",children:[(0,y.jsxs)("span",{children:[ke,"h"]}),(0,y.jsxs)("span",{children:[Math.round(.75*ke),"h"]}),(0,y.jsxs)("span",{children:[Math.round(.5*ke),"h"]}),(0,y.jsxs)("span",{children:[Math.round(.25*ke),"h"]}),(0,y.jsx)("span",{children:"0h"})]}),(0,y.jsxs)("div",{className:"absolute inset-0 flex flex-col justify-between pointer-events-none pr-8",children:[(0,y.jsx)("div",{className:"w-full border-t border-gray-200 dark:border-gray-700"}),(0,y.jsx)("div",{className:"w-full border-t border-gray-200 dark:border-gray-700"}),(0,y.jsx)("div",{className:"w-full border-t border-gray-200 dark:border-gray-700"}),(0,y.jsx)("div",{className:"w-full border-t border-gray-200 dark:border-gray-700"}),(0,y.jsx)("div",{className:"w-full border-t border-gray-200 dark:border-gray-700"})]}),je<=ke&&(0,y.jsx)("div",{className:"absolute w-full border-t-2 border-red-600 dark:border-red-500 z-10 pr-8",style:{bottom:"".concat(je/ke*100,"%"),borderStyle:"dashed"},children:(0,y.jsxs)("span",{className:"absolute -top-3 right-8 text-xs text-red-600 dark:text-red-500 font-medium",children:[i("worktime.stats.target"),": ",je,i("worktime.stats.hourShort")]})}),(0,y.jsxs)("div",{className:"absolute top-0 left-0 text-xs flex items-center gap-2",children:[(0,y.jsxs)("div",{className:"flex items-center",children:[(0,y.jsx)("div",{className:"w-3 h-3 bg-blue-100 dark:bg-blue-900/50 border-2 border-blue-600 dark:border-blue-400 rounded-sm mr-1"}),(0,y.jsxs)("span",{className:"text-blue-600 dark:text-blue-400",children:["\u2264 ",je,i("worktime.stats.hourShort")]})]}),(0,y.jsxs)("div",{className:"flex items-center",children:[(0,y.jsx)("div",{className:"w-3 h-3 bg-red-100 dark:bg-red-900/50 border-2 border-red-600 dark:border-red-400 rounded-sm mr-1"}),(0,y.jsxs)("span",{className:"text-red-600 dark:text-red-400",children:["> ",je,i("worktime.stats.hourShort")]})]})]}),(0,y.jsx)("div",{className:"absolute inset-0 pr-8 flex items-end",children:(0,y.jsx)("div",{className:"w-full h-full flex justify-between",children:h.weeklyData.map(((e,t)=>{const s="number"===typeof e.hours?e.hours:parseFloat(e.hours),r=s>je?(s-je)/ke*100:0,a=Math.min(s,je)/ke*100,n=e.date,o=B?(0,ie.lK)(ce).length:7,l=B?"".concat(100/o,"%"):"13%",d=B?"w-3/12":"w-5/12";return(0,y.jsx)("div",{className:"flex flex-col items-center",style:{width:l},children:(0,y.jsxs)("div",{className:"relative ".concat(d," h-full flex flex-col justify-end cursor-pointer"),title:i("worktime.stats.clickToView"),children:[r>0&&(0,y.jsx)("div",{className:"w-full bg-red-100 dark:bg-red-900/50 border-2 border-red-600 dark:border-red-400 hover:bg-red-200 dark:hover:bg-red-900/70 cursor-pointer",onClick:()=>fe(n),style:{height:"".concat(r,"%"),minHeight:"2px",borderTopLeftRadius:"8px",borderTopRightRadius:"8px",borderBottomWidth:r>0&&a>0?"0":"2px"}}),a>0&&(0,y.jsx)("div",{className:"w-full bg-blue-100 dark:bg-blue-900/50 border-2 border-blue-600 dark:border-blue-400 hover:bg-blue-200 dark:hover:bg-blue-900/70 cursor-pointer",onClick:()=>fe(n),style:{height:"".concat(a,"%"),minHeight:s>0?"4px":"0",borderTopLeftRadius:r>0?"0":"8px",borderTopRightRadius:r>0?"0":"8px",borderBottomLeftRadius:"4px",borderBottomRightRadius:"4px",borderTopWidth:r>0?"0":"2px"}})]})},t)}))})}),(0,y.jsx)("div",{className:"absolute bottom-0 left-0 right-8 pt-8 flex justify-between pointer-events-none",children:h.weeklyData.map(((e,t)=>{const s=B?(0,ie.lK)(ce).length:7,r=B?"".concat(100/s,"%"):"13%";return(0,y.jsxs)("div",{className:"flex flex-col items-center",style:{width:r},children:[(0,y.jsx)("div",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-400",children:(()=>{const t=e.day.toLowerCase();return t.includes("montag")||t.includes("mo")?i("worktime.days.monday").substring(0,2):t.includes("dienstag")||t.includes("di")?i("worktime.days.tuesday").substring(0,2):t.includes("mittwoch")||t.includes("mi")?i("worktime.days.wednesday").substring(0,2):t.includes("donnerstag")||t.includes("do")?i("worktime.days.thursday").substring(0,2):t.includes("freitag")||t.includes("fr")?i("worktime.days.friday").substring(0,2):t.includes("samstag")||t.includes("sa")?i("worktime.days.saturday").substring(0,2):t.includes("sonntag")||t.includes("so")?i("worktime.days.sunday").substring(0,2):e.day.substring(0,2)})()}),(0,y.jsxs)("div",{className:"text-xs sm:text-sm font-medium dark:text-gray-300",children:[e.hours.toFixed(1),i("worktime.stats.hourShort")]})]},t)}))})]})]}),pe&&(0,y.jsx)(oe.G,{isOpen:pe,onClose:()=>{xe(!1)},selectedDate:he})]}),"commissions"===A&&(0,y.jsx)("div",{className:"space-y-6",children:D?(0,y.jsx)("div",{className:"p-4 text-center",children:i("common.loading")}):R?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,y.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/30 p-4 rounded-lg",children:[(0,y.jsx)("h3",{className:"text-sm font-medium text-blue-900 dark:text-blue-100 mb-2",children:i("worktime.stats.commissions.total","Gesamtkommissionen")}),(0,y.jsx)("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:new Intl.NumberFormat("de-DE",{style:"currency",currency:"COP"}).format(R.totalCommissions||0)})]}),(0,y.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/30 p-4 rounded-lg",children:[(0,y.jsx)("h3",{className:"text-sm font-medium text-green-900 dark:text-green-100 mb-2",children:i("worktime.stats.commissions.totalBookings","Anzahl Buchungen")}),(0,y.jsx)("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:R.totalBookings||0})]}),(0,y.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/30 p-4 rounded-lg",children:[(0,y.jsx)("h3",{className:"text-sm font-medium text-purple-900 dark:text-purple-100 mb-2",children:i("worktime.stats.commissions.average","Durchschnitt")}),(0,y.jsx)("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:new Intl.NumberFormat("de-DE",{style:"currency",currency:"COP"}).format(R.averageCommission||0)})]})]}),(0,y.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,y.jsxs)("div",{className:"bg-white dark:bg-gray-700 p-4 rounded-lg border border-gray-200 dark:border-gray-600",children:[(0,y.jsx)("h3",{className:"text-lg font-semibold mb-3 dark:text-white",children:i("worktime.stats.commissions.byTourType","Nach Tour-Typ")}),(0,y.jsxs)("div",{className:"space-y-2",children:[(0,y.jsxs)("div",{className:"flex justify-between",children:[(0,y.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:i("tours.typeOwn","Eigene Touren")}),(0,y.jsx)("span",{className:"font-semibold dark:text-white",children:new Intl.NumberFormat("de-DE",{style:"currency",currency:"COP"}).format((null===(t=R.byTourType)||void 0===t?void 0:t.own)||0)})]}),(0,y.jsxs)("div",{className:"flex justify-between",children:[(0,y.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:i("tours.typeExternal","Externe Touren")}),(0,y.jsx)("span",{className:"font-semibold dark:text-white",children:new Intl.NumberFormat("de-DE",{style:"currency",currency:"COP"}).format((null===(s=R.byTourType)||void 0===s?void 0:s.external)||0)})]})]})]}),(0,y.jsxs)("div",{className:"bg-white dark:bg-gray-700 p-4 rounded-lg border border-gray-200 dark:border-gray-600",children:[(0,y.jsx)("h3",{className:"text-lg font-semibold mb-3 dark:text-white",children:i("worktime.stats.commissions.tourSales","Tour-Verk\xe4ufe")}),(0,y.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:(null===(n=R.tourSales)||void 0===n?void 0:n.length)>0?R.tourSales.map((e=>(0,y.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-200 dark:border-gray-600 last:border-0",children:[(0,y.jsxs)("div",{children:[(0,y.jsx)("p",{className:"font-medium dark:text-white",children:e.tourTitle}),(0,y.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.salesCount," ",i("worktime.stats.commissions.sales","Verk\xe4ufe")]})]}),(0,y.jsx)("span",{className:"font-semibold dark:text-white",children:new Intl.NumberFormat("de-DE",{style:"currency",currency:"COP"}).format(e.totalCommission||0)})]},e.tourId))):(0,y.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:i("worktime.stats.commissions.noSales","Keine Verk\xe4ufe")})})]})]})]}):(0,y.jsx)("div",{className:"p-4 text-center text-gray-500 dark:text-gray-400",children:i("worktime.stats.commissions.noData","Keine Kommissions-Daten verf\xfcgbar")})})]})};var ue=s(5475),me=s(9130),pe=s(6287);const xe=()=>{const{t:e}=(0,a.Bd)();return(0,y.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 shadow-sm",children:(0,y.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between",children:[(0,y.jsxs)("div",{className:"flex items-center mb-4 md:mb-0",children:[(0,y.jsx)("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-3 rounded-full mr-4",children:(0,y.jsx)(me.A,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),(0,y.jsxs)("div",{children:[(0,y.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:e("appDownload.title")}),(0,y.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e("appDownload.description")})]})]}),(0,y.jsxs)(ue.N_,{to:"/mobile-app",className:"inline-flex items-center rounded-md border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800",children:[e("appDownload.download"),(0,y.jsx)(pe.A,{className:"ml-2 -mr-1 h-4 w-4"})]})]})})},he=()=>{const{t:e}=(0,a.Bd)(),t=(0,n.Zp)(),[s,o]=(0,r.useState)(null),[i,l]=(0,r.useState)(!0);(0,r.useEffect)((()=>{localStorage.getItem("token")?(o({id:1,username:"testuser",email:"test@example.com",first_name:"Test",last_name:"User"}),l(!1)):t("/login")}),[t]);return i?(0,y.jsx)("div",{className:"flex items-center justify-center min-h-screen text-gray-700 dark:text-gray-300",children:e("common.loading")}):(0,y.jsx)("div",{className:"min-h-screen dark:bg-gray-900",children:(0,y.jsxs)("div",{className:"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6","data-onboarding":"dashboard-header",children:[(0,y.jsx)("div",{"data-onboarding":"worktime-stats",children:(0,y.jsx)(ce,{})}),(0,y.jsxs)("div",{className:"mt-2 sm:mt-4 md:mt-6 grid grid-cols-1 gap-4",children:[(0,y.jsx)("div",{className:"dashboard-requests-wrapper bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 w-full","data-onboarding":"requests-section",children:(0,y.jsx)(G,{})}),(0,y.jsx)("div",{className:"mt-4",children:(0,y.jsx)(xe,{})})]})]})})}}}]);
//# sourceMappingURL=786.4bdcde4f.chunk.js.map