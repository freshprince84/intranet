{"version":3,"file":"static/js/541.1daf05e6.chunk.js","mappings":"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","sources":["components/CerebroArticleSelector.tsx","components/CreateTaskModal.tsx","components/TaskDataBox.tsx","components/EmailTemplateBox.tsx","components/SocialSecurityCompletionBox.tsx","components/EditTaskModal.tsx","components/reservations/CreateReservationModal.tsx","types/tour.ts","components/tours/CreateTourModal.tsx","components/tours/EditTourModal.tsx","components/tours/TourDetailsModal.tsx","components/tours/TourBookingsModal.tsx","components/tours/TourExportDialog.tsx","components/tours/TourReservationLinkModal.tsx","components/reservations/SendInvitationSidepane.tsx","components/reservations/SendPasscodeSidepane.tsx","components/WorktimeTracker.tsx","pages/Worktracker.tsx","types/reservation.ts","services/reservationService.ts","components/reservations/ReservationNotificationLogs.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { MagnifyingGlassIcon } from '@heroicons/react/24/solid';\nimport { XCircleIcon } from '@heroicons/react/24/solid';\nimport debounce from 'lodash/debounce';\n\ninterface CerebroArticle {\n  id: number;\n  title: string;\n  slug: string;\n  content?: string;\n}\n\ninterface CerebroArticleSelectorProps {\n  onArticleSelected: (article: CerebroArticle) => void;\n  excludeArticleIds?: number[];\n  selectedArticles?: CerebroArticle[];\n  onArticleRemove?: (articleId: number) => void;\n}\n\nconst CerebroArticleSelector: React.FC<CerebroArticleSelectorProps> = ({\n  onArticleSelected,\n  excludeArticleIds = [],\n  selectedArticles,\n  onArticleRemove\n}) => {\n  const [articles, setArticles] = useState<CerebroArticle[]>([]);\n  const [selectedArticleId, setSelectedArticleId] = useState<number | null>(null);\n  const [selectedArticlePreview, setSelectedArticlePreview] = useState<CerebroArticle | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Alle Artikel beim Laden abrufen\n  useEffect(() => {\n    const fetchAllArticles = async () => {\n      try {\n        setLoading(true);\n        setError(null);\n        \n        const response = await axiosInstance.get(API_ENDPOINTS.CEREBRO.ARTICLES.BASE);\n        \n        // Filtere bereits ausgewhlte Artikel\n        const filteredArticles = response.data.filter(\n          (article: CerebroArticle) => !excludeArticleIds.includes(article.id)\n        );\n        \n        setArticles(filteredArticles);\n      } catch (err) {\n        console.error('Fehler beim Abrufen der Artikel:', err);\n        // Einfachere Fehlerbehandlung ohne axios-Import\n        const axiosError = err as any;\n        setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchAllArticles();\n  }, [excludeArticleIds]);\n\n  // Artikeldetails abrufen, wenn ein Artikel ausgewhlt wird\n  const fetchArticleDetails = async (articleId: number) => {\n    try {\n      setLoading(true);\n      const response = await axiosInstance.get(API_ENDPOINTS.CEREBRO.ARTICLES.BY_ID(articleId));\n      setSelectedArticlePreview(response.data);\n    } catch (err) {\n      console.error('Fehler beim Abrufen der Artikeldetails:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleArticleSelect = (e: React.ChangeEvent<HTMLSelectElement>) => {\n    const articleId = parseInt(e.target.value, 10);\n    \n    if (!isNaN(articleId)) {\n      setSelectedArticleId(articleId);\n      \n      // Artikel aus der Liste finden\n      const selectedArticle = articles.find(article => article.id === articleId);\n      \n      if (selectedArticle) {\n        // Artikeldetails abrufen fr die Vorschau\n        fetchArticleDetails(articleId);\n      }\n    } else {\n      setSelectedArticleId(null);\n      setSelectedArticlePreview(null);\n    }\n  };\n\n  const handleArticleConfirm = () => {\n    if (selectedArticleId !== null) {\n      const selectedArticle = articles.find(article => article.id === selectedArticleId);\n      if (selectedArticle) {\n        onArticleSelected(selectedArticle);\n        setSelectedArticleId(null);\n        setSelectedArticlePreview(null);\n      }\n    }\n  };\n\n  return (\n    <div className=\"mt-4\">\n      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n        Cerebro-Artikel verknpfen\n      </label>\n      \n      <div className=\"flex flex-col gap-3\">\n        <div className=\"flex items-center gap-2\">\n          <select\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n            value={selectedArticleId || ''}\n            onChange={handleArticleSelect}\n          >\n            <option value=\"\">-- Artikel auswhlen --</option>\n            {articles.map((article) => (\n              <option key={article.id} value={article.id}>\n                {article.title}\n              </option>\n            ))}\n          </select>\n          \n          <button\n            type=\"button\"\n            onClick={handleArticleConfirm}\n            disabled={selectedArticleId === null}\n            className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            Verknpfen\n          </button>\n        </div>\n\n        {loading && (\n          <div className=\"text-sm text-gray-500\">\n            Lade Artikel...\n          </div>\n        )}\n        \n        {error && (\n          <div className=\"text-sm text-red-600\">\n            {error}\n          </div>\n        )}\n        \n        {selectedArticlePreview && (\n          <div className=\"mt-2 p-4 border border-gray-300 rounded-md bg-gray-50\">\n            <h4 className=\"font-medium text-lg mb-2\">{selectedArticlePreview.title}</h4>\n            <div className=\"prose prose-sm max-w-none\">\n              {selectedArticlePreview.content ? (\n                <div className=\"text-sm text-gray-700 max-h-40 overflow-y-auto\">\n                  {selectedArticlePreview.content.substring(0, 300)}\n                  {selectedArticlePreview.content.length > 300 && '...'}\n                </div>\n              ) : (\n                <p className=\"text-sm text-gray-500 italic\">Kein Inhalt verfgbar</p>\n              )}\n            </div>\n            <div className=\"mt-2\">\n              <a \n                href={`/cerebro/articles/${selectedArticlePreview.slug}`}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"text-sm text-blue-600 hover:underline\"\n              >\n                Artikel ffnen\n              </a>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default CerebroArticleSelector; ","import React, { useState, useEffect, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../config/axios.ts';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, ArrowPathIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport CerebroArticleSelector from './CerebroArticleSelector.tsx';\nimport MarkdownPreview from './MarkdownPreview.tsx';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\n\ninterface User {\n    id: number;\n    firstName: string;\n    lastName: string;\n}\n\ninterface Role {\n    id: number;\n    name: string;\n}\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface CerebroArticle {\n    id: number;\n    title: string;\n    slug: string;\n    content?: string;\n}\n\ninterface TaskAttachment {\n    id?: number;\n    fileName: string;\n    fileType: string;\n    fileSize: number;\n    filePath?: string;\n    uploadedAt?: string;\n    file?: File; // Fr temporre Anhnge vor dem Hochladen\n}\n\ninterface CreateTaskModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onTaskCreated: (newTask: Task) => void;\n}\n\ninterface Task {\n    id: number;\n    title: string;\n    description: string | null;\n    status: 'open' | 'in_progress' | 'improval' | 'quality_control' | 'done';\n    responsible: {\n        id: number;\n        firstName: string;\n        lastName: string;\n    } | null;\n    responsibleId: number | null;\n    role: {\n        id: number;\n        name: string;\n    } | null;\n    roleId: number | null;\n    qualityControl: {\n        id: number;\n        firstName: string;\n        lastName: string;\n    } | null;\n    branch: {\n        id: number;\n        name: string;\n    };\n    dueDate: string | null;\n    requestId: number | null;\n}\n\nconst CreateTaskModal = ({ isOpen, onClose, onTaskCreated }: CreateTaskModalProps) => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { openSidepane, closeSidepane } = useSidepane();\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    const [title, setTitle] = useState('');\n    const [description, setDescription] = useState('');\n    const [assigneeType, setAssigneeType] = useState<'user' | 'role'>('user');\n    const [responsibleId, setResponsibleId] = useState<number | ''>('');\n    const [roleId, setRoleId] = useState<number | ''>('');\n    const [qualityControlId, setQualityControlId] = useState<number | ''>('');\n    const [branchId, setBranchId] = useState<number | ''>('');\n    const [dueDate, setDueDate] = useState('');\n    const [users, setUsers] = useState<User[]>([]);\n    const [roles, setRoles] = useState<Role[]>([]);\n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [selectedArticles, setSelectedArticles] = useState<CerebroArticle[]>([]);\n    const [activeTab, setActiveTab] = useState<'data' | 'cerebro'>('data');\n    const [temporaryAttachments, setTemporaryAttachments] = useState<TaskAttachment[]>([]);\n    const [uploading, setUploading] = useState(false);\n    const fileInputRef = useRef<HTMLInputElement>(null);\n    const textareaRef = useRef<HTMLTextAreaElement>(null);\n\n    const getDefaultDueDate = () => {\n        const date = new Date();\n        date.setDate(date.getDate() + 7);\n        return date.toISOString().split('T')[0];\n    };\n\n    useEffect(() => {\n        if (isOpen) {\n            fetchUsers();\n            fetchRoles();\n            fetchBranches();\n            \n            if (user) {\n                setQualityControlId(user.id);\n            }\n            \n            setDueDate(getDefaultDueDate());\n        }\n    }, [isOpen, user]);\n\n    useEffect(() => {\n        if (branches.length > 0 && branchId === '') {\n            if (branches.length === 1) {\n                setBranchId(branches[0].id);\n            } else if (branches.length > 1) {\n                setBranchId(branches[0].id);\n            }\n        }\n    }, [branches, branchId]);\n    \n    useEffect(() => {\n        // Prfen der Bildschirmgre beim Mounten\n        const checkScreenSize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        \n        // Initial prfen\n        checkScreenSize();\n        \n        // Event-Listener fr Grennderungen\n        window.addEventListener('resize', checkScreenSize);\n        \n        // Cleanup\n        return () => {\n            window.removeEventListener('resize', checkScreenSize);\n        };\n    }, []);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    const fetchUsers = async () => {\n        try {\n            setError(null);\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                return;\n            }\n\n            console.log('Lade Benutzer fr CreateTaskModal...');\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.USERS.DROPDOWN);\n            \n            console.log('Benutzer geladen:', response.data.length);\n            setUsers(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der Benutzer:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            if (axiosError.code === 'ERR_NETWORK') {\n                setError(t('tasks.createTask.errors.connectionError'));\n            } else {\n                setError(`${t('tasks.createTask.errors.loadUsersError')}: ${axiosError.response?.data?.message || axiosError.message}`);\n            }\n        }\n    };\n\n    const fetchRoles = async () => {\n        try {\n            setError(null);\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                return;\n            }\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.ROLES.BASE);\n            setRoles(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der Rollen:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            if (axiosError.code === 'ERR_NETWORK') {\n                setError(t('tasks.createTask.errors.connectionError'));\n            } else {\n                setError(`${t('tasks.createTask.errors.loadRolesError')}: ${axiosError.response?.data?.message || axiosError.message}`);\n            }\n        }\n    };\n\n    const fetchBranches = async () => {\n        try {\n            setError(null);\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                return;\n            }\n\n            console.log('Lade Niederlassungen fr CreateTaskModal...');\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\n            \n            console.log('Niederlassungen geladen:', response.data.length);\n            setBranches(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der Niederlassungen:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            if (axiosError.code === 'ERR_NETWORK') {\n                setError(t('tasks.createTask.errors.connectionError'));\n            } else {\n                setError(`${t('tasks.createTask.errors.loadBranchesError')}: ${axiosError.response?.data?.message || axiosError.message}`);\n            }\n        }\n    };\n\n    const handlePaste = async (event: React.ClipboardEvent) => {\n        const items = event.clipboardData.items;\n        \n        for (let i = 0; i < items.length; i++) {\n            const item = items[i];\n            \n            // Prfen, ob das eingefgte Element ein Bild ist\n            if (item.type.indexOf('image') === 0) {\n                event.preventDefault(); // Standardeingabe verhindern\n                \n                const file = item.getAsFile();\n                if (file) {\n                    await handleTemporaryAttachment(file);\n                }\n                return;\n            }\n        }\n    };\n\n    const handleDrop = async (event: React.DragEvent) => {\n        event.preventDefault();\n        event.stopPropagation();\n        \n        if (event.dataTransfer.files && event.dataTransfer.files.length > 0) {\n            const file = event.dataTransfer.files[0];\n            await handleTemporaryAttachment(file);\n        }\n    };\n\n    const handleDragOver = (event: React.DragEvent) => {\n        event.preventDefault();\n        event.stopPropagation();\n    };\n\n    const handleTemporaryAttachment = async (file: File) => {\n        setUploading(true);\n        setError(null);\n\n        try {\n            // Erstelle einen temporren Anhang\n            const newAttachment: TaskAttachment = {\n                fileName: file.name,\n                fileType: file.type,\n                fileSize: file.size,\n                file: file // Speichern der Datei fr spteren Upload\n            };\n            \n            setTemporaryAttachments(prev => [...prev, newAttachment]);\n\n            // Fge Markdown-Link ins Textarea ein (fr Card-Anzeige)\n            // Bilder werden zustzlich als groe Vorschau unter dem Textarea angezeigt\n            let insertText = '';\n            if (file.type.startsWith('image/')) {\n                // Hinweis: Wir verwenden hier den Platzhalter, da die Datei erst nach dem Erstellen hochgeladen wird\n                // Die tatschliche URL wird nach dem erfolgreichen Upload im Backend gesetzt\n                insertText = `\\n![${file.name}](${t('tasks.createTask.form.uploadAfterCreate')})\\n`;\n            } else {\n                // Fr andere Dateien einen temporren Platzhalter\n                insertText = `\\n[${file.name}](${t('tasks.createTask.form.uploadAfterCreate')})\\n`;\n            }\n            \n            // Fge den Link an der aktuellen Cursorposition ein\n            if (textareaRef.current) {\n                const cursorPos = textareaRef.current.selectionStart;\n                const textBefore = description.substring(0, cursorPos);\n                const textAfter = description.substring(cursorPos);\n                \n                setDescription(textBefore + insertText + textAfter);\n                \n                // Setze den Cursor hinter den eingefgten Link\n                setTimeout(() => {\n                    if (textareaRef.current) {\n                        const newPos = cursorPos + insertText.length;\n                        textareaRef.current.selectionStart = newPos;\n                        textareaRef.current.selectionEnd = newPos;\n                        textareaRef.current.focus();\n                    }\n                }, 0);\n            } else {\n                setDescription(description + insertText);\n            }\n        } catch (err) {\n            console.error('Fehler beim Verarbeiten der Datei:', err);\n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        } finally {\n            setUploading(false);\n        }\n    };\n\n    const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n        const files = event.target.files;\n        if (!files || files.length === 0) return;\n\n        const file = files[0];\n        await handleTemporaryAttachment(file);\n        \n        // Zurcksetzen des Datei-Inputs\n        if (fileInputRef.current) {\n            fileInputRef.current.value = '';\n        }\n    };\n\n    const handleRemoveTemporaryAttachment = (index: number) => {\n        // Finde den zu entfernenden Anhang\n        const attachmentToRemove = temporaryAttachments[index];\n        \n        if (attachmentToRemove) {\n            // Entferne den Anhang aus dem temporaryAttachments-Array\n            setTemporaryAttachments(temporaryAttachments.filter((_, i) => i !== index));\n            \n            // Entferne auch den Verweis im Beschreibungstext\n            if (attachmentToRemove.fileName) {\n                // Suche nach Bild- und Link-Markdown mit dem Dateinamen\n                const escapedFileName = attachmentToRemove.fileName.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n                const uploadText = t('tasks.createTask.form.uploadAfterCreate');\n                const imagePattern = new RegExp(`!\\\\[${escapedFileName}\\\\]\\\\(${uploadText.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}\\\\)`, 'g');\n                const linkPattern = new RegExp(`\\\\[${escapedFileName}\\\\]\\\\(${uploadText.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}\\\\)`, 'g');\n                \n                // Bereinige die Beschreibung\n                const newDescription = description\n                    .replace(imagePattern, '')\n                    .replace(linkPattern, '')\n                    // Entferne berschssige Leerzeilen, die durch das Entfernen entstehen knnten\n                    .replace(/\\n{3,}/g, '\\n\\n');\n                \n                setDescription(newDescription);\n            }\n        }\n    };\n\n    const uploadTemporaryAttachments = async (taskId: number) => {\n        if (temporaryAttachments.length === 0) return;\n        \n        try {\n            setLoading(true);\n            \n            // Upload jeder temporren Datei\n            for (const attachment of temporaryAttachments) {\n                if (!attachment.file) continue;\n                \n                const formData = new FormData();\n                formData.append('file', attachment.file);\n                \n                await axiosInstance.post(\n                    API_ENDPOINTS.TASKS.ATTACHMENTS(taskId),\n                    formData,\n                    {\n                        headers: {\n                            'Content-Type': 'multipart/form-data',\n                        },\n                    }\n                );\n            }\n            \n            console.log(`${temporaryAttachments.length} Anhnge erfolgreich hochgeladen.`);\n        } catch (err) {\n            console.error('Fehler beim Hochladen der Anhnge:', err);\n            // Wir zeigen hier keinen Fehler, da der Task bereits erstellt wurde\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n        setLoading(true);\n\n        try {\n            // Validierung\n            if (!title || (!responsibleId && !roleId) || !branchId) {\n                setError(t('tasks.createTask.errors.fillAllFields'));\n                setLoading(false);\n                return;\n            }\n\n            if (responsibleId && roleId) {\n                setError(t('tasks.createTask.errors.chooseUserOrRole'));\n                setLoading(false);\n                return;\n            }\n\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                setLoading(false);\n                return;\n            }\n\n            // Validiere die IDs\n            const branch = Number(branchId);\n            const qualityControl = qualityControlId ? Number(qualityControlId) : null;\n            const responsible = responsibleId ? Number(responsibleId) : null;\n            const role = roleId ? Number(roleId) : null;\n\n            if ((responsibleId && isNaN(responsible!)) || \n                (roleId && isNaN(role!)) || \n                isNaN(branch) || \n                (qualityControlId && isNaN(qualityControl!))) {\n                setError(t('tasks.createTask.errors.invalidIds'));\n                setLoading(false);\n                return;\n            }\n\n            // Basisdaten fr die Anfrage vorbereiten\n            const taskData: any = {\n                title,\n                description,\n                status: 'open',\n                qualityControlId: qualityControl,\n                branchId: branch,\n                dueDate\n            };\n\n            // Nur ein Feld hinzufgen - entweder responsibleId oder roleId, aber nicht beide\n            if (assigneeType === 'user' && responsibleId) {\n                taskData.responsibleId = responsibleId;\n            } else if (assigneeType === 'role' && roleId) {\n                taskData.roleId = roleId;\n            }\n\n            const response = await axiosInstance.post(API_ENDPOINTS.TASKS.BASE, taskData);\n\n            const newTaskId = response.data.id;\n            \n            // Verknpfe Cerebro-Artikel, falls vorhanden\n            if (selectedArticles.length > 0) {\n                await Promise.all(\n                    selectedArticles.map(article => \n                        axiosInstance.post(API_ENDPOINTS.TASKS.LINK_CARTICLE(newTaskId, article.id))\n                    )\n                );\n            }\n            \n            // Lade temporre Anhnge hoch, falls vorhanden\n            await uploadTemporaryAttachments(newTaskId);\n            \n            console.log('Task erfolgreich erstellt:', response.data);\n            // bergebe den neuen Task an den Callback\n            onTaskCreated(response.data);\n            handleClose();\n        } catch (err) {\n            console.error('Fehler beim Erstellen des Tasks:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.error || axiosError.message || t('tasks.createTask.errors.createError'));\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleClose = () => {\n        setTitle('');\n        setDescription('');\n        setAssigneeType('user');\n        setResponsibleId('');\n        setRoleId('');\n        setQualityControlId('');\n        setBranchId('');\n        setDueDate('');\n        setError(null);\n        setSelectedArticles([]);\n        setTemporaryAttachments([]);\n        onClose();\n    };\n\n    const handleAddArticle = (article: CerebroArticle) => {\n        setSelectedArticles(prev => [...prev, article]);\n    };\n    \n    const handleRemoveArticle = (articleId: number) => {\n        setSelectedArticles(prev => prev.filter(a => a.id !== articleId));\n    };\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                \n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n                            <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                                {t('tasks.createTask.title')}\n                            </Dialog.Title>\n                            <button\n                                onClick={handleClose}\n                                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <TaskForm \n                            error={error}\n                            title={title}\n                            setTitle={setTitle}\n                            description={description}\n                            setDescription={setDescription}\n                            assigneeType={assigneeType}\n                            setAssigneeType={setAssigneeType}\n                            responsibleId={responsibleId}\n                            setResponsibleId={setResponsibleId}\n                            roleId={roleId}\n                            setRoleId={setRoleId}\n                            qualityControlId={qualityControlId}\n                            setQualityControlId={setQualityControlId}\n                            branchId={branchId}\n                            setBranchId={setBranchId}\n                            dueDate={dueDate}\n                            setDueDate={setDueDate}\n                            users={users}\n                            roles={roles}\n                            branches={branches}\n                            loading={loading}\n                            handleSubmit={handleSubmit}\n                            handleClose={handleClose}\n                            selectedArticles={selectedArticles}\n                            onArticleSelect={handleAddArticle}\n                            onArticleRemove={handleRemoveArticle}\n                            uploading={uploading}\n                            temporaryAttachments={temporaryAttachments}\n                            onFileUpload={handleFileUpload}\n                            onRemoveAttachment={handleRemoveTemporaryAttachment}\n                            textareaRef={textareaRef}\n                            fileInputRef={fileInputRef}\n                            handlePaste={handlePaste}\n                            handleDrop={handleDrop}\n                            handleDragOver={handleDragOver}\n                        />\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n    \n    // Fr Desktop (ab 640px) - Sidepane\n    // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {/* Hinweis: onClick entfernt, da Backdrop pointer-events: none hat, damit Hauptinhalt interaktiv bleibt */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                        {t('tasks.createTask.title')}\n                    </h2>\n                    <button\n                        onClick={handleClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    <TaskForm \n                        error={error}\n                        title={title}\n                        setTitle={setTitle}\n                        description={description}\n                        setDescription={setDescription}\n                        assigneeType={assigneeType}\n                        setAssigneeType={setAssigneeType}\n                        responsibleId={responsibleId}\n                        setResponsibleId={setResponsibleId}\n                        roleId={roleId}\n                        setRoleId={setRoleId}\n                        qualityControlId={qualityControlId}\n                        setQualityControlId={setQualityControlId}\n                        branchId={branchId}\n                        setBranchId={setBranchId}\n                        dueDate={dueDate}\n                        setDueDate={setDueDate}\n                        users={users}\n                        roles={roles}\n                        branches={branches}\n                        loading={loading}\n                        handleSubmit={handleSubmit}\n                        handleClose={handleClose}\n                        selectedArticles={selectedArticles}\n                        onArticleSelect={handleAddArticle}\n                        onArticleRemove={handleRemoveArticle}\n                        uploading={uploading}\n                        temporaryAttachments={temporaryAttachments}\n                        onFileUpload={handleFileUpload}\n                        onRemoveAttachment={handleRemoveTemporaryAttachment}\n                        textareaRef={textareaRef}\n                        fileInputRef={fileInputRef}\n                        handlePaste={handlePaste}\n                        handleDrop={handleDrop}\n                        handleDragOver={handleDragOver}\n                    />\n                </div>\n            </div>\n        </>\n    );\n};\n\n// Ausgelagerte Formular-Komponente, um Code-Duplizierung zu vermeiden\ninterface TaskFormProps {\n    error: string | null;\n    title: string;\n    setTitle: (value: string) => void;\n    description: string;\n    setDescription: (value: string) => void;\n    assigneeType: 'user' | 'role';\n    setAssigneeType: (value: 'user' | 'role') => void;\n    responsibleId: number | '';\n    setResponsibleId: (value: number | '') => void;\n    roleId: number | '';\n    setRoleId: (value: number | '') => void;\n    qualityControlId: number | '';\n    setQualityControlId: (value: number | '') => void;\n    branchId: number | '';\n    setBranchId: (value: number | '') => void;\n    dueDate: string;\n    setDueDate: (value: string) => void;\n    users: User[];\n    roles: Role[];\n    branches: Branch[];\n    loading: boolean;\n    handleSubmit: (e: React.FormEvent) => Promise<void>;\n    handleClose: () => void;\n    selectedArticles: CerebroArticle[];\n    onArticleSelect: (article: CerebroArticle) => void;\n    onArticleRemove: (articleId: number) => void;\n    uploading?: boolean;\n    temporaryAttachments?: TaskAttachment[];\n    onFileUpload?: (event: React.ChangeEvent<HTMLInputElement>) => Promise<void>;\n    onRemoveAttachment?: (index: number) => void;\n    textareaRef?: React.RefObject<HTMLTextAreaElement>;\n    fileInputRef?: React.RefObject<HTMLInputElement>;\n    handlePaste?: (event: React.ClipboardEvent) => Promise<void>;\n    handleDrop?: (event: React.DragEvent) => Promise<void>;\n    handleDragOver?: (event: React.DragEvent) => void;\n}\n\nconst TaskForm: React.FC<TaskFormProps> = ({\n    error,\n    title,\n    setTitle,\n    description,\n    setDescription,\n    assigneeType,\n    setAssigneeType,\n    responsibleId,\n    setResponsibleId,\n    roleId,\n    setRoleId,\n    qualityControlId,\n    setQualityControlId,\n    branchId,\n    setBranchId,\n    dueDate,\n    setDueDate,\n    users,\n    roles,\n    branches,\n    loading,\n    handleSubmit,\n    handleClose,\n    selectedArticles,\n    onArticleSelect,\n    onArticleRemove,\n    uploading = false,\n    temporaryAttachments = [],\n    onFileUpload,\n    onRemoveAttachment,\n    textareaRef,\n    fileInputRef,\n    handlePaste,\n    handleDrop,\n    handleDragOver,\n}) => {\n    const { t } = useTranslation();\n    const [activeTab, setActiveTab] = useState<'data' | 'cerebro'>('data');\n    \n    return (\n        <form onSubmit={handleSubmit} className=\"space-y-4\" noValidate>\n            {error && (\n                <div className=\"bg-red-100 dark:bg-red-900 border-l-4 border-red-500 dark:border-red-700 text-red-700 dark:text-red-300 p-4 mb-4\">\n                    <p>{error}</p>\n                </div>\n            )}\n\n            {/* Tabs Navigation */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700\">\n                <nav className=\"-mb-px flex space-x-4\" aria-label=\"Tabs\">\n                    <button\n                        type=\"button\"\n                        className={`${\n                            activeTab === 'data'\n                                ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:border-gray-600'\n                        } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                        onClick={() => setActiveTab('data')}\n                    >\n                        Daten\n                    </button>\n                    <button\n                        type=\"button\"\n                        className={`${\n                            activeTab === 'cerebro'\n                                ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:border-gray-600'\n                        } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                        onClick={() => setActiveTab('cerebro')}\n                    >\n                        Cerebro Artikel\n                    </button>\n                </nav>\n            </div>\n\n            {/* Data Tab Content */}\n            {activeTab === 'data' && (\n                <>\n                    <div>\n                        <label htmlFor=\"title\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.createTask.form.title')} *\n                        </label>\n                        <input\n                            type=\"text\"\n                            id=\"title\"\n                            value={title}\n                            onChange={(e) => setTitle(e.target.value)}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                            required\n                        />\n                    </div>\n\n                    <div className=\"space-y-4\">\n                        <div>\n                            <label htmlFor=\"description_sidepane\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                {t('tasks.createTask.form.description')}\n                            </label>\n                            <div className=\"relative\">\n                                <textarea\n                                    ref={textareaRef}\n                                    id=\"description_task_create\"\n                                    rows={6}\n                                    className=\"block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white sm:text-sm\"\n                                    value={description}\n                                    onChange={(e) => setDescription(e.target.value)}\n                                    onPaste={handlePaste}\n                                    onDrop={handleDrop}\n                                    onDragOver={handleDragOver}\n                                    placeholder={t('tasks.createTask.form.descriptionPlaceholder')}\n                                />\n                                {/* Heftklammer-Icon zum Hinzufgen von Dateien */}\n                                <div className=\"relative group absolute bottom-2 left-2\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={() => fileInputRef?.current?.click()}\n                                        className=\"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-400 focus:outline-none\"\n                                    >\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13\" />\n                                        </svg>\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                        {t('tasks.createTask.form.fileUpload')}\n                                    </div>\n                                </div>\n                                <input\n                                    ref={fileInputRef}\n                                    type=\"file\"\n                                    onChange={onFileUpload}\n                                    className=\"hidden\"\n                                />\n                                {uploading && (\n                                    <div className=\"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-800 bg-opacity-70 dark:bg-opacity-70\">\n                                        <span className=\"text-sm text-gray-500 dark:text-gray-400\">{t('tasks.createTask.form.uploading')}</span>\n                                    </div>\n                                )}\n                            </div>\n                            {/* Anzeige der temporren Anhnge direkt unter dem Textfeld */}\n                            {temporaryAttachments && temporaryAttachments.length > 0 && (\n                                <div className=\"mt-2\">\n                                    <ul className=\"flex flex-wrap gap-2\">\n                                        {temporaryAttachments.map((attachment, index) => (\n                                            <li key={index} className=\"inline-flex items-center bg-gray-100 dark:bg-gray-700 rounded-md px-2 py-1 relative group\">\n                                                <span className=\"text-sm font-medium text-gray-800 dark:text-gray-300\">\n                                                    {attachment.fileName}\n                                                </span>\n                                                <div className=\"flex ml-2\">\n                                                    <div className=\"relative group ml-1\">\n                                                        <button\n                                                            type=\"button\"\n                                                            onClick={() => onRemoveAttachment?.(index)}\n                                                            className=\"text-red-600 hover:text-red-900\"\n                                                        >\n                                                            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                                                            </svg>\n                                                        </button>\n                                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                            {t('tasks.createTask.form.remove')}\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                                {/* Tooltip fr Bildvorschau bei Bild-Dateien */}\n                                                {attachment.fileType.startsWith('image/') && attachment.file && (\n                                                    <div className=\"absolute z-10 bg-white dark:bg-gray-800 p-2 rounded-md shadow-lg -top-32 left-0 border border-gray-200 dark:border-gray-700 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none\">\n                                                        <img \n                                                            src={URL.createObjectURL(attachment.file)}\n                                                            alt={attachment.fileName}\n                                                            className=\"max-w-[200px] max-h-[150px] object-contain\"\n                                                        />\n                                                    </div>\n                                                )}\n                                            </li>\n                                        ))}\n                                    </ul>\n                                </div>\n                            )}\n                        </div>\n                    </div>\n\n                    <div className=\"space-y-2\">\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.createTask.form.responsibleFor')} *\n                        </label>\n                        <div className=\"flex space-x-4\">\n                            <label className=\"inline-flex items-center\">\n                                <input\n                                    type=\"radio\"\n                                    className=\"form-radio text-blue-600 dark:bg-gray-700 dark:border-gray-600\"\n                                    name=\"assigneeType\"\n                                    value=\"user\"\n                                    checked={assigneeType === 'user'}\n                                    onChange={() => {\n                                        setAssigneeType('user');\n                                        setRoleId('');\n                                    }}\n                                />\n                                <span className=\"ml-2 dark:text-gray-300\">{t('tasks.createTask.form.user')}</span>\n                            </label>\n                            <label className=\"inline-flex items-center\">\n                                <input\n                                    type=\"radio\"\n                                    className=\"form-radio text-blue-600 dark:bg-gray-700 dark:border-gray-600\"\n                                    name=\"assigneeType\"\n                                    value=\"role\"\n                                    checked={assigneeType === 'role'}\n                                    onChange={() => {\n                                        setAssigneeType('role');\n                                        setResponsibleId('');\n                                    }}\n                                />\n                                <span className=\"ml-2 dark:text-gray-300\">{t('tasks.createTask.form.role')}</span>\n                            </label>\n                        </div>\n                    </div>\n\n                    {assigneeType === 'user' ? (\n                        <div>\n                            <label htmlFor=\"responsible\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                {t('tasks.createTask.form.responsibleUser')} *\n                            </label>\n                            <select\n                                id=\"responsible\"\n                                value={responsibleId}\n                                onChange={(e) => setResponsibleId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                                required\n                            >\n                                <option value=\"\">{t('tasks.createTask.form.pleaseSelect')}</option>\n                                {Array.isArray(users) && users.map(user => (\n                                    <option key={user.id} value={user.id}>\n                                        {user.firstName} {user.lastName}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n                    ) : (\n                        <div>\n                            <label htmlFor=\"role\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                {t('tasks.createTask.form.responsibleRole')} *\n                            </label>\n                            <select\n                                id=\"role\"\n                                value={roleId}\n                                onChange={(e) => setRoleId(e.target.value ? Number(e.target.value) : '')}\n                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                                required\n                            >\n                                <option value=\"\">{t('tasks.createTask.form.pleaseSelect')}</option>\n                                {Array.isArray(roles) && roles.map(role => (\n                                    <option key={role.id} value={role.id}>\n                                        {role.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n                    )}\n\n                    <div>\n                        <label htmlFor=\"qualityControl\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.createTask.form.qualityControl')}\n                        </label>\n                        <select\n                            id=\"qualityControl\"\n                            value={qualityControlId}\n                            onChange={(e) => setQualityControlId(e.target.value ? Number(e.target.value) : '')}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                        >\n                            <option value=\"\">{t('tasks.createTask.form.noQualityControl')}</option>\n                            {Array.isArray(users) && users.map(user => (\n                                <option key={user.id} value={user.id}>\n                                    {user.firstName} {user.lastName}\n                                </option>\n                            ))}\n                        </select>\n                    </div>\n\n                    <div>\n                        <label htmlFor=\"branch\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.createTask.form.branch')} *\n                        </label>\n                        <select\n                            id=\"branch\"\n                            value={branchId}\n                            onChange={(e) => setBranchId(Number(e.target.value))}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                            required\n                        >\n                            <option value=\"\">{t('common.pleaseSelect')}</option>\n                            {Array.isArray(branches) && branches.map(branch => (\n                                <option key={branch.id} value={branch.id}>\n                                    {branch.name}\n                                </option>\n                            ))}\n                        </select>\n                    </div>\n\n                    <div>\n                        <label htmlFor=\"dueDate\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.createTask.form.dueDate')}\n                        </label>\n                        <input\n                            type=\"date\"\n                            id=\"dueDate\"\n                            value={dueDate}\n                            onChange={(e) => setDueDate(e.target.value)}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                        />\n                    </div>\n                </>\n            )}\n\n            {/* Cerebro Articles Tab Content */}\n            {activeTab === 'cerebro' && (\n                <div>\n                    <div className=\"mb-4\">\n                        <h3 className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">Verknpfte Cerebro-Artikel</h3>\n                        \n                        {selectedArticles.length > 0 ? (\n                            <ul className=\"mt-2 space-y-2\">\n                                {selectedArticles.map(article => (\n                                    <li key={article.id} className=\"flex items-center justify-between bg-gray-50 dark:bg-gray-700 p-2 rounded\">\n                                        <span className=\"dark:text-gray-300\">{article.title}</span>\n                                        <button\n                                            type=\"button\"\n                                            onClick={() => onArticleRemove(article.id)}\n                                            className=\"text-red-600 hover:text-red-800\"\n                                        >\n                                            {t('tasks.createTask.form.remove')}\n                                        </button>\n                                    </li>\n                                ))}\n                            </ul>\n                        ) : (\n                            <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">{t('tasks.createTask.form.noArticlesLinked')}</p>\n                        )}\n                    </div>\n                    \n                    <CerebroArticleSelector\n                        onArticleSelected={onArticleSelect}\n                        excludeArticleIds={selectedArticles.map(a => a.id)}\n                        selectedArticles={selectedArticles}\n                        onArticleRemove={onArticleRemove}\n                    />\n                </div>\n            )}\n\n            <div className=\"flex justify-end gap-3 pt-4\">\n                <div className=\"relative group\">\n                    <button\n                        type=\"button\"\n                        onClick={handleClose}\n                        className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                    >\n                        <XMarkIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('tasks.createTask.form.cancel')}\n                    </div>\n                </div>\n                <div className=\"relative group\">\n                    <button\n                        type=\"submit\"\n                        className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n                        disabled={loading}\n                    >\n                        {loading ? (\n                            <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                        ) : (\n                            <CheckIcon className=\"h-5 w-5\" />\n                        )}\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {loading ? t('tasks.createTask.form.creating') : t('tasks.createTask.form.create')}\n                    </div>\n                </div>\n            </div>\n        </form>\n    );\n};\n\nexport default CreateTaskModal; ","import React from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { ClipboardDocumentIcon } from '@heroicons/react/24/outline';\r\nimport useMessage from '../hooks/useMessage.ts';\r\n\r\ninterface Task {\r\n  id: number;\r\n  title: string;\r\n  description: string | null;\r\n  [key: string]: any;\r\n}\r\n\r\ninterface TaskDataBoxProps {\r\n  task: Task;\r\n}\r\n\r\nconst TaskDataBox: React.FC<TaskDataBoxProps> = ({ task }) => {\r\n  const { t } = useTranslation();\r\n  const { showMessage } = useMessage();\r\n\r\n  // Extrahiere automatisch generierte Daten aus task.description oder task.metadata\r\n  // Prfe ob Task ein Lebenszyklus-Task ist\r\n  const isLifecycleTask = task.title?.includes('ARL') || \r\n                          task.title?.includes('EPS') || \r\n                          task.title?.includes('Pension') || \r\n                          task.title?.includes('Caja') ||\r\n                          task.description?.includes('lifecycle');\r\n\r\n  // Versuche Daten aus description zu extrahieren (JSON-Format)\r\n  let autoGeneratedData: Record<string, any> = {};\r\n  \r\n  if (task.description) {\r\n    try {\r\n      // Versuche JSON aus description zu extrahieren\r\n      const jsonMatch = task.description.match(/\\{[\\s\\S]*\\}/);\r\n      if (jsonMatch) {\r\n        autoGeneratedData = JSON.parse(jsonMatch[0]);\r\n      }\r\n    } catch (e) {\r\n      // Kein JSON gefunden, versuche strukturierte Daten zu extrahieren\r\n      const lines = task.description.split('\\n');\r\n      lines.forEach(line => {\r\n        const match = line.match(/([^:]+):\\s*(.+)/);\r\n        if (match) {\r\n          const key = match[1].trim();\r\n          const value = match[2].trim();\r\n          autoGeneratedData[key] = value;\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  // Wenn keine Daten gefunden wurden und es ein Lebenszyklus-Task ist, zeige Standard-Daten\r\n  if (Object.keys(autoGeneratedData).length === 0 && isLifecycleTask) {\r\n    autoGeneratedData = {\r\n      taskType: task.title,\r\n      description: task.description || t('lifecycle.noDataAvailable')\r\n    };\r\n  }\r\n\r\n  const handleCopyData = async () => {\r\n    try {\r\n      const dataString = JSON.stringify(autoGeneratedData, null, 2);\r\n      await navigator.clipboard.writeText(dataString);\r\n      showMessage(t('lifecycle.dataCopied', { defaultValue: 'Daten in Zwischenablage kopiert' }), 'success');\r\n    } catch (error) {\r\n      console.error('Fehler beim Kopieren:', error);\r\n      showMessage(t('lifecycle.copyError', { defaultValue: 'Fehler beim Kopieren' }), 'error');\r\n    }\r\n  };\r\n\r\n  // Zeige Box nur wenn es ein Lebenszyklus-Task ist oder Daten vorhanden sind\r\n  if (!isLifecycleTask && Object.keys(autoGeneratedData).length === 0) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 mb-4\">\r\n      <div className=\"flex items-center justify-between mb-4\">\r\n        <h3 className=\"text-lg font-semibold flex items-center dark:text-white\">\r\n          <ClipboardDocumentIcon className=\"h-5 w-5 mr-2\" />\r\n          {t('lifecycle.autoGeneratedData', { defaultValue: 'Automatisch generierte Daten' })}\r\n        </h3>\r\n        <button\r\n          onClick={handleCopyData}\r\n          className=\"text-blue-600 dark:text-blue-400 hover:underline text-sm\"\r\n        >\r\n          {t('lifecycle.copyData', { defaultValue: 'Daten kopieren' })}\r\n        </button>\r\n      </div>\r\n      <div className=\"space-y-2\">\r\n        {Object.keys(autoGeneratedData).length > 0 ? (\r\n          Object.entries(autoGeneratedData).map(([key, value]) => (\r\n            <div key={key} className=\"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2\">\r\n              <span className=\"font-medium w-full sm:w-1/3 dark:text-gray-300\">\r\n                {t(`lifecycle.${key}`) || key}:\r\n              </span>\r\n              <span className=\"text-gray-600 dark:text-gray-400 flex-1 break-words\">\r\n                {typeof value === 'object' ? JSON.stringify(value, null, 2) : String(value)}\r\n              </span>\r\n            </div>\r\n          ))\r\n        ) : (\r\n          <div className=\"text-gray-500 dark:text-gray-400 text-sm\">\r\n            {t('lifecycle.noDataAvailable', { defaultValue: 'Keine automatisch generierten Daten verfgbar' })}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TaskDataBox;\r\n\r\n","import React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { EnvelopeIcon, PaperAirplaneIcon, ArrowPathIcon, CheckIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface Task {\n  id: number;\n  title: string;\n  description: string | null;\n  [key: string]: any;\n}\n\ninterface EmailTemplateBoxProps {\n  task: Task;\n}\n\nconst EmailTemplateBox: React.FC<EmailTemplateBoxProps> = ({ task }) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const [emailTemplate, setEmailTemplate] = useState<string>('');\n  const [loading, setLoading] = useState(false);\n  const [emailSent, setEmailSent] = useState(false);\n  const [generating, setGenerating] = useState(false);\n\n  // Prfe ob Task ein Lebenszyklus-Task ist\n  const isLifecycleTask = task.title?.includes('ARL') || \n                          task.title?.includes('EPS') || \n                          task.title?.includes('Pension') || \n                          task.title?.includes('Caja') ||\n                          task.description?.includes('lifecycle');\n\n  // Zeige Box nur wenn es ein Lebenszyklus-Task ist\n  if (!isLifecycleTask) {\n    return null;\n  }\n\n  const handleGenerateTemplate = async () => {\n    setGenerating(true);\n    try {\n      // API-Call zum Generieren der Email-Vorlage\n      // TODO: Endpoint implementieren wenn Backend bereit ist\n      // const response = await axiosInstance.post(`/api/tasks/${task.id}/generate-email`);\n      // setEmailTemplate(response.data.template);\n      \n      // Temporr: Generiere einfache Vorlage basierend auf Task-Daten\n      const template = `Sehr geehrte Damen und Herren,\n\nim Rahmen des Onboarding-Prozesses bentigen wir die Anmeldung fr ${task.title}.\n\nBitte senden Sie uns die erforderlichen Informationen zurck.\n\nMit freundlichen Gren\nIhr Team`;\n      \n      setEmailTemplate(template);\n      showMessage(t('lifecycle.templateGenerated', { defaultValue: 'Email-Vorlage generiert' }), 'success');\n    } catch (error: any) {\n      console.error('Fehler beim Generieren der Email-Vorlage:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.templateGenerationError', { defaultValue: 'Fehler beim Generieren der Vorlage' }),\n        'error'\n      );\n    } finally {\n      setGenerating(false);\n    }\n  };\n\n  const handleSendEmail = async () => {\n    if (!emailTemplate.trim()) {\n      showMessage(t('lifecycle.templateRequired', { defaultValue: 'Bitte generieren Sie zuerst eine Vorlage' }), 'warning');\n      return;\n    }\n\n    setLoading(true);\n    try {\n      // API-Call zum Versenden der Email\n      // TODO: Endpoint implementieren wenn Backend bereit ist\n      // await axiosInstance.post(`/api/tasks/${task.id}/send-email`, {\n      //   template: emailTemplate\n      // });\n      \n      // Temporr: Simuliere Versand\n      await new Promise(resolve => setTimeout(resolve, 1000));\n      \n      setEmailSent(true);\n      showMessage(t('lifecycle.emailSent', { defaultValue: 'Email erfolgreich versendet' }), 'success');\n    } catch (error: any) {\n      console.error('Fehler beim Versenden der Email:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.emailSendError', { defaultValue: 'Fehler beim Versenden der Email' }),\n        'error'\n      );\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 mb-4\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <h3 className=\"text-lg font-semibold flex items-center dark:text-white\">\n          <EnvelopeIcon className=\"h-5 w-5 mr-2\" />\n          {t('lifecycle.emailTemplate', { defaultValue: 'Email-Vorlage' })}\n        </h3>\n        <button\n          onClick={handleGenerateTemplate}\n          disabled={generating}\n          className=\"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center text-sm\"\n        >\n          {generating ? (\n            <>\n              <ArrowPathIcon className=\"h-4 w-4 mr-2 animate-spin\" />\n              {t('common.generating', { defaultValue: 'Generiere...' })}\n            </>\n          ) : (\n            t('lifecycle.generateTemplate', { defaultValue: 'Vorlage generieren' })\n          )}\n        </button>\n      </div>\n      \n      {emailTemplate && (\n        <div className=\"space-y-4\">\n          <textarea\n            value={emailTemplate}\n            onChange={(e) => {\n              setEmailTemplate(e.target.value);\n              setEmailSent(false);\n            }}\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            rows={10}\n            placeholder={t('lifecycle.templatePlaceholder', { defaultValue: 'Email-Vorlage wird hier angezeigt...' })}\n          />\n          <div className=\"flex justify-end\">\n            <button\n              onClick={handleSendEmail}\n              disabled={loading || emailSent}\n              className=\"p-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n              title={loading ? t('common.sending', { defaultValue: 'Sende...' }) : emailSent ? t('lifecycle.emailSent', { defaultValue: 'Versendet' }) : t('lifecycle.sendEmail', { defaultValue: 'Email versenden' })}\n            >\n              {loading ? (\n                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n              ) : emailSent ? (\n                <CheckIcon className=\"h-5 w-5\" />\n              ) : (\n                <PaperAirplaneIcon className=\"h-5 w-5\" />\n              )}\n            </button>\n          </div>\n        </div>\n      )}\n      \n      {!emailTemplate && (\n        <div className=\"text-gray-500 dark:text-gray-400 text-sm text-center py-4\">\n          {t('lifecycle.noTemplate', { defaultValue: 'Klicken Sie auf \"Vorlage generieren\" um eine Email-Vorlage zu erstellen' })}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default EmailTemplateBox;\n\n","import React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport useMessage from '../hooks/useMessage.ts';\n\ninterface Task {\n  id: number;\n  title: string;\n  description: string | null;\n  responsibleId: number | null;\n  [key: string]: any;\n}\n\ninterface SocialSecurityCompletionBoxProps {\n  task: Task;\n  onComplete?: () => void;\n}\n\nconst SocialSecurityCompletionBox: React.FC<SocialSecurityCompletionBoxProps> = ({\n  task,\n  onComplete\n}) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const [formData, setFormData] = useState({\n    registrationNumber: '',\n    provider: '',\n    registrationDate: '',\n    notes: ''\n  });\n  const [loading, setLoading] = useState(false);\n\n  // Prfe ob Task ein Lebenszyklus-Task ist\n  const isLifecycleTask = task.title?.includes('ARL') || \n                          task.title?.includes('EPS') || \n                          task.title?.includes('Pension') || \n                          task.title?.includes('Caja') ||\n                          task.description?.includes('lifecycle');\n\n  // Bestimme Typ der Sozialversicherung aus Task-Titel\n  const getSocialSecurityType = (): string | null => {\n    if (task.title?.includes('ARL')) return 'arl';\n    if (task.title?.includes('EPS')) return 'eps';\n    if (task.title?.includes('Pension')) return 'pension';\n    if (task.title?.includes('Caja')) return 'caja';\n    return null;\n  };\n\n  // Zeige Box nur wenn es ein Lebenszyklus-Task ist\n  if (!isLifecycleTask) {\n    return null;\n  }\n\n  const socialSecurityType = getSocialSecurityType();\n\n  // Extrahiere userId aus task (muss aus task.responsibleId oder task.description kommen)\n  // TODO: Backend sollte userId in task-Metadaten bereitstellen\n  const extractUserId = (): number | null => {\n    // Versuche userId aus description zu extrahieren\n    if (task.description) {\n      const userIdMatch = task.description.match(/userId[:\\s]+(\\d+)/i);\n      if (userIdMatch) {\n        return parseInt(userIdMatch[1], 10);\n      }\n    }\n    // Fallback: verwende responsibleId (wenn es der User selbst ist)\n    return task.responsibleId;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n    \n    try {\n      const userId = extractUserId();\n      if (!userId || !socialSecurityType) {\n        showMessage(\n          t('lifecycle.missingData', { defaultValue: 'Benutzer-ID oder Sozialversicherungs-Typ fehlt' }),\n          'error'\n        );\n        return;\n      }\n\n      // API-Call zum Abschlieen der Anmeldung\n      await axiosInstance.put(\n        API_ENDPOINTS.LIFECYCLE.SOCIAL_SECURITY(userId, socialSecurityType),\n        {\n          status: 'registered',\n          registrationNumber: formData.registrationNumber,\n          provider: formData.provider,\n          registrationDate: formData.registrationDate,\n          notes: formData.notes,\n          completedAt: new Date().toISOString()\n        }\n      );\n\n      showMessage(\n        t('lifecycle.registrationCompleted', { defaultValue: 'Anmeldung erfolgreich abgeschlossen' }),\n        'success'\n      );\n\n      // Formular zurcksetzen\n      setFormData({\n        registrationNumber: '',\n        provider: '',\n        registrationDate: '',\n        notes: ''\n      });\n\n      if (onComplete) {\n        onComplete();\n      }\n    } catch (error: any) {\n      console.error('Fehler beim Abschlieen der Anmeldung:', error);\n      showMessage(\n        error.response?.data?.message || t('lifecycle.registrationError', { defaultValue: 'Fehler beim Abschlieen der Anmeldung' }),\n        'error'\n      );\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 mb-4\">\n      <h3 className=\"text-lg font-semibold mb-4 dark:text-white\">\n        {t('lifecycle.completeRegistration', { defaultValue: 'Anmeldung abschlieen' })}\n      </h3>\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n            {t('lifecycle.registrationNumber', { defaultValue: 'Registrierungsnummer' })} *\n          </label>\n          <input\n            type=\"text\"\n            value={formData.registrationNumber}\n            onChange={(e) => setFormData({ ...formData, registrationNumber: e.target.value })}\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            required\n            placeholder={t('lifecycle.registrationNumberPlaceholder', { defaultValue: 'z.B. 123456789' })}\n          />\n        </div>\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n            {t('lifecycle.provider', { defaultValue: 'Anbieter' })} *\n          </label>\n          <input\n            type=\"text\"\n            value={formData.provider}\n            onChange={(e) => setFormData({ ...formData, provider: e.target.value })}\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            required\n            placeholder={t('lifecycle.providerPlaceholder', { defaultValue: 'z.B. ARL Sura, EPS Sanitas' })}\n          />\n        </div>\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n            {t('lifecycle.registrationDate', { defaultValue: 'Anmeldedatum' })} *\n          </label>\n          <input\n            type=\"date\"\n            value={formData.registrationDate}\n            onChange={(e) => setFormData({ ...formData, registrationDate: e.target.value })}\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            required\n          />\n        </div>\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n            {t('lifecycle.notes', { defaultValue: 'Notizen' })}\n          </label>\n          <textarea\n            value={formData.notes}\n            onChange={(e) => setFormData({ ...formData, notes: e.target.value })}\n            className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            rows={3}\n            placeholder={t('lifecycle.notesPlaceholder', { defaultValue: 'Zustzliche Informationen...' })}\n          />\n        </div>\n        <div className=\"flex justify-end\">\n          <button\n            type=\"submit\"\n            disabled={loading}\n            className=\"p-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n            title={loading ? t('common.saving', { defaultValue: 'Speichere...' }) : t('lifecycle.complete', { defaultValue: 'Abschlieen' })}\n          >\n            {loading ? (\n              <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n            ) : (\n              <CheckIcon className=\"h-5 w-5\" />\n            )}\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};\n\nexport default SocialSecurityCompletionBox;\n\n","import React, { useEffect, useState, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS, getTaskAttachmentUrl } from '../config/api.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport CerebroArticleSelector from './CerebroArticleSelector.tsx';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, TrashIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport MarkdownPreview from './MarkdownPreview.tsx';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\nimport TaskDataBox from './TaskDataBox.tsx';\nimport EmailTemplateBox from './EmailTemplateBox.tsx';\nimport SocialSecurityCompletionBox from './SocialSecurityCompletionBox.tsx';\n\ninterface User {\n    id: number;\n    firstName: string;\n    lastName: string;\n}\n\ninterface Role {\n    id: number;\n    name: string;\n}\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface TaskAttachment {\n    id: number;\n    fileName: string;\n    fileType: string;\n    fileSize: number;\n    filePath: string;\n    uploadedAt: string;\n    file?: File;\n}\n\ninterface CerebroArticle {\n    id: number;\n    title: string;\n    slug: string;\n    content?: string;\n}\n\ninterface Task {\n    id: number;\n    title: string;\n    description: string | null;\n    status: 'open' | 'in_progress' | 'improval' | 'quality_control' | 'done';\n    responsible: {\n        id: number;\n        firstName: string;\n        lastName: string;\n    } | null;\n    responsibleId: number | null;\n    role: {\n        id: number;\n        name: string;\n    } | null;\n    roleId: number | null;\n    qualityControl: {\n        id: number;\n        firstName: string;\n        lastName: string;\n    } | null;\n    branch: {\n        id: number;\n        name: string;\n    };\n    dueDate: string | null;\n    requestId: number | null;\n    attachments?: TaskAttachment[];\n}\n\ninterface EditTaskModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n    onTaskUpdated: (updatedTask: Task) => void;\n    task: Task;\n}\n\nconst EditTaskModal: React.FC<EditTaskModalProps> = ({ isOpen, onClose, onTaskUpdated, task }) => {\n    const { t } = useTranslation();\n    const { hasPermission } = usePermissions();\n    const { user } = useAuth();\n    const { openSidepane, closeSidepane } = useSidepane();\n    const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n    \n    // Entferne Bild-Markdown-Links aus der Beschreibung (fr Textarea-Anzeige)\n    const removeImageMarkdown = (text: string): string => {\n        if (!text) return '';\n        // Entferne alle Bild-Markdown-Links: ![alt](url)\n        return text.replace(/!\\[([^\\]]*)\\]\\([^)]+\\)/g, '').trim();\n    };\n    \n    const [title, setTitle] = useState(task.title || '');\n    const [description, setDescription] = useState(removeImageMarkdown(task.description || ''));\n    // Speichere die originale Beschreibung (mit Bildern) fr das Speichern\n    const originalDescription = task.description || '';\n    const [status, setStatus] = useState(task.status || 'open');\n    const [assigneeType, setAssigneeType] = useState<'user' | 'role'>(task.roleId ? 'role' : 'user');\n    const [responsibleId, setResponsibleId] = useState<number | null>(task.responsibleId || null);\n    const [roleId, setRoleId] = useState<number | null>(task.roleId || null);\n    const [qualityControlId, setQualityControlId] = useState<number | null>(task.qualityControl?.id || null);\n    const [branchId, setBranchId] = useState<number>(task.branch?.id || 0);\n    const [attachments, setAttachments] = useState<TaskAttachment[]>(task.attachments || []);\n    const [temporaryAttachments, setTemporaryAttachments] = useState<TaskAttachment[]>([]);\n    const [uploading, setUploading] = useState(false);\n    // Liste der whrend der Bearbeitung hochgeladenen Attachments (fr Cleanup bei Abbrechen)\n    const [uploadedDuringEdit, setUploadedDuringEdit] = useState<number[]>([]);\n    const fileInputRef = useRef<HTMLInputElement>(null);\n    const textareaRef = useRef<HTMLTextAreaElement>(null);\n\n    // Formatiere das Datum im Format YYYY-MM-DD fr das HTML-Datumseingabefeld\n    const formatDate = (dateString: string | null): string | null => {\n        if (!dateString) return null;\n        \n        // Versuche das Datum zu parsen\n        const date = new Date(dateString);\n        if (isNaN(date.getTime())) return null; // Ungltiges Datum\n        \n        // Formatiere als YYYY-MM-DD\n        return date.toISOString().split('T')[0];\n    };\n\n    const [dueDate, setDueDate] = useState<string | null>(formatDate(task.dueDate));\n    const [users, setUsers] = useState<User[]>([]);\n    const [roles, setRoles] = useState<Role[]>([]);\n    const [branches, setBranches] = useState<Branch[]>([]);\n    const [error, setError] = useState<string | null>(null);\n    const [loading, setLoading] = useState(false);\n    const [confirmDelete, setConfirmDelete] = useState(false);\n    const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n    const [linkedArticles, setLinkedArticles] = useState<CerebroArticle[]>([]);\n    const [activeTab, setActiveTab] = useState<'data' | 'cerebro'>('data');\n\n    const canDeleteTask = hasPermission('tasks', 'both', 'table');\n\n    // Responsive Design: berwache Fensterbreite\n    useEffect(() => {\n        const handleResize = () => {\n            setIsMobile(window.innerWidth < 640);\n            setIsLargeScreen(window.innerWidth > 1070);\n        };\n        window.addEventListener('resize', handleResize);\n        return () => window.removeEventListener('resize', handleResize);\n    }, []);\n\n    // Cleanup: Lsche hochgeladene Attachments wenn Modal ohne Speichern geschlossen wird\n    useEffect(() => {\n        if (!isOpen && uploadedDuringEdit.length > 0) {\n            // Modal wurde geschlossen - lsche alle whrend der Bearbeitung hochgeladenen Attachments\n            const cleanup = async () => {\n                for (const attachmentId of uploadedDuringEdit) {\n                    try {\n                        await axiosInstance.delete(API_ENDPOINTS.TASKS.ATTACHMENT(task.id, attachmentId));\n                        console.log(`Task Attachment ${attachmentId} gelscht (Modal ohne Speichern geschlossen)`);\n                    } catch (err) {\n                        console.error(`Fehler beim Lschen von Task Attachment ${attachmentId}:`, err);\n                    }\n                }\n                setUploadedDuringEdit([]);\n            };\n            cleanup();\n        }\n    }, [isOpen, uploadedDuringEdit, task.id]);\n\n    // Sidepane-Status verwalten\n    useEffect(() => {\n        if (isOpen) {\n            openSidepane();\n        } else {\n            closeSidepane();\n        }\n        \n        return () => {\n            closeSidepane();\n        };\n    }, [isOpen, openSidepane, closeSidepane]);\n\n    useEffect(() => {\n        if (isOpen) {\n            fetchUsers();\n            fetchRoles();\n            fetchBranches();\n            fetchLinkedArticles();\n            fetchAttachments();\n        }\n    }, [isOpen, task.id]);\n\n    const fetchUsers = async () => {\n        try {\n            setError(null);\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                return;\n            }\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.USERS.DROPDOWN);\n            setUsers(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der Benutzer:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            if (axiosError.code === 'ERR_NETWORK') {\n                setError(t('tasks.editTask.errors.connectionError'));\n            } else {\n                setError(`${t('tasks.editTask.errors.loadUsersError')}: ${axiosError.response?.data?.message || axiosError.message}`);\n            }\n        }\n    };\n\n    const fetchRoles = async () => {\n        try {\n            setError(null);\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                return;\n            }\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.ROLES.BASE);\n            setRoles(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der Rollen:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            if (axiosError.code === 'ERR_NETWORK') {\n                setError(t('tasks.editTask.errors.connectionError'));\n            } else {\n                setError(`${t('tasks.editTask.errors.loadRolesError')}: ${axiosError.response?.data?.message || axiosError.message}`);\n            }\n        }\n    };\n\n    const fetchBranches = async () => {\n        try {\n            setError(null);\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                return;\n            }\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE);\n            setBranches(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der Niederlassungen:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            if (axiosError.code === 'ERR_NETWORK') {\n                setError(t('tasks.editTask.errors.connectionError'));\n            } else {\n                setError(`${t('tasks.editTask.errors.loadBranchesError')}: ${axiosError.response?.data?.message || axiosError.message}`);\n            }\n        }\n    };\n\n    const fetchLinkedArticles = async () => {\n        try {\n            setError(null);\n            const response = await axiosInstance.get(API_ENDPOINTS.TASKS.CARTICLES(task.id));\n            setLinkedArticles(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der verknpften Artikel:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        }\n    };\n\n    const fetchAttachments = async () => {\n        try {\n            setError(null);\n            const response = await axiosInstance.get(API_ENDPOINTS.TASKS.ATTACHMENTS(task.id));\n            setAttachments(response.data || []);\n        } catch (err) {\n            console.error('Fehler beim Laden der Anhnge:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n            setAttachments([]);\n        }\n    };\n\n    const handlePaste = async (event: React.ClipboardEvent) => {\n        const items = event.clipboardData.items;\n        \n        for (let i = 0; i < items.length; i++) {\n            const item = items[i];\n            \n            // Prfen, ob das eingefgte Element ein Bild ist\n            if (item.type.indexOf('image') === 0) {\n                event.preventDefault(); // Standardeingabe verhindern\n                \n                const file = item.getAsFile();\n                if (file) {\n                    await uploadFileAndInsertLink(file);\n                }\n                return;\n            }\n        }\n    };\n\n    const handleDrop = async (event: React.DragEvent) => {\n        event.preventDefault();\n        event.stopPropagation();\n        \n        if (event.dataTransfer.files && event.dataTransfer.files.length > 0) {\n            const file = event.dataTransfer.files[0];\n            await uploadFileAndInsertLink(file);\n        }\n    };\n\n    const handleDragOver = (event: React.DragEvent) => {\n        event.preventDefault();\n        event.stopPropagation();\n    };\n\n    const uploadFileAndInsertLink = async (file: File) => {\n        setUploading(true);\n        setError(null);\n\n        try {\n            const formData = new FormData();\n            formData.append('file', file);\n\n            const response = await axiosInstance.post(\n                API_ENDPOINTS.TASKS.ATTACHMENTS(task.id),\n                formData,\n                {\n                    headers: {\n                        'Content-Type': 'multipart/form-data',\n                    },\n                }\n            );\n\n            const newAttachment = response.data;\n            setAttachments([...attachments, newAttachment]);\n            // Merke diese Attachment-ID fr mgliches Cleanup\n            setUploadedDuringEdit(prev => [...prev, newAttachment.id]);\n\n            // Fr Bilder: KEIN Markdown-Link ins Textarea einfgen (wird beim Speichern automatisch hinzugefgt)\n            // Fr andere Dateien: Link ins Textarea einfgen\n            if (!newAttachment.fileType.startsWith('image/')) {\n                const insertText = `\\n[${newAttachment.fileName}](${getTaskAttachmentUrl(task.id, newAttachment.id)})\\n`;\n                \n                // Fge den Link an der aktuellen Cursorposition ein\n                if (textareaRef.current) {\n                    const cursorPos = textareaRef.current.selectionStart;\n                    const textBefore = description.substring(0, cursorPos);\n                    const textAfter = description.substring(cursorPos);\n                    \n                    setDescription(textBefore + insertText + textAfter);\n                    \n                    // Setze den Cursor hinter den eingefgten Link\n                    setTimeout(() => {\n                        if (textareaRef.current) {\n                            const newPos = cursorPos + insertText.length;\n                            textareaRef.current.selectionStart = newPos;\n                            textareaRef.current.selectionEnd = newPos;\n                            textareaRef.current.focus();\n                        }\n                    }, 0);\n                } else {\n                    setDescription(description + insertText);\n                }\n            }\n        } catch (err) {\n            console.error('Fehler beim Verarbeiten der Datei:', err);\n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        } finally {\n            setUploading(false);\n        }\n    };\n\n    const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\n        const files = event.target.files;\n        if (!files || files.length === 0) return;\n\n        const file = files[0];\n        await uploadFileAndInsertLink(file);\n        \n        // Zurcksetzen des Datei-Inputs\n        if (fileInputRef.current) {\n            fileInputRef.current.value = '';\n        }\n    };\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        setError(null);\n        setLoading(true);\n\n        try {\n            // Validierung\n            if (!title || !status || !branchId) {\n                setError(t('tasks.editTask.errors.fillAllFields'));\n                setLoading(false);\n                return;\n            }\n\n            // berprfen, ob entweder Benutzer oder Rolle ausgewhlt wurde\n            if (assigneeType === 'user' && !responsibleId) {\n                setError(t('tasks.editTask.form.chooseUser'));\n                setLoading(false);\n                return;\n            }\n            \n            if (assigneeType === 'role' && !roleId) {\n                setError(t('tasks.editTask.form.chooseRole'));\n                setLoading(false);\n                return;\n            }\n\n            // Verwende description (vom Textarea) als Basis\n            // Fge Markdown-Links fr Bilder automatisch hinzu (falls noch nicht vorhanden)\n            let finalDescription = description || ''; // WICHTIG: Verwende description als Basis, nicht originalDescription\n            const imageAttachments = attachments.filter(att => att.fileType?.startsWith('image/') && att.id);\n            \n            // Extrahiere bereits vorhandene Bilder aus originalDescription (falls vorhanden)\n            const existingImagePattern = /!\\[([^\\]]*)\\]\\([^)]+\\)/g;\n            const existingImages: string[] = [];\n            let match;\n            if (originalDescription) {\n                while ((match = existingImagePattern.exec(originalDescription)) !== null) {\n                    existingImages.push(match[0]);\n                }\n            }\n            \n            // Fge alle Bilder hinzu (sowohl neue als auch bereits vorhandene)\n            for (const attachment of imageAttachments) {\n                const imageUrl = getTaskAttachmentUrl(task.id, attachment.id!);\n                const imageMarkdown = `![${attachment.fileName}](${imageUrl})`;\n                \n                // Prfe, ob dieser Bild-Link bereits in der Beschreibung vorhanden ist\n                const escapedFileName = attachment.fileName.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n                const imagePattern = new RegExp(`!\\\\[${escapedFileName}\\\\]\\\\([^)]+\\\\)`, 'g');\n                \n                if (!imagePattern.test(finalDescription)) {\n                    // Bild-Link ist noch nicht in der Beschreibung, fge ihn hinzu\n                    finalDescription = finalDescription ? `${finalDescription}\\n${imageMarkdown}` : imageMarkdown;\n                }\n            }\n            \n            // Fge auch bereits vorhandene Bilder hinzu, die nicht in attachments sind (z.B. von anderen Quellen)\n            for (const existingImage of existingImages) {\n                if (!finalDescription.includes(existingImage)) {\n                    finalDescription = finalDescription ? `${finalDescription}\\n${existingImage}` : existingImage;\n                }\n            }\n\n            // Basis-Daten fr die Anfrage\n            const taskData: any = {\n                title,\n                description: finalDescription,\n                status,\n                qualityControlId,\n                branchId,\n                dueDate\n            };\n\n            // Entweder responsibleId oder roleId hinzufgen, nicht beides\n            if (assigneeType === 'user') {\n                taskData.responsibleId = responsibleId;\n                taskData.roleId = null; // Rolle explizit auf null setzen, um sie zu entfernen\n            } else if (assigneeType === 'role') {\n                taskData.roleId = roleId;\n                taskData.responsibleId = null; // Benutzer explizit auf null setzen, um ihn zu entfernen\n            }\n\n            const response = await axiosInstance.put(`${API_ENDPOINTS.TASKS.BASE}/${task.id}`, taskData);\n\n            console.log('Task aktualisiert:', response.data);\n            \n            // Hole den aktualisierten Task vom Server (inkl. Attachments)\n            const updatedTaskResponse = await axiosInstance.get(API_ENDPOINTS.TASKS.BY_ID(task.id));\n            \n            // Attachments sind bereits in der Response enthalten\n            // URL-Generierung fr Attachments hinzufgen\n            if (updatedTaskResponse.data.attachments) {\n                updatedTaskResponse.data.attachments = updatedTaskResponse.data.attachments.map((att: any) => ({\n                    id: att.id,\n                    fileName: att.fileName,\n                    fileType: att.fileType,\n                    fileSize: att.fileSize,\n                    filePath: att.filePath,\n                    uploadedAt: att.uploadedAt,\n                    url: getTaskAttachmentUrl(task.id, att.id)\n                }));\n            } else {\n                updatedTaskResponse.data.attachments = [];\n            }\n            \n            // bergebe den aktualisierten Task an den Callback\n            // Reset uploadedDuringEdit da erfolgreich gespeichert\n            setUploadedDuringEdit([]);\n            onTaskUpdated(updatedTaskResponse.data);\n            onClose();\n        } catch (err) {\n            console.error('Fehler beim Aktualisieren des Tasks:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleDelete = async () => {\n        if (!confirmDelete) {\n            setConfirmDelete(true);\n            return;\n        }\n        \n        try {\n            const token = localStorage.getItem('token');\n            if (!token) {\n                setError('Nicht authentifiziert');\n                return;\n            }\n\n            await axiosInstance.delete(API_ENDPOINTS.TASKS.BY_ID(task.id));\n\n            // Beim Lschen wird kein Task zurckgegeben, daher undefined bergeben\n            onTaskUpdated(undefined as any);\n            onClose();\n        } catch (err) {\n            console.error('Delete Error:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        }\n    };\n\n    const handleAddArticle = async (article: CerebroArticle) => {\n        try {\n            setError(null);\n            \n            await axiosInstance.post(\n                API_ENDPOINTS.TASKS.LINK_CARTICLE(task.id, article.id)\n            );\n            \n            setLinkedArticles(prev => [...prev, article]);\n        } catch (err) {\n            console.error('Fehler beim Verknpfen des Artikels:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        }\n    };\n    \n    const handleRemoveArticle = async (articleId: number) => {\n        try {\n            setError(null);\n            \n            await axiosInstance.delete(\n                API_ENDPOINTS.TASKS.UNLINK_CARTICLE(task.id, articleId)\n            );\n            \n            setLinkedArticles(prev => prev.filter(a => a.id !== articleId));\n        } catch (err) {\n            console.error('Fehler beim Entfernen der Artikelverknpfung:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        }\n    };\n\n    const handleDeleteAttachment = async (attachmentId: number) => {\n        try {\n            setError(null);\n            \n            // Finde den zu entfernenden Anhang\n            const attachmentToRemove = attachments.find(a => a.id === attachmentId);\n            \n            if (attachmentToRemove) {\n                await axiosInstance.delete(API_ENDPOINTS.TASKS.ATTACHMENT(task.id, attachmentId));\n                \n                // Entferne den Anhang aus der Liste\n                setAttachments(attachments.filter(attachment => attachment.id !== attachmentId));\n                \n                // Entferne auch die Verweise im Beschreibungstext\n                if (attachmentToRemove.fileName) {\n                    // Erzeuge URL-Muster fr diesen Anhang\n                    const attachmentUrl = getTaskAttachmentUrl(task.id, attachmentId);\n                    const escapedAttachmentUrl = attachmentUrl.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n                    \n                    // Suche nach Bild- und Link-Markdown\n                    const imagePattern = new RegExp(`!\\\\[(.*?)\\\\]\\\\(${escapedAttachmentUrl}\\\\)`, 'g');\n                    const linkPattern = new RegExp(`\\\\[(.*?)\\\\]\\\\(${escapedAttachmentUrl}\\\\)`, 'g');\n                    \n                    // Bereinige die Beschreibung\n                    const newDescription = description\n                        .replace(imagePattern, '')\n                        .replace(linkPattern, '')\n                        // Entferne berschssige Leerzeilen, die durch das Entfernen entstehen knnten\n                        .replace(/\\n{3,}/g, '\\n\\n');\n                    \n                    setDescription(newDescription);\n                }\n            }\n        } catch (err) {\n            console.error('Fehler beim Lschen des Anhangs:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        }\n    };\n\n    const handleDownloadAttachment = async (attachment: TaskAttachment) => {\n        try {\n            const response = await axiosInstance.get(\n                API_ENDPOINTS.TASKS.ATTACHMENT(task.id, attachment.id),\n                { responseType: 'blob' }\n            );\n            \n            // Blob-URL erstellen und Download auslsen\n            const url = window.URL.createObjectURL(new Blob([response.data]));\n            const link = document.createElement('a');\n            link.href = url;\n            link.setAttribute('download', attachment.fileName);\n            document.body.appendChild(link);\n            link.click();\n            link.remove();\n        } catch (err) {\n            console.error('Fehler beim Herunterladen des Anhangs:', err);\n            \n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        }\n    };\n\n    const handleRemoveTemporaryAttachment = (index: number) => {\n        // Finde den zu entfernenden Anhang\n        const attachmentToRemove = temporaryAttachments[index];\n        \n        if (attachmentToRemove) {\n            // Entferne den Anhang aus dem temporaryAttachments-Array\n            setTemporaryAttachments(temporaryAttachments.filter((_, i) => i !== index));\n            \n            // Entferne auch den Verweis im Beschreibungstext\n            if (attachmentToRemove.fileName) {\n                // Suche nach Bild- und Link-Markdown mit dem Dateinamen\n                const escapedFileName = attachmentToRemove.fileName.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n                const uploadText = t('tasks.editTask.form.uploadAfterCreate');\n                const imagePattern = new RegExp(`!\\\\[${escapedFileName}\\\\]\\\\(${uploadText.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}\\\\)`, 'g');\n                const linkPattern = new RegExp(`\\\\[${escapedFileName}\\\\]\\\\(${uploadText.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}\\\\)`, 'g');\n                \n                // Bereinige die Beschreibung\n                const newDescription = description\n                    .replace(imagePattern, '')\n                    .replace(linkPattern, '')\n                    // Entferne berschssige Leerzeilen, die durch das Entfernen entstehen knnten\n                    .replace(/\\n{3,}/g, '\\n\\n');\n                \n                setDescription(newDescription);\n            }\n        }\n    };\n\n    const renderForm = () => (\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n            {/* Tabs Navigation */}\n            <div className=\"border-b border-gray-200 dark:border-gray-700\">\n                <nav className=\"-mb-px flex space-x-4\" aria-label=\"Tabs\">\n                    <button\n                        type=\"button\"\n                        className={`${\n                            activeTab === 'data'\n                                ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:border-gray-600'\n                        } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                        onClick={() => setActiveTab('data')}\n                    >\n                        {t('tasks.editTask.tabs.data')}\n                    </button>\n                    <button\n                        type=\"button\"\n                        className={`${\n                            activeTab === 'cerebro'\n                                ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300 dark:hover:border-gray-600'\n                        } whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm`}\n                        onClick={() => setActiveTab('cerebro')}\n                    >\n                        {t('tasks.editTask.tabs.cerebro')}\n                    </button>\n                </nav>\n            </div>\n\n            {/* Data Tab Content */}\n            {activeTab === 'data' && (\n                <>\n                    <div>\n                        <label htmlFor=\"title\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.editTask.form.title')}\n                        </label>\n                        <input\n                            type=\"text\"\n                            id=\"title\"\n                            value={title}\n                            onChange={(e) => setTitle(e.target.value)}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                            required\n                        />\n                    </div>\n\n                    <div>\n                        <label htmlFor=\"description_edit\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.editTask.form.description')}\n                        </label>\n                        <div className=\"relative\">\n                            <textarea\n                                ref={textareaRef}\n                                id=\"description_edit\"\n                                rows={6}\n                                className=\"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                                value={description}\n                                onChange={(e) => setDescription(e.target.value)}\n                                onPaste={handlePaste}\n                                onDrop={handleDrop}\n                                onDragOver={handleDragOver}\n                                placeholder={t('tasks.editTask.form.descriptionPlaceholder')}\n                            />\n                            <div className=\"relative group absolute bottom-2 left-2\">\n                                <button\n                                    type=\"button\"\n                                    onClick={() => fileInputRef.current?.click()}\n                                    className=\"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-400 focus:outline-none\"\n                                >\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13\" />\n                                    </svg>\n                                </button>\n                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                    {t('tasks.editTask.form.fileUpload')}\n                                </div>\n                            </div>\n                            <input\n                                ref={fileInputRef}\n                                type=\"file\"\n                                onChange={handleFileUpload}\n                                className=\"hidden\"\n                            />\n                            {uploading && (\n                                <div className=\"absolute inset-0 flex items-center justify-center bg-white dark:bg-gray-800 bg-opacity-70 dark:bg-opacity-70\">\n                                    <span className=\"text-sm text-gray-600 dark:text-gray-300\">{t('tasks.editTask.form.uploading')}</span>\n                                </div>\n                            )}\n                        </div>\n                        {renderAttachments()}\n                        {renderTemporaryAttachments()}\n                        {/* Bilder werden bereits im Textarea als Markdown angezeigt und in der Card durch MarkdownPreview mit showImagePreview={true} */}\n                    </div>\n\n                    <div>\n                        <label htmlFor=\"status\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.editTask.form.status')}\n                        </label>\n                        <select\n                            id=\"status\"\n                            value={status}\n                            onChange={(e) => setStatus(e.target.value as Task['status'])}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                        >\n                            <option value=\"open\">{t('tasks.status.open')}</option>\n                            <option value=\"in_progress\">{t('tasks.status.in_progress')}</option>\n                            <option value=\"improval\">{t('tasks.status.improval')}</option>\n                            <option value=\"quality_control\">{t('tasks.status.quality_control')}</option>\n                            <option value=\"done\">{t('tasks.status.done')}</option>\n                        </select>\n                    </div>\n\n                    <div className=\"space-y-2\">\n                        <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.editTask.form.responsibleFor')} *\n                        </label>\n                        <div className=\"flex space-x-4\">\n                            <label className=\"inline-flex items-center\">\n                                <input\n                                    type=\"radio\"\n                                    className=\"form-radio text-blue-600 dark:bg-gray-700 dark:border-gray-600\"\n                                    name=\"assigneeType\"\n                                    value=\"user\"\n                                    checked={assigneeType === 'user'}\n                                    onChange={() => {\n                                        setAssigneeType('user');\n                                        setRoleId(null);\n                                    }}\n                                />\n                                <span className=\"ml-2 dark:text-gray-300\">{t('tasks.editTask.form.user')}</span>\n                            </label>\n                            <label className=\"inline-flex items-center\">\n                                <input\n                                    type=\"radio\"\n                                    className=\"form-radio text-blue-600 dark:bg-gray-700 dark:border-gray-600\"\n                                    name=\"assigneeType\"\n                                    value=\"role\"\n                                    checked={assigneeType === 'role'}\n                                    onChange={() => {\n                                        setAssigneeType('role');\n                                        setResponsibleId(null);\n                                    }}\n                                />\n                                <span className=\"ml-2 dark:text-gray-300\">{t('tasks.editTask.form.role')}</span>\n                            </label>\n                        </div>\n                    </div>\n\n                    {assigneeType === 'user' ? (\n                        <div>\n                            <label htmlFor=\"responsible\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                {t('tasks.editTask.form.responsibleUser')} *\n                            </label>\n                            <select\n                                id=\"responsible\"\n                                value={responsibleId === null ? '' : responsibleId}\n                                onChange={(e) => setResponsibleId(e.target.value ? Number(e.target.value) : null)}\n                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                                required={assigneeType === 'user'}\n                            >\n                                <option value=\"\">{t('tasks.editTask.form.pleaseSelect')}</option>\n                                {Array.isArray(users) && users.map(user => (\n                                    <option key={user.id} value={user.id}>\n                                        {user.firstName} {user.lastName}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n                    ) : (\n                        <div>\n                            <label htmlFor=\"role\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                {t('tasks.editTask.form.responsibleRole')} *\n                            </label>\n                            <select\n                                id=\"role\"\n                                value={roleId === null ? '' : roleId}\n                                onChange={(e) => setRoleId(e.target.value ? Number(e.target.value) : null)}\n                                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                                required={assigneeType === 'role'}\n                            >\n                                <option value=\"\">{t('tasks.editTask.form.pleaseSelect')}</option>\n                                {Array.isArray(roles) && roles.map(role => (\n                                    <option key={role.id} value={role.id}>\n                                        {role.name}\n                                    </option>\n                                ))}\n                            </select>\n                        </div>\n                    )}\n\n                    <div>\n                        <label htmlFor=\"qualityControl\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.editTask.form.qualityControl')}\n                        </label>\n                        <select\n                            id=\"qualityControl\"\n                            value={qualityControlId === null ? '' : qualityControlId}\n                            onChange={(e) => setQualityControlId(e.target.value ? Number(e.target.value) : null)}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                        >\n                            <option value=\"\">{t('tasks.editTask.form.noQualityControl')}</option>\n                            {Array.isArray(users) && users.map(user => (\n                                <option key={user.id} value={user.id}>\n                                    {user.firstName} {user.lastName}\n                                </option>\n                            ))}\n                        </select>\n                    </div>\n\n                    <div>\n                        <label htmlFor=\"branch\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.editTask.form.branch')}\n                        </label>\n                        <select\n                            id=\"branch\"\n                            value={branchId === 0 ? '' : branchId}\n                            onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : 0)}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                            required\n                        >\n                            <option value=\"\">{t('common.pleaseSelect')}</option>\n                            {Array.isArray(branches) && branches.map(branch => (\n                                <option key={branch.id} value={branch.id}>\n                                    {branch.name}\n                                </option>\n                            ))}\n                        </select>\n                    </div>\n\n                    <div>\n                        <label htmlFor=\"dueDate\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                            {t('tasks.editTask.form.dueDate')}\n                        </label>\n                        <input\n                            type=\"date\"\n                            id=\"dueDate\"\n                            value={dueDate || ''}\n                            onChange={(e) => {\n                                // Wenn das Feld leer ist, setze auf null\n                                if (!e.target.value) {\n                                    setDueDate(null);\n                                } else {\n                                    // Ansonsten behalte das Format YYYY-MM-DD bei\n                                    setDueDate(e.target.value);\n                                }\n                            }}\n                            className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                        />\n                    </div>\n                </>\n            )}\n\n            {/* Cerebro Articles Tab Content */}\n            {activeTab === 'cerebro' && (\n                <div>\n                    {linkedArticles.length > 0 && (\n                        <div className=\"mb-4\">\n                            <h3 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">{t('tasks.editTask.form.linkedCerebroArticles')}</h3>\n                            <ul className=\"space-y-2\">\n                                {linkedArticles.map(article => (\n                                    <li key={article.id} className=\"flex items-center justify-between bg-gray-50 dark:bg-gray-700 p-2 rounded\">\n                                        <a \n                                            href={`/cerebro/articles/${article.slug}`} \n                                            target=\"_blank\" \n                                            rel=\"noopener noreferrer\"\n                                            className=\"text-blue-600 hover:underline dark:text-blue-400 dark:hover:text-blue-300\"\n                                        >\n                                            {article.title}\n                                        </a>\n                                        <button\n                                            type=\"button\"\n                                            onClick={() => handleRemoveArticle(article.id)}\n                                            className=\"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300\"\n                                        >\n                                            {t('tasks.editTask.form.remove')}\n                                        </button>\n                                    </li>\n                                ))}\n                            </ul>\n                        </div>\n                    )}\n\n                    <CerebroArticleSelector \n                        onArticleSelected={handleAddArticle}\n                        excludeArticleIds={linkedArticles.map(a => a.id)}\n                        selectedArticles={linkedArticles}\n                        onArticleRemove={handleRemoveArticle}\n                    />\n                </div>\n            )}\n\n            {/* Lifecycle Task Boxes - nur fr Lebenszyklus-Tasks */}\n            {activeTab === 'data' && (task.title?.includes('ARL') || \n                                      task.title?.includes('EPS') || \n                                      task.title?.includes('Pension') || \n                                      task.title?.includes('Caja') ||\n                                      task.description?.includes('lifecycle')) && (\n                <>\n                    <TaskDataBox task={task} />\n                    <EmailTemplateBox task={task} />\n                    <SocialSecurityCompletionBox \n                        task={task} \n                        onComplete={() => {\n                            // Optional: Task neu laden oder Status aktualisieren\n                            if (onTaskUpdated) {\n                                // Task wird automatisch aktualisiert wenn Modal geschlossen wird\n                            }\n                        }} \n                    />\n                </>\n            )}\n                \n            <div className=\"flex justify-between pt-4\">\n                {canDeleteTask && (\n                    <div className=\"relative group\">\n                        <button\n                            type=\"button\"\n                            onClick={handleDelete}\n                            className={`p-2 rounded-md ${\n                                confirmDelete\n                                    ? 'bg-red-600 text-white dark:bg-red-700 dark:text-white hover:bg-red-700 dark:hover:bg-red-600'\n                                    : 'text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300'\n                            }`}\n                        >\n                            {confirmDelete ? (\n                                <CheckIcon className=\"h-5 w-5\" />\n                            ) : (\n                                <TrashIcon className=\"h-5 w-5\" />\n                            )}\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {confirmDelete ? t('tasks.editTask.form.confirmDelete') : t('tasks.editTask.form.delete')}\n                        </div>\n                    </div>\n                )}\n                <div className=\"flex gap-2\">\n                    <div className=\"relative group\">\n                        <button\n                            type=\"button\"\n                            onClick={onClose}\n                            className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                        >\n                            <XMarkIcon className=\"h-5 w-5\" />\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {t('tasks.editTask.form.cancel')}\n                        </div>\n                    </div>\n                    <div className=\"relative group\">\n                        <button\n                            type=\"submit\"\n                            className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n                            disabled={loading}\n                        >\n                            {loading ? (\n                                <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                            ) : (\n                                <CheckIcon className=\"h-5 w-5\" />\n                            )}\n                        </button>\n                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                            {loading ? t('tasks.editTask.form.saving') : t('tasks.editTask.form.save')}\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </form>\n    );\n\n    const renderAttachments = () => {\n        if (attachments.length === 0) return null;\n        \n        return (\n            <div className=\"mt-2\">\n                <ul className=\"flex flex-wrap gap-2\">\n                    {attachments.map((attachment) => (\n                        <li key={attachment.id} className=\"inline-flex items-center bg-gray-100 dark:bg-gray-700 rounded-md px-2 py-1 relative group\">\n                            <span className=\"text-sm font-medium text-gray-800 dark:text-gray-300\">\n                                {attachment.fileName}\n                            </span>\n                            <div className=\"flex ml-2\">\n                                <div className=\"relative group mr-1\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={() => handleDownloadAttachment(attachment)}\n                                        className=\"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300\"\n                                    >\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4\" />\n                                        </svg>\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                        {t('tasks.editTask.form.download')}\n                                    </div>\n                                </div>\n                                <div className=\"relative group ml-1\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={() => handleDeleteAttachment(attachment.id)}\n                                        className=\"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300\"\n                                    >\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                                        </svg>\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                        {t('tasks.editTask.form.remove')}\n                                    </div>\n                                </div>\n                            </div>\n                            {/* Tooltip fr Bildvorschau bei Bild-Dateien */}\n                            {attachment.fileType.startsWith('image/') && (\n                                <div className=\"absolute z-10 bg-white dark:bg-gray-800 p-2 rounded-md shadow-lg -top-32 left-0 border border-gray-200 dark:border-gray-600 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none\">\n                                    <img \n                                        src={getTaskAttachmentUrl(task.id, attachment.id)}\n                                        alt={attachment.fileName}\n                                        className=\"max-w-[200px] max-h-[150px] object-contain\"\n                                    />\n                                </div>\n                            )}\n                        </li>\n                    ))}\n                </ul>\n            </div>\n        );\n    };\n\n    const renderTemporaryAttachments = () => {\n        if (temporaryAttachments.length === 0) return null;\n        \n        return (\n            <div className=\"mt-2\">\n                <ul className=\"flex flex-wrap gap-2\">\n                    {temporaryAttachments.map((attachment, index) => (\n                        <li key={`temp-${index}`} className=\"inline-flex items-center bg-gray-100 dark:bg-gray-700 rounded-md px-2 py-1 relative group\">\n                            <span className=\"text-sm font-medium text-gray-800 dark:text-gray-300\">\n                                {attachment.fileName}\n                            </span>\n                            <div className=\"flex ml-2\">\n                                <div className=\"relative group ml-1\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={() => handleRemoveTemporaryAttachment(index)}\n                                        className=\"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300\"\n                                    >\n                                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                                        </svg>\n                                    </button>\n                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                        {t('tasks.editTask.form.remove')}\n                                    </div>\n                                </div>\n                            </div>\n                            {/* Tooltip fr Bildvorschau bei Bild-Dateien */}\n                            {attachment.fileType?.startsWith('image/') && attachment.file && (\n                                <div className=\"absolute z-10 bg-white dark:bg-gray-800 p-2 rounded-md shadow-lg -top-32 left-0 border border-gray-200 dark:border-gray-600 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none\">\n                                    <img \n                                        src={URL.createObjectURL(attachment.file)}\n                                        alt={attachment.fileName}\n                                        className=\"max-w-[200px] max-h-[150px] object-contain\"\n                                    />\n                                </div>\n                            )}\n                        </li>\n                    ))}\n                </ul>\n            </div>\n        );\n    };\n\n    if (!isOpen) return null;\n\n    // Fr Mobile (unter 640px) - klassisches Modal\n    if (isMobile) {\n        return (\n            <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n                <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n                \n                <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                    <Dialog.Panel className=\"mx-auto max-w-xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n                            <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                                {t('tasks.editTask.title')}\n                            </Dialog.Title>\n                            <button\n                                onClick={onClose}\n                                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                            >\n                                <XMarkIcon className=\"h-6 w-6\" />\n                            </button>\n                        </div>\n\n                        <div className=\"p-4\">\n                            {error && (\n                                <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                                    {error}\n                                </div>\n                            )}\n\n                            {renderForm()}\n                        </div>\n                    </Dialog.Panel>\n                </div>\n            </Dialog>\n        );\n    }\n\n    // Fr Desktop (ab 640px) - Sidepane\n    // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n    return (\n        <>\n            {/* Backdrop - nur wenn offen und <= 1070px */}\n            {isOpen && !isLargeScreen && (\n                <div \n                    className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n                    aria-hidden=\"true\" \n                    onClick={onClose}\n                    style={{\n                        opacity: isOpen ? 1 : 0,\n                        transition: 'opacity 300ms ease-out'\n                    }}\n                />\n            )}\n            \n            {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n            <div \n                className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n                style={{\n                    transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n                    pointerEvents: isOpen ? 'auto' : 'none'\n                }}\n                aria-hidden={!isOpen}\n                role=\"dialog\"\n                aria-modal={isOpen}\n            >\n                <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n                    <h2 className=\"text-lg font-semibold dark:text-white\">\n                            {t('tasks.editTask.title')}\n                    </h2>\n                    <button\n                        onClick={onClose}\n                        className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n                    >\n                        <XMarkIcon className=\"h-6 w-6\" />\n                    </button>\n                </div>\n\n                <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n                    {error && (\n                        <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n                            {error}\n                        </div>\n                    )}\n\n                    {renderForm()}\n                </div>\n            </div>\n        </>\n    );\n};\n\nexport default EditTaskModal; ","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon } from '@heroicons/react/24/outline';\r\nimport { reservationService, CreateReservationData } from '../../services/reservationService.ts';\r\nimport { Reservation } from '../../types/reservation.ts';\r\nimport useMessage from '../../hooks/useMessage.ts';\r\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\r\n\r\ninterface CreateReservationModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onReservationCreated: (newReservation: Reservation) => void;\r\n}\r\n\r\nconst CreateReservationModal: React.FC<CreateReservationModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  onReservationCreated\r\n}) => {\r\n  const { t } = useTranslation();\r\n  const { showMessage } = useMessage();\r\n  const { openSidepane, closeSidepane } = useSidepane();\r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\r\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\r\n\r\n  const [guestName, setGuestName] = useState('');\r\n  const [contact, setContact] = useState('');\r\n  const [amount, setAmount] = useState('');\r\n  const [currency, setCurrency] = useState('COP');\r\n  const [contactType, setContactType] = useState<'phone' | 'email' | null>(null);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  // Erkenne automatisch ob es Telefonnummer oder Email ist\r\n  const detectContactType = (value: string): 'phone' | 'email' | null => {\r\n    if (!value || value.trim().length === 0) {\r\n      return null;\r\n    }\r\n    // Email-Format: enthlt @ und .\r\n    if (value.includes('@') && value.includes('.')) {\r\n      return 'email';\r\n    }\r\n    // Telefonnummer: enthlt nur Ziffern, +, Leerzeichen, Bindestriche\r\n    return 'phone';\r\n  };\r\n\r\n  const handleContactChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const value = e.target.value;\r\n    setContact(value);\r\n    setContactType(detectContactType(value));\r\n  };\r\n\r\n  const handleAmountChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const value = e.target.value;\r\n    // Erlaube nur Zahlen und Dezimalpunkt\r\n    if (value === '' || /^\\d*\\.?\\d*$/.test(value)) {\r\n      setAmount(value);\r\n    }\r\n  };\r\n\r\n  // Responsive-Verhalten\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      setIsMobile(window.innerWidth < 640);\r\n      setIsLargeScreen(window.innerWidth > 1070);\r\n    };\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    handleResize();\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', handleResize);\r\n    };\r\n  }, []);\r\n\r\n  // Sidepane-Status verwalten\r\n  useEffect(() => {\r\n    if (isOpen && !isMobile) {\r\n      openSidepane();\r\n    } else {\r\n      closeSidepane();\r\n    }\r\n\r\n    return () => {\r\n      closeSidepane();\r\n    };\r\n  }, [isOpen, isMobile, openSidepane, closeSidepane]);\r\n\r\n  // Reset form when modal closes\r\n  useEffect(() => {\r\n    if (!isOpen) {\r\n      setGuestName('');\r\n      setContact('');\r\n      setAmount('');\r\n      setCurrency('COP');\r\n      setContactType(null);\r\n      setError(null);\r\n    }\r\n  }, [isOpen]);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError(null);\r\n\r\n    // Validierung\r\n    if (!guestName || guestName.trim().length === 0) {\r\n      setError(t('reservations.createReservation.errors.guestNameRequired', 'Gast-Name ist erforderlich'));\r\n      return;\r\n    }\r\n\r\n    if (!contact || contact.trim().length === 0) {\r\n      setError(t('reservations.createReservation.errors.contactRequired', 'Kontaktinformation ist erforderlich'));\r\n      return;\r\n    }\r\n\r\n    if (!amount || parseFloat(amount) <= 0) {\r\n      setError(t('reservations.createReservation.errors.amountRequired', 'Betrag muss eine positive Zahl sein'));\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n\r\n      const data: CreateReservationData = {\r\n        guestName: guestName.trim(),\r\n        contact: contact.trim(),\r\n        amount: parseFloat(amount),\r\n        currency: currency\r\n      };\r\n\r\n      console.log('[CreateReservationModal] Sende Daten:', data);\r\n      console.log('[CreateReservationModal] API Endpoint:', '/api/reservations');\r\n      const newReservation = await reservationService.create(data);\r\n      console.log('[CreateReservationModal] Reservierung erstellt:', newReservation);\r\n      \r\n      showMessage(\r\n        t('reservations.createReservation.success', 'Reservierung erfolgreich erstellt'),\r\n        'success'\r\n      );\r\n\r\n      onReservationCreated(newReservation);\r\n      onClose();\r\n    } catch (err: any) {\r\n      console.error('[CreateReservationModal] Fehler beim Erstellen der Reservierung:', err);\r\n      console.error('[CreateReservationModal] Error Response:', err.response);\r\n      console.error('[CreateReservationModal] Error Status:', err.response?.status);\r\n      console.error('[CreateReservationModal] Error Data:', err.response?.data);\r\n      const errorMessage = err.response?.data?.message || err.message ||\r\n        t('reservations.createReservation.errors.createError', 'Fehler beim Erstellen der Reservierung');\r\n      setError(errorMessage);\r\n      showMessage(errorMessage, 'error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    onClose();\r\n  };\r\n\r\n  // Fr Mobile (< 640px) - Modal\r\n  if (isMobile) {\r\n    return (\r\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\r\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n          <Dialog.Panel className=\"mx-auto max-w-lg w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n            <div className=\"bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4\">\r\n              <div className=\"flex items-center justify-between mb-4\">\r\n                <Dialog.Title className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                  {t('reservations.createReservation.title', 'Neue Reservierung')}\r\n                </Dialog.Title>\r\n                <button\r\n                  onClick={handleClose}\r\n                  className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\r\n                >\r\n                  <XMarkIcon className=\"h-6 w-6\" />\r\n                </button>\r\n              </div>\r\n\r\n            {error && (\r\n              <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-200 rounded\">\r\n                {error}\r\n              </div>\r\n            )}\r\n\r\n            <form onSubmit={handleSubmit}>\r\n              {/* Gast-Name */}\r\n              <div className=\"mb-4\">\r\n                <label htmlFor=\"guestName\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                  {t('reservations.createReservation.guestName', 'Gast-Name')} *\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  id=\"guestName\"\r\n                  value={guestName}\r\n                  onChange={(e) => setGuestName(e.target.value)}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                  required\r\n                />\r\n              </div>\r\n\r\n              {/* Kontakt */}\r\n              <div className=\"mb-4\">\r\n                <label htmlFor=\"contact\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                  {t('reservations.createReservation.contact', 'Telefonnummer oder Email')} *\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  id=\"contact\"\r\n                  value={contact}\r\n                  onChange={handleContactChange}\r\n                  placeholder={t('reservations.createReservation.contactPlaceholder', 'z.B. +573001234567 oder email@example.com')}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                  required\r\n                />\r\n                {contactType && (\r\n                  <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n                    {contactType === 'email'\r\n                      ? t('reservations.createReservation.detectedEmail', 'Email erkannt')\r\n                      : t('reservations.createReservation.detectedPhone', 'Telefonnummer erkannt')\r\n                    }\r\n                  </p>\r\n                )}\r\n              </div>\r\n\r\n              {/* Betrag & Whrung */}\r\n              <div className=\"grid grid-cols-2 gap-4 mb-4\">\r\n                <div>\r\n                  <label htmlFor=\"amount\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                    {t('reservations.createReservation.amount', 'Betrag')} *\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    id=\"amount\"\r\n                    value={amount}\r\n                    onChange={handleAmountChange}\r\n                    placeholder=\"0.00\"\r\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                    required\r\n                  />\r\n                </div>\r\n                <div>\r\n                  <label htmlFor=\"currency\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                    {t('reservations.createReservation.currency', 'Whrung')}\r\n                  </label>\r\n                  <select\r\n                    id=\"currency\"\r\n                    value={currency}\r\n                    onChange={(e) => setCurrency(e.target.value)}\r\n                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                  >\r\n                    <option value=\"COP\">COP</option>\r\n                    <option value=\"USD\">USD</option>\r\n                    <option value=\"EUR\">EUR</option>\r\n                  </select>\r\n                </div>\r\n              </div>\r\n\r\n              <p className=\"mb-4 text-sm text-gray-500 dark:text-gray-400\">\r\n                {t('reservations.createReservation.hint', 'Nach der Erstellung wird automatisch eine WhatsApp-Nachricht mit Zahlungslink versendet (wenn Telefonnummer angegeben).')}\r\n              </p>\r\n\r\n              {/* Buttons */}\r\n              <div className=\"flex justify-end space-x-3\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={onClose}\r\n                  className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n                >\r\n                  {t('common.cancel', 'Abbrechen')}\r\n                </button>\r\n                <button\r\n                  type=\"submit\"\r\n                  disabled={loading}\r\n                  className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                >\r\n                  {loading\r\n                    ? t('common.creating', 'Wird erstellt...')\r\n                    : t('common.create', 'Erstellen')\r\n                  }\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </Dialog.Panel>\r\n      </div>\r\n    </Dialog>\r\n    );\r\n  }\r\n\r\n  // Fr Desktop (ab 640px) - Sidepane\r\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\r\n  return (\r\n    <>\r\n      {/* Backdrop - nur wenn offen und <= 1070px */}\r\n      {isOpen && !isLargeScreen && (\r\n        <div \r\n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \r\n          aria-hidden=\"true\" \r\n          style={{\r\n            opacity: isOpen ? 1 : 0,\r\n            transition: 'opacity 300ms ease-out'\r\n          }}\r\n        />\r\n      )}\r\n      \r\n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\r\n      <div \r\n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\r\n        style={{\r\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n          pointerEvents: isOpen ? 'auto' : 'none'\r\n        }}\r\n        aria-hidden={!isOpen}\r\n        role=\"dialog\"\r\n        aria-modal={isOpen}\r\n      >\r\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n          <h2 className=\"text-lg font-semibold dark:text-white\">\r\n            {t('reservations.createReservation.title', 'Neue Reservierung')}\r\n          </h2>\r\n          <button\r\n            onClick={handleClose}\r\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n          >\r\n            <XMarkIcon className=\"h-6 w-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\r\n          {error && (\r\n            <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-200 rounded\">\r\n              {error}\r\n            </div>\r\n          )}\r\n\r\n          <form onSubmit={handleSubmit}>\r\n            {/* Gast-Name */}\r\n            <div className=\"mb-4\">\r\n              <label htmlFor=\"guestName\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                {t('reservations.createReservation.guestName', 'Gast-Name')} *\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"guestName\"\r\n                value={guestName}\r\n                onChange={(e) => setGuestName(e.target.value)}\r\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                required\r\n              />\r\n            </div>\r\n\r\n            {/* Kontakt */}\r\n            <div className=\"mb-4\">\r\n              <label htmlFor=\"contact\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                {t('reservations.createReservation.contact', 'Telefonnummer oder Email')} *\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                id=\"contact\"\r\n                value={contact}\r\n                onChange={handleContactChange}\r\n                placeholder={t('reservations.createReservation.contactPlaceholder', 'z.B. +573001234567 oder email@example.com')}\r\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                required\r\n              />\r\n              {contactType && (\r\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n                  {contactType === 'email'\r\n                    ? t('reservations.createReservation.detectedEmail', 'Email erkannt')\r\n                    : t('reservations.createReservation.detectedPhone', 'Telefonnummer erkannt')\r\n                  }\r\n                </p>\r\n              )}\r\n            </div>\r\n\r\n            {/* Betrag & Whrung */}\r\n            <div className=\"grid grid-cols-2 gap-4 mb-4\">\r\n              <div>\r\n                <label htmlFor=\"amount\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                  {t('reservations.createReservation.amount', 'Betrag')} *\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  id=\"amount\"\r\n                  value={amount}\r\n                  onChange={handleAmountChange}\r\n                  placeholder=\"0.00\"\r\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                  required\r\n                />\r\n              </div>\r\n              <div>\r\n                <label htmlFor=\"currency\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                  {t('reservations.createReservation.currency', 'Whrung')}\r\n                </label>\r\n                <select\r\n                  id=\"currency\"\r\n                  value={currency}\r\n                  onChange={(e) => setCurrency(e.target.value)}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                >\r\n                  <option value=\"COP\">COP</option>\r\n                  <option value=\"USD\">USD</option>\r\n                  <option value=\"EUR\">EUR</option>\r\n                </select>\r\n              </div>\r\n            </div>\r\n\r\n            <p className=\"mb-4 text-sm text-gray-500 dark:text-gray-400\">\r\n              {t('reservations.createReservation.hint', 'Nach der Erstellung wird automatisch eine WhatsApp-Nachricht mit Zahlungslink versendet (wenn Telefonnummer angegeben).')}\r\n            </p>\r\n\r\n            {/* Buttons */}\r\n            <div className=\"flex justify-end space-x-3\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={handleClose}\r\n                className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n              >\r\n                {t('common.cancel', 'Abbrechen')}\r\n              </button>\r\n              <button\r\n                type=\"submit\"\r\n                disabled={loading}\r\n                className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              >\r\n                {loading\r\n                  ? t('common.creating', 'Wird erstellt...')\r\n                  : t('common.create', 'Erstellen')\r\n                }\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default CreateReservationModal;\r\n\r\n","export enum TourType {\r\n  OWN = 'own',\r\n  EXTERNAL = 'external'\r\n}\r\n\r\nexport enum TourBookingStatus {\r\n  CONFIRMED = 'confirmed',\r\n  CANCELLED = 'cancelled',\r\n  COMPLETED = 'completed',\r\n  NO_SHOW = 'no_show'\r\n}\r\n\r\nexport enum MessageDirection {\r\n  OUTGOING = 'outgoing',\r\n  INCOMING = 'incoming'\r\n}\r\n\r\nexport enum MessageStatus {\r\n  SENT = 'sent',\r\n  DELIVERED = 'delivered',\r\n  READ = 'read',\r\n  FAILED = 'failed'\r\n}\r\n\r\nexport interface Tour {\r\n  id: number;\r\n  title: string;\r\n  description?: string | null;\r\n  type: TourType;\r\n  isActive: boolean;\r\n  duration?: number | null;\r\n  maxParticipants?: number | null;\r\n  minParticipants?: number | null;\r\n  price?: number | string | null;\r\n  currency?: string | null;\r\n  location?: string | null;\r\n  meetingPoint?: string | null;\r\n  includes?: string | null;\r\n  excludes?: string | null;\r\n  requirements?: string | null;\r\n  totalCommission?: number | string | null;\r\n  totalCommissionPercent?: number | string | null;\r\n  sellerCommissionPercent?: number | string | null;\r\n  sellerCommissionFixed?: number | string | null;\r\n  externalProviderId?: number | null;\r\n  externalProvider?: TourProvider | null;\r\n  externalBookingUrl?: string | null;\r\n  imageUrl?: string | null;\r\n  galleryUrls?: string[] | null;\r\n  availableFrom?: string | null;\r\n  availableTo?: string | null;\r\n  recurringSchedule?: any | null;\r\n  organizationId: number;\r\n  branchId?: number | null;\r\n  branch?: { id: number; name: string } | null;\r\n  createdById?: number | null;\r\n  createdBy?: { id: number; firstName: string; lastName: string } | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface TourProvider {\r\n  id: number;\r\n  name: string;\r\n  phone?: string | null;\r\n  email?: string | null;\r\n  contactPerson?: string | null;\r\n  notes?: string | null;\r\n  organizationId: number;\r\n  branchId?: number | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface TourBooking {\r\n  id: number;\r\n  tourId: number;\r\n  tour?: Tour | null;\r\n  bookingDate: string;\r\n  tourDate: string;\r\n  numberOfParticipants: number;\r\n  totalPrice: number | string;\r\n  currency: string;\r\n  customerName: string;\r\n  customerEmail?: string | null;\r\n  customerPhone?: string | null;\r\n  customerNotes?: string | null;\r\n  paymentStatus: 'pending' | 'paid' | 'partially_paid' | 'refunded';\r\n  amountPaid?: number | string | null;\r\n  amountPending?: number | string | null;\r\n  paymentLink?: string | null;\r\n  bookedById?: number | null;\r\n  bookedBy?: { id: number; firstName: string; lastName: string } | null;\r\n  commissionAmount?: number | string | null;\r\n  commissionCalculatedAt?: string | null;\r\n  status: TourBookingStatus;\r\n  cancelledBy?: string | null;\r\n  cancelledAt?: string | null;\r\n  cancelledReason?: string | null;\r\n  isExternal: boolean;\r\n  externalBookingId?: string | null;\r\n  externalStatus?: string | null;\r\n  externalMessage?: string | null;\r\n  alternativeTours?: number[] | null;\r\n  organizationId: number;\r\n  branchId?: number | null;\r\n  branch?: { id: number; name: string } | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface TourReservation {\r\n  id: number;\r\n  tourId: number;\r\n  tour?: Tour | null;\r\n  bookingId: number;\r\n  booking?: TourBooking | null;\r\n  reservationId: number;\r\n  reservation?: any | null;\r\n  tourPrice: number | string;\r\n  accommodationPrice: number | string;\r\n  currency: string;\r\n  tourPricePaid?: number | string | null;\r\n  tourPricePending?: number | string | null;\r\n  accommodationPaid?: number | string | null;\r\n  accommodationPending?: number | string | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\nexport interface TourWhatsAppMessage {\r\n  id: number;\r\n  bookingId: number;\r\n  booking?: TourBooking | null;\r\n  direction: MessageDirection;\r\n  message: string;\r\n  phoneNumber: string;\r\n  sentAt: string;\r\n  status: MessageStatus;\r\n  errorMessage?: string | null;\r\n  processed: boolean;\r\n  processedAt?: string | null;\r\n  action?: string | null;\r\n  extractedData?: any | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n}\r\n\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport axiosInstance from '../../config/axios.ts';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon } from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../../config/api.ts';\r\nimport { useAuth } from '../../hooks/useAuth.tsx';\r\nimport { Tour, TourType, TourProvider } from '../../types/tour.ts';\r\nimport useMessage from '../../hooks/useMessage.ts';\r\n\r\ninterface Branch {\r\n    id: number;\r\n    name: string;\r\n}\r\n\r\ninterface CreateTourModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    onTourCreated: (newTour: Tour) => void;\r\n}\r\n\r\nconst CreateTourModal = ({ isOpen, onClose, onTourCreated }: CreateTourModalProps) => {\r\n    const { t } = useTranslation();\r\n    const { user } = useAuth();\r\n    const { showMessage } = useMessage();\r\n    \r\n    const [title, setTitle] = useState('');\r\n    const [description, setDescription] = useState('');\r\n    const [type, setType] = useState<TourType>(TourType.OWN);\r\n    const [isActive, setIsActive] = useState(true);\r\n    const [duration, setDuration] = useState<number | ''>('');\r\n    const [maxParticipants, setMaxParticipants] = useState<number | ''>('');\r\n    const [minParticipants, setMinParticipants] = useState<number | ''>('');\r\n    const [price, setPrice] = useState<number | ''>('');\r\n    const [currency, setCurrency] = useState('COP');\r\n    const [location, setLocation] = useState('');\r\n    const [meetingPoint, setMeetingPoint] = useState('');\r\n    const [includes, setIncludes] = useState('');\r\n    const [excludes, setExcludes] = useState('');\r\n    const [requirements, setRequirements] = useState('');\r\n    const [totalCommission, setTotalCommission] = useState<number | ''>('');\r\n    const [totalCommissionPercent, setTotalCommissionPercent] = useState<number | ''>('');\r\n    const [sellerCommissionPercent, setSellerCommissionPercent] = useState<number | ''>('');\r\n    const [sellerCommissionFixed, setSellerCommissionFixed] = useState<number | ''>('');\r\n    const [externalProviderId, setExternalProviderId] = useState<number | ''>('');\r\n    const [externalBookingUrl, setExternalBookingUrl] = useState('');\r\n    const [branchId, setBranchId] = useState<number | ''>('');\r\n    const [imageFile, setImageFile] = useState<File | null>(null);\r\n    const [imagePreview, setImagePreview] = useState<string | null>(null);\r\n    const [galleryFiles, setGalleryFiles] = useState<File[]>([]);\r\n    const [galleryPreviews, setGalleryPreviews] = useState<string[]>([]);\r\n    const [uploadingImage, setUploadingImage] = useState(false);\r\n    \r\n    const [branches, setBranches] = useState<Branch[]>([]);\r\n    const [tourProviders, setTourProviders] = useState<TourProvider[]>([]);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [loading, setLoading] = useState(false);\r\n    const [loadingData, setLoadingData] = useState(true);\r\n\r\n    // Lade Branches und TourProviders\r\n    useEffect(() => {\r\n        const loadData = async () => {\r\n            try {\r\n                setLoadingData(true);\r\n                const [branchesRes, providersRes] = await Promise.all([\r\n                    axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE),\r\n                    axiosInstance.get(API_ENDPOINTS.TOUR_PROVIDERS?.BASE || '/api/tour-providers')\r\n                ]);\r\n                \r\n                setBranches(branchesRes.data?.data || branchesRes.data || []);\r\n                setTourProviders(providersRes.data?.data || providersRes.data || []);\r\n            } catch (err: any) {\r\n                console.error('Fehler beim Laden der Daten:', err);\r\n                showMessage(t('errors.loadError'), 'error');\r\n            } finally {\r\n                setLoadingData(false);\r\n            }\r\n        };\r\n        \r\n        if (isOpen) {\r\n            loadData();\r\n        }\r\n    }, [isOpen, t, showMessage]);\r\n\r\n    // Reset form when modal opens/closes\r\n    useEffect(() => {\r\n        if (!isOpen) {\r\n            setTitle('');\r\n            setDescription('');\r\n            setType(TourType.OWN);\r\n            setIsActive(true);\r\n            setDuration('');\r\n            setMaxParticipants('');\r\n            setMinParticipants('');\r\n            setPrice('');\r\n            setCurrency('COP');\r\n            setLocation('');\r\n            setMeetingPoint('');\r\n            setIncludes('');\r\n            setExcludes('');\r\n            setRequirements('');\r\n            setTotalCommission('');\r\n            setTotalCommissionPercent('');\r\n            setSellerCommissionPercent('');\r\n            setSellerCommissionFixed('');\r\n            setExternalProviderId('');\r\n            setExternalBookingUrl('');\r\n            setBranchId('');\r\n            setImageFile(null);\r\n            setImagePreview(null);\r\n            setGalleryFiles([]);\r\n            setGalleryPreviews([]);\r\n            setError(null);\r\n        }\r\n    }, [isOpen]);\r\n    \r\n    // Bild-Vorschau erstellen\r\n    const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (file) {\r\n            setImageFile(file);\r\n            const reader = new FileReader();\r\n            reader.onloadend = () => {\r\n                setImagePreview(reader.result as string);\r\n            };\r\n            reader.readAsDataURL(file);\r\n        }\r\n    };\r\n    \r\n    const handleGalleryChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const files = Array.from(e.target.files || []);\r\n        if (files.length > 0) {\r\n            setGalleryFiles(prev => [...prev, ...files]);\r\n            files.forEach(file => {\r\n                const reader = new FileReader();\r\n                reader.onloadend = () => {\r\n                    setGalleryPreviews(prev => [...prev, reader.result as string]);\r\n                };\r\n                reader.readAsDataURL(file);\r\n            });\r\n        }\r\n    };\r\n    \r\n    const removeGalleryImage = (index: number) => {\r\n        setGalleryFiles(prev => prev.filter((_, i) => i !== index));\r\n        setGalleryPreviews(prev => prev.filter((_, i) => i !== index));\r\n    };\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setError(null);\r\n        setLoading(true);\r\n\r\n        try {\r\n            const tourData: any = {\r\n                title,\r\n                description: description || null,\r\n                type,\r\n                isActive,\r\n                duration: duration ? Number(duration) : null,\r\n                maxParticipants: maxParticipants ? Number(maxParticipants) : null,\r\n                minParticipants: minParticipants ? Number(minParticipants) : null,\r\n                price: price ? Number(price) : null,\r\n                currency: currency || 'COP',\r\n                location: location || null,\r\n                meetingPoint: meetingPoint || null,\r\n                includes: includes || null,\r\n                excludes: excludes || null,\r\n                requirements: requirements || null,\r\n                totalCommission: totalCommission ? Number(totalCommission) : null,\r\n                totalCommissionPercent: totalCommissionPercent ? Number(totalCommissionPercent) : null,\r\n                sellerCommissionPercent: sellerCommissionPercent ? Number(sellerCommissionPercent) : null,\r\n                sellerCommissionFixed: sellerCommissionFixed ? Number(sellerCommissionFixed) : null,\r\n                externalProviderId: externalProviderId ? Number(externalProviderId) : null,\r\n                externalBookingUrl: externalBookingUrl || null,\r\n                branchId: branchId ? Number(branchId) : null\r\n            };\r\n\r\n            const response = await axiosInstance.post(API_ENDPOINTS.TOURS.BASE, tourData);\r\n            \r\n            if (response.data.success) {\r\n                const createdTour = response.data.data;\r\n                \r\n                // Hauptbild hochladen (falls vorhanden)\r\n                if (imageFile && createdTour.id) {\r\n                    try {\r\n                        setUploadingImage(true);\r\n                        const formData = new FormData();\r\n                        formData.append('image', imageFile);\r\n                        await axiosInstance.post(API_ENDPOINTS.TOURS.UPLOAD_IMAGE(createdTour.id), formData, {\r\n                            headers: { 'Content-Type': 'multipart/form-data' }\r\n                        });\r\n                    } catch (imgErr: any) {\r\n                        console.error('Fehler beim Hochladen des Hauptbildes:', imgErr);\r\n                        showMessage(t('tours.imageUploadError', 'Tour erstellt, aber Fehler beim Hochladen des Bildes'), 'warning');\r\n                    } finally {\r\n                        setUploadingImage(false);\r\n                    }\r\n                }\r\n                \r\n                // Galerie-Bilder hochladen (falls vorhanden)\r\n                if (galleryFiles.length > 0 && createdTour.id) {\r\n                    try {\r\n                        setUploadingImage(true);\r\n                        for (const file of galleryFiles) {\r\n                            const formData = new FormData();\r\n                            formData.append('image', file);\r\n                            await axiosInstance.post(API_ENDPOINTS.TOURS.UPLOAD_GALLERY(createdTour.id), formData, {\r\n                                headers: { 'Content-Type': 'multipart/form-data' }\r\n                            });\r\n                        }\r\n                    } catch (galleryErr: any) {\r\n                        console.error('Fehler beim Hochladen der Galerie-Bilder:', galleryErr);\r\n                        showMessage(t('tours.galleryUploadError', 'Tour erstellt, aber Fehler beim Hochladen der Galerie-Bilder'), 'warning');\r\n                    } finally {\r\n                        setUploadingImage(false);\r\n                    }\r\n                }\r\n                \r\n                showMessage(t('tours.createSuccess', 'Tour erfolgreich erstellt'), 'success');\r\n                // Lade Tour neu, um Bilder zu erhalten\r\n                const updatedResponse = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(createdTour.id));\r\n                onTourCreated(updatedResponse.data.data);\r\n                onClose();\r\n            } else {\r\n                setError(response.data.message || t('errors.saveError'));\r\n            }\r\n        } catch (err: any) {\r\n            console.error('Fehler beim Erstellen der Tour:', err);\r\n            const errorMessage = err.response?.data?.message || t('errors.saveError');\r\n            setError(errorMessage);\r\n            showMessage(errorMessage, 'error');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n                <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] overflow-y-auto\">\r\n                    <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\r\n                        <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white\">\r\n                            {t('tours.create', 'Neue Tour erstellen')}\r\n                        </Dialog.Title>\r\n                        <button\r\n                            onClick={onClose}\r\n                            className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\r\n                        >\r\n                            <XMarkIcon className=\"h-6 w-6\" />\r\n                        </button>\r\n                    </div>\r\n\r\n                    <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">\r\n                        {error && (\r\n                            <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200 px-4 py-3 rounded\">\r\n                                {error}\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Grundinformationen */}\r\n                        <div className=\"space-y-4\">\r\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                                {t('tours.basicInfo', 'Grundinformationen')}\r\n                            </h3>\r\n                            \r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.name', 'Titel')} *\r\n                                </label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={title}\r\n                                    onChange={(e) => setTitle(e.target.value)}\r\n                                    required\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                />\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.description', 'Beschreibung')}\r\n                                </label>\r\n                                <textarea\r\n                                    value={description}\r\n                                    onChange={(e) => setDescription(e.target.value)}\r\n                                    rows={4}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                />\r\n                            </div>\r\n\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.type', 'Typ')} *\r\n                                    </label>\r\n                                    <select\r\n                                        value={type}\r\n                                        onChange={(e) => setType(e.target.value as TourType)}\r\n                                        required\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    >\r\n                                        <option value={TourType.OWN}>{t('tours.typeOwn', 'Eigene Tour')}</option>\r\n                                        <option value={TourType.EXTERNAL}>{t('tours.typeExternal', 'Externe Tour')}</option>\r\n                                    </select>\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.status', 'Status')}\r\n                                    </label>\r\n                                    <select\r\n                                        value={isActive ? 'true' : 'false'}\r\n                                        onChange={(e) => setIsActive(e.target.value === 'true')}\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    >\r\n                                        <option value=\"true\">{t('tours.statusActive', 'Aktiv')}</option>\r\n                                        <option value=\"false\">{t('tours.statusInactive', 'Inaktiv')}</option>\r\n                                    </select>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.branch', 'Niederlassung')}\r\n                                </label>\r\n                                <select\r\n                                    value={branchId}\r\n                                    onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                >\r\n                                    <option value=\"\">{t('common.all', 'Alle')}</option>\r\n                                    {branches.map(branch => (\r\n                                        <option key={branch.id} value={branch.id}>{branch.name}</option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Tour-Details */}\r\n                        <div className=\"space-y-4\">\r\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                                {t('tours.details', 'Tour-Details')}\r\n                            </h3>\r\n                            \r\n                            <div className=\"grid grid-cols-3 gap-4\">\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.duration', 'Dauer (Stunden)')}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={duration}\r\n                                        onChange={(e) => setDuration(e.target.value ? Number(e.target.value) : '')}\r\n                                        min=\"0\"\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.minParticipants', 'Min. Teilnehmer')}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={minParticipants}\r\n                                        onChange={(e) => setMinParticipants(e.target.value ? Number(e.target.value) : '')}\r\n                                        min=\"0\"\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.maxParticipants', 'Max. Teilnehmer')}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={maxParticipants}\r\n                                        onChange={(e) => setMaxParticipants(e.target.value ? Number(e.target.value) : '')}\r\n                                        min=\"0\"\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.price', 'Preis')}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={price}\r\n                                        onChange={(e) => setPrice(e.target.value ? Number(e.target.value) : '')}\r\n                                        min=\"0\"\r\n                                        step=\"0.01\"\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.currency', 'Whrung')}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={currency}\r\n                                        onChange={(e) => setCurrency(e.target.value)}\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.location', 'Ort')}\r\n                                </label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={location}\r\n                                    onChange={(e) => setLocation(e.target.value)}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                />\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.meetingPoint', 'Treffpunkt')}\r\n                                </label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={meetingPoint}\r\n                                    onChange={(e) => setMeetingPoint(e.target.value)}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Externe Tour-Informationen */}\r\n                        {type === TourType.EXTERNAL && (\r\n                            <div className=\"space-y-4\">\r\n                                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                                    {t('tours.externalInfo', 'Externe Tour-Informationen')}\r\n                                </h3>\r\n                                \r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.externalProvider', 'Externer Anbieter')}\r\n                                    </label>\r\n                                    <select\r\n                                        value={externalProviderId}\r\n                                        onChange={(e) => setExternalProviderId(e.target.value ? Number(e.target.value) : '')}\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    >\r\n                                        <option value=\"\">{t('common.select', 'Auswhlen')}</option>\r\n                                        {tourProviders.map(provider => (\r\n                                            <option key={provider.id} value={provider.id}>{provider.name}</option>\r\n                                        ))}\r\n                                    </select>\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.externalBookingUrl', 'Externe Buchungs-URL')}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"url\"\r\n                                        value={externalBookingUrl}\r\n                                        onChange={(e) => setExternalBookingUrl(e.target.value)}\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Kommissionen */}\r\n                        <div className=\"space-y-4\">\r\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                                {t('tours.commissions', 'Kommissionen')}\r\n                            </h3>\r\n                            \r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.totalCommission', 'Gesamtkommission')}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={totalCommission}\r\n                                        onChange={(e) => setTotalCommission(e.target.value ? Number(e.target.value) : '')}\r\n                                        min=\"0\"\r\n                                        step=\"0.01\"\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.totalCommissionPercent', 'Gesamtkommission (%)')}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={totalCommissionPercent}\r\n                                        onChange={(e) => setTotalCommissionPercent(e.target.value ? Number(e.target.value) : '')}\r\n                                        min=\"0\"\r\n                                        max=\"100\"\r\n                                        step=\"0.01\"\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.sellerCommissionPercent', 'Verkufer-Kommission (%)')}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={sellerCommissionPercent}\r\n                                        onChange={(e) => setSellerCommissionPercent(e.target.value ? Number(e.target.value) : '')}\r\n                                        min=\"0\"\r\n                                        max=\"100\"\r\n                                        step=\"0.01\"\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.sellerCommissionFixed', 'Verkufer-Kommission (Fix)')}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={sellerCommissionFixed}\r\n                                        onChange={(e) => setSellerCommissionFixed(e.target.value ? Number(e.target.value) : '')}\r\n                                        min=\"0\"\r\n                                        step=\"0.01\"\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Zustzliche Informationen */}\r\n                        <div className=\"space-y-4\">\r\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                                {t('tours.additionalInfo', 'Zustzliche Informationen')}\r\n                            </h3>\r\n                            \r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.includes', 'Enthlt')}\r\n                                </label>\r\n                                <textarea\r\n                                    value={includes}\r\n                                    onChange={(e) => setIncludes(e.target.value)}\r\n                                    rows={3}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                />\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.excludes', 'Nicht enthalten')}\r\n                                </label>\r\n                                <textarea\r\n                                    value={excludes}\r\n                                    onChange={(e) => setExcludes(e.target.value)}\r\n                                    rows={3}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                />\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.requirements', 'Anforderungen')}\r\n                                </label>\r\n                                <textarea\r\n                                    value={requirements}\r\n                                    onChange={(e) => setRequirements(e.target.value)}\r\n                                    rows={3}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={onClose}\r\n                                className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600\"\r\n                            >\r\n                                {t('common.cancel', 'Abbrechen')}\r\n                            </button>\r\n                            <button\r\n                                type=\"submit\"\r\n                                disabled={loading || loadingData}\r\n                                className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                            >\r\n                                {loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\r\n                            </button>\r\n                        </div>\r\n                    </form>\r\n                </Dialog.Panel>\r\n            </div>\r\n        </Dialog>\r\n    );\r\n};\r\n\r\nexport default CreateTourModal;\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport axiosInstance from '../../config/axios.ts';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon } from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../../config/api.ts';\r\nimport { useAuth } from '../../hooks/useAuth.tsx';\r\nimport { Tour, TourType, TourProvider } from '../../types/tour.ts';\r\nimport useMessage from '../../hooks/useMessage.ts';\r\n\r\ninterface Branch {\r\n    id: number;\r\n    name: string;\r\n}\r\n\r\ninterface EditTourModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    onTourUpdated: (updatedTour: Tour) => void;\r\n    tour: Tour;\r\n}\r\n\r\nconst EditTourModal = ({ isOpen, onClose, onTourUpdated, tour }: EditTourModalProps) => {\r\n    const { t } = useTranslation();\r\n    const { user } = useAuth();\r\n    const { showMessage } = useMessage();\r\n    \r\n    const [title, setTitle] = useState(tour.title || '');\r\n    const [description, setDescription] = useState(tour.description || '');\r\n    const [type, setType] = useState<TourType>(tour.type || TourType.OWN);\r\n    const [isActive, setIsActive] = useState(tour.isActive ?? true);\r\n    const [duration, setDuration] = useState<number | ''>(tour.duration || '');\r\n    const [maxParticipants, setMaxParticipants] = useState<number | ''>(tour.maxParticipants || '');\r\n    const [minParticipants, setMinParticipants] = useState<number | ''>(tour.minParticipants || '');\r\n    const [price, setPrice] = useState<number | ''>(tour.price ? (typeof tour.price === 'string' ? parseFloat(tour.price) : tour.price) : '');\r\n    const [currency, setCurrency] = useState(tour.currency || 'COP');\r\n    const [location, setLocation] = useState(tour.location || '');\r\n    const [meetingPoint, setMeetingPoint] = useState(tour.meetingPoint || '');\r\n    const [includes, setIncludes] = useState(tour.includes || '');\r\n    const [excludes, setExcludes] = useState(tour.excludes || '');\r\n    const [requirements, setRequirements] = useState(tour.requirements || '');\r\n    const [totalCommission, setTotalCommission] = useState<number | ''>(tour.totalCommission ? (typeof tour.totalCommission === 'string' ? parseFloat(tour.totalCommission) : tour.totalCommission) : '');\r\n    const [totalCommissionPercent, setTotalCommissionPercent] = useState<number | ''>(tour.totalCommissionPercent ? (typeof tour.totalCommissionPercent === 'string' ? parseFloat(tour.totalCommissionPercent) : tour.totalCommissionPercent) : '');\r\n    const [sellerCommissionPercent, setSellerCommissionPercent] = useState<number | ''>(tour.sellerCommissionPercent ? (typeof tour.sellerCommissionPercent === 'string' ? parseFloat(tour.sellerCommissionPercent) : tour.sellerCommissionPercent) : '');\r\n    const [sellerCommissionFixed, setSellerCommissionFixed] = useState<number | ''>(tour.sellerCommissionFixed ? (typeof tour.sellerCommissionFixed === 'string' ? parseFloat(tour.sellerCommissionFixed) : tour.sellerCommissionFixed) : '');\r\n    const [externalProviderId, setExternalProviderId] = useState<number | ''>(tour.externalProviderId || '');\r\n    const [externalBookingUrl, setExternalBookingUrl] = useState(tour.externalBookingUrl || '');\r\n    const [branchId, setBranchId] = useState<number | ''>(tour.branchId || '');\r\n    const [imageFile, setImageFile] = useState<File | null>(null);\r\n    const [imagePreview, setImagePreview] = useState<string | null>(tour.imageUrl ? `${API_BASE_URL || ''}${tour.imageUrl}` : null);\r\n    const [galleryFiles, setGalleryFiles] = useState<File[]>([]);\r\n    const [galleryPreviews, setGalleryPreviews] = useState<string[]>(tour.galleryUrls?.map(url => `${API_BASE_URL || ''}${url}`) || []);\r\n    const [uploadingImage, setUploadingImage] = useState(false);\r\n    \r\n    const [branches, setBranches] = useState<Branch[]>([]);\r\n    const [tourProviders, setTourProviders] = useState<TourProvider[]>([]);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [loading, setLoading] = useState(false);\r\n    const [loadingData, setLoadingData] = useState(true);\r\n\r\n    // Lade Branches und TourProviders\r\n    useEffect(() => {\r\n        const loadData = async () => {\r\n            try {\r\n                setLoadingData(true);\r\n                const [branchesRes, providersRes] = await Promise.all([\r\n                    axiosInstance.get(API_ENDPOINTS.BRANCHES.BASE),\r\n                    axiosInstance.get(API_ENDPOINTS.TOUR_PROVIDERS?.BASE || '/api/tour-providers')\r\n                ]);\r\n                \r\n                setBranches(branchesRes.data?.data || branchesRes.data || []);\r\n                setTourProviders(providersRes.data?.data || providersRes.data || []);\r\n            } catch (err: any) {\r\n                console.error('Fehler beim Laden der Daten:', err);\r\n                showMessage(t('errors.loadError'), 'error');\r\n            } finally {\r\n                setLoadingData(false);\r\n            }\r\n        };\r\n        \r\n        if (isOpen) {\r\n            loadData();\r\n        }\r\n    }, [isOpen, t, showMessage]);\r\n\r\n    // Update form when tour changes\r\n    useEffect(() => {\r\n        if (tour) {\r\n            setTitle(tour.title || '');\r\n            setDescription(tour.description || '');\r\n            setType(tour.type || TourType.OWN);\r\n            setIsActive(tour.isActive ?? true);\r\n            setDuration(tour.duration || '');\r\n            setMaxParticipants(tour.maxParticipants || '');\r\n            setMinParticipants(tour.minParticipants || '');\r\n            setPrice(tour.price ? (typeof tour.price === 'string' ? parseFloat(tour.price) : tour.price) : '');\r\n            setCurrency(tour.currency || 'COP');\r\n            setLocation(tour.location || '');\r\n            setMeetingPoint(tour.meetingPoint || '');\r\n            setIncludes(tour.includes || '');\r\n            setExcludes(tour.excludes || '');\r\n            setRequirements(tour.requirements || '');\r\n            setTotalCommission(tour.totalCommission ? (typeof tour.totalCommission === 'string' ? parseFloat(tour.totalCommission) : tour.totalCommission) : '');\r\n            setTotalCommissionPercent(tour.totalCommissionPercent ? (typeof tour.totalCommissionPercent === 'string' ? parseFloat(tour.totalCommissionPercent) : tour.totalCommissionPercent) : '');\r\n            setSellerCommissionPercent(tour.sellerCommissionPercent ? (typeof tour.sellerCommissionPercent === 'string' ? parseFloat(tour.sellerCommissionPercent) : tour.sellerCommissionPercent) : '');\r\n            setSellerCommissionFixed(tour.sellerCommissionFixed ? (typeof tour.sellerCommissionFixed === 'string' ? parseFloat(tour.sellerCommissionFixed) : tour.sellerCommissionFixed) : '');\r\n            setExternalProviderId(tour.externalProviderId || '');\r\n            setExternalBookingUrl(tour.externalBookingUrl || '');\r\n            setBranchId(tour.branchId || '');\r\n            setImagePreview(tour.imageUrl ? `${API_BASE_URL || ''}${tour.imageUrl}` : null);\r\n            setGalleryPreviews(tour.galleryUrls?.map(url => `${API_BASE_URL || ''}${url}`) || []);\r\n        }\r\n    }, [tour]);\r\n    \r\n    // Bild-Vorschau erstellen\r\n    const handleImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = e.target.files?.[0];\r\n        if (file) {\r\n            setImageFile(file);\r\n            const reader = new FileReader();\r\n            reader.onloadend = () => {\r\n                setImagePreview(reader.result as string);\r\n            };\r\n            reader.readAsDataURL(file);\r\n        }\r\n    };\r\n    \r\n    const handleGalleryChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const files = Array.from(e.target.files || []);\r\n        if (files.length > 0) {\r\n            setGalleryFiles(prev => [...prev, ...files]);\r\n            files.forEach(file => {\r\n                const reader = new FileReader();\r\n                reader.onloadend = () => {\r\n                    setGalleryPreviews(prev => [...prev, reader.result as string]);\r\n                };\r\n                reader.readAsDataURL(file);\r\n            });\r\n        }\r\n    };\r\n    \r\n    const removeGalleryImage = async (index: number) => {\r\n        // Wenn es ein existierendes Bild ist (aus tour.galleryUrls), lsche es vom Server\r\n        const currentGallery = tour.galleryUrls || [];\r\n        if (index < currentGallery.length) {\r\n            try {\r\n                await axiosInstance.delete(API_ENDPOINTS.TOURS.DELETE_GALLERY_IMAGE(tour.id, index));\r\n                // Lade Tour neu\r\n                const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(tour.id));\r\n                if (response.data.success) {\r\n                    onTourUpdated(response.data.data);\r\n                }\r\n            } catch (err: any) {\r\n                console.error('Fehler beim Lschen des Galerie-Bildes:', err);\r\n                showMessage(err.response?.data?.message || t('errors.deleteError'), 'error');\r\n            }\r\n        } else {\r\n            // Wenn es ein neues Bild ist (noch nicht hochgeladen), entferne es nur aus dem State\r\n            const newIndex = index - currentGallery.length;\r\n            setGalleryFiles(prev => prev.filter((_, i) => i !== newIndex));\r\n            setGalleryPreviews(prev => prev.filter((_, i) => i !== index));\r\n        }\r\n    };\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setError(null);\r\n        setLoading(true);\r\n\r\n        try {\r\n            const tourData: any = {\r\n                title,\r\n                description: description || null,\r\n                type,\r\n                isActive,\r\n                duration: duration ? Number(duration) : null,\r\n                maxParticipants: maxParticipants ? Number(maxParticipants) : null,\r\n                minParticipants: minParticipants ? Number(minParticipants) : null,\r\n                price: price ? Number(price) : null,\r\n                currency: currency || 'COP',\r\n                location: location || null,\r\n                meetingPoint: meetingPoint || null,\r\n                includes: includes || null,\r\n                excludes: excludes || null,\r\n                requirements: requirements || null,\r\n                totalCommission: totalCommission ? Number(totalCommission) : null,\r\n                totalCommissionPercent: totalCommissionPercent ? Number(totalCommissionPercent) : null,\r\n                sellerCommissionPercent: sellerCommissionPercent ? Number(sellerCommissionPercent) : null,\r\n                sellerCommissionFixed: sellerCommissionFixed ? Number(sellerCommissionFixed) : null,\r\n                externalProviderId: externalProviderId ? Number(externalProviderId) : null,\r\n                externalBookingUrl: externalBookingUrl || null,\r\n                branchId: branchId ? Number(branchId) : null\r\n            };\r\n\r\n            const response = await axiosInstance.put(API_ENDPOINTS.TOURS.BY_ID(tour.id), tourData);\r\n            \r\n            if (response.data.success) {\r\n                const updatedTour = response.data.data;\r\n                \r\n                // Hauptbild hochladen (falls gendert)\r\n                if (imageFile) {\r\n                    try {\r\n                        setUploadingImage(true);\r\n                        const formData = new FormData();\r\n                        formData.append('image', imageFile);\r\n                        await axiosInstance.post(API_ENDPOINTS.TOURS.UPLOAD_IMAGE(tour.id), formData, {\r\n                            headers: { 'Content-Type': 'multipart/form-data' }\r\n                        });\r\n                    } catch (imgErr: any) {\r\n                        console.error('Fehler beim Hochladen des Hauptbildes:', imgErr);\r\n                        showMessage(t('tours.imageUploadError', 'Tour aktualisiert, aber Fehler beim Hochladen des Bildes'), 'warning');\r\n                    } finally {\r\n                        setUploadingImage(false);\r\n                    }\r\n                }\r\n                \r\n                // Neue Galerie-Bilder hochladen (falls vorhanden)\r\n                if (galleryFiles.length > 0) {\r\n                    try {\r\n                        setUploadingImage(true);\r\n                        for (const file of galleryFiles) {\r\n                            const formData = new FormData();\r\n                            formData.append('image', file);\r\n                            await axiosInstance.post(API_ENDPOINTS.TOURS.UPLOAD_GALLERY(tour.id), formData, {\r\n                                headers: { 'Content-Type': 'multipart/form-data' }\r\n                            });\r\n                        }\r\n                    } catch (galleryErr: any) {\r\n                        console.error('Fehler beim Hochladen der Galerie-Bilder:', galleryErr);\r\n                        showMessage(t('tours.galleryUploadError', 'Tour aktualisiert, aber Fehler beim Hochladen der Galerie-Bilder'), 'warning');\r\n                    } finally {\r\n                        setUploadingImage(false);\r\n                    }\r\n                }\r\n                \r\n                showMessage(t('tours.updateSuccess', 'Tour erfolgreich aktualisiert'), 'success');\r\n                // Lade Tour neu, um aktualisierte Bilder zu erhalten\r\n                const updatedResponse = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(tour.id));\r\n                onTourUpdated(updatedResponse.data.data);\r\n                onClose();\r\n            } else {\r\n                setError(response.data.message || t('errors.saveError'));\r\n            }\r\n        } catch (err: any) {\r\n            console.error('Fehler beim Aktualisieren der Tour:', err);\r\n            const errorMessage = err.response?.data?.message || t('errors.saveError');\r\n            setError(errorMessage);\r\n            showMessage(errorMessage, 'error');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n                <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] overflow-y-auto\">\r\n                    <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\r\n                        <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white\">\r\n                            {t('tours.edit', 'Tour bearbeiten')}\r\n                        </Dialog.Title>\r\n                        <button\r\n                            onClick={onClose}\r\n                            className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\r\n                        >\r\n                            <XMarkIcon className=\"h-6 w-6\" />\r\n                        </button>\r\n                    </div>\r\n\r\n                    <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">\r\n                        {error && (\r\n                            <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-800 dark:text-red-200 px-4 py-3 rounded\">\r\n                                {error}\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Grundinformationen */}\r\n                        <div className=\"space-y-4\">\r\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                                {t('tours.basicInfo', 'Grundinformationen')}\r\n                            </h3>\r\n                            \r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.name', 'Titel')} *\r\n                                </label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={title}\r\n                                    onChange={(e) => setTitle(e.target.value)}\r\n                                    required\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                />\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.description', 'Beschreibung')}\r\n                                </label>\r\n                                <textarea\r\n                                    value={description}\r\n                                    onChange={(e) => setDescription(e.target.value)}\r\n                                    rows={4}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                />\r\n                            </div>\r\n\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.type', 'Typ')} *\r\n                                    </label>\r\n                                    <select\r\n                                        value={type}\r\n                                        onChange={(e) => setType(e.target.value as TourType)}\r\n                                        required\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    >\r\n                                        <option value={TourType.OWN}>{t('tours.typeOwn', 'Eigene Tour')}</option>\r\n                                        <option value={TourType.EXTERNAL}>{t('tours.typeExternal', 'Externe Tour')}</option>\r\n                                    </select>\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.status', 'Status')}\r\n                                    </label>\r\n                                    <select\r\n                                        value={isActive ? 'true' : 'false'}\r\n                                        onChange={(e) => setIsActive(e.target.value === 'true')}\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    >\r\n                                        <option value=\"true\">{t('tours.statusActive', 'Aktiv')}</option>\r\n                                        <option value=\"false\">{t('tours.statusInactive', 'Inaktiv')}</option>\r\n                                    </select>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.branch', 'Niederlassung')}\r\n                                </label>\r\n                                <select\r\n                                    value={branchId}\r\n                                    onChange={(e) => setBranchId(e.target.value ? Number(e.target.value) : '')}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                >\r\n                                    <option value=\"\">{t('common.all', 'Alle')}</option>\r\n                                    {branches.map(branch => (\r\n                                        <option key={branch.id} value={branch.id}>{branch.name}</option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Tour-Details */}\r\n                        <div className=\"space-y-4\">\r\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                                {t('tours.details', 'Tour-Details')}\r\n                            </h3>\r\n                            \r\n                            <div className=\"grid grid-cols-3 gap-4\">\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.duration', 'Dauer (Stunden)')}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={duration}\r\n                                        onChange={(e) => setDuration(e.target.value ? Number(e.target.value) : '')}\r\n                                        min=\"0\"\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.minParticipants', 'Min. Teilnehmer')}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={minParticipants}\r\n                                        onChange={(e) => setMinParticipants(e.target.value ? Number(e.target.value) : '')}\r\n                                        min=\"0\"\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.maxParticipants', 'Max. Teilnehmer')}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={maxParticipants}\r\n                                        onChange={(e) => setMaxParticipants(e.target.value ? Number(e.target.value) : '')}\r\n                                        min=\"0\"\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.price', 'Preis')}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={price}\r\n                                        onChange={(e) => setPrice(e.target.value ? Number(e.target.value) : '')}\r\n                                        min=\"0\"\r\n                                        step=\"0.01\"\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.currency', 'Whrung')}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"text\"\r\n                                        value={currency}\r\n                                        onChange={(e) => setCurrency(e.target.value)}\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.location', 'Ort')}\r\n                                </label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={location}\r\n                                    onChange={(e) => setLocation(e.target.value)}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                />\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.meetingPoint', 'Treffpunkt')}\r\n                                </label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={meetingPoint}\r\n                                    onChange={(e) => setMeetingPoint(e.target.value)}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Externe Tour-Informationen */}\r\n                        {type === TourType.EXTERNAL && (\r\n                            <div className=\"space-y-4\">\r\n                                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                                    {t('tours.externalInfo', 'Externe Tour-Informationen')}\r\n                                </h3>\r\n                                \r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.externalProvider', 'Externer Anbieter')}\r\n                                    </label>\r\n                                    <select\r\n                                        value={externalProviderId}\r\n                                        onChange={(e) => setExternalProviderId(e.target.value ? Number(e.target.value) : '')}\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    >\r\n                                        <option value=\"\">{t('common.select', 'Auswhlen')}</option>\r\n                                        {tourProviders.map(provider => (\r\n                                            <option key={provider.id} value={provider.id}>{provider.name}</option>\r\n                                        ))}\r\n                                    </select>\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.externalBookingUrl', 'Externe Buchungs-URL')}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"url\"\r\n                                        value={externalBookingUrl}\r\n                                        onChange={(e) => setExternalBookingUrl(e.target.value)}\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Kommissionen */}\r\n                        <div className=\"space-y-4\">\r\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                                {t('tours.commissions', 'Kommissionen')}\r\n                            </h3>\r\n                            \r\n                            <div className=\"grid grid-cols-2 gap-4\">\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.totalCommission', 'Gesamtkommission')}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={totalCommission}\r\n                                        onChange={(e) => setTotalCommission(e.target.value ? Number(e.target.value) : '')}\r\n                                        min=\"0\"\r\n                                        step=\"0.01\"\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.totalCommissionPercent', 'Gesamtkommission (%)')}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={totalCommissionPercent}\r\n                                        onChange={(e) => setTotalCommissionPercent(e.target.value ? Number(e.target.value) : '')}\r\n                                        min=\"0\"\r\n                                        max=\"100\"\r\n                                        step=\"0.01\"\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.sellerCommissionPercent', 'Verkufer-Kommission (%)')}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={sellerCommissionPercent}\r\n                                        onChange={(e) => setSellerCommissionPercent(e.target.value ? Number(e.target.value) : '')}\r\n                                        min=\"0\"\r\n                                        max=\"100\"\r\n                                        step=\"0.01\"\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                        {t('tours.sellerCommissionFixed', 'Verkufer-Kommission (Fix)')}\r\n                                    </label>\r\n                                    <input\r\n                                        type=\"number\"\r\n                                        value={sellerCommissionFixed}\r\n                                        onChange={(e) => setSellerCommissionFixed(e.target.value ? Number(e.target.value) : '')}\r\n                                        min=\"0\"\r\n                                        step=\"0.01\"\r\n                                        className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Zustzliche Informationen */}\r\n                        <div className=\"space-y-4\">\r\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                                {t('tours.additionalInfo', 'Zustzliche Informationen')}\r\n                            </h3>\r\n                            \r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.includes', 'Enthlt')}\r\n                                </label>\r\n                                <textarea\r\n                                    value={includes}\r\n                                    onChange={(e) => setIncludes(e.target.value)}\r\n                                    rows={3}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                />\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.excludes', 'Nicht enthalten')}\r\n                                </label>\r\n                                <textarea\r\n                                    value={excludes}\r\n                                    onChange={(e) => setExcludes(e.target.value)}\r\n                                    rows={3}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                />\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.requirements', 'Anforderungen')}\r\n                                </label>\r\n                                <textarea\r\n                                    value={requirements}\r\n                                    onChange={(e) => setRequirements(e.target.value)}\r\n                                    rows={3}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Bild-Upload */}\r\n                        <div className=\"space-y-4\">\r\n                            <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                                {t('tours.images', 'Bilder')}\r\n                            </h3>\r\n                            \r\n                            {/* Hauptbild */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.mainImage', 'Hauptbild')}\r\n                                </label>\r\n                                <input\r\n                                    type=\"file\"\r\n                                    accept=\"image/*\"\r\n                                    onChange={handleImageChange}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                />\r\n                                {imagePreview && (\r\n                                    <div className=\"mt-2\">\r\n                                        <img\r\n                                            src={imagePreview}\r\n                                            alt=\"Vorschau\"\r\n                                            className=\"max-w-xs h-48 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\r\n                                        />\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                            \r\n                            {/* Galerie */}\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.gallery', 'Galerie')}\r\n                                </label>\r\n                                <input\r\n                                    type=\"file\"\r\n                                    accept=\"image/*\"\r\n                                    multiple\r\n                                    onChange={handleGalleryChange}\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                />\r\n                                {galleryPreviews.length > 0 && (\r\n                                    <div className=\"mt-2 grid grid-cols-3 gap-2\">\r\n                                        {galleryPreviews.map((preview, index) => (\r\n                                            <div key={index} className=\"relative\">\r\n                                                <img\r\n                                                    src={preview}\r\n                                                    alt={`Galerie ${index + 1}`}\r\n                                                    className=\"w-full h-32 object-cover rounded-md border border-gray-300 dark:border-gray-600\"\r\n                                                />\r\n                                                <button\r\n                                                    type=\"button\"\r\n                                                    onClick={() => removeGalleryImage(index)}\r\n                                                    className=\"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600\"\r\n                                                >\r\n                                                    <XMarkIcon className=\"h-4 w-4\" />\r\n                                                </button>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={onClose}\r\n                                className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600\"\r\n                            >\r\n                                {t('common.cancel', 'Abbrechen')}\r\n                            </button>\r\n                            <button\r\n                                type=\"submit\"\r\n                                disabled={loading || loadingData || uploadingImage}\r\n                                className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                            >\r\n                                {loading ? t('common.saving', 'Speichere...') : t('common.save', 'Speichern')}\r\n                            </button>\r\n                        </div>\r\n                    </form>\r\n                </Dialog.Panel>\r\n            </div>\r\n        </Dialog>\r\n    );\r\n};\r\n\r\nexport default EditTourModal;\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport axiosInstance from '../../config/axios.ts';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, MapPinIcon, ClockIcon, UsersIcon, CurrencyDollarIcon, BuildingOfficeIcon, UserIcon } from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../../config/api.ts';\r\nimport { Tour, TourType } from '../../types/tour.ts';\r\nimport useMessage from '../../hooks/useMessage.ts';\r\nimport { format } from 'date-fns';\r\nimport { de } from 'date-fns/locale';\r\n\r\ninterface TourDetailsModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    tourId: number;\r\n    onTourUpdated?: (updatedTour: Tour) => void;\r\n}\r\n\r\nconst TourDetailsModal = ({ isOpen, onClose, tourId, onTourUpdated }: TourDetailsModalProps) => {\r\n    const { t } = useTranslation();\r\n    const { showMessage } = useMessage();\r\n    const [tour, setTour] = useState<Tour | null>(null);\r\n    const [loading, setLoading] = useState(false);\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    useEffect(() => {\r\n        if (isOpen && tourId) {\r\n            loadTour();\r\n        }\r\n    }, [isOpen, tourId]);\r\n\r\n    const loadTour = async () => {\r\n        try {\r\n            setLoading(true);\r\n            setError(null);\r\n            const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BY_ID(tourId));\r\n            if (response.data.success) {\r\n                setTour(response.data.data);\r\n            } else {\r\n                setError(response.data.message || t('errors.loadError'));\r\n            }\r\n        } catch (err: any) {\r\n            console.error('Fehler beim Laden der Tour:', err);\r\n            const errorMessage = err.response?.data?.message || t('errors.loadError');\r\n            setError(errorMessage);\r\n            showMessage(errorMessage, 'error');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n                <Dialog.Panel className=\"mx-auto max-w-4xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] overflow-y-auto\">\r\n                    <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\r\n                        <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white\">\r\n                            {t('tours.details', 'Tour-Details')}\r\n                        </Dialog.Title>\r\n                        <button\r\n                            onClick={onClose}\r\n                            className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\r\n                        >\r\n                            <XMarkIcon className=\"h-6 w-6\" />\r\n                        </button>\r\n                    </div>\r\n\r\n                    <div className=\"p-6\">\r\n                        {loading ? (\r\n                            <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\r\n                                {t('common.loading')}\r\n                            </div>\r\n                        ) : error ? (\r\n                            <div className=\"text-center py-8 text-red-500 dark:text-red-400\">\r\n                                {error}\r\n                            </div>\r\n                        ) : !tour ? (\r\n                            <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\r\n                                {t('tours.notFound', 'Tour nicht gefunden')}\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"space-y-6\">\r\n                                {/* Header */}\r\n                                <div>\r\n                                    <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-2\">\r\n                                        {tour.title}\r\n                                    </h2>\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <span className={`px-3 py-1 text-sm rounded-full ${\r\n                                            tour.type === TourType.OWN\r\n                                                ? 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200'\r\n                                                : 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200'\r\n                                        }`}>\r\n                                            {tour.type === TourType.OWN ? t('tours.typeOwn') : t('tours.typeExternal')}\r\n                                        </span>\r\n                                        <span className={`px-3 py-1 text-sm rounded-full ${\r\n                                            tour.isActive\r\n                                                ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200'\r\n                                                : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200'\r\n                                        }`}>\r\n                                            {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Beschreibung */}\r\n                                {tour.description && (\r\n                                    <div>\r\n                                        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\">\r\n                                            {t('tours.description')}\r\n                                        </h3>\r\n                                        <p className=\"text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\r\n                                            {tour.description}\r\n                                        </p>\r\n                                    </div>\r\n                                )}\r\n\r\n                                {/* Tour-Details Grid */}\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                                    {/* Linke Spalte */}\r\n                                    <div className=\"space-y-4\">\r\n                                        {tour.duration && (\r\n                                            <div className=\"flex items-start gap-3\">\r\n                                                <ClockIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\r\n                                                <div>\r\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\r\n                                                        {t('tours.duration')}\r\n                                                    </div>\r\n                                                    <div className=\"text-gray-900 dark:text-white\">\r\n                                                        {tour.duration} {t('common.hours', 'h')}\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n\r\n                                        {(tour.minParticipants || tour.maxParticipants) && (\r\n                                            <div className=\"flex items-start gap-3\">\r\n                                                <UsersIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\r\n                                                <div>\r\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\r\n                                                        {t('tours.participants', 'Teilnehmer')}\r\n                                                    </div>\r\n                                                    <div className=\"text-gray-900 dark:text-white\">\r\n                                                        {tour.minParticipants && tour.maxParticipants\r\n                                                            ? `${tour.minParticipants} - ${tour.maxParticipants}`\r\n                                                            : tour.minParticipants\r\n                                                            ? `${tour.minParticipants}+`\r\n                                                            : tour.maxParticipants\r\n                                                            ? `bis ${tour.maxParticipants}`\r\n                                                            : '-'}\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n\r\n                                        {tour.price && (\r\n                                            <div className=\"flex items-start gap-3\">\r\n                                                <CurrencyDollarIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\r\n                                                <div>\r\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\r\n                                                        {t('tours.price')}\r\n                                                    </div>\r\n                                                    <div className=\"text-gray-900 dark:text-white font-semibold\">\r\n                                                        {Number(tour.price).toLocaleString()} {tour.currency || 'COP'}\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n\r\n                                        {tour.location && (\r\n                                            <div className=\"flex items-start gap-3\">\r\n                                                <MapPinIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\r\n                                                <div>\r\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\r\n                                                        {t('tours.location')}\r\n                                                    </div>\r\n                                                    <div className=\"text-gray-900 dark:text-white\">\r\n                                                        {tour.location}\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n\r\n                                        {tour.meetingPoint && (\r\n                                            <div className=\"flex items-start gap-3\">\r\n                                                <MapPinIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\r\n                                                <div>\r\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\r\n                                                        {t('tours.meetingPoint')}\r\n                                                    </div>\r\n                                                    <div className=\"text-gray-900 dark:text-white\">\r\n                                                        {tour.meetingPoint}\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n\r\n                                    {/* Rechte Spalte */}\r\n                                    <div className=\"space-y-4\">\r\n                                        {tour.branch && (\r\n                                            <div className=\"flex items-start gap-3\">\r\n                                                <BuildingOfficeIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\r\n                                                <div>\r\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\r\n                                                        {t('tours.branch')}\r\n                                                    </div>\r\n                                                    <div className=\"text-gray-900 dark:text-white\">\r\n                                                        {tour.branch.name}\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n\r\n                                        {tour.createdBy && (\r\n                                            <div className=\"flex items-start gap-3\">\r\n                                                <UserIcon className=\"h-5 w-5 text-gray-400 mt-0.5\" />\r\n                                                <div>\r\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\r\n                                                        {t('tours.columns.createdBy')}\r\n                                                    </div>\r\n                                                    <div className=\"text-gray-900 dark:text-white\">\r\n                                                        {tour.createdBy.firstName} {tour.createdBy.lastName}\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n\r\n                                        {tour.createdAt && (\r\n                                            <div>\r\n                                                <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\r\n                                                    {t('common.createdAt', 'Erstellt am')}\r\n                                                </div>\r\n                                                <div className=\"text-gray-900 dark:text-white\">\r\n                                                    {format(new Date(tour.createdAt), 'dd.MM.yyyy HH:mm', { locale: de })}\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n\r\n                                        {tour.externalProvider && (\r\n                                            <div>\r\n                                                <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\r\n                                                    {t('tours.externalProvider')}\r\n                                                </div>\r\n                                                <div className=\"text-gray-900 dark:text-white\">\r\n                                                    {tour.externalProvider.name}\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n\r\n                                        {tour.externalBookingUrl && (\r\n                                            <div>\r\n                                                <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\r\n                                                    {t('tours.externalBookingUrl')}\r\n                                                </div>\r\n                                                <a\r\n                                                    href={tour.externalBookingUrl}\r\n                                                    target=\"_blank\"\r\n                                                    rel=\"noopener noreferrer\"\r\n                                                    className=\"text-blue-600 dark:text-blue-400 hover:underline\"\r\n                                                >\r\n                                                    {tour.externalBookingUrl}\r\n                                                </a>\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Kommissionen */}\r\n                                {(tour.totalCommission || tour.totalCommissionPercent || tour.sellerCommissionPercent || tour.sellerCommissionFixed) && (\r\n                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-6\">\r\n                                        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\r\n                                            {t('tours.commissions')}\r\n                                        </h3>\r\n                                        <div className=\"grid grid-cols-2 gap-4\">\r\n                                            {tour.totalCommission && (\r\n                                                <div>\r\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\r\n                                                        {t('tours.totalCommission')}\r\n                                                    </div>\r\n                                                    <div className=\"text-gray-900 dark:text-white\">\r\n                                                        {Number(tour.totalCommission).toLocaleString()} {tour.currency || 'COP'}\r\n                                                    </div>\r\n                                                </div>\r\n                                            )}\r\n                                            {tour.totalCommissionPercent && (\r\n                                                <div>\r\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\r\n                                                        {t('tours.totalCommissionPercent')}\r\n                                                    </div>\r\n                                                    <div className=\"text-gray-900 dark:text-white\">\r\n                                                        {Number(tour.totalCommissionPercent)}%\r\n                                                    </div>\r\n                                                </div>\r\n                                            )}\r\n                                            {tour.sellerCommissionPercent && (\r\n                                                <div>\r\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\r\n                                                        {t('tours.sellerCommissionPercent')}\r\n                                                    </div>\r\n                                                    <div className=\"text-gray-900 dark:text-white\">\r\n                                                        {Number(tour.sellerCommissionPercent)}%\r\n                                                    </div>\r\n                                                </div>\r\n                                            )}\r\n                                            {tour.sellerCommissionFixed && (\r\n                                                <div>\r\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\r\n                                                        {t('tours.sellerCommissionFixed')}\r\n                                                    </div>\r\n                                                    <div className=\"text-gray-900 dark:text-white\">\r\n                                                        {Number(tour.sellerCommissionFixed).toLocaleString()} {tour.currency || 'COP'}\r\n                                                    </div>\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                {/* Zustzliche Informationen */}\r\n                                {(tour.includes || tour.excludes || tour.requirements) && (\r\n                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-6\">\r\n                                        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\r\n                                            {t('tours.additionalInfo')}\r\n                                        </h3>\r\n                                        <div className=\"space-y-4\">\r\n                                            {tour.includes && (\r\n                                                <div>\r\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1\">\r\n                                                        {t('tours.includes')}\r\n                                                    </div>\r\n                                                    <p className=\"text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\r\n                                                        {tour.includes}\r\n                                                    </p>\r\n                                                </div>\r\n                                            )}\r\n                                            {tour.excludes && (\r\n                                                <div>\r\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1\">\r\n                                                        {t('tours.excludes')}\r\n                                                    </div>\r\n                                                    <p className=\"text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\r\n                                                        {tour.excludes}\r\n                                                    </p>\r\n                                                </div>\r\n                                            )}\r\n                                            {tour.requirements && (\r\n                                                <div>\r\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1\">\r\n                                                        {t('tours.requirements')}\r\n                                                    </div>\r\n                                                    <p className=\"text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\r\n                                                        {tour.requirements}\r\n                                                    </p>\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n\r\n                                {/* Verfgbarkeit */}\r\n                                {(tour.availableFrom || tour.availableTo) && (\r\n                                    <div className=\"border-t border-gray-200 dark:border-gray-700 pt-6\">\r\n                                        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\r\n                                            {t('tours.availability', 'Verfgbarkeit')}\r\n                                        </h3>\r\n                                        <div className=\"grid grid-cols-2 gap-4\">\r\n                                            {tour.availableFrom && (\r\n                                                <div>\r\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\r\n                                                        {t('tours.availableFrom', 'Verfgbar ab')}\r\n                                                    </div>\r\n                                                    <div className=\"text-gray-900 dark:text-white\">\r\n                                                        {format(new Date(tour.availableFrom), 'dd.MM.yyyy', { locale: de })}\r\n                                                    </div>\r\n                                                </div>\r\n                                            )}\r\n                                            {tour.availableTo && (\r\n                                                <div>\r\n                                                    <div className=\"text-sm font-medium text-gray-500 dark:text-gray-400\">\r\n                                                        {t('tours.availableTo', 'Verfgbar bis')}\r\n                                                    </div>\r\n                                                    <div className=\"text-gray-900 dark:text-white\">\r\n                                                        {format(new Date(tour.availableTo), 'dd.MM.yyyy', { locale: de })}\r\n                                                    </div>\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"flex justify-end p-6 border-t border-gray-200 dark:border-gray-700\">\r\n                        <button\r\n                            onClick={onClose}\r\n                            className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600\"\r\n                        >\r\n                            {t('common.close', 'Schlieen')}\r\n                        </button>\r\n                    </div>\r\n                </Dialog.Panel>\r\n            </div>\r\n        </Dialog>\r\n    );\r\n};\r\n\r\nexport default TourDetailsModal;\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport axiosInstance from '../../config/axios.ts';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon } from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../../config/api.ts';\r\nimport { TourBooking, TourBookingStatus } from '../../types/tour.ts';\r\nimport useMessage from '../../hooks/useMessage.ts';\r\nimport { format } from 'date-fns';\r\nimport { de } from 'date-fns/locale';\r\n\r\ninterface TourBookingsModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    tourId: number;\r\n}\r\n\r\nconst TourBookingsModal = ({ isOpen, onClose, tourId }: TourBookingsModalProps) => {\r\n    const { t } = useTranslation();\r\n    const { showMessage } = useMessage();\r\n    const [bookings, setBookings] = useState<TourBooking[]>([]);\r\n    const [loading, setLoading] = useState(false);\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    useEffect(() => {\r\n        if (isOpen && tourId) {\r\n            loadBookings();\r\n        }\r\n    }, [isOpen, tourId]);\r\n\r\n    const loadBookings = async () => {\r\n        try {\r\n            setLoading(true);\r\n            setError(null);\r\n            const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BOOKINGS(tourId));\r\n            if (response.data.success) {\r\n                setBookings(response.data.data || []);\r\n            } else {\r\n                setError(response.data.message || t('errors.loadError'));\r\n            }\r\n        } catch (err: any) {\r\n            console.error('Fehler beim Laden der Buchungen:', err);\r\n            const errorMessage = err.response?.data?.message || t('errors.loadError');\r\n            setError(errorMessage);\r\n            showMessage(errorMessage, 'error');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const getStatusColor = (status: TourBookingStatus) => {\r\n        switch (status) {\r\n            case TourBookingStatus.CONFIRMED:\r\n                return 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200';\r\n            case TourBookingStatus.CANCELLED:\r\n                return 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200';\r\n            case TourBookingStatus.COMPLETED:\r\n                return 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200';\r\n            case TourBookingStatus.NO_SHOW:\r\n                return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200';\r\n            default:\r\n                return 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200';\r\n        }\r\n    };\r\n\r\n    const getPaymentStatusColor = (status: string) => {\r\n        switch (status) {\r\n            case 'paid':\r\n                return 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200';\r\n            case 'partially_paid':\r\n                return 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200';\r\n            case 'pending':\r\n                return 'bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200';\r\n            case 'refunded':\r\n                return 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200';\r\n            default:\r\n                return 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200';\r\n        }\r\n    };\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n                <Dialog.Panel className=\"mx-auto max-w-6xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl max-h-[90vh] overflow-y-auto\">\r\n                    <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\r\n                        <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white\">\r\n                            {t('tours.bookings', 'Buchungen')} ({bookings.length})\r\n                        </Dialog.Title>\r\n                        <button\r\n                            onClick={onClose}\r\n                            className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\r\n                        >\r\n                            <XMarkIcon className=\"h-6 w-6\" />\r\n                        </button>\r\n                    </div>\r\n\r\n                    <div className=\"p-6\">\r\n                        {loading ? (\r\n                            <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\r\n                                {t('common.loading')}\r\n                            </div>\r\n                        ) : error ? (\r\n                            <div className=\"text-center py-8 text-red-500 dark:text-red-400\">\r\n                                {error}\r\n                            </div>\r\n                        ) : bookings.length === 0 ? (\r\n                            <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\r\n                                {t('tourBookings.noBookings', 'Keine Buchungen vorhanden')}\r\n                            </div>\r\n                        ) : (\r\n                            <div className=\"overflow-x-auto\">\r\n                                <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\r\n                                    <thead className=\"bg-gray-50 dark:bg-gray-800\">\r\n                                        <tr>\r\n                                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                                                {t('tourBookings.customerName', 'Kunde')}\r\n                                            </th>\r\n                                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                                                {t('tourBookings.tourDate', 'Tour-Datum')}\r\n                                            </th>\r\n                                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                                                {t('tourBookings.numberOfParticipants', 'Teilnehmer')}\r\n                                            </th>\r\n                                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                                                {t('tourBookings.totalPrice', 'Gesamtpreis')}\r\n                                            </th>\r\n                                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                                                {t('tourBookings.paymentStatus', 'Zahlungsstatus')}\r\n                                            </th>\r\n                                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                                                {t('tourBookings.status', 'Status')}\r\n                                            </th>\r\n                                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\r\n                                                {t('tourBookings.bookedBy', 'Gebucht von')}\r\n                                            </th>\r\n                                        </tr>\r\n                                    </thead>\r\n                                    <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\r\n                                        {bookings.map((booking) => (\r\n                                            <tr key={booking.id} className=\"hover:bg-gray-50 dark:hover:bg-gray-700\">\r\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                                    <div className=\"text-sm text-gray-900 dark:text-white\">\r\n                                                        {booking.customerName}\r\n                                                    </div>\r\n                                                    {booking.customerEmail && (\r\n                                                        <div className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                                                            {booking.customerEmail}\r\n                                                        </div>\r\n                                                    )}\r\n                                                    {booking.customerPhone && (\r\n                                                        <div className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                                                            {booking.customerPhone}\r\n                                                        </div>\r\n                                                    )}\r\n                                                </td>\r\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                                    <div className=\"text-sm text-gray-900 dark:text-white\">\r\n                                                        {format(new Date(booking.tourDate), 'dd.MM.yyyy', { locale: de })}\r\n                                                    </div>\r\n                                                    <div className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                                                        {t('tourBookings.bookingDate', 'Gebucht')}: {format(new Date(booking.bookingDate), 'dd.MM.yyyy', { locale: de })}\r\n                                                    </div>\r\n                                                </td>\r\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                                    <div className=\"text-sm text-gray-900 dark:text-white\">\r\n                                                        {booking.numberOfParticipants}\r\n                                                    </div>\r\n                                                </td>\r\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                                    <div className=\"text-sm text-gray-900 dark:text-white font-semibold\">\r\n                                                        {Number(booking.totalPrice).toLocaleString()} {booking.currency}\r\n                                                    </div>\r\n                                                    {booking.amountPaid && booking.amountPending && (\r\n                                                        <div className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                                                            {t('tourBookings.amountPaid', 'Bezahlt')}: {Number(booking.amountPaid).toLocaleString()} {booking.currency}\r\n                                                            <br />\r\n                                                            {t('tourBookings.amountPending', 'Ausstehend')}: {Number(booking.amountPending).toLocaleString()} {booking.currency}\r\n                                                        </div>\r\n                                                    )}\r\n                                                </td>\r\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                                    <span className={`px-2 py-1 text-xs rounded-full ${getPaymentStatusColor(booking.paymentStatus)}`}>\r\n                                                        {t(`tourBookings.paymentStatus.${booking.paymentStatus}`, booking.paymentStatus)}\r\n                                                    </span>\r\n                                                </td>\r\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                                    <span className={`px-2 py-1 text-xs rounded-full ${getStatusColor(booking.status)}`}>\r\n                                                        {t(`tourBookings.status.${booking.status}`, booking.status)}\r\n                                                    </span>\r\n                                                </td>\r\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\r\n                                                    {booking.bookedBy ? (\r\n                                                        <div className=\"text-sm text-gray-900 dark:text-white\">\r\n                                                            {booking.bookedBy.firstName} {booking.bookedBy.lastName}\r\n                                                        </div>\r\n                                                    ) : (\r\n                                                        <div className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                                                            -\r\n                                                        </div>\r\n                                                    )}\r\n                                                </td>\r\n                                            </tr>\r\n                                        ))}\r\n                                    </tbody>\r\n                                </table>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div className=\"flex justify-end p-6 border-t border-gray-200 dark:border-gray-700\">\r\n                        <button\r\n                            onClick={onClose}\r\n                            className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600\"\r\n                        >\r\n                            {t('common.close', 'Schlieen')}\r\n                        </button>\r\n                    </div>\r\n                </Dialog.Panel>\r\n            </div>\r\n        </Dialog>\r\n    );\r\n};\r\n\r\nexport default TourBookingsModal;\r\n\r\n","import React, { useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, ArrowDownTrayIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../../config/axios.ts';\nimport { API_ENDPOINTS } from '../../config/api.ts';\nimport useMessage from '../../hooks/useMessage.ts';\n\ninterface TourExportDialogProps {\n    isOpen: boolean;\n    onClose: () => void;\n    tourCount: number;\n}\n\nconst TourExportDialog = ({ isOpen, onClose, tourCount }: TourExportDialogProps) => {\n    const { t } = useTranslation();\n    const { showMessage } = useMessage();\n    \n    const [selectedFields, setSelectedFields] = useState<string[]>([\n        'id', 'title', 'description', 'type', 'price', 'currency', 'duration',\n        'maxParticipants', 'minParticipants', 'location', 'meetingPoint',\n        'imageUrl', 'galleryUrls', 'availableFrom', 'availableTo'\n    ]);\n    const [exporting, setExporting] = useState(false);\n    const [format, setFormat] = useState<'json' | 'csv'>('json');\n\n    const availableFields = [\n        { id: 'id', label: t('tours.columns.title', 'Titel') },\n        { id: 'title', label: t('tours.name', 'Titel') },\n        { id: 'description', label: t('tours.description', 'Beschreibung') },\n        { id: 'type', label: t('tours.type', 'Typ') },\n        { id: 'price', label: t('tours.price', 'Preis') },\n        { id: 'currency', label: t('tours.currency', 'Whrung') },\n        { id: 'duration', label: t('tours.duration', 'Dauer') },\n        { id: 'maxParticipants', label: t('tours.maxParticipants', 'Max. Teilnehmer') },\n        { id: 'minParticipants', label: t('tours.minParticipants', 'Min. Teilnehmer') },\n        { id: 'location', label: t('tours.location', 'Ort') },\n        { id: 'meetingPoint', label: t('tours.meetingPoint', 'Treffpunkt') },\n        { id: 'includes', label: t('tours.includes', 'Enthlt') },\n        { id: 'excludes', label: t('tours.excludes', 'Nicht enthalten') },\n        { id: 'requirements', label: t('tours.requirements', 'Anforderungen') },\n        { id: 'imageUrl', label: t('tours.mainImage', 'Hauptbild') },\n        { id: 'galleryUrls', label: t('tours.gallery', 'Galerie') },\n        { id: 'availableFrom', label: t('tours.availableFrom', 'Verfgbar ab') },\n        { id: 'availableTo', label: t('tours.availableTo', 'Verfgbar bis') },\n        { id: 'externalBookingUrl', label: t('tours.externalBookingUrl', 'Externe Buchungs-URL') },\n        { id: 'branch', label: t('tours.branch', 'Niederlassung') },\n        { id: 'externalProvider', label: t('tours.externalProvider', 'Externer Anbieter') }\n    ];\n\n    const toggleField = (fieldId: string) => {\n        setSelectedFields(prev =>\n            prev.includes(fieldId)\n                ? prev.filter(f => f !== fieldId)\n                : [...prev, fieldId]\n        );\n    };\n\n    const selectAll = () => {\n        setSelectedFields(availableFields.map(f => f.id));\n    };\n\n    const deselectAll = () => {\n        setSelectedFields([]);\n    };\n\n    const handleExport = async () => {\n        if (selectedFields.length === 0) {\n            showMessage(t('tours.export.noFieldsSelected', 'Bitte whlen Sie mindestens ein Feld aus'), 'error');\n            return;\n        }\n\n        setExporting(true);\n        try {\n            const fieldsParam = selectedFields.join(',');\n            const response = await axiosInstance.get(API_ENDPOINTS.TOURS.EXPORT, {\n                params: { fields: fieldsParam }\n            });\n\n            const tours = response.data.tours || response.data;\n\n            if (format === 'json') {\n                // JSON-Export\n                const blob = new Blob([JSON.stringify(tours, null, 2)], { type: 'application/json' });\n                const url = window.URL.createObjectURL(blob);\n                const a = document.createElement('a');\n                a.href = url;\n                a.download = `tours-export-${new Date().toISOString().split('T')[0]}.json`;\n                document.body.appendChild(a);\n                a.click();\n                document.body.removeChild(a);\n                window.URL.revokeObjectURL(url);\n            } else {\n                // CSV-Export\n                if (!Array.isArray(tours) || tours.length === 0) {\n                    showMessage(t('tours.export.noData', 'Keine Daten zum Exportieren'), 'warning');\n                    return;\n                }\n\n                // CSV-Header\n                const headers = selectedFields.map(fieldId => {\n                    const field = availableFields.find(f => f.id === fieldId);\n                    return field?.label || fieldId;\n                });\n\n                // CSV-Rows\n                const rows = tours.map((tour: any) => {\n                    return selectedFields.map(fieldId => {\n                        let value = tour[fieldId];\n                        if (value === null || value === undefined) return '';\n                        if (typeof value === 'object') {\n                            if (fieldId === 'branch') return value?.name || '';\n                            if (fieldId === 'externalProvider') return value?.name || '';\n                            if (fieldId === 'galleryUrls' && Array.isArray(value)) return value.join('; ');\n                            return JSON.stringify(value);\n                        }\n                        if (typeof value === 'boolean') return value ? 'Ja' : 'Nein';\n                        return String(value);\n                    });\n                });\n\n                // CSV-String erstellen\n                const csvContent = [\n                    headers.join(','),\n                    ...rows.map(row => row.map(cell => `\"${String(cell).replace(/\"/g, '\"\"')}\"`).join(','))\n                ].join('\\n');\n\n                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n                const url = window.URL.createObjectURL(blob);\n                const a = document.createElement('a');\n                a.href = url;\n                a.download = `tours-export-${new Date().toISOString().split('T')[0]}.csv`;\n                document.body.appendChild(a);\n                a.click();\n                document.body.removeChild(a);\n                window.URL.revokeObjectURL(url);\n            }\n\n            showMessage(t('tours.export.success', 'Export erfolgreich'), 'success');\n            onClose();\n        } catch (err: any) {\n            console.error('Fehler beim Exportieren:', err);\n            showMessage(err.response?.data?.message || t('tours.export.error', 'Fehler beim Exportieren'), 'error');\n        } finally {\n            setExporting(false);\n        }\n    };\n\n    if (!isOpen) return null;\n\n    return (\n        <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n                <Dialog.Panel className=\"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n                    <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n                        <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white\">\n                            {t('tours.export.title', 'Touren exportieren')} ({tourCount})\n                        </Dialog.Title>\n                        <button\n                            onClick={onClose}\n                            className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                        >\n                            <XMarkIcon className=\"h-6 w-6\" />\n                        </button>\n                    </div>\n\n                    <div className=\"p-6 space-y-6\">\n                        {/* Format-Auswahl */}\n                        <div>\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                                {t('tours.export.format', 'Export-Format')}\n                            </label>\n                            <div className=\"flex gap-4\">\n                                <label className=\"flex items-center\">\n                                    <input\n                                        type=\"radio\"\n                                        value=\"json\"\n                                        checked={format === 'json'}\n                                        onChange={(e) => setFormat(e.target.value as 'json' | 'csv')}\n                                        className=\"mr-2\"\n                                    />\n                                    JSON\n                                </label>\n                                <label className=\"flex items-center\">\n                                    <input\n                                        type=\"radio\"\n                                        value=\"csv\"\n                                        checked={format === 'csv'}\n                                        onChange={(e) => setFormat(e.target.value as 'json' | 'csv')}\n                                        className=\"mr-2\"\n                                    />\n                                    CSV\n                                </label>\n                            </div>\n                        </div>\n\n                        {/* Feldauswahl */}\n                        <div>\n                            <div className=\"flex items-center justify-between mb-3\">\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                                    {t('tours.export.selectFields', 'Felder auswhlen')}\n                                </label>\n                                <div className=\"flex gap-2\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={selectAll}\n                                        className=\"text-sm text-blue-600 dark:text-blue-400 hover:underline\"\n                                    >\n                                        {t('common.selectAll', 'Alle auswhlen')}\n                                    </button>\n                                    <span className=\"text-gray-400\">|</span>\n                                    <button\n                                        type=\"button\"\n                                        onClick={deselectAll}\n                                        className=\"text-sm text-blue-600 dark:text-blue-400 hover:underline\"\n                                    >\n                                        {t('common.deselectAll', 'Alle abwhlen')}\n                                    </button>\n                                </div>\n                            </div>\n                            <div className=\"border border-gray-300 dark:border-gray-600 rounded-md p-4 max-h-96 overflow-y-auto\">\n                                <div className=\"grid grid-cols-2 gap-2\">\n                                    {availableFields.map(field => (\n                                        <label key={field.id} className=\"flex items-center\">\n                                            <input\n                                                type=\"checkbox\"\n                                                checked={selectedFields.includes(field.id)}\n                                                onChange={() => toggleField(field.id)}\n                                                className=\"mr-2 rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                                            />\n                                            <span className=\"text-sm text-gray-700 dark:text-gray-300\">\n                                                {field.label}\n                                            </span>\n                                        </label>\n                                    ))}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div className=\"flex justify-end space-x-3 p-6 border-t border-gray-200 dark:border-gray-700\">\n                        <button\n                            type=\"button\"\n                            onClick={onClose}\n                            className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600\"\n                        >\n                            {t('common.cancel', 'Abbrechen')}\n                        </button>\n                        <button\n                            type=\"button\"\n                            onClick={handleExport}\n                            disabled={exporting || selectedFields.length === 0}\n                            className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\"\n                        >\n                            <ArrowDownTrayIcon className=\"h-4 w-4\" />\n                            {exporting ? t('common.exporting', 'Exportiere...') : t('common.export', 'Exportieren')}\n                        </button>\n                    </div>\n                </Dialog.Panel>\n            </div>\n        </Dialog>\n    );\n};\n\nexport default TourExportDialog;\n\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, LinkIcon } from '@heroicons/react/24/outline';\r\nimport axiosInstance from '../../config/axios.ts';\r\nimport { API_ENDPOINTS } from '../../config/api.ts';\r\nimport useMessage from '../../hooks/useMessage.ts';\r\nimport { TourBooking, TourReservation } from '../../types/tour.ts';\r\n\r\ninterface TourReservationLinkModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    booking: TourBooking | null;\r\n    onLinked: () => void;\r\n}\r\n\r\nconst TourReservationLinkModal = ({ isOpen, onClose, booking, onLinked }: TourReservationLinkModalProps) => {\r\n    const { t } = useTranslation();\r\n    const { showMessage } = useMessage();\r\n    \r\n    const [reservations, setReservations] = useState<any[]>([]);\r\n    const [selectedReservationId, setSelectedReservationId] = useState<number | ''>('');\r\n    const [tourPrice, setTourPrice] = useState<number | ''>('');\r\n    const [accommodationPrice, setAccommodationPrice] = useState<number | ''>('');\r\n    const [loading, setLoading] = useState(false);\r\n    const [loadingReservations, setLoadingReservations] = useState(false);\r\n    const [existingLinks, setExistingLinks] = useState<TourReservation[]>([]);\r\n\r\n    useEffect(() => {\r\n        if (isOpen && booking) {\r\n            loadReservations();\r\n            loadExistingLinks();\r\n            // Setze Tour-Preis als Standard\r\n            if (booking.totalPrice) {\r\n                setTourPrice(typeof booking.totalPrice === 'string' ? parseFloat(booking.totalPrice) : booking.totalPrice);\r\n            }\r\n        }\r\n    }, [isOpen, booking]);\r\n\r\n    const loadReservations = async () => {\r\n        try {\r\n            setLoadingReservations(true);\r\n            const response = await axiosInstance.get(API_ENDPOINTS.RESERVATION.BASE);\r\n            if (response.data.success || Array.isArray(response.data)) {\r\n                const data = response.data.success ? response.data.data : response.data;\r\n                setReservations(Array.isArray(data) ? data : []);\r\n            }\r\n        } catch (err: any) {\r\n            console.error('Fehler beim Laden der Reservations:', err);\r\n            showMessage(t('errors.loadError'), 'error');\r\n        } finally {\r\n            setLoadingReservations(false);\r\n        }\r\n    };\r\n\r\n    const loadExistingLinks = async () => {\r\n        if (!booking) return;\r\n        try {\r\n            const response = await axiosInstance.get(API_ENDPOINTS.TOUR_RESERVATIONS.BY_BOOKING(booking.id));\r\n            if (response.data.success) {\r\n                setExistingLinks(response.data.data || []);\r\n            }\r\n        } catch (err: any) {\r\n            console.error('Fehler beim Laden der Verknpfungen:', err);\r\n        }\r\n    };\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!booking || !selectedReservationId || !tourPrice || !accommodationPrice) {\r\n            showMessage(t('tours.reservationLink.fillAllFields', 'Bitte fllen Sie alle Felder aus'), 'error');\r\n            return;\r\n        }\r\n\r\n        setLoading(true);\r\n        try {\r\n            const response = await axiosInstance.post(API_ENDPOINTS.TOUR_RESERVATIONS.BASE, {\r\n                tourId: booking.tourId,\r\n                bookingId: booking.id,\r\n                reservationId: selectedReservationId,\r\n                tourPrice: Number(tourPrice),\r\n                accommodationPrice: Number(accommodationPrice),\r\n                currency: booking.currency || 'COP'\r\n            });\r\n\r\n            if (response.data.success) {\r\n                showMessage(t('tours.reservationLink.success', 'Verknpfung erfolgreich erstellt'), 'success');\r\n                onLinked();\r\n                onClose();\r\n            } else {\r\n                showMessage(response.data.message || t('errors.saveError'), 'error');\r\n            }\r\n        } catch (err: any) {\r\n            console.error('Fehler beim Erstellen der Verknpfung:', err);\r\n            showMessage(err.response?.data?.message || t('errors.saveError'), 'error');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleDeleteLink = async (linkId: number) => {\r\n        if (!window.confirm(t('tours.reservationLink.confirmDelete', 'Mchten Sie diese Verknpfung wirklich lschen?'))) {\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const response = await axiosInstance.delete(API_ENDPOINTS.TOUR_RESERVATIONS.BY_ID(linkId));\r\n            if (response.data.success) {\r\n                showMessage(t('tours.reservationLink.deleted', 'Verknpfung gelscht'), 'success');\r\n                loadExistingLinks();\r\n                onLinked();\r\n            } else {\r\n                showMessage(response.data.message || t('errors.deleteError'), 'error');\r\n            }\r\n        } catch (err: any) {\r\n            console.error('Fehler beim Lschen der Verknpfung:', err);\r\n            showMessage(err.response?.data?.message || t('errors.deleteError'), 'error');\r\n        }\r\n    };\r\n\r\n    if (!isOpen || !booking) return null;\r\n\r\n    const selectedReservation = reservations.find(r => r.id === Number(selectedReservationId));\r\n    const reservationAmount = selectedReservation?.amount ? Number(selectedReservation.amount) : 0;\r\n    const totalPrice = (Number(tourPrice) || 0) + (Number(accommodationPrice) || 0);\r\n    const isValid = totalPrice <= reservationAmount && totalPrice > 0;\r\n\r\n    return (\r\n        <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n            <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n            <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n                <Dialog.Panel className=\"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n                    <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\r\n                        <Dialog.Title className=\"text-xl font-semibold text-gray-900 dark:text-white flex items-center gap-2\">\r\n                            <LinkIcon className=\"h-6 w-6\" />\r\n                            {t('tours.reservationLink.title', 'Tour mit Reservation verknpfen')}\r\n                        </Dialog.Title>\r\n                        <button\r\n                            onClick={onClose}\r\n                            className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\r\n                        >\r\n                            <XMarkIcon className=\"h-6 w-6\" />\r\n                        </button>\r\n                    </div>\r\n\r\n                    <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">\r\n                        <div>\r\n                            <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                {t('tours.reservationLink.reservation', 'Reservation')} *\r\n                            </label>\r\n                            <select\r\n                                value={selectedReservationId}\r\n                                onChange={(e) => {\r\n                                    setSelectedReservationId(e.target.value ? Number(e.target.value) : '');\r\n                                    const res = reservations.find(r => r.id === Number(e.target.value));\r\n                                    if (res?.amount) {\r\n                                        const resAmount = Number(res.amount);\r\n                                        const currentTourPrice = Number(tourPrice) || 0;\r\n                                        setAccommodationPrice(resAmount - currentTourPrice);\r\n                                    }\r\n                                }}\r\n                                required\r\n                                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                disabled={loadingReservations}\r\n                            >\r\n                                <option value=\"\">{t('common.select', 'Auswhlen')}</option>\r\n                                {reservations.map(reservation => (\r\n                                    <option key={reservation.id} value={reservation.id}>\r\n                                        {reservation.guestName} - {reservation.checkInDate} bis {reservation.checkOutDate} ({Number(reservation.amount || 0).toLocaleString()} {reservation.currency || 'COP'})\r\n                                    </option>\r\n                                ))}\r\n                            </select>\r\n                            {selectedReservation && (\r\n                                <p className=\"mt-1 text-sm text-gray-500 dark:text-gray-400\">\r\n                                    {t('tours.reservationLink.reservationAmount', 'Reservationsbetrag')}: {reservationAmount.toLocaleString()} {selectedReservation.currency || 'COP'}\r\n                                </p>\r\n                            )}\r\n                        </div>\r\n\r\n                        <div className=\"grid grid-cols-2 gap-4\">\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.reservationLink.tourPrice', 'Tour-Preis')} *\r\n                                </label>\r\n                                <input\r\n                                    type=\"number\"\r\n                                    value={tourPrice}\r\n                                    onChange={(e) => setTourPrice(e.target.value ? Number(e.target.value) : '')}\r\n                                    min=\"0\"\r\n                                    step=\"0.01\"\r\n                                    required\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                />\r\n                            </div>\r\n\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                                    {t('tours.reservationLink.accommodationPrice', 'Betten-Preis')} *\r\n                                </label>\r\n                                <input\r\n                                    type=\"number\"\r\n                                    value={accommodationPrice}\r\n                                    onChange={(e) => setAccommodationPrice(e.target.value ? Number(e.target.value) : '')}\r\n                                    min=\"0\"\r\n                                    step=\"0.01\"\r\n                                    required\r\n                                    className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        {selectedReservation && (\r\n                            <div className={`p-3 rounded-md ${isValid ? 'bg-green-50 dark:bg-green-900/30' : 'bg-red-50 dark:bg-red-900/30'}`}>\r\n                                <p className={`text-sm ${isValid ? 'text-green-800 dark:text-green-200' : 'text-red-800 dark:text-red-200'}`}>\r\n                                    {t('tours.reservationLink.totalPrice', 'Gesamtpreis')}: {totalPrice.toLocaleString()} {booking.currency || 'COP'}\r\n                                    {!isValid && totalPrice > reservationAmount && (\r\n                                        <span className=\"block mt-1\">\r\n                                            {t('tours.reservationLink.exceedsAmount', 'berschreitet Reservationsbetrag')}\r\n                                        </span>\r\n                                    )}\r\n                                </p>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Bestehende Verknpfungen */}\r\n                        {existingLinks.length > 0 && (\r\n                            <div>\r\n                                <h3 className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\r\n                                    {t('tours.reservationLink.existingLinks', 'Bestehende Verknpfungen')}\r\n                                </h3>\r\n                                <div className=\"space-y-2\">\r\n                                    {existingLinks.map(link => (\r\n                                        <div key={link.id} className=\"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-md\">\r\n                                            <div>\r\n                                                <p className=\"text-sm font-medium dark:text-white\">\r\n                                                    {link.reservation?.guestName || `Reservation #${link.reservationId}`}\r\n                                                </p>\r\n                                                <p className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                                                    Tour: {Number(link.tourPrice || 0).toLocaleString()} {link.currency} | \r\n                                                    Betten: {Number(link.accommodationPrice || 0).toLocaleString()} {link.currency}\r\n                                                </p>\r\n                                            </div>\r\n                                            <button\r\n                                                type=\"button\"\r\n                                                onClick={() => handleDeleteLink(link.id)}\r\n                                                className=\"px-3 py-1 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-md\"\r\n                                            >\r\n                                                {t('common.delete', 'Lschen')}\r\n                                            </button>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700\">\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={onClose}\r\n                                className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600\"\r\n                            >\r\n                                {t('common.cancel', 'Abbrechen')}\r\n                            </button>\r\n                            <button\r\n                                type=\"submit\"\r\n                                disabled={loading || !isValid || !selectedReservationId}\r\n                                className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                            >\r\n                                {loading ? t('common.saving', 'Wird gespeichert...') : t('common.save', 'Speichern')}\r\n                            </button>\r\n                        </div>\r\n                    </form>\r\n                </Dialog.Panel>\r\n            </div>\r\n        </Dialog>\r\n    );\r\n};\r\n\r\nexport default TourReservationLinkModal;\r\n\r\n","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { XMarkIcon } from '@heroicons/react/24/outline';\nimport { reservationService } from '../../services/reservationService.ts';\nimport { Reservation } from '../../types/reservation.ts';\nimport useMessage from '../../hooks/useMessage.ts';\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\n\ninterface SendInvitationSidepaneProps {\n  isOpen: boolean;\n  onClose: () => void;\n  reservation: Reservation;\n  onSuccess: () => void;\n}\n\nconst SendInvitationSidepane: React.FC<SendInvitationSidepaneProps> = ({\n  isOpen,\n  onClose,\n  reservation,\n  onSuccess\n}) => {\n  const { t } = useTranslation();\n  const { showMessage } = useMessage();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n\n  // Formular-Felder\n  const [guestPhone, setGuestPhone] = useState(reservation.guestPhone || '');\n  const [guestEmail, setGuestEmail] = useState(reservation.guestEmail || '');\n  const [customMessage, setCustomMessage] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [previewMessage, setPreviewMessage] = useState('');\n\n  // Standard-Nachricht generieren (entspricht Meta Business Template: reservation_checkin_invitation)\n  const generateStandardMessage = () => {\n    return `Hola {{guestName}},\n\nNos complace darte la bienvenida a La Familia Hostel!\n\nComo llegars despus de las 22:00, puedes realizar el check-in en lnea ahora:\n{{checkInLink}}\n\nPor favor, realiza el pago por adelantado:\n{{paymentLink}}\n\nPor favor, escrbenos brevemente una vez que hayas completado tanto el check-in como el pago. Gracias!\n\nTe esperamos maana!`;\n  };\n\n  // Initialisiere Standard-Nachricht beim ffnen\n  useEffect(() => {\n    if (isOpen && !customMessage) {\n      setCustomMessage(generateStandardMessage());\n    }\n  }, [isOpen, reservation]);\n\n  // Preview-Nachricht generieren (mit echten Links)\n  useEffect(() => {\n    if (customMessage) {\n      // Generiere LobbyPMS Check-in-Link (analog zu Backend generateLobbyPmsCheckInLink)\n      // Format: https://app.lobbypms.com/checkinonline/confirmar?codigo={lobbyReservationId}&email={email}&lg={language}\n      // WICHTIG: Check-in-Link IMMER mit der ursprnglich importierten E-Mail generieren\n      // (reservation.guestEmail), nicht mit der genderten E-Mail (guestEmail)\n      // Der Check-in-Link muss immer die Original-E-Mail verwenden, die beim Import verwendet wurde\n      // WICHTIG: Verwende lobbyReservationId (LobbyPMS booking_id) als codigo, nicht die interne ID\n      const email = reservation.guestEmail || '';\n      let checkInLink = '[Check-in-Link wird generiert]';\n      if (email) {\n        // Verwende lobbyReservationId (LobbyPMS booking_id) als codigo, Fallback auf id wenn nicht vorhanden\n        const codigo = reservation.lobbyReservationId || reservation.id.toString();\n        const baseUrl = 'https://app.lobbypms.com/checkinonline/confirmar';\n        const params = new URLSearchParams();\n        params.append('codigo', codigo);\n        params.append('email', email);\n        params.append('lg', 'GB'); // Standard: Englisch\n        checkInLink = `${baseUrl}?${params.toString()}`;\n      }\n      \n      // Verwende bestehenden Payment-Link oder Fallback\n      const paymentLink = reservation.paymentLink || '[Zahlungslink wird erstellt]';\n      \n      let preview = customMessage\n        .replace(/\\{\\{guestName\\}\\}/g, reservation.guestName)\n        .replace(/\\{\\{checkInLink\\}\\}/g, checkInLink)\n        .replace(/\\{\\{paymentLink\\}\\}/g, paymentLink);\n      setPreviewMessage(preview);\n    }\n  }, [customMessage, reservation.guestName, reservation.paymentLink, reservation.id, reservation.guestEmail]);\n\n  // Responsive-Verhalten\n  useEffect(() => {\n    const handleResize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n\n    window.addEventListener('resize', handleResize);\n    handleResize();\n\n    return () => {\n      window.removeEventListener('resize', handleResize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen && !isMobile) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n\n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, isMobile, openSidepane, closeSidepane]);\n\n  // Reset form when sidepane closes\n  useEffect(() => {\n    if (!isOpen) {\n      setGuestPhone(reservation.guestPhone || '');\n      setGuestEmail(reservation.guestEmail || '');\n      setCustomMessage('');\n      setError(null);\n      setPreviewMessage('');\n    }\n  }, [isOpen, reservation]);\n\n  const handleClose = () => {\n    setError(null);\n    onClose();\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n\n    // Validierung: Mindestens eine Kontaktinfo muss vorhanden sein\n    if (!guestPhone && !guestEmail) {\n      setError(t('reservations.sendInvitation.noContact', 'Bitte geben Sie mindestens eine Telefonnummer oder E-Mail-Adresse an.'));\n      return;\n    }\n\n    try {\n      setLoading(true);\n\n      await reservationService.sendInvitation(reservation.id, {\n        guestPhone: guestPhone || undefined,\n        guestEmail: guestEmail || undefined,\n        customMessage: customMessage || undefined\n      });\n\n      showMessage(\n        t('reservations.sendInvitation.success', 'Einladung erfolgreich versendet'),\n        'success'\n      );\n      onSuccess();\n      handleClose();\n    } catch (err: any) {\n      console.error('Fehler beim Versenden der Einladung:', err);\n      const errorMessage = err.response?.data?.message || \n        t('reservations.sendInvitation.error', 'Fehler beim Versenden der Einladung');\n      setError(errorMessage);\n      showMessage(errorMessage, 'error');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Warnung anzeigen, wenn bereits versendet wurde\n  const alreadySent = reservation.sentMessageAt;\n\n  // Fr Mobile (< 640px) - Dialog (Modal)\n  if (isMobile) {\n    return (\n      <div\n        className={`fixed inset-0 z-50 overflow-y-auto ${isOpen ? '' : 'hidden'}`}\n        aria-labelledby=\"modal-title\"\n        role=\"dialog\"\n        aria-modal=\"true\"\n      >\n        <div className=\"flex min-h-screen items-end justify-center p-4 text-center sm:items-center sm:p-0\">\n          <div\n            className=\"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity\"\n            onClick={handleClose}\n          />\n\n          <div className=\"relative transform overflow-hidden rounded-lg bg-white dark:bg-gray-800 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <h2 className=\"text-lg font-semibold dark:text-white\">\n                {t('reservations.sendInvitation.title', 'Einladung senden')}\n              </h2>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <div className=\"p-4 overflow-y-auto max-h-[calc(100vh-200px)]\">\n              {renderForm()}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            {t('reservations.sendInvitation.title', 'Einladung senden')}\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {renderForm()}\n        </div>\n      </div>\n    </>\n  );\n\n  function renderForm() {\n    return (\n      <>\n        {error && (\n          <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-200 rounded\">\n            {error}\n          </div>\n        )}\n\n        {alreadySent && (\n          <div className=\"mb-4 p-3 bg-yellow-100 dark:bg-yellow-900 border border-yellow-400 dark:border-yellow-700 text-yellow-700 dark:text-yellow-200 rounded\">\n            <p className=\"text-sm\">\n              {t('reservations.sendInvitation.alreadySent', 'Bereits versendet am')}: {new Date(reservation.sentMessageAt!).toLocaleString()}\n            </p>\n            <p className=\"text-xs mt-1\">\n              {t('reservations.sendInvitation.canResend', 'Sie knnen die Einladung erneut senden.')}\n            </p>\n          </div>\n        )}\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          {/* Kontaktinfo */}\n          <div>\n            <h3 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-3\">\n              {t('reservations.sendInvitation.contactInfo', 'Kontaktinformationen')}\n            </h3>\n\n            <div className=\"space-y-3\">\n              {/* Telefonnummer */}\n              <div>\n                <label htmlFor=\"guestPhone\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('reservations.phone', 'Telefonnummer')}\n                </label>\n                <input\n                  type=\"tel\"\n                  id=\"guestPhone\"\n                  value={guestPhone}\n                  onChange={(e) => setGuestPhone(e.target.value)}\n                  placeholder=\"+573001234567\"\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                />\n              </div>\n\n              {/* E-Mail */}\n              <div>\n                <label htmlFor=\"guestEmail\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('reservations.email', 'E-Mail')}\n                </label>\n                <input\n                  type=\"email\"\n                  id=\"guestEmail\"\n                  value={guestEmail}\n                  onChange={(e) => setGuestEmail(e.target.value)}\n                  placeholder=\"email@example.com\"\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Nachricht */}\n          <div>\n            <h3 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-3\">\n              {t('reservations.sendInvitation.message', 'Nachricht')}\n            </h3>\n\n            <div className=\"space-y-3\">\n              {/* Textarea fr Nachricht */}\n              <div>\n                <label htmlFor=\"customMessage\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  {t('reservations.sendInvitation.messageLabel', 'Nachricht (editierbar)')}\n                </label>\n                <textarea\n                  id=\"customMessage\"\n                  value={customMessage}\n                  onChange={(e) => setCustomMessage(e.target.value)}\n                  rows={10}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white font-mono text-xs\"\n                  placeholder={generateStandardMessage()}\n                />\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\n                  {t('reservations.sendInvitation.messageVariables', 'Verfgbare Variablen: {{guestName}}, {{checkInLink}}, {{paymentLink}}')}\n                </p>\n              </div>\n\n              {/* Preview */}\n              {previewMessage && (\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('reservations.sendInvitation.preview', 'Vorschau')}\n                  </label>\n                  <div className=\"p-3 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-md text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\n                    {previewMessage}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Buttons */}\n          <div className=\"flex justify-end space-x-3 pt-4 border-t dark:border-gray-700\">\n            <button\n              type=\"button\"\n              onClick={handleClose}\n              className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n            >\n              {t('common.cancel', 'Abbrechen')}\n            </button>\n            <button\n              type=\"submit\"\n              disabled={loading || (!guestPhone && !guestEmail)}\n              className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {loading\n                ? t('reservations.sendInvitation.sending', 'Wird gesendet...')\n                : t('reservations.sendInvitation.send', 'Senden')\n              }\n            </button>\n          </div>\n        </form>\n      </>\n    );\n  }\n};\n\nexport default SendInvitationSidepane;\n\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { XMarkIcon } from '@heroicons/react/24/outline';\r\nimport { reservationService } from '../../services/reservationService.ts';\r\nimport { Reservation } from '../../types/reservation.ts';\r\nimport useMessage from '../../hooks/useMessage.ts';\r\nimport { useSidepane } from '../../contexts/SidepaneContext.tsx';\r\n\r\ninterface SendPasscodeSidepaneProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  reservation: Reservation;\r\n  onSuccess: () => void;\r\n}\r\n\r\nconst SendPasscodeSidepane: React.FC<SendPasscodeSidepaneProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  reservation,\r\n  onSuccess\r\n}) => {\r\n  const { t } = useTranslation();\r\n  const { showMessage } = useMessage();\r\n  const { openSidepane, closeSidepane } = useSidepane();\r\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\r\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\r\n\r\n  // Formular-Felder\r\n  const [guestPhone, setGuestPhone] = useState(reservation.guestPhone || '');\r\n  const [guestEmail, setGuestEmail] = useState(reservation.guestEmail || '');\r\n  const [customMessage, setCustomMessage] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [previewMessage, setPreviewMessage] = useState('');\r\n\r\n  // Standard-Nachricht generieren (entspricht Meta Business Template: reservation_checkin_completed)\r\n  // Template verwendet 2 Variablen: {{1}} = Begrung, {{2}} = Kompletter Text mit Zimmerinfo und PIN\r\n  // Fr die Vorschau kombinieren wir beide zu einem vollstndigen Text\r\n  const generateStandardMessage = () => {\r\n    return `Bienvenido,\r\n\r\nHola {{guestName}},\r\n\r\nTu check-in se ha completado exitosamente! Informacin de tu habitacin: - Habitacin: {{roomNumber}} - Descripcin: {{roomDescription}} Acceso: - PIN de la puerta: {{passcode}} - App: TTLock\r\n\r\nTe deseamos una estancia agradable!`;\r\n  };\r\n\r\n  // Initialisiere Standard-Nachricht beim ffnen\r\n  useEffect(() => {\r\n    if (isOpen && !customMessage) {\r\n      setCustomMessage(generateStandardMessage());\r\n    }\r\n  }, [isOpen, reservation]);\r\n\r\n  // Preview-Nachricht generieren (mit Passcode-Platzhalter)\r\n  useEffect(() => {\r\n    if (customMessage) {\r\n      // Verwende bestehenden Passcode oder Platzhalter\r\n      const passcode = reservation.doorPin || reservation.ttlLockPassword || '[Passcode wird generiert]';\r\n      const roomNumber = reservation.roomNumber || '[Zimmernummer]';\r\n      const roomDescription = reservation.roomDescription || '[Zimmerbeschreibung]';\r\n      \r\n      let preview = customMessage\r\n        .replace(/\\{\\{guestName\\}\\}/g, reservation.guestName)\r\n        .replace(/\\{\\{passcode\\}\\}/g, passcode)\r\n        .replace(/\\{\\{roomNumber\\}\\}/g, roomNumber)\r\n        .replace(/\\{\\{roomDescription\\}\\}/g, roomDescription);\r\n      setPreviewMessage(preview);\r\n    }\r\n  }, [customMessage, reservation.guestName, reservation.doorPin, reservation.ttlLockPassword, reservation.roomNumber, reservation.roomDescription]);\r\n\r\n  // Responsive-Verhalten\r\n  useEffect(() => {\r\n    const handleResize = () => {\r\n      setIsMobile(window.innerWidth < 640);\r\n      setIsLargeScreen(window.innerWidth > 1070);\r\n    };\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    handleResize();\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', handleResize);\r\n    };\r\n  }, []);\r\n\r\n  // Sidepane-Status verwalten\r\n  useEffect(() => {\r\n    if (isOpen && !isMobile) {\r\n      openSidepane();\r\n    } else {\r\n      closeSidepane();\r\n    }\r\n\r\n    return () => {\r\n      closeSidepane();\r\n    };\r\n  }, [isOpen, isMobile, openSidepane, closeSidepane]);\r\n\r\n  // Reset form when sidepane closes\r\n  useEffect(() => {\r\n    if (!isOpen) {\r\n      setGuestPhone(reservation.guestPhone || '');\r\n      setGuestEmail(reservation.guestEmail || '');\r\n      setCustomMessage('');\r\n      setError(null);\r\n      setPreviewMessage('');\r\n    }\r\n  }, [isOpen, reservation]);\r\n\r\n  const handleClose = () => {\r\n    setError(null);\r\n    onClose();\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError(null);\r\n\r\n    // Validierung: Mindestens eine Kontaktinfo muss vorhanden sein\r\n    if (!guestPhone && !guestEmail) {\r\n      setError(t('reservations.sendPasscode.noContact', 'Bitte geben Sie mindestens eine Telefonnummer oder E-Mail-Adresse an.'));\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n\r\n      await reservationService.sendPasscode(reservation.id, {\r\n        guestPhone: guestPhone || undefined,\r\n        guestEmail: guestEmail || undefined,\r\n        customMessage: customMessage || undefined\r\n      });\r\n\r\n      showMessage(\r\n        t('reservations.sendPasscode.success', 'Passcode erfolgreich versendet'),\r\n        'success'\r\n      );\r\n      onSuccess();\r\n      handleClose();\r\n    } catch (err: any) {\r\n      console.error('Fehler beim Versenden des Passcodes:', err);\r\n      const errorMessage = err.response?.data?.message || \r\n        t('reservations.sendPasscode.error', 'Fehler beim Versenden des Passcodes');\r\n      setError(errorMessage);\r\n      showMessage(errorMessage, 'error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Fr Mobile (< 640px) - Dialog (Modal)\r\n  if (isMobile) {\r\n    return (\r\n      <div\r\n        className={`fixed inset-0 z-50 overflow-y-auto ${isOpen ? '' : 'hidden'}`}\r\n        aria-labelledby=\"modal-title\"\r\n        role=\"dialog\"\r\n        aria-modal=\"true\"\r\n      >\r\n        <div className=\"flex min-h-screen items-end justify-center p-4 text-center sm:items-center sm:p-0\">\r\n          <div\r\n            className=\"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity\"\r\n            onClick={handleClose}\r\n          />\r\n\r\n          <div className=\"relative transform overflow-hidden rounded-lg bg-white dark:bg-gray-800 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg\">\r\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\r\n              <h2 className=\"text-lg font-semibold dark:text-white\">\r\n                {t('reservations.sendPasscode.title', 'Passcode senden')}\r\n              </h2>\r\n              <button\r\n                onClick={handleClose}\r\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n              >\r\n                <XMarkIcon className=\"h-6 w-6\" />\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"p-4 overflow-y-auto max-h-[calc(100vh-200px)]\">\r\n              {renderForm()}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Fr Desktop (ab 640px) - Sidepane\r\n  return (\r\n    <>\r\n      {/* Backdrop - nur wenn offen und <= 1070px */}\r\n      {isOpen && !isLargeScreen && (\r\n        <div \r\n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \r\n          aria-hidden=\"true\" \r\n          style={{\r\n            opacity: isOpen ? 1 : 0,\r\n            transition: 'opacity 300ms ease-out'\r\n          }}\r\n        />\r\n      )}\r\n      \r\n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\r\n      <div \r\n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\r\n        style={{\r\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n          pointerEvents: isOpen ? 'auto' : 'none'\r\n        }}\r\n        aria-hidden={!isOpen}\r\n        role=\"dialog\"\r\n        aria-modal={isOpen}\r\n      >\r\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\r\n          <h2 className=\"text-lg font-semibold dark:text-white\">\r\n            {t('reservations.sendPasscode.title', 'Passcode senden')}\r\n          </h2>\r\n          <button\r\n            onClick={handleClose}\r\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\r\n          >\r\n            <XMarkIcon className=\"h-6 w-6\" />\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\r\n          {renderForm()}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n\r\n  function renderForm() {\r\n    return (\r\n      <>\r\n        {error && (\r\n          <div className=\"mb-4 p-3 bg-red-100 dark:bg-red-900 border border-red-400 dark:border-red-700 text-red-700 dark:text-red-200 rounded\">\r\n            {error}\r\n          </div>\r\n        )}\r\n\r\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n          {/* Kontaktinfo */}\r\n          <div>\r\n            <h3 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-3\">\r\n              {t('reservations.sendPasscode.contactInfo', 'Kontaktinformationen')}\r\n            </h3>\r\n\r\n            <div className=\"space-y-3\">\r\n              {/* Telefonnummer */}\r\n              <div>\r\n                <label htmlFor=\"guestPhone\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                  {t('reservations.phone', 'Telefonnummer')}\r\n                </label>\r\n                <input\r\n                  type=\"tel\"\r\n                  id=\"guestPhone\"\r\n                  value={guestPhone}\r\n                  onChange={(e) => setGuestPhone(e.target.value)}\r\n                  placeholder=\"+573001234567\"\r\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                />\r\n              </div>\r\n\r\n              {/* E-Mail */}\r\n              <div>\r\n                <label htmlFor=\"guestEmail\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                  {t('reservations.email', 'E-Mail')}\r\n                </label>\r\n                <input\r\n                  type=\"email\"\r\n                  id=\"guestEmail\"\r\n                  value={guestEmail}\r\n                  onChange={(e) => setGuestEmail(e.target.value)}\r\n                  placeholder=\"email@example.com\"\r\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Nachricht */}\r\n          <div>\r\n            <h3 className=\"text-sm font-semibold text-gray-900 dark:text-white mb-3\">\r\n              {t('reservations.sendPasscode.message', 'Nachricht')}\r\n            </h3>\r\n\r\n            <div className=\"space-y-3\">\r\n              {/* Textarea fr Nachricht */}\r\n              <div>\r\n                <label htmlFor=\"customMessage\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                  {t('reservations.sendPasscode.messageLabel', 'Nachricht (editierbar)')}\r\n                </label>\r\n                <textarea\r\n                  id=\"customMessage\"\r\n                  value={customMessage}\r\n                  onChange={(e) => setCustomMessage(e.target.value)}\r\n                  rows={8}\r\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white font-mono text-xs\"\r\n                  placeholder={generateStandardMessage()}\r\n                />\r\n                <p className=\"mt-1 text-xs text-gray-500 dark:text-gray-400\">\r\n                  {t('reservations.sendPasscode.messageVariables', 'Verfgbare Variablen: {{guestName}}, {{passcode}}, {{roomNumber}}, {{roomDescription}}')}\r\n                </p>\r\n              </div>\r\n\r\n              {/* Preview */}\r\n              {previewMessage && (\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\r\n                    {t('reservations.sendPasscode.preview', 'Vorschau')}\r\n                  </label>\r\n                  <div className=\"p-3 bg-gray-50 dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded-md text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap\">\r\n                    {previewMessage}\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Buttons */}\r\n          <div className=\"flex justify-end space-x-3 pt-4 border-t dark:border-gray-700\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={handleClose}\r\n              className=\"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n            >\r\n              {t('common.cancel', 'Abbrechen')}\r\n            </button>\r\n            <button\r\n              type=\"submit\"\r\n              disabled={loading || (!guestPhone && !guestEmail)}\r\n              className=\"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n            >\r\n              {loading\r\n                ? t('reservations.sendPasscode.sending', 'Wird gesendet...')\r\n                : t('reservations.sendPasscode.send', 'Senden')\r\n              }\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </>\r\n    );\r\n  }\r\n};\r\n\r\nexport default SendPasscodeSidepane;\r\n\r\n","import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { ClockIcon, ListBulletIcon, ArrowPathIcon, ExclamationTriangleIcon } from '@heroicons/react/24/outline';\nimport axiosInstance from '../config/axios.ts';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport { useWorktime } from '../contexts/WorktimeContext.tsx';\nimport { useBranch } from '../contexts/BranchContext.tsx';\nimport { useOrganization } from '../contexts/OrganizationContext.tsx';\nimport { WorktimeModal } from './WorktimeModal.tsx';\n\n// Wir entfernen die benutzerdefinierten API-URL-Definitionen und verwenden die direkte URL,\n// um Konflikte mit der globalen Axios-Konfiguration zu vermeiden\n// const API_BASE_URL = 'http://localhost:5000';\n// const API_URL = `${API_BASE_URL}/api`;\n\ninterface Branch {\n    id: number;\n    name: string;\n}\n\ninterface WorkTime {\n    id: number;\n    startTime: Date;\n    endTime: Date | null;\n    branchId: number;\n    userId: number;\n    organizationId: number | null;\n    branch: {\n        id: number;\n        name: string;\n    };\n}\n\ninterface WorktimeModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n}\n\nconst WorktimeTracker: React.FC = () => {\n    /* CLAUDE-ANCHOR: a7c238f1-9d6a-42e5-8af1-6d8b2e9a4f18 - WORKTIME_TRACKER_COMPONENT */\n    const { t } = useTranslation();\n    const [isTracking, setIsTracking] = useState(false);\n    const [startTime, setStartTime] = useState<Date | null>(null);\n    const [elapsedTime, setElapsedTime] = useState<string>('00:00:00');\n    const [activeWorktime, setActiveWorktime] = useState<WorkTime | null>(null);\n    const [isLoading, setIsLoading] = useState(true);\n    const [showWorkTimeModal, setShowWorkTimeModal] = useState(false);\n    const [statusError, setStatusError] = useState<string | null>(null);\n    const { user } = useAuth();\n    const { isTracking: contextTracking, updateTrackingStatus, checkTrackingStatus } = useWorktime();\n    const { branches, selectedBranch, setSelectedBranch } = useBranch();\n    const { organization } = useOrganization();\n\n    // Prfe ob aktive WorkTime zu anderer Organisation gehrt\n    const isDifferentOrganization = useMemo(() => {\n        if (!activeWorktime || !organization) return false;\n        // Beide null = standalone User, keine Warnung\n        if (activeWorktime.organizationId === null && organization.id === undefined) return false;\n        // Vergleich: WorkTime gehrt zu anderer Organisation\n        return activeWorktime.organizationId !== organization.id;\n    }, [activeWorktime, organization]);\n\n    // Funktion zum Abrufen des aktiven Worktime-Status\n    const checkActiveWorktime = useCallback(async () => {\n        try {\n            setIsLoading(true);\n            setStatusError(null);\n            \n            console.log('Prfe aktive Zeiterfassung...');\n            console.log('Benutzer geladen:', user?.id);\n            \n            const token = localStorage.getItem('token');\n            console.log('Token vorhanden:', token ? 'Ja' : 'Nein');\n            \n            if (!token) {\n                console.error('Kein Authentifizierungstoken gefunden');\n                setStatusError(t('worktime.tracker.notAuthenticated'));\n                setIsLoading(false);\n                return;\n            }\n            \n            try {\n                // Verwende axiosInstance statt direktem axios\n                const response = await axiosInstance.get(API_ENDPOINTS.WORKTIME.ACTIVE);\n                \n                console.log('API-Antwort Status:', response.status);\n                \n                const data = response.data;\n                console.log('Aktive Zeiterfassung Daten:', data);\n                \n                if (data && data.active === true) {\n                    console.log('Aktive Zeiterfassung gefunden:', data.id);\n                    // Startzeit setzen und Timer initialisieren\n                    // Entferne das 'Z' am Ende des Strings, damit JS den Zeitstempel nicht als UTC interpretiert\n                    const startISOString = data.startTime.endsWith('Z') \n                        ? data.startTime.substring(0, data.startTime.length - 1)\n                        : data.startTime;\n                    \n                    const startTimeDate = new Date(startISOString);\n                    \n                    // Initial berechnete Zeit anzeigen\n                    const now = new Date();\n                    const diff = now.getTime() - startTimeDate.getTime();\n                    const totalSeconds = Math.floor(diff / 1000);\n                    const hours = Math.floor(totalSeconds / 3600);\n                    const minutes = Math.floor((totalSeconds % 3600) / 60);\n                    const seconds = totalSeconds % 60;\n                    \n                    // Alle State-Updates in einem Batch zusammenfassen, um nur einen Re-Render zu verursachen\n                    setActiveWorktime(data);\n                    setStartTime(startTimeDate);\n                    setElapsedTime(\n                        `${hours.toString().padStart(2, '0')}:${minutes\n                            .toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`\n                    );\n                    setIsTracking(true);\n                    \n                    // Nur Branch setzen, wenn es sich gendert hat (vermeidet unntigen Re-Render)\n                    if (selectedBranch !== data.branchId) {\n                        setSelectedBranch(data.branchId);\n                    }\n                    \n                    // Aktualisiere den globalen Tracking-Status\n                    updateTrackingStatus(true);\n                } else {\n                    console.log('Keine aktive Zeiterfassung vorhanden');\n                    // Alle State-Updates in einem Batch zusammenfassen\n                    setIsTracking(false);\n                    setActiveWorktime(null);\n                    setStartTime(null);\n                    setElapsedTime('00:00:00');\n                    \n                    // Aktualisiere den globalen Tracking-Status\n                    updateTrackingStatus(false);\n                }\n            } catch (error) {\n                console.error('Fehler beim Abrufen der aktiven Zeiterfassung:', error);\n                \n                // Einfachere Fehlerbehandlung ohne axios-Import\n                const axiosError = error as any;\n                if (axiosError.code === 'ERR_NETWORK') {\n                    setStatusError(t('worktime.tracker.connectionError'));\n                } else {\n                    setStatusError(`${t('worktime.tracker.errorFetch')}: ${axiosError.response?.data?.message || axiosError.message}`);\n                }\n            }\n        } finally {\n            setIsLoading(false);\n        }\n    }, [user?.id, updateTrackingStatus, selectedBranch, organization]);\n    \n    //  PERFORMANCE: Verwende WorktimeContext statt eigenen Request\n    // Initiale Prfung: Verwende isTracking aus WorktimeContext (wird bereits beim Seitenaufruf geladen)\n    useEffect(() => {\n        if (user) {\n            // WorktimeContext ldt bereits beim Mount, verwende diesen Status\n            // Warte auf contextTracking (kann undefined sein beim ersten Render)\n            if (contextTracking !== undefined) {\n                // Context ist geladen, verwende diesen Status\n                setIsTracking(contextTracking);\n                setIsLoading(false);\n            }\n            // Wenn contextTracking noch undefined ist, warten wir einfach\n            // WorktimeContext wird den Status automatisch laden\n        } else {\n            setIsLoading(false);\n        }\n    }, [user, contextTracking]);\n\n    // Timer-Logik\n    useEffect(() => {\n        let intervalId: number;\n\n        if (isTracking && startTime) {\n            intervalId = window.setInterval(() => {\n                const now = new Date();\n                const diff = now.getTime() - startTime.getTime();\n                \n                // Berechnung mit Millisekunden, um negative Werte zu vermeiden\n                const totalSeconds = Math.floor(diff / 1000);\n                const hours = Math.floor(totalSeconds / 3600);\n                const minutes = Math.floor((totalSeconds % 3600) / 60);\n                const seconds = totalSeconds % 60;\n\n                setElapsedTime(\n                    `${hours.toString().padStart(2, '0')}:${minutes\n                        .toString()\n                        .padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`\n                );\n            }, 1000);\n        }\n\n        return () => {\n            if (intervalId) {\n                clearInterval(intervalId);\n            }\n        };\n    }, [isTracking, startTime]);\n\n    const handleToggleTracking = async () => {\n        if (isTracking) {\n            await handleStopTracking();\n        } else {\n            await handleStartTracking();\n        }\n    };\n\n    const handleStartTracking = async () => {\n        if (!selectedBranch) {\n            alert(t('worktime.tracker.selectBranch'));\n            return;\n        }\n\n        try {\n            const token = localStorage.getItem('token');\n            if (!token) {\n                console.error('Kein Authentifizierungstoken gefunden');\n                alert(t('worktime.tracker.notAuthenticatedMessage'));\n                return;\n            }\n            \n            // Verwende axiosInstance statt direktem axios\n            const response = await axiosInstance.post(\n                API_ENDPOINTS.WORKTIME.START,\n                {\n                    branchId: selectedBranch,\n                    // Die aktuelle Zeit mit Bercksichtigung der Zeitzonenverschiebung senden\n                    // Da die Datenbank in UTC speichert, mssen wir die lokale Zeit so senden,\n                    // dass sie nach der automatischen UTC-Umwandlung korrekt ist\n                    startTime: new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000)\n                },\n                {\n                    headers: {\n                        'Authorization': `Bearer ${token}`,\n                        'Content-Type': 'application/json'\n                    }\n                }\n            );\n\n            const data = response.data;\n            \n            // Erstelle ein Date-Objekt ohne Zeitzonenumrechnung\n            // Entferne das 'Z' am Ende des Strings, damit JS den Zeitstempel nicht als UTC interpretiert\n            const startISOString = data.startTime.endsWith('Z') \n                ? data.startTime.substring(0, data.startTime.length - 1)\n                : data.startTime;\n            \n            const startTimeDate = new Date(startISOString);\n            \n            // Initial berechnete Zeit anzeigen (0:00:00 beim Start)\n            // Alle State-Updates in einem Batch zusammenfassen, um nur einen Re-Render zu verursachen\n            setActiveWorktime(data);\n            setStartTime(startTimeDate);\n            setElapsedTime('00:00:00');\n            setIsTracking(true);\n            \n            // Aktualisiere den globalen Tracking-Status\n            updateTrackingStatus(true);\n        } catch (error) {\n            console.error('Fehler:', error);\n            \n            // Detaillierte Fehlerbehandlung\n            let errorMessage = t('worktime.tracker.errorStart');\n            if (error.response) {\n                errorMessage = error.response.data?.message || `Fehler (Status: ${error.response.status})`;\n            }\n            \n            alert(errorMessage);\n        }\n    };\n\n    const handleStopTracking = async () => {\n        try {\n            const token = localStorage.getItem('token');\n            if (!token) {\n                console.error('Kein Authentifizierungstoken gefunden');\n                alert(t('worktime.tracker.notAuthenticatedMessage'));\n                return;\n            }\n            \n            // Verwende axiosInstance statt direktem axios\n            const response = await axiosInstance.post(\n                API_ENDPOINTS.WORKTIME.STOP,\n                {\n                    // Die aktuelle Zeit mit Bercksichtigung der Zeitzonenverschiebung senden\n                    endTime: new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000)\n                },\n                {\n                    headers: {\n                        'Authorization': `Bearer ${token}`,\n                        'Content-Type': 'application/json'\n                    }\n                }\n            );\n\n            // Alle State-Updates in einem Batch zusammenfassen, um nur einen Re-Render zu verursachen\n            setIsTracking(false);\n            setActiveWorktime(null);\n            setStartTime(null);\n            setElapsedTime('00:00:00');\n            \n            // Aktualisiere den globalen Tracking-Status\n            updateTrackingStatus(false);\n        } catch (error) {\n            console.error('Fehler:', error);\n            \n            // Detaillierte Fehlerbehandlung\n            let errorMessage = t('worktime.tracker.errorStop');\n            if (error.response) {\n                errorMessage = error.response.data?.message || `Fehler (Status: ${error.response.status})`;\n            }\n            \n            alert(errorMessage);\n        }\n    };\n\n    const openWorkTimeModal = () => {\n        setShowWorkTimeModal(true);\n    };\n\n    const closeWorkTimeModal = () => {\n        setShowWorkTimeModal(false);\n    };\n\n    // Branch-Name memoized berechnen (vermeidet unntige Re-Berechnungen)\n    const branchName = useMemo(() => {\n        if (!activeWorktime) return null;\n        return branches.find(b => b.id === activeWorktime.branchId)?.name || t('worktime.tracker.unknown');\n    }, [branches, activeWorktime]);\n\n    // Manuelle Statusaktualisierung\n    const handleRefreshStatus = () => {\n        checkActiveWorktime();\n    };\n\n    // Manuelle Zeiterfassung forciert stoppen (fr Notflle)\n    const handleForceStop = async () => {\n        if (!window.confirm(t('worktime.tracker.forceStopConfirm'))) {\n            return;\n        }\n        \n        try {\n            const token = localStorage.getItem('token');\n            if (!token) {\n                console.error('Kein Authentifizierungstoken gefunden');\n                alert(t('worktime.tracker.notAuthenticatedMessage'));\n                return;\n            }\n            \n            // Verwende axiosInstance statt direktem axios\n            const response = await axiosInstance.post(\n                API_ENDPOINTS.WORKTIME.STOP,\n                {\n                    // Die aktuelle Zeit mit Bercksichtigung der Zeitzonenverschiebung senden\n                    endTime: new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000),\n                    force: true\n                },\n                {\n                    headers: {\n                        'Authorization': `Bearer ${token}`,\n                        'Content-Type': 'application/json'\n                    }\n                }\n            );\n\n            setIsTracking(false);\n            setStartTime(null);\n            setElapsedTime('00:00:00');\n            setActiveWorktime(null);\n            setStatusError(null);\n            alert(t('worktime.tracker.forceStopSuccess'));\n            \n            // Aktualisiere den globalen Tracking-Status\n            updateTrackingStatus(false);\n        } catch (error) {\n            console.error('Fehler:', error);\n            setStatusError(`Fehler beim Stoppen: ${error.response?.status || 'Netzwerkfehler'}`);\n            alert(t('worktime.tracker.forceStopError'));\n        }\n    };\n\n    // Formatiere das Startdatum fr die lokale Anzeige\n    const formatStartDate = (dateString: string | number | Date) => {\n        // Entferne das 'Z' am Ende des Strings, damit JS den Zeitstempel nicht als UTC interpretiert\n        if (typeof dateString === 'string' && dateString.endsWith('Z')) {\n            dateString = dateString.substring(0, dateString.length - 1);\n        }\n        \n        const date = new Date(dateString);\n        \n        // Tag, Monat und Jahr aus lokaler Zeit extrahieren\n        const day = date.getDate().toString().padStart(2, '0');\n        const month = (date.getMonth() + 1).toString().padStart(2, '0');\n        const year = date.getFullYear();\n        \n        // Stunden, Minuten und Sekunden aus lokaler Zeit extrahieren\n        const hours = date.getHours().toString().padStart(2, '0');\n        const minutes = date.getMinutes().toString().padStart(2, '0');\n        const seconds = date.getSeconds().toString().padStart(2, '0');\n        \n        // Im deutschen Format zurckgeben\n        return `${day}.${month}.${year}, ${hours}:${minutes}:${seconds}`;\n    };\n\n    if (isLoading) {\n        return (\n            <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 mb-6\">\n                <div className=\"flex justify-center items-center h-32\">\n                    <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 dark:border-gray-300\"></div>\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6 sm:mb-6\">\n            <div className=\"flex items-center justify-between mb-4\">\n                <h2 className=\"text-xl font-semibold flex items-center dark:text-white\">\n                    <ClockIcon className=\"h-6 w-6 mr-2\" />\n                    {t('worktime.tracker.title')}\n                </h2>\n            </div>\n            \n            {statusError && (\n                <div className=\"mb-4 p-2 bg-red-50 dark:bg-red-900/30 text-red-600 dark:text-red-300 border border-red-200 dark:border-red-700 rounded-md flex justify-between items-center\">\n                    <span>{statusError}</span>\n                    {statusError !== t('worktime.tracker.noActiveTracking') && (\n                        <button \n                            onClick={handleForceStop}\n                            className=\"text-sm bg-red-100 hover:bg-red-200 text-red-700 dark:bg-red-800 dark:hover:bg-red-700 dark:text-red-300 px-2 py-1 rounded-md\"\n                        >\n                            {t('worktime.tracker.stop')} {t('common.force', 'Erzwingen')}\n                        </button>\n                    )}\n                </div>\n            )}\n\n            {/* Warnung wenn WorkTime zu anderer Organisation gehrt */}\n            {isTracking && isDifferentOrganization && (\n                <div className=\"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-200 border border-yellow-200 dark:border-yellow-700 rounded-md flex items-start\">\n                    <ExclamationTriangleIcon className=\"h-5 w-5 mr-2 mt-0.5 flex-shrink-0\" />\n                    <div className=\"flex-1\">\n                        <p className=\"font-medium\">{t('worktime.tracker.differentOrganizationWarning.title', 'Hinweis: Andere Organisation')}</p>\n                        <p className=\"text-sm mt-1\">\n                            {t('worktime.tracker.differentOrganizationWarning.message', 'Diese Zeiterfassung wurde in einer anderen Organisation gestartet. Sie wird nach dem Stoppen der Organisation zugeordnet, in der sie gestartet wurde.')}\n                        </p>\n                    </div>\n                </div>\n            )}\n            \n            {/* Ein-/Ausschalter fr die Zeiterfassung - verkleinert */}\n            <div className=\"flex items-start justify-center mb-4\">\n                <div className=\"flex flex-col items-center\">\n                    <label className=\"relative inline-flex items-center cursor-pointer\">\n                        <input \n                            type=\"checkbox\" \n                            className=\"sr-only peer\" \n                            checked={isTracking}\n                            onChange={handleToggleTracking}\n                            disabled={!selectedBranch && !isTracking}\n                            data-onboarding={isTracking ? \"stop-worktime\" : \"start-worktime\"}\n                        />\n                        <div className={`w-20 h-10 rounded-full \n                            ${isTracking \n                                ? 'bg-green-500 shadow-lg shadow-green-200 dark:shadow-green-900/20' \n                                : 'bg-gray-300 dark:bg-gray-600'\n                            }\n                            before:content-[''] before:absolute before:top-0 before:left-0 before:bottom-0 before:right-0 \n                            peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-700\n                            peer-checked:after:translate-x-10\n                            after:content-[''] after:absolute after:top-1 after:left-1\n                            after:bg-white dark:after:bg-gray-200 after:border-gray-300 dark:after:border-gray-600 after:border after:rounded-full\n                            after:h-8 after:w-8 after:transition-all after:duration-300 ease-in-out\n                            transition-colors duration-300`}>\n                        </div>\n                    </label>\n                    <span className=\"mt-2 text-sm font-medium\">\n                        {isTracking \n                            ? <span className=\"text-green-600 dark:text-green-400 font-bold\">{t('worktime.tracker.running')}</span> \n                            : <span className=\"text-gray-600 dark:text-gray-400\">{t('worktime.tracker.start')}</span>\n                        }\n                    </span>\n                </div>\n\n                {/* Icon-Button zum ffnen des Modals */}\n                <button \n                    onClick={openWorkTimeModal}\n                    className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-2 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-blue-700 shadow-sm flex items-center justify-center ml-8 mt-1\"\n                    title={t('worktime.tracker.showTimes')}\n                >\n                    <ListBulletIcon className=\"h-6 w-6\" />\n                </button>\n            </div>\n\n            {/* Informationen zur aktiven Zeiterfassung oder Platzhalter */}\n            <div className={`p-2 my-2 rounded-md text-sm ${isTracking && activeWorktime ? 'bg-green-50 dark:bg-green-900/20 dark:text-green-200' : 'bg-gray-50 dark:bg-gray-700 dark:text-gray-300'}`}>\n                {isTracking && activeWorktime ? (\n                    <>\n                        <p><strong>{t('worktime.tracker.activeTracking')}</strong> {elapsedTime}</p>\n                        <p><strong>{t('worktime.tracker.started')}</strong> {formatStartDate(startTime || Date.now())}</p>\n                        <p><strong>{t('worktime.tracker.selectBranchLabel')}:</strong> {branchName || t('worktime.tracker.unknown')}</p>\n                    </>\n                ) : (\n                    <>\n                        <p>&nbsp;</p>\n                        <p>&nbsp;</p>\n                        <p>&nbsp;</p>\n                    </>\n                )}\n            </div>\n\n            {/* WorkTime Modal */}\n            {showWorkTimeModal && (\n                <WorktimeModal isOpen={showWorkTimeModal} onClose={closeWorkTimeModal} />\n            )}\n        </div>\n    );\n};\n\nexport default WorktimeTracker; ","import React, { useEffect, useState, useMemo, useCallback, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useLocation } from 'react-router-dom';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { useTableSettings } from '../hooks/useTableSettings.ts';\nimport TableColumnConfig from '../components/TableColumnConfig.tsx';\nimport { PencilIcon, TrashIcon, PlusIcon, ArrowLeftIcon, ArrowRightIcon, CheckCircleIcon, ArrowsUpDownIcon, FunnelIcon, XMarkIcon, DocumentDuplicateIcon, InformationCircleIcon, ClipboardDocumentListIcon, ArrowPathIcon, Squares2X2Icon, TableCellsIcon, UserIcon, BuildingOfficeIcon, CalendarIcon, ChevronLeftIcon, ChevronRightIcon, HomeIcon, EnvelopeIcon, PhoneIcon, LinkIcon, CurrencyDollarIcon, ClockIcon, KeyIcon, PaperAirplaneIcon, MapIcon, ArrowDownTrayIcon } from '@heroicons/react/24/outline';\nimport CreateTaskModal from '../components/CreateTaskModal.tsx';\nimport EditTaskModal from '../components/EditTaskModal.tsx';\nimport CreateReservationModal from '../components/reservations/CreateReservationModal.tsx';\nimport CreateTourModal from '../components/tours/CreateTourModal.tsx';\nimport EditTourModal from '../components/tours/EditTourModal.tsx';\nimport TourDetailsModal from '../components/tours/TourDetailsModal.tsx';\nimport TourBookingsModal from '../components/tours/TourBookingsModal.tsx';\nimport TourExportDialog from '../components/tours/TourExportDialog.tsx';\nimport TourReservationLinkModal from '../components/tours/TourReservationLinkModal.tsx';\nimport SendInvitationSidepane from '../components/reservations/SendInvitationSidepane.tsx';\nimport SendPasscodeSidepane from '../components/reservations/SendPasscodeSidepane.tsx';\nimport ReservationNotificationLogs from '../components/reservations/ReservationNotificationLogs.tsx';\nimport { Reservation, ReservationStatus, PaymentStatus } from '../types/reservation.ts';\nimport { Tour, TourType, TourBooking } from '../types/tour.ts';\nimport { useNavigate } from 'react-router-dom';\nimport useMessage from '../hooks/useMessage.ts';\nimport WorktimeTracker from '../components/WorktimeTracker.tsx';\nimport WorktimeList from '../components/WorktimeList.tsx';\nimport { API_ENDPOINTS, getTaskAttachmentUrl } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport FilterPane from '../components/FilterPane.tsx';\nimport { FilterCondition } from '../components/FilterRow.tsx';\nimport SavedFilterTags from '../components/SavedFilterTags.tsx';\nimport { applyFilters, evaluateDateCondition, evaluateUserRoleCondition, evaluateResponsibleAndQualityControl } from '../utils/filterLogic.ts';\nimport { toast } from 'react-toastify';\nimport MarkdownPreview from '../components/MarkdownPreview.tsx';\nimport { getExpiryStatus, getExpiryColorClasses, createDueDateMetadataItem } from '../utils/expiryUtils.ts';\nimport { getStatusText, getStatusColor } from '../utils/statusUtils.tsx';\nimport DataCard, { MetadataItem } from '../components/shared/DataCard.tsx';\nimport CardGrid from '../components/shared/CardGrid.tsx';\nimport { format } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport { reservationService } from '../services/reservationService.ts';\n\ninterface Task {\n    id: number;\n    title: string;\n    description: string | null;\n    status: 'open' | 'in_progress' | 'improval' | 'quality_control' | 'done';\n    responsible: {\n        id: number;\n        firstName: string;\n        lastName: string;\n    } | null;\n    responsibleId: number | null;\n    role: {\n        id: number;\n        name: string;\n    } | null;\n    roleId: number | null;\n    qualityControl: {\n        id: number;\n        firstName: string;\n        lastName: string;\n    } | null;\n    branch: {\n        id: number;\n        name: string;\n    };\n    dueDate: string | null;\n    requestId: number | null;\n    attachments?: Array<{\n        id: number;\n        fileName: string;\n        fileType: string;\n        fileSize?: number;\n        filePath?: string;\n        uploadedAt?: string;\n        url: string;\n    }>;\n}\n\ninterface SortConfig {\n    key: keyof Task | 'responsible.firstName' | 'qualityControl.firstName' | 'branch.name';\n    direction: 'asc' | 'desc';\n}\n\ninterface ReservationSortConfig {\n    key: 'guestName' | 'status' | 'paymentStatus' | 'checkInDate' | 'checkOutDate' | 'roomNumber' | 'branch' | 'guestEmail' | 'guestPhone' | 'amount' | 'arrivalTime' | 'branch.name';\n    direction: 'asc' | 'desc';\n}\n\ninterface TourSortConfig {\n    key: 'title' | 'type' | 'price' | 'location' | 'duration' | 'branch' | 'createdBy' | 'isActive';\n    direction: 'asc' | 'desc';\n}\n\n// Standard-Spaltenreihenfolge (wird in der Komponente neu definiert)\nconst defaultColumnOrder = ['title', 'responsibleAndQualityControl', 'status', 'dueDate', 'branch', 'actions'];\n\n// Definiere eine tableId fr die To-Dos Tabelle\nconst TODOS_TABLE_ID = 'worktracker-todos';\n\n// Definiere eine tableId fr die Reservations Tabelle\nconst RESERVATIONS_TABLE_ID = 'worktracker-reservations';\n\n// Definiere eine tableId fr die Tours Tabelle\nconst TOURS_TABLE_ID = 'worktracker-tours';\n\n// Card-Einstellungen Standardwerte\nconst defaultCardMetadata = ['title', 'status', 'responsible', 'qualityControl', 'branch', 'dueDate', 'description'];\nconst defaultCardColumnOrder = ['title', 'status', 'responsible', 'qualityControl', 'branch', 'dueDate', 'description'];\nconst defaultCardSortDirections: Record<string, 'asc' | 'desc'> = {\n  title: 'asc',\n  status: 'asc',\n  responsible: 'asc',\n  qualityControl: 'asc',\n  branch: 'asc',\n  dueDate: 'asc',\n  description: 'asc'\n};\n\n// Default Sortierrichtungen fr Reservations Card-Metadaten\nconst defaultReservationCardSortDirections: Record<string, 'asc' | 'desc'> = {\n  guestName: 'asc',\n  status: 'asc',\n  paymentStatus: 'asc',\n  checkInDate: 'desc',  // Neueste zuerst (wie aktuell hardcoded)\n  checkOutDate: 'desc',\n  roomNumber: 'asc',\n  branch: 'asc',\n  guestEmail: 'asc',\n  guestPhone: 'asc',\n  amount: 'desc',\n  arrivalTime: 'desc'\n};\n\n// Mapping zwischen Tabellen-Spalten-IDs und Card-Metadaten-IDs\n// Tabellen-Spalte -> Card-Metadaten (kann Array sein fr 1:N Mapping)\nconst tableToCardMapping: Record<string, string[]> = {\n  'title': ['title'],\n  'status': ['status'],\n  'responsibleAndQualityControl': ['responsible', 'qualityControl'], // 1 Tabelle-Spalte -> 2 Card-Metadaten\n  'branch': ['branch'],\n  'dueDate': ['dueDate'],\n  'actions': [], // Keine Card-Entsprechung\n  'description': ['description'] // Nur in Cards verfgbar\n};\n\n// Reverse Mapping: Card-Metadaten -> Tabellen-Spalten\nconst cardToTableMapping: Record<string, string> = {\n  'title': 'title',\n  'status': 'status',\n  'responsible': 'responsibleAndQualityControl',\n  'qualityControl': 'responsibleAndQualityControl',\n  'branch': 'branch',\n  'dueDate': 'dueDate',\n  'description': 'description'\n};\n\n// Helfer-Funktion: Tabellen-Spalte ausgeblendet -> Card-Metadaten ausblenden\nconst getHiddenCardMetadata = (hiddenTableColumns: string[]): Set<string> => {\n  const hiddenCardMetadata = new Set<string>();\n  hiddenTableColumns.forEach(tableCol => {\n    const cardMetadata = tableToCardMapping[tableCol] || [];\n    cardMetadata.forEach(cardMeta => hiddenCardMetadata.add(cardMeta));\n  });\n  return hiddenCardMetadata;\n};\n\n// Helfer-Funktion: Card-Metadaten zu Tabellen-Spalten konvertieren\nconst getCardMetadataFromColumnOrder = (columnOrder: string[]): string[] => {\n  const cardMetadata: string[] = [];\n  columnOrder.forEach(tableCol => {\n    const cardMeta = tableToCardMapping[tableCol];\n    if (cardMeta && cardMeta.length > 0) {\n      cardMetadata.push(...cardMeta);\n    }\n  });\n  // Beschreibung hinzufgen, wenn nicht schon vorhanden\n  if (!cardMetadata.includes('description')) {\n    cardMetadata.push('description');\n  }\n  return cardMetadata;\n};\n\n// Reservations: Tabellen-Spalte -> Card-Metadaten (1:1 Mapping)\nconst reservationTableToCardMapping: Record<string, string[]> = {\n  'guestName': ['guestName'],\n  'status': ['status'],\n  'paymentStatus': ['paymentStatus'],\n  'checkInDate': ['checkInDate'],\n  'checkOutDate': ['checkOutDate'],\n  'roomNumber': ['roomNumber'],\n  'branch': ['branch'],\n  'guestEmail': ['guestEmail'],\n  'guestPhone': ['guestPhone'],\n  'amount': ['amount'],\n  'arrivalTime': ['arrivalTime'],\n  'actions': [] // Keine Card-Entsprechung\n};\n\n// Reservations: Reverse Mapping: Card-Metadaten -> Tabellen-Spalten (1:1 Mapping)\nconst reservationCardToTableMapping: Record<string, string> = {\n  'guestName': 'guestName',\n  'status': 'status',\n  'paymentStatus': 'paymentStatus',\n  'checkInDate': 'checkInDate',\n  'checkOutDate': 'checkOutDate',\n  'roomNumber': 'roomNumber',\n  'branch': 'branch',\n  'guestEmail': 'guestEmail',\n  'guestPhone': 'guestPhone',\n  'amount': 'amount',\n  'arrivalTime': 'arrivalTime'\n};\n\n// Tours: Tabellen-Spalte -> Card-Metadaten (1:1 Mapping)\nconst tourTableToCardMapping: Record<string, string[]> = {\n  'title': ['title'],\n  'type': ['type'],\n  'price': ['price'],\n  'location': ['location'],\n  'duration': ['duration'],\n  'branch': ['branch'],\n  'createdBy': ['createdBy'],\n  'isActive': ['isActive'],\n  'actions': [] // Keine Card-Entsprechung\n};\n\n// Tours: Reverse Mapping: Card-Metadaten -> Tabellen-Spalten (1:1 Mapping)\nconst tourCardToTableMapping: Record<string, string> = {\n  'title': 'title',\n  'type': 'type',\n  'price': 'price',\n  'location': 'location',\n  'duration': 'duration',\n  'branch': 'branch',\n  'createdBy': 'createdBy',\n  'isActive': 'isActive'\n};\n\n// Tours: Helfer-Funktion: Tabellen-Spalte ausgeblendet -> Card-Metadaten ausblenden\nconst getTourHiddenCardMetadata = (hiddenTableColumns: string[]): Set<string> => {\n  const hiddenCardMetadata = new Set<string>();\n  hiddenTableColumns.forEach(tableCol => {\n    const cardMetadata = tourTableToCardMapping[tableCol] || [];\n    cardMetadata.forEach(cardMeta => hiddenCardMetadata.add(cardMeta));\n  });\n  return hiddenCardMetadata;\n};\n\n// Tours: Helfer-Funktion: Card-Metadaten zu Tabellen-Spalten konvertieren\nconst getTourCardMetadataFromColumnOrder = (columnOrder: string[]): string[] => {\n  const cardMetadata: string[] = [];\n  columnOrder.forEach(tableCol => {\n    const cardMeta = tourTableToCardMapping[tableCol] || [];\n    if (cardMeta.length > 0) {\n      cardMetadata.push(...cardMeta);\n    }\n  });\n  return cardMetadata;\n};\n\n// Reservations: Helfer-Funktion: Tabellen-Spalte ausgeblendet -> Card-Metadaten ausblenden\nconst getReservationHiddenCardMetadata = (hiddenTableColumns: string[]): Set<string> => {\n  const hiddenCardMetadata = new Set<string>();\n  hiddenTableColumns.forEach(tableCol => {\n    const cardMetadata = reservationTableToCardMapping[tableCol] || [];\n    cardMetadata.forEach(cardMeta => hiddenCardMetadata.add(cardMeta));\n  });\n  return hiddenCardMetadata;\n};\n\n// Reservations: Helfer-Funktion: Card-Metadaten zu Tabellen-Spalten konvertieren\nconst getReservationCardMetadataFromColumnOrder = (columnOrder: string[]): string[] => {\n  const cardMetadata: string[] = [];\n  columnOrder.forEach(tableCol => {\n    const cardMeta = reservationTableToCardMapping[tableCol];\n    if (cardMeta && cardMeta.length > 0) {\n      cardMetadata.push(...cardMeta);\n    }\n  });\n  return cardMetadata;\n};\n\nconst Worktracker: React.FC = () => {\n    const { t } = useTranslation();\n    const { user } = useAuth();\n    const { hasPermission, permissions } = usePermissions();\n    const location = useLocation();\n    const navigate = useNavigate();\n    const { showMessage } = useMessage();\n    \n    // Definiere die verfgbaren Spalten fr die Tabelle (dynamisch aus bersetzungen)\n    const availableColumns = useMemo(() => [\n        { id: 'title', label: t('tasks.columns.title'), shortLabel: t('tasks.columns.title') },\n        { id: 'status', label: t('tasks.columns.status'), shortLabel: t('tasks.columns.status') },\n        { id: 'responsibleAndQualityControl', label: t('tasks.columns.responsibleAndQualityControl'), shortLabel: t('tasks.columns.responsibleAndQualityControl').split('/')[0] },\n        { id: 'branch', label: t('tasks.columns.branch'), shortLabel: t('tasks.columns.branch').substring(0, 5) },\n        { id: 'dueDate', label: t('tasks.columns.dueDate'), shortLabel: t('tasks.columns.dueDate').substring(0, 5) },\n        { id: 'actions', label: t('tasks.columns.actions'), shortLabel: t('common.actions').substring(0, 3) },\n    ], [t]);\n\n    // Definiere zustzliche Spalten, die nur fr den Filter verfgbar sind, nicht fr die Tabellenanzeige\n    const filterOnlyColumns = useMemo(() => [\n        { id: 'responsible', label: t('tasks.columns.responsible'), shortLabel: t('tasks.columns.responsible').substring(0, 3) },\n        { id: 'qualityControl', label: t('tasks.columns.qualityControl'), shortLabel: t('tasks.columns.qualityControl').substring(0, 2) },\n    ], [t]);\n    \n    // Reservations-Spalten\n    const availableReservationColumns = useMemo(() => [\n        { id: 'guestName', label: t('reservations.columns.guestName', 'Gast'), shortLabel: t('reservations.columns.guestName', 'Gast').substring(0, 4) },\n        { id: 'status', label: t('reservations.columns.status', 'Status'), shortLabel: t('reservations.columns.status', 'Status').substring(0, 3) },\n        { id: 'paymentStatus', label: t('reservations.columns.paymentStatus', 'Zahlungsstatus'), shortLabel: t('reservations.columns.paymentStatus', 'Zahlungsstatus').substring(0, 3) },\n        { id: 'checkInDate', label: t('reservations.columns.checkInDate', 'Check-in'), shortLabel: t('reservations.columns.checkInDate', 'Check-in').substring(0, 5) },\n        { id: 'checkOutDate', label: t('reservations.columns.checkOutDate', 'Check-out'), shortLabel: t('reservations.columns.checkOutDate', 'Check-out').substring(0, 5) },\n        { id: 'roomNumber', label: t('reservations.columns.roomNumber', 'Zimmer'), shortLabel: t('reservations.columns.roomNumber', 'Zimmer').substring(0, 3) },\n        { id: 'branch', label: t('reservations.columns.branch', 'Niederlassung'), shortLabel: t('reservations.columns.branch', 'Niederlassung').substring(0, 5) },\n        { id: 'guestEmail', label: t('reservations.columns.guestEmail', 'E-Mail'), shortLabel: t('reservations.columns.guestEmail', 'E-Mail').substring(0, 3) },\n        { id: 'guestPhone', label: t('reservations.columns.guestPhone', 'Telefon'), shortLabel: t('reservations.columns.guestPhone', 'Telefon').substring(0, 3) },\n        { id: 'amount', label: t('reservations.columns.amount', 'Betrag'), shortLabel: t('reservations.columns.amount', 'Betrag').substring(0, 3) },\n        { id: 'arrivalTime', label: t('reservations.columns.arrivalTime', 'Ankunftszeit'), shortLabel: t('reservations.columns.arrivalTime', 'Ankunftszeit').substring(0, 3) },\n        { id: 'actions', label: t('reservations.columns.actions', 'Aktionen'), shortLabel: t('common.actions').substring(0, 3) },\n    ], [t]);\n    \n    // Reservations Filter-Spalten (zustzliche Spalten nur fr Filter)\n    const reservationFilterOnlyColumns = useMemo(() => [\n        { id: 'onlineCheckInCompleted', label: t('reservations.columns.onlineCheckInCompleted', 'Online Check-in'), shortLabel: t('reservations.columns.onlineCheckInCompleted', 'Online Check-in').substring(0, 3) },\n        { id: 'doorPin', label: t('reservations.columns.doorPin', 'Tr-PIN'), shortLabel: t('reservations.columns.doorPin', 'Tr-PIN').substring(0, 3) },\n    ], [t]);\n    \n    // Tours-Spalten\n    const availableTourColumns = useMemo(() => [\n        { id: 'title', label: t('tours.columns.title', 'Titel'), shortLabel: t('tours.columns.title', 'Titel').substring(0, 4) },\n        { id: 'type', label: t('tours.columns.type', 'Typ'), shortLabel: t('tours.columns.type', 'Typ').substring(0, 3) },\n        { id: 'price', label: t('tours.columns.price', 'Preis'), shortLabel: t('tours.columns.price', 'Preis').substring(0, 3) },\n        { id: 'location', label: t('tours.columns.location', 'Ort'), shortLabel: t('tours.columns.location', 'Ort').substring(0, 3) },\n        { id: 'duration', label: t('tours.columns.duration', 'Dauer'), shortLabel: t('tours.columns.duration', 'Dauer').substring(0, 3) },\n        { id: 'branch', label: t('tours.columns.branch', 'Niederlassung'), shortLabel: t('tours.columns.branch', 'Niederlassung').substring(0, 5) },\n        { id: 'createdBy', label: t('tours.columns.createdBy', 'Erstellt von'), shortLabel: t('tours.columns.createdBy', 'Erstellt von').substring(0, 5) },\n        { id: 'isActive', label: t('tours.columns.status', 'Status'), shortLabel: t('tours.columns.status', 'Status').substring(0, 3) },\n        { id: 'actions', label: t('tours.columns.actions', 'Aktionen'), shortLabel: t('common.actions').substring(0, 3) },\n    ], [t]);\n    \n    // Tours Filter-Spalten (zustzliche Spalten nur fr Filter)\n    const tourFilterOnlyColumns = useMemo(() => [\n        { id: 'description', label: t('tours.columns.description', 'Beschreibung'), shortLabel: t('tours.columns.description', 'Beschreibung').substring(0, 3) },\n        { id: 'maxParticipants', label: t('tours.columns.maxParticipants', 'Max. Teilnehmer'), shortLabel: t('tours.columns.maxParticipants', 'Max. Teilnehmer').substring(0, 3) },\n        { id: 'minParticipants', label: t('tours.columns.minParticipants', 'Min. Teilnehmer'), shortLabel: t('tours.columns.minParticipants', 'Min. Teilnehmer').substring(0, 3) },\n    ], [t]);\n    \n    // Status-bersetzungen (verwende zentrale Utils mit bersetzungsuntersttzung)\n    // WICHTIG: Funktionalitt bleibt identisch - nur Code-Duplikation entfernt!\n    const getStatusLabel = (status: Task['status']): string => {\n        return getStatusText(status, 'task', t);\n    };\n    // Tab-State\n    const [activeTab, setActiveTab] = useState<'todos' | 'reservations' | 'tours' | 'tourBookings'>('todos');\n    \n    const [tasks, setTasks] = useState<Task[]>([]);\n    const [allTasks, setAllTasks] = useState<Task[]>([]); // Alle Tasks (fr Hintergrund-Laden und Filter-Wechsel)\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState<string | null>(null);\n    const [searchTerm, setSearchTerm] = useState('');\n    const [statusFilter, setStatusFilter] = useState<Task['status'] | 'all'>('all');\n    \n    // Reservations-States\n    const [reservations, setReservations] = useState<Reservation[]>([]);\n    const [reservationsLoading, setReservationsLoading] = useState(false);\n    const [reservationsError, setReservationsError] = useState<string | null>(null);\n    const [reservationSearchTerm, setReservationSearchTerm] = useState('');\n    const [reservationFilterStatus, setReservationFilterStatus] = useState<ReservationStatus | 'all'>('all');\n    const [reservationFilterPaymentStatus, setReservationFilterPaymentStatus] = useState<PaymentStatus | 'all'>('all');\n    \n    // Tours-States\n    const [tours, setTours] = useState<Tour[]>([]);\n    const [allTours, setAllTours] = useState<Tour[]>([]);\n    const [toursLoading, setToursLoading] = useState(false);\n    const [toursError, setToursError] = useState<string | null>(null);\n    const [tourSearchTerm, setTourSearchTerm] = useState('');\n    const [tourFilterConditions, setTourFilterConditions] = useState<FilterCondition[]>([]);\n    const [tourFilterLogicalOperators, setTourFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n    const [tourFilterSortDirections, setTourFilterSortDirections] = useState<Array<{ column: string; direction: 'asc' | 'desc'; priority: number; conditionIndex: number }>>([]);\n    const [tourActiveFilterName, setTourActiveFilterName] = useState<string>(t('tours.filters.current', 'Aktuell'));\n    const [tourSelectedFilterId, setTourSelectedFilterId] = useState<number | null>(null);\n    const [isCreateTourModalOpen, setIsCreateTourModalOpen] = useState(false);\n    const [isEditTourModalOpen, setIsEditTourModalOpen] = useState(false);\n    const [isTourDetailsModalOpen, setIsTourDetailsModalOpen] = useState(false);\n    const [isTourBookingsModalOpen, setIsTourBookingsModalOpen] = useState(false);\n    const [isTourExportDialogOpen, setIsTourExportDialogOpen] = useState(false);\n    const [selectedTour, setSelectedTour] = useState<Tour | null>(null);\n    const [selectedTourId, setSelectedTourId] = useState<number | null>(null);\n    const [isCreateReservationModalOpen, setIsCreateReservationModalOpen] = useState(false);\n    const [syncingReservations, setSyncingReservations] = useState(false);\n    const [generatingPinForReservation, setGeneratingPinForReservation] = useState<number | null>(null);\n    const [selectedReservationForInvitation, setSelectedReservationForInvitation] = useState<Reservation | null>(null);\n    const [isSendInvitationSidepaneOpen, setIsSendInvitationSidepaneOpen] = useState(false);\n    const [selectedReservationForPasscode, setSelectedReservationForPasscode] = useState<Reservation | null>(null);\n    const [isSendPasscodeSidepaneOpen, setIsSendPasscodeSidepaneOpen] = useState(false);\n    \n    // Tour-Bookings States\n    const [tourBookings, setTourBookings] = useState<TourBooking[]>([]);\n    const [allTourBookings, setAllTourBookings] = useState<TourBooking[]>([]);\n    const [tourBookingsLoading, setTourBookingsLoading] = useState(false);\n    const [tourBookingsError, setTourBookingsError] = useState<string | null>(null);\n    const [tourBookingsSearchTerm, setTourBookingsSearchTerm] = useState('');\n    const [selectedBookingForLink, setSelectedBookingForLink] = useState<TourBooking | null>(null);\n    const [isTourReservationLinkModalOpen, setIsTourReservationLinkModalOpen] = useState(false);\n    \n    // Reservations Filter States (analog zu Tasks)\n    const [reservationFilterConditions, setReservationFilterConditions] = useState<FilterCondition[]>([]);\n    const [reservationFilterLogicalOperators, setReservationFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n    const [reservationFilterSortDirections, setReservationFilterSortDirections] = useState<Array<{ column: string; direction: 'asc' | 'desc'; priority: number; conditionIndex: number }>>([]);\n    const [reservationActiveFilterName, setReservationActiveFilterName] = useState<string>('');\n    const [reservationSelectedFilterId, setReservationSelectedFilterId] = useState<number | null>(null);\n    \n    // State fr erweiterte Filterbedingungen\n    const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n    const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n    const [filterSortDirections, setFilterSortDirections] = useState<Array<{ column: string; direction: 'asc' | 'desc'; priority: number; conditionIndex: number }>>([]);\n    \n    // Filter State Management (Controlled Mode)\n    const [activeFilterName, setActiveFilterName] = useState<string>('');\n    const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n    \n    const [isFilterModalOpen, setIsFilterModalOpen] = useState(false);\n    // Tabellen-Header-Sortierung (nur fr Tabellen-Ansicht)\n    const [tableSortConfig, setTableSortConfig] = useState<SortConfig>({ key: 'dueDate', direction: 'asc' });\n    // Tabellen-Header-Sortierung fr Reservations (nur fr Tabellen-Ansicht)\n    const [reservationTableSortConfig, setReservationTableSortConfig] = useState<ReservationSortConfig>({ key: 'checkInDate', direction: 'desc' });\n    // Tabellen-Header-Sortierung fr Tours (nur fr Tabellen-Ansicht)\n    const [tourTableSortConfig, setTourTableSortConfig] = useState<TourSortConfig>({ key: 'title', direction: 'asc' });\n    const [isCreateModalOpen, setIsCreateModalOpen] = useState(false);\n    const [isEditModalOpen, setIsEditModalOpen] = useState(false);\n    const [selectedTask, setSelectedTask] = useState<Task | null>(null);\n    const [copiedTask, setCopiedTask] = useState<Task | null>(null);\n\n    // Tabellen-Einstellungen laden - Tasks\n    const {\n        settings: tasksSettings,\n        isLoading: isLoadingTasksSettings,\n        updateColumnOrder: updateTasksColumnOrder,\n        updateHiddenColumns: updateTasksHiddenColumns,\n        toggleColumnVisibility: toggleTasksColumnVisibility,\n        isColumnVisible: isTasksColumnVisible,\n        updateViewMode: updateTasksViewMode\n    } = useTableSettings('worktracker_tasks', {\n        defaultColumnOrder,\n        defaultHiddenColumns: [],\n        defaultViewMode: 'cards'\n    });\n    \n    // Tabellen-Einstellungen laden - Reservations\n    const defaultReservationColumnOrder = ['guestName', 'status', 'paymentStatus', 'checkInDate', 'checkOutDate', 'roomNumber', 'branch', 'actions'];\n    const {\n        settings: reservationsSettings,\n        isLoading: isLoadingReservationsSettings,\n        updateColumnOrder: updateReservationsColumnOrder,\n        updateHiddenColumns: updateReservationsHiddenColumns,\n        toggleColumnVisibility: toggleReservationsColumnVisibility,\n        isColumnVisible: isReservationsColumnVisible,\n        updateViewMode: updateReservationsViewMode\n    } = useTableSettings('worktracker-reservations', {\n        defaultColumnOrder: defaultReservationColumnOrder,\n        defaultHiddenColumns: [],\n        defaultViewMode: 'cards'\n    });\n    \n    // Tabellen-Einstellungen laden - Tours\n    const defaultTourColumnOrder = ['title', 'type', 'price', 'location', 'duration', 'branch', 'isActive', 'actions'];\n    const {\n        settings: toursSettings,\n        isLoading: isLoadingToursSettings,\n        updateColumnOrder: updateToursColumnOrder,\n        updateHiddenColumns: updateToursHiddenColumns,\n        toggleColumnVisibility: toggleToursColumnVisibility,\n        isColumnVisible: isToursColumnVisible,\n        updateViewMode: updateToursViewMode\n    } = useTableSettings('worktracker-tours', {\n        defaultColumnOrder: defaultTourColumnOrder,\n        defaultHiddenColumns: [],\n        defaultViewMode: 'cards'\n    });\n    \n    // Dynamische Settings basierend auf activeTab\n    const settings = activeTab === 'todos' ? tasksSettings : activeTab === 'reservations' ? reservationsSettings : toursSettings;\n    const isLoadingSettings = activeTab === 'todos' ? isLoadingTasksSettings : activeTab === 'reservations' ? isLoadingReservationsSettings : isLoadingToursSettings;\n    const updateColumnOrder = activeTab === 'todos' ? updateTasksColumnOrder : activeTab === 'reservations' ? updateReservationsColumnOrder : updateToursColumnOrder;\n    const updateHiddenColumns = activeTab === 'todos' ? updateTasksHiddenColumns : activeTab === 'reservations' ? updateReservationsHiddenColumns : updateToursHiddenColumns;\n    const toggleColumnVisibility = activeTab === 'todos' ? toggleTasksColumnVisibility : activeTab === 'reservations' ? toggleReservationsColumnVisibility : toggleToursColumnVisibility;\n    const isColumnVisible = activeTab === 'todos' ? isTasksColumnVisible : activeTab === 'reservations' ? isReservationsColumnVisible : isToursColumnVisible;\n    const updateViewMode = activeTab === 'todos' ? updateTasksViewMode : activeTab === 'reservations' ? updateReservationsViewMode : updateToursViewMode;\n\n    const [draggedColumn, setDraggedColumn] = useState<string | null>(null);\n    const [dragOverColumn, setDragOverColumn] = useState<string | null>(null);\n    const [displayLimit, setDisplayLimit] = useState<number>(10);\n\n    // Expand/Collapse States fr Reservations (analog zu MonthlyReports)\n    const [expandedReservationRows, setExpandedReservationRows] = useState<Set<number>>(new Set());\n\n    // View-Mode aus Settings laden\n    const viewMode = settings.viewMode || 'cards';\n\n    // Abgeleitete Werte fr Card-Ansicht aus Tabellen-Settings\n    // Card-Metadaten-Reihenfolge aus columnOrder ableiten\n    const cardMetadataOrder = useMemo(() => {\n        if (activeTab === 'todos') {\n            return getCardMetadataFromColumnOrder(settings.columnOrder || defaultColumnOrder);\n        } else {\n            return getReservationCardMetadataFromColumnOrder(settings.columnOrder || defaultReservationColumnOrder);\n        }\n    }, [settings.columnOrder, activeTab]);\n\n    // Versteckte Card-Metadaten aus hiddenColumns ableiten\n    const hiddenCardMetadata = useMemo(() => {\n        if (activeTab === 'todos') {\n            return getHiddenCardMetadata(settings.hiddenColumns || []);\n        } else {\n            return getReservationHiddenCardMetadata(settings.hiddenColumns || []);\n        }\n    }, [settings.hiddenColumns, activeTab]);\n\n    // Sichtbare Card-Metadaten (alle Card-Metadaten minus versteckte)\n    const visibleCardMetadata = useMemo(() => {\n        return new Set(cardMetadataOrder.filter(meta => !hiddenCardMetadata.has(meta)));\n    }, [cardMetadataOrder, hiddenCardMetadata]);\n\n    // Lokale Sortierrichtungen fr Tasks Cards (nicht persistiert)\n    const [taskCardSortDirections, setTaskCardSortDirections] = useState<Record<string, 'asc' | 'desc'>>(() => {\n        return defaultCardSortDirections;\n    });\n\n    // Handler fr Sortierrichtung-nderung bei Tasks\n    const handleTaskCardSortDirectionChange = (columnId: string, direction: 'asc' | 'desc') => {\n        setTaskCardSortDirections(prev => ({\n            ...prev,\n            [columnId]: direction\n        }));\n    };\n\n    // Lokale Sortierrichtungen fr Reservations Cards (nicht persistiert)\n    const [reservationCardSortDirections, setReservationCardSortDirections] = useState<Record<string, 'asc' | 'desc'>>(() => {\n        return defaultReservationCardSortDirections;\n    });\n\n    // Handler fr Sortierrichtung-nderung bei Reservations\n    const handleReservationCardSortDirectionChange = (columnId: string, direction: 'asc' | 'desc') => {\n        setReservationCardSortDirections(prev => ({\n            ...prev,\n            [columnId]: direction\n        }));\n    };\n\n    // Default Sortierrichtungen fr Tours Card-Metadaten\n    const defaultTourCardSortDirections: Record<string, 'asc' | 'desc'> = {\n        title: 'asc',\n        type: 'asc',\n        price: 'asc',\n        location: 'asc',\n        duration: 'asc',\n        branch: 'asc',\n        createdBy: 'asc',\n        isActive: 'asc'\n    };\n\n    // Lokale Sortierrichtungen fr Tours Cards (nicht persistiert)\n    const [tourCardSortDirections, setTourCardSortDirections] = useState<Record<string, 'asc' | 'desc'>>(() => {\n        return defaultTourCardSortDirections;\n    });\n\n    // Handler fr Sortierrichtung-nderung bei Tours\n    const handleTourCardSortDirectionChange = (columnId: string, direction: 'asc' | 'desc') => {\n        setTourCardSortDirections(prev => ({\n            ...prev,\n            [columnId]: direction\n        }));\n    };\n\n    // Toggle-Funktion fr Expand/Collapse bei Reservations\n    const toggleReservationExpanded = (reservationId: number) => {\n        setExpandedReservationRows(prev => {\n            const newSet = new Set(prev);\n            if (newSet.has(reservationId)) {\n                newSet.delete(reservationId);\n            } else {\n                newSet.add(reservationId);\n            }\n            return newSet;\n        });\n    };\n\n    // CSS-Klasse fr Container-Box setzen (fr CSS-basierte Schattierungs-Entfernung)\n    useEffect(() => {\n        const wrappers = document.querySelectorAll('.dashboard-tasks-wrapper');\n        wrappers.forEach(wrapper => {\n            if (viewMode === 'cards') {\n                wrapper.classList.add('cards-mode');\n            } else {\n                wrapper.classList.remove('cards-mode');\n            }\n        });\n    }, [viewMode]);\n\n    // Ref um sicherzustellen, dass loadTasks nur einmal beim Mount aufgerufen wird\n    // (auch bei React.StrictMode doppelter Ausfhrung)\n    const hasLoadedRef = useRef(false);\n\n    // Funktion zum Neu Laden der Tasks\n    const loadTasks = async (filterId?: number, filterConditions?: any[], background = false) => {\n        try {\n            if (!background) {\n                setLoading(true);\n            }\n            \n            // Baue Query-Parameter\n            const params: any = {};\n            if (filterId) {\n                params.filterId = filterId;\n            } else if (filterConditions && filterConditions.length > 0) {\n                params.filterConditions = JSON.stringify({\n                    conditions: filterConditions,\n                    operators: filterLogicalOperators\n                });\n            }\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.TASKS.BASE, { params });\n            const tasksData = response.data;\n            \n            // Attachments sind bereits in der Response enthalten\n            // URL-Generierung fr Attachments hinzufgen\n            // Sicherstellen, dass keine undefined/null Werte im Array sind\n            const tasksWithAttachments = tasksData\n                .filter((task: Task) => task != null)\n                .map((task: Task) => {\n                    const attachments = (task.attachments || [])\n                        .filter((att: any) => att != null)\n                        .map((att: any) => ({\n                            id: att.id,\n                            fileName: att.fileName,\n                            fileType: att.fileType,\n                            fileSize: att.fileSize,\n                            filePath: att.filePath,\n                            uploadedAt: att.uploadedAt,\n                            url: getTaskAttachmentUrl(task.id, att.id)\n                        }));\n                    \n                    return {\n                        ...task,\n                        attachments: attachments\n                    };\n                });\n            \n            if (background) {\n                // Hintergrund-Laden: Speichere in allTasks\n                console.log(' Alle Tasks im Hintergrund geladen:', tasksWithAttachments.length, 'Tasks');\n                setAllTasks(tasksWithAttachments);\n            } else {\n                // Vordergrund-Laden: Zeige sofort an\n                console.log(' Tasks geladen:', tasksWithAttachments.length, 'Tasks');\n                setTasks(tasksWithAttachments);\n            }\n            setError(null);\n        } catch (error) {\n            console.error('Fehler beim Laden der Tasks:', error);\n            if (!background) {\n                setError(t('worktime.messages.tasksLoadError'));\n            }\n        } finally {\n            if (!background) {\n                setLoading(false);\n            }\n        }\n    };\n\n    const handleGeneratePinAndSend = async (reservationId: number) => {\n        try {\n            setGeneratingPinForReservation(reservationId);\n            await reservationService.generatePinAndSend(reservationId);\n            showMessage(t('reservations.pinGeneratedAndSent', 'PIN-Code generiert und Mitteilung versendet'), 'success');\n            await loadReservations(); // Aktualisiere Liste\n        } catch (error: any) {\n            console.error('Fehler beim Generieren des PIN-Codes und Versenden der Mitteilung:', error);\n            showMessage(\n                error.response?.data?.message || t('reservations.pinGenerateError', 'Fehler beim Generieren des PIN-Codes und Versenden der Mitteilung'),\n                'error'\n            );\n        } finally {\n            setGeneratingPinForReservation(null);\n        }\n    };\n\n    // Funktion zum Laden der Reservations\n    const loadReservations = async () => {\n        try {\n            setReservationsLoading(true);\n            setReservationsError(null);\n            const response = await axiosInstance.get(API_ENDPOINTS.RESERVATION.BASE);\n            const reservationsData = response.data?.data || response.data || [];\n            console.log(' Reservations geladen:', reservationsData.length, 'Reservations');\n            setReservations(reservationsData);\n        } catch (err: any) {\n            console.error('Fehler beim Laden der Reservations:', err);\n            const errorMessage = err.response?.data?.message || t('reservations.loadError', 'Fehler beim Laden der Reservations');\n            setReservationsError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setReservationsLoading(false);\n        }\n    };\n\n    // Lade Reservations, wenn Tab aktiv ist\n    useEffect(() => {\n        if (activeTab === 'reservations' && hasPermission('reservations', 'read', 'table')) {\n            loadReservations();\n        }\n    }, [activeTab]);\n    \n    // Funktion zum Laden der Tours\n    const loadTours = async (filterId?: number, filterConditions?: any[], background = false) => {\n        try {\n            if (!background) {\n                setToursLoading(true);\n                setToursError(null);\n            }\n            \n            const params: any = {};\n            if (filterId) {\n                params.filterId = filterId;\n            } else if (filterConditions && filterConditions.length > 0) {\n                params.filterConditions = JSON.stringify({\n                    conditions: filterConditions,\n                    operators: tourFilterLogicalOperators\n                });\n            }\n            \n            const response = await axiosInstance.get(API_ENDPOINTS.TOURS.BASE, { params });\n            if (response.data.success) {\n                const toursData = response.data.data || [];\n                setAllTours(toursData);\n                if (!background) {\n                    setTours(toursData);\n                }\n            } else {\n                const errorMessage = response.data.message || t('errors.loadError');\n                if (!background) {\n                    setToursError(errorMessage);\n                    showMessage(errorMessage, 'error');\n                }\n            }\n        } catch (err: any) {\n            console.error('Fehler beim Laden der Touren:', err);\n            const errorMessage = err.response?.data?.message || t('errors.loadError');\n            if (!background) {\n                setToursError(errorMessage);\n                showMessage(errorMessage, 'error');\n            }\n        } finally {\n            if (!background) {\n                setToursLoading(false);\n            }\n        }\n    };\n    \n    // Lade Tours, wenn Tab aktiv ist\n    useEffect(() => {\n        if (activeTab === 'tours' && hasPermission('tours', 'read', 'table')) {\n            loadTours();\n        }\n    }, [activeTab]);\n    \n    // Funktion zum Laden der Tour-Buchungen\n    const loadTourBookings = async () => {\n        try {\n            setTourBookingsLoading(true);\n            setTourBookingsError(null);\n            const response = await axiosInstance.get(API_ENDPOINTS.TOUR_BOOKINGS.BASE);\n            const bookingsData = response.data?.data || response.data || [];\n            console.log(' Tour-Buchungen geladen:', bookingsData.length, 'Buchungen');\n            setTourBookings(bookingsData);\n            setAllTourBookings(bookingsData);\n        } catch (err: any) {\n            console.error('Fehler beim Laden der Tour-Buchungen:', err);\n            const errorMessage = err.response?.data?.message || t('tourBookings.loadError', 'Fehler beim Laden der Tour-Buchungen');\n            setTourBookingsError(errorMessage);\n            showMessage(errorMessage, 'error');\n        } finally {\n            setTourBookingsLoading(false);\n        }\n    };\n    \n    // Lade Tour-Buchungen, wenn Tab aktiv ist\n    useEffect(() => {\n        if (activeTab === 'tourBookings' && hasPermission('tour_bookings', 'read', 'table')) {\n            loadTourBookings();\n        }\n    }, [activeTab]);\n    \n    // Tour-Filter-Funktionen\n    const applyTourFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[], sortDirections: Array<{ column: string; direction: 'asc' | 'desc'; priority: number; conditionIndex: number }>) => {\n        setTourFilterConditions(conditions);\n        setTourFilterLogicalOperators(operators);\n        setTourFilterSortDirections(sortDirections);\n        loadTours(undefined, conditions, false);\n    };\n    \n    const resetTourFilterConditions = () => {\n        setTourFilterConditions([]);\n        setTourFilterLogicalOperators([]);\n        setTourFilterSortDirections([]);\n        setTourActiveFilterName(t('tours.filters.current', 'Aktuell'));\n        setTourSelectedFilterId(null);\n        loadTours();\n    };\n    \n    const handleTourFilterChange = (filterId: number | null, filterName: string) => {\n        setTourSelectedFilterId(filterId);\n        setTourActiveFilterName(filterName);\n        if (filterId) {\n            loadTours(filterId);\n        } else {\n            resetTourFilterConditions();\n        }\n    };\n\n    // Lade Tasks beim ersten Render (nur einmal, auch bei React.StrictMode)\n    useEffect(() => {\n        if (!hasLoadedRef.current) {\n            hasLoadedRef.current = true;\n            loadTasks();\n        }\n    }, []);\n\n    // URL-Parameter fr editTask verarbeiten\n    useEffect(() => {\n        if (tasks.length > 0) {\n            const queryParams = new URLSearchParams(location.search);\n            const editTaskId = queryParams.get('editTask');\n            \n            if (editTaskId) {\n                const taskId = parseInt(editTaskId, 10);\n                if (!isNaN(taskId)) {\n                    const task = tasks.find(t => t.id === taskId);\n                    if (task) {\n                        setSelectedTask(task);\n                        setIsEditModalOpen(true);\n                    }\n                }\n            }\n        }\n    }, [tasks, location.search]);\n\n    // Initialer Default-Filter setzen und Tasks laden (Controlled Mode)\n    useEffect(() => {\n        const setInitialFilterAndLoad = async () => {\n            try {\n                const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(TODOS_TABLE_ID));\n                const filters = response.data;\n                \n                const aktuellFilter = filters.find((filter: any) => filter.name === 'Aktuell');\n                if (aktuellFilter) {\n                    // 1. Filter-State setzen\n                    setActiveFilterName(t('tasks.filters.current'));\n                    setSelectedFilterId(aktuellFilter.id);\n                    \n                    // Migration: Altes Format zu neuem Format konvertieren\n                    let sortDirections = aktuellFilter.sortDirections || [];\n                    if (Array.isArray(sortDirections) && sortDirections.length > 0) {\n                        // Bereits neues Format\n                    } else if (sortDirections && typeof sortDirections === 'object' && !Array.isArray(sortDirections)) {\n                        // Altes Format: Record -> Array konvertieren\n                        sortDirections = Object.entries(sortDirections as Record<string, 'asc' | 'desc'>).map(([column, direction], index) => ({\n                            column,\n                            direction,\n                            priority: index + 1,\n                            conditionIndex: filterConditions.findIndex(c => c.column === column)\n                        }));\n                    }\n                    applyFilterConditions(aktuellFilter.conditions, aktuellFilter.operators, sortDirections);\n                    \n                    // 2. Tasks mit Standardfilter laden (server-seitig gefiltert)\n                    await loadTasks(aktuellFilter.id);\n                    \n                    // 3. Restliche Tasks im Hintergrund laden (fr Filter-Wechsel)\n                    setTimeout(() => {\n                        loadTasks(undefined, undefined, true);\n                    }, 2000); // 2 Sekunden Verzgerung, damit initiale Ladezeit nicht beeinflusst wird\n                } else {\n                    // Fallback: Alle Tasks laden (ohne Filter)\n                    await loadTasks();\n                }\n            } catch (error) {\n                console.error('Fehler beim Setzen des initialen Filters:', error);\n                // Fallback: Alle Tasks laden\n                await loadTasks();\n            }\n        };\n\n        setInitialFilterAndLoad();\n    }, []);\n\n    // Standard-Filter erstellen und speichern\n    useEffect(() => {\n        const createStandardFilters = async () => {\n            try {\n                const token = localStorage.getItem('token');\n                \n                if (!token) {\n                    console.error('Nicht authentifiziert');\n                    return;\n                }\n\n                // Prfen, ob die Standard-Filter bereits existieren\n                const existingFiltersResponse = await axiosInstance.get(\n                    `${API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(TODOS_TABLE_ID)}`,\n                    {\n                        headers: {\n                            Authorization: `Bearer ${token}`\n                        }\n                    }\n                );\n\n                const existingFilters = existingFiltersResponse.data || [];\n                const archivFilterExists = existingFilters.some(filter => filter.name === 'Archiv');\n                const aktuellFilterExists = existingFilters.some(filter => filter.name === 'Aktuell');\n\n                // Erstelle \"Archiv\"-Filter, wenn er noch nicht existiert\n                if (!archivFilterExists) {\n                    const archivFilter = {\n                        tableId: TODOS_TABLE_ID,\n                        name: 'Archiv', // Immer auf Deutsch speichern, wird beim Anzeigen bersetzt\n                        conditions: [\n                            { column: 'status', operator: 'equals', value: 'done' }\n                        ],\n                        operators: []\n                    };\n\n                    await axiosInstance.post(\n                        `${API_ENDPOINTS.SAVED_FILTERS.BASE}`,\n                        archivFilter,\n                        {\n                            headers: {\n                                Authorization: `Bearer ${token}`\n                            }\n                        }\n                    );\n                }\n\n                // Erstelle \"Aktuell\"-Filter, wenn er noch nicht existiert\n                if (!aktuellFilterExists) {\n                    const aktuellFilter = {\n                        tableId: TODOS_TABLE_ID,\n                        name: 'Aktuell', // Immer auf Deutsch speichern, wird beim Anzeigen bersetzt\n                        conditions: [\n                            { column: 'status', operator: 'notEquals', value: 'done' }\n                        ],\n                        operators: []\n                    };\n\n                    await axiosInstance.post(\n                        `${API_ENDPOINTS.SAVED_FILTERS.BASE}`,\n                        aktuellFilter,\n                        {\n                            headers: {\n                                Authorization: `Bearer ${token}`\n                            }\n                        }\n                    );\n                }\n            } catch (error) {\n                console.error('Fehler beim Erstellen der Standard-Filter:', error);\n            }\n        };\n\n        createStandardFilters();\n    }, []);\n\n    // getStatusColor und getStatusText werden jetzt von statusUtils verwendet (siehe getStatusLabel oben)\n\n    const handleStatusChange = async (taskId: number, newStatus: Task['status']) => {\n        try {\n            // Optimistisches Update: State sofort aktualisieren\n            setTasks(prevTasks => {\n                const validTasks = prevTasks.filter(task => task != null);\n                return validTasks.map(task => \n                    task.id === taskId ? { ...task, status: newStatus } : task\n                );\n            });\n\n            await axiosInstance.patch(API_ENDPOINTS.TASKS.BY_ID(taskId), { status: newStatus });\n            toast.success(t('worktime.messages.taskUpdated'));\n        } catch (error) {\n            // Rollback bei Fehler: Vollstndiges Reload\n            console.error('Fehler beim Aktualisieren des Status:', error);\n            loadTasks();\n                toast.error(t('worktime.messages.taskUpdatedError'));\n        }\n    };\n\n    const handleEditClick = (task: Task) => {\n        setSelectedTask(task);\n        setIsEditModalOpen(true);\n    };\n\n    const isResponsibleForTask = (task: Task) => {\n        if (task.responsible) {\n            return task.responsible.id === user?.id;\n        } else if (task.role) {\n            // Prfe, ob der Benutzer die angegebene Rolle hat\n            return user?.roles?.some(userRole => userRole.role?.id === task.role?.id) || false;\n        }\n        return false;\n    };\n\n    const isQualityControlForTask = (task: Task) => {\n        return task.qualityControl?.id === user?.id;\n    };\n\n    const handleSort = (key: SortConfig['key']) => {\n        // Nur fr Tabellen-Ansicht (Header-Sortierung)\n        if (viewMode === 'table') {\n            setTableSortConfig(current => ({\n                key,\n                direction: current.key === key && current.direction === 'asc' ? 'desc' : 'asc'\n            }));\n        }\n    };\n\n    const handleReservationSort = (key: ReservationSortConfig['key']) => {\n        // Nur fr Tabellen-Ansicht (Header-Sortierung)\n        if (viewMode === 'table' && activeTab === 'reservations') {\n            setReservationTableSortConfig(current => ({\n                key,\n                direction: current.key === key && current.direction === 'asc' ? 'desc' : 'asc'\n            }));\n        }\n    };\n\n    const handleTourSort = (key: TourSortConfig['key']) => {\n        // Nur fr Tabellen-Ansicht (Header-Sortierung)\n        if (viewMode === 'table' && activeTab === 'tours') {\n            setTourTableSortConfig(current => ({\n                key,\n                direction: current.key === key && current.direction === 'asc' ? 'desc' : 'asc'\n            }));\n        }\n    };\n\n    const renderStatusButtons = (task: Task): JSX.Element[] => {\n        const buttons: JSX.Element[] = [];\n        \n        // Prfe, ob der Benutzer Schreibberechtigungen fr Tasks hat\n        const canModifyTasks = hasPermission('tasks', 'write', 'table');\n        \n        if (!canModifyTasks) return buttons;\n        \n        // Zurck-Button (links)\n        if (task.status === 'in_progress' && isResponsibleForTask(task)) {\n            buttons.push(\n                <div className=\"relative group\">\n                    <button\n                        key=\"back\"\n                        onClick={() => handleStatusChange(task.id, 'open')}\n                        className=\"p-1.5 bg-red-600 dark:bg-red-500 text-white rounded hover:bg-red-700 dark:hover:bg-red-600\"\n                    >\n                        <ArrowLeftIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('tasks.actions.backToOpen')}\n                    </div>\n                </div>\n            );\n        } else if (task.status === 'quality_control' && isResponsibleForTask(task)) {\n            buttons.push(\n                <div className=\"relative group\">\n                    <button\n                        key=\"back\"\n                        onClick={() => handleStatusChange(task.id, 'in_progress')}\n                        className=\"p-1.5 bg-red-600 dark:bg-red-500 text-white rounded hover:bg-red-700 dark:hover:bg-red-600\"\n                    >\n                        <ArrowLeftIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('tasks.actions.backToInProgress')}\n                    </div>\n                </div>\n            );\n        } else if (task.status === 'done' && isQualityControlForTask(task)) {\n            buttons.push(\n                <div className=\"relative group\">\n                    <button\n                        key=\"back\"\n                        onClick={() => handleStatusChange(task.id, 'quality_control')}\n                        className=\"p-2 bg-red-600 dark:bg-red-500 text-white rounded hover:bg-red-700 dark:hover:bg-red-600\"\n                    >\n                        <ArrowLeftIcon className=\"h-6 w-6\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('tasks.actions.backToQualityControl')}\n                    </div>\n                </div>\n            );\n        }\n\n        // Weiter-Button (rechts)\n        if (task.status === 'open' && isResponsibleForTask(task)) {\n            buttons.push(\n                <div className=\"relative group\">\n                    <button\n                        key=\"forward\"\n                        onClick={() => handleStatusChange(task.id, 'in_progress')}\n                        className=\"p-1.5 bg-blue-600 dark:bg-blue-500 text-white rounded hover:bg-blue-700 dark:hover:bg-blue-600\"\n                    >\n                        <ArrowRightIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('tasks.actions.setInProgress')}\n                    </div>\n                </div>\n            );\n        } else if (task.status === 'in_progress' && isResponsibleForTask(task)) {\n            buttons.push(\n                <div className=\"relative group\">\n                    <button\n                        key=\"forward\"\n                        onClick={() => handleStatusChange(task.id, 'quality_control')}\n                        className=\"p-1.5 bg-purple-600 dark:bg-purple-500 text-white rounded hover:bg-purple-700 dark:hover:bg-purple-600\"\n                    >\n                        <ArrowRightIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('tasks.actions.setQualityControl')}\n                    </div>\n                </div>\n            );\n        } else if (task.status === 'quality_control' && isQualityControlForTask(task)) {\n            buttons.push(\n                <div className=\"relative group\">\n                    <button\n                        key=\"forward\"\n                        onClick={() => handleStatusChange(task.id, 'done')}\n                        className=\"p-1.5 bg-green-600 dark:bg-green-500 text-white rounded hover:bg-green-700 dark:hover:bg-green-600\"\n                    >\n                        <ArrowRightIcon className=\"h-5 w-5\" />\n                    </button>\n                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                        {t('tasks.actions.markDone')}\n                    </div>\n                </div>\n            );\n        }\n\n        return buttons;\n    };\n\n    const getActiveFilterCount = () => {\n        if (activeTab === 'todos') {\n            return filterConditions.length;\n        } else if (activeTab === 'reservations') {\n            return reservationFilterConditions.length;\n        } else if (activeTab === 'tours') {\n            return tourFilterConditions.length;\n        }\n        return 0;\n    };\n\n    const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[], sortDirections?: Array<{ column: string; direction: 'asc' | 'desc'; priority: number; conditionIndex: number }>) => {\n        setFilterConditions(conditions);\n        setFilterLogicalOperators(operators);\n        if (sortDirections !== undefined) {\n            // Sicherstellen, dass sortDirections ein Array ist\n            const validSortDirections = Array.isArray(sortDirections) ? sortDirections : [];\n            setFilterSortDirections(validSortDirections);\n        }\n    };\n    \n    const resetFilterConditions = () => {\n        setFilterConditions([]);\n        setFilterLogicalOperators([]);\n        setFilterSortDirections([]);\n        setActiveFilterName('');\n        setSelectedFilterId(null);\n    };\n    \n    // Reservations Filter Functions\n    const applyReservationFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[], sortDirections?: Array<{ column: string; direction: 'asc' | 'desc'; priority: number; conditionIndex: number }>) => {\n        setReservationFilterConditions(conditions);\n        setReservationFilterLogicalOperators(operators);\n        if (sortDirections !== undefined) {\n            const validSortDirections = Array.isArray(sortDirections) ? sortDirections : [];\n            setReservationFilterSortDirections(validSortDirections);\n        }\n    };\n    \n    const resetReservationFilterConditions = () => {\n        setReservationFilterConditions([]);\n        setReservationFilterLogicalOperators([]);\n        setReservationFilterSortDirections([]);\n        setReservationActiveFilterName('');\n        setReservationSelectedFilterId(null);\n    };\n    \n    // Filter Change Handler (Controlled Mode)\n    const handleFilterChange = async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[], sortDirections?: Array<{ column: string; direction: 'asc' | 'desc'; priority: number; conditionIndex: number }>) => {\n        if (activeTab === 'todos') {\n            setActiveFilterName(name);\n            setSelectedFilterId(id);\n            applyFilterConditions(conditions, operators, sortDirections);\n            // Table-Header-Sortierung zurcksetzen, damit Filter-Sortierung bernimmt\n            setTableSortConfig({ key: 'dueDate', direction: 'asc' });\n            \n            // Wenn Filter-ID vorhanden (Standardfilter): Server-seitig laden\n            // Sonst: Client-seitig filtern (komplexe Filter)\n            if (id) {\n                await loadTasks(id);\n            }\n            // Wenn kein ID: Client-seitiges Filtering wird automatisch durch filteredAndSortedTasks angewendet\n        } else if (activeTab === 'reservations') {\n            setReservationActiveFilterName(name);\n            setReservationSelectedFilterId(id);\n            applyReservationFilterConditions(conditions, operators, sortDirections);\n            // Table-Header-Sortierung zurcksetzen, damit Filter-Sortierung bernimmt\n            setReservationTableSortConfig({ key: 'checkInDate', direction: 'desc' });\n        } else if (activeTab === 'tours') {\n            setTourActiveFilterName(name);\n            setTourSelectedFilterId(id);\n            applyTourFilterConditions(conditions, operators, sortDirections || []);\n            // Table-Header-Sortierung zurcksetzen, damit Filter-Sortierung bernimmt\n            setTourTableSortConfig({ key: 'title', direction: 'asc' });\n            \n            // Wenn Filter-ID vorhanden (Standardfilter): Server-seitig laden\n            // Sonst: Client-seitig filtern (komplexe Filter)\n            if (id) {\n                await loadTours(id);\n            }\n            // Wenn kein ID: Client-seitiges Filtering wird automatisch durch filteredAndSortedTours angewendet\n        }\n    };\n    \n    const handleReservationFilterChange = async (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[], sortDirections?: Array<{ column: string; direction: 'asc' | 'desc'; priority: number; conditionIndex: number }>) => {\n        setReservationActiveFilterName(name);\n        setReservationSelectedFilterId(id);\n        applyReservationFilterConditions(conditions, operators, sortDirections);\n        setReservationTableSortConfig({ key: 'checkInDate', direction: 'desc' });\n    };\n\n    const getStatusPriority = (status: Task['status']): number => {\n        switch (status) {\n            case 'open': return 1;\n            case 'in_progress': return 2;\n            case 'improval': return 3;\n            case 'quality_control': return 4;\n            case 'done': return 5;\n            default: return 99; // Fallback fr unbekannte Status\n        }\n    };\n\n    // Status-Farben fr Reservations\n    const getReservationStatusColor = (status: ReservationStatus): string => {\n        switch (status) {\n            case ReservationStatus.CONFIRMED:\n                return 'bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200';\n            case ReservationStatus.NOTIFICATION_SENT:\n                return 'bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200';\n            case ReservationStatus.CHECKED_IN:\n                return 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200';\n            case ReservationStatus.CHECKED_OUT:\n                return 'bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200';\n            case ReservationStatus.CANCELLED:\n                return 'bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200';\n            case ReservationStatus.NO_SHOW:\n                return 'bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200';\n            default:\n                return 'bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200';\n        }\n    };\n\n    const getPaymentStatusColor = (status: PaymentStatus): string => {\n        switch (status) {\n            case PaymentStatus.PAID:\n                return 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200';\n            case PaymentStatus.PARTIALLY_PAID:\n                return 'bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200';\n            case PaymentStatus.REFUNDED:\n                return 'bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200';\n            case PaymentStatus.PENDING:\n            default:\n                return 'bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200';\n        }\n    };\n\n    const filteredAndSortedTasks = useMemo(() => {\n        // Verwende allTasks, wenn verfgbar und kein Standardfilter aktiv (fr komplexe Filter)\n        // Sonst verwende tasks (bereits server-seitig gefiltert)\n        const tasksToFilter = (allTasks.length > 0 && !selectedFilterId) ? allTasks : tasks;\n        \n        console.log(' Filtere Tasks:', tasksToFilter.length, 'Tasks vorhanden');\n        console.log(' Filterbedingungen:', filterConditions);\n        console.log(' Verwende:', allTasks.length > 0 && !selectedFilterId ? 'allTasks (client-seitig)' : 'tasks (server-seitig gefiltert)');\n        \n        // Sicherstellen, dass keine undefined/null Werte im Array sind\n        const validTasks = tasksToFilter.filter(task => task != null);\n        const filtered = validTasks\n            .filter(task => {\n                // Globale Suchfunktion\n                if (searchTerm) {\n                    const searchLower = searchTerm.toLowerCase();\n                    const matchesSearch = \n                        task.title.toLowerCase().includes(searchLower) ||\n                        (task.description && task.description.toLowerCase().includes(searchLower)) ||\n                        (task.responsible ? `${task.responsible.firstName} ${task.responsible.lastName}`.toLowerCase().includes(searchLower) : false) ||\n                        (task.role ? task.role.name.toLowerCase().includes(searchLower) : false) ||\n                        (task.qualityControl && `${task.qualityControl.firstName} ${task.qualityControl.lastName}`.toLowerCase().includes(searchLower)) ||\n                        task.branch.name.toLowerCase().includes(searchLower);\n                    \n                    if (!matchesSearch) return false;\n                }\n                \n                // Wenn erweiterte Filterbedingungen definiert sind, wende diese an\n                if (filterConditions.length > 0) {\n                    // Column-Evaluatoren fr Tasks mit korrekter User/Role-Logik\n                    const columnEvaluators: any = {\n                        'title': (task: Task, cond: FilterCondition) => {\n                            const value = (cond.value as string || '').toLowerCase();\n                            if (!task.title || typeof task.title !== 'string') {\n                                console.error('title evaluator: task.title ist undefined oder kein String', { task, cond });\n                                return null;\n                            }\n                            const title = task.title.toLowerCase();\n                            if (!title || typeof title !== 'string') {\n                                console.error('title evaluator: title nach toLowerCase() ist undefined oder kein String', { task, cond, title });\n                                return null;\n                            }\n                            if (cond.operator === 'equals') return task.title === cond.value;\n                            if (cond.operator === 'contains') return title.includes(value);\n                            if (cond.operator === 'startsWith') return title.startsWith(value);\n                            if (cond.operator === 'endsWith') {\n                                if (title === undefined || title === null) {\n                                    console.error('title evaluator: title ist undefined/null vor endsWith', { task, cond, title, value });\n                                    return false;\n                                }\n                                return title.endsWith(value);\n                            }\n                            return null;\n                        },\n                        'status': (task: Task, cond: FilterCondition) => {\n                            if (cond.operator === 'equals') return task.status === cond.value;\n                            if (cond.operator === 'notEquals') return task.status !== cond.value;\n                            return null;\n                        },\n                        'responsible': (task: Task, cond: FilterCondition) => {\n                            // Untersttzt user-{id} und role-{id} Format\n                            const responsibleName = task.responsible\n                                ? `${task.responsible.firstName} ${task.responsible.lastName}`\n                                : task.role\n                                    ? task.role.name\n                                    : '';\n                            return evaluateUserRoleCondition(\n                                task.responsible?.id || null,\n                                task.role?.id || null,\n                                cond,\n                                responsibleName\n                            );\n                        },\n                        'qualityControl': (task: Task, cond: FilterCondition) => {\n                            // Untersttzt nur user-{id} Format (keine Rollen)\n                            const qualityControlName = task.qualityControl\n                                ? `${task.qualityControl.firstName} ${task.qualityControl.lastName}`\n                                : '';\n                            return evaluateUserRoleCondition(\n                                task.qualityControl?.id || null,\n                                null, // QualityControl hat keine Rollen\n                                cond,\n                                qualityControlName\n                            );\n                        },\n                        'responsibleAndQualityControl': (task: Task, cond: FilterCondition) => {\n                            // Untersttzt user-{id} und role-{id} Format fr beide Felder\n                            const responsibleName = task.responsible\n                                ? `${task.responsible.firstName} ${task.responsible.lastName}`\n                                : task.role\n                                    ? task.role.name\n                                    : '';\n                            const qualityControlName = task.qualityControl\n                                ? `${task.qualityControl.firstName} ${task.qualityControl.lastName}`\n                                : '';\n                            return evaluateResponsibleAndQualityControl(\n                                task.responsible?.id || null,\n                                task.role?.id || null,\n                                task.qualityControl?.id || null,\n                                cond,\n                                responsibleName,\n                                qualityControlName\n                            );\n                        },\n                        'branch': (task: Task, cond: FilterCondition) => {\n                            const branchName = task.branch.name.toLowerCase();\n                            const value = (cond.value as string || '').toLowerCase();\n                            if (cond.operator === 'equals') return branchName === value;\n                            if (cond.operator === 'contains') return branchName.includes(value);\n                            return null;\n                        },\n                        'dueDate': (task: Task, cond: FilterCondition) => {\n                            return evaluateDateCondition(task.dueDate, cond);\n                        }\n                    };\n\n                    const getFieldValue = (task: Task, columnId: string): any => {\n                        switch (columnId) {\n                            case 'title': return task.title;\n                            case 'status': return task.status;\n                            case 'responsible': return task.responsible\n                                ? `${task.responsible.firstName} ${task.responsible.lastName}`\n                                : task.role\n                                    ? task.role.name\n                                    : '';\n                            case 'qualityControl': return task.qualityControl\n                                ? `${task.qualityControl.firstName} ${task.qualityControl.lastName}`\n                                : '';\n                            case 'responsibleAndQualityControl': return task.responsible\n                                ? `${task.responsible.firstName} ${task.responsible.lastName}`\n                                : task.role\n                                    ? task.role.name\n                                    : '';\n                            case 'branch': return task.branch.name;\n                            case 'dueDate': return task.dueDate;\n                            default: return (task as any)[columnId];\n                        }\n                    };\n\n                    // Wende Filter mit zentraler Logik an (nur fr dieses einzelne Item)\n                    const filtered = applyFilters(\n                        [task],\n                        filterConditions,\n                        filterLogicalOperators,\n                        getFieldValue,\n                        columnEvaluators\n                    );\n                    \n                    if (filtered.length === 0) return false;\n                }\n                \n                return true;\n            });\n        \n        console.log(' Gefilterte Tasks:', filtered.length, 'von', tasks.length);\n        \n        // Hilfsfunktion zum Extrahieren von Werten fr Sortierung\n        const getSortValue = (task: Task, columnId: string): any => {\n            switch (columnId) {\n                case 'title':\n                    return task.title.toLowerCase();\n                case 'status':\n                    return getStatusPriority(task.status);\n                case 'responsible':\n                case 'responsibleAndQualityControl':\n                    return task.responsible ? `${task.responsible.firstName} ${task.responsible.lastName}`.toLowerCase() : (task.role ? `Rolle: ${task.role.name}`.toLowerCase() : '');\n                case 'qualityControl':\n                    return task.qualityControl ? `${task.qualityControl.firstName} ${task.qualityControl.lastName}`.toLowerCase() : '';\n                case 'branch':\n                    return task.branch.name.toLowerCase();\n                case 'dueDate':\n                    return task.dueDate ? new Date(task.dueDate).getTime() : Number.MAX_SAFE_INTEGER;\n                case 'description':\n                    return (task.description || '').toLowerCase();\n                default:\n                    return '';\n            }\n        };\n        \n        const sorted = filtered.sort((a, b) => {\n            // 1. Prioritt: Table-Header-Sortierung (temporre berschreibung, auch wenn Filter aktiv)\n            if (viewMode === 'table' && tableSortConfig.key) {\n                const valueA = getSortValue(a, tableSortConfig.key);\n                const valueB = getSortValue(b, tableSortConfig.key);\n                \n                let comparison = 0;\n                if (typeof valueA === 'number' && typeof valueB === 'number') {\n                    comparison = valueA - valueB;\n                } else {\n                    comparison = String(valueA).localeCompare(String(valueB));\n                }\n                \n                if (comparison !== 0) {\n                    return tableSortConfig.direction === 'asc' ? comparison : -comparison;\n                }\n            }\n            \n            // 2. Prioritt: Filter-Sortierrichtungen (wenn Filter aktiv)\n            if (filterSortDirections.length > 0 && filterConditions.length > 0) {\n                // Sortiere nach Prioritt (1, 2, 3, ...)\n                const sortedByPriority = [...filterSortDirections].sort((sd1, sd2) => sd1.priority - sd2.priority);\n                \n                for (const sortDir of sortedByPriority) {\n                    const valueA = getSortValue(a, sortDir.column);\n                    const valueB = getSortValue(b, sortDir.column);\n                    \n                    let comparison = 0;\n                    if (typeof valueA === 'number' && typeof valueB === 'number') {\n                        comparison = valueA - valueB;\n                    } else {\n                        comparison = String(valueA).localeCompare(String(valueB));\n                    }\n                    \n                    if (sortDir.direction === 'desc') {\n                        comparison = -comparison;\n                    }\n                    \n                    if (comparison !== 0) {\n                        return comparison;\n                    }\n                }\n                return 0;\n            }\n            \n            // 3. Prioritt: Cards-Mode Multi-Sortierung (wenn kein Filter aktiv, Cards-Mode)\n            if (viewMode === 'cards' && filterConditions.length === 0) {\n                const sortableColumns = cardMetadataOrder.filter(colId => visibleCardMetadata.has(colId));\n                \n                for (const columnId of sortableColumns) {\n                    const direction = taskCardSortDirections[columnId] || 'asc';\n                    const valueA = getSortValue(a, columnId);\n                    const valueB = getSortValue(b, columnId);\n                    \n                    let comparison = 0;\n                    if (typeof valueA === 'number' && typeof valueB === 'number') {\n                        comparison = valueA - valueB;\n                    } else {\n                        comparison = String(valueA).localeCompare(String(valueB));\n                    }\n                    \n                    if (direction === 'desc') {\n                        comparison = -comparison;\n                    }\n                    \n                    if (comparison !== 0) {\n                        return comparison;\n                    }\n                }\n                return 0;\n            }\n            \n            // 4. Prioritt: Tabellen-Mode Einzel-Sortierung (wenn kein Filter aktiv, Table-Mode)\n            if (viewMode === 'table' && filterConditions.length === 0 && tableSortConfig.key) {\n                const valueA = getSortValue(a, tableSortConfig.key);\n                const valueB = getSortValue(b, tableSortConfig.key);\n                \n                let comparison = 0;\n                if (typeof valueA === 'number' && typeof valueB === 'number') {\n                    comparison = valueA - valueB;\n                } else {\n                    comparison = String(valueA).localeCompare(String(valueB));\n                }\n                \n                if (comparison !== 0) {\n                    return tableSortConfig.direction === 'asc' ? comparison : -comparison;\n                }\n            }\n            \n            // 5. Fallback: Standardsortierung (wenn keine benutzerdefinierte Sortierung)\n            const aDate = a.dueDate ? new Date(a.dueDate).getTime() : Number.MAX_SAFE_INTEGER;\n            const bDate = b.dueDate ? new Date(b.dueDate).getTime() : Number.MAX_SAFE_INTEGER;\n            \n            if (aDate !== bDate) {\n                return aDate - bDate;\n            }\n            \n            const aStatusPrio = getStatusPriority(a.status);\n            const bStatusPrio = getStatusPriority(b.status);\n            \n            if (aStatusPrio !== bStatusPrio) {\n                return aStatusPrio - bStatusPrio;\n            }\n            \n            return a.title.localeCompare(b.title);\n        });\n        \n        console.log(' Gefilterte und sortierte Tasks:', sorted.length);\n        return sorted;\n    }, [tasks, allTasks, selectedFilterId, searchTerm, tableSortConfig, getStatusPriority, filterConditions, filterLogicalOperators, filterSortDirections, viewMode, cardMetadataOrder, visibleCardMetadata, taskCardSortDirections]);\n\n    // Filter- und Sortierlogik fr Reservations\n    const filteredAndSortedReservations = useMemo(() => {\n        console.log(' Filtere Reservations:', reservations.length, 'Reservations vorhanden');\n        const validReservations = reservations.filter(reservation => reservation != null);\n        \n        let filtered = validReservations.filter(reservation => {\n            // Status-Filter\n            if (reservationFilterStatus !== 'all' && reservation.status !== reservationFilterStatus) {\n                return false;\n            }\n            \n            // Payment-Status-Filter\n            if (reservationFilterPaymentStatus !== 'all' && reservation.paymentStatus !== reservationFilterPaymentStatus) {\n                return false;\n            }\n            \n            // Such-Filter\n            if (reservationSearchTerm) {\n                const searchLower = reservationSearchTerm.toLowerCase();\n                const matchesSearch = \n                    (reservation.guestName && reservation.guestName.toLowerCase().includes(searchLower)) ||\n                    (reservation.guestEmail && reservation.guestEmail.toLowerCase().includes(searchLower)) ||\n                    (reservation.guestPhone && reservation.guestPhone.toLowerCase().includes(searchLower)) ||\n                    (reservation.roomNumber && reservation.roomNumber.toLowerCase().includes(searchLower)) ||\n                    (reservation.lobbyReservationId && reservation.lobbyReservationId.toLowerCase().includes(searchLower));\n                \n                if (!matchesSearch) return false;\n            }\n            \n            return true;\n        });\n\n        // Erweiterte Filterbedingungen anwenden\n        if (reservationFilterConditions.length > 0) {\n            // Column-Evaluatoren fr Reservations (analog zu Tasks)\n            const columnEvaluators: any = {\n                'guestName': (reservation: Reservation, cond: FilterCondition) => {\n                    const value = (cond.value as string || '').toLowerCase();\n                    const guestName = (reservation.guestName || '').toLowerCase();\n                    if (cond.operator === 'equals') return reservation.guestName === cond.value;\n                    if (cond.operator === 'contains') return guestName.includes(value);\n                    if (cond.operator === 'startsWith') return guestName.startsWith(value);\n                    if (cond.operator === 'endsWith') return guestName.endsWith(value);\n                    return null;\n                },\n                'status': (reservation: Reservation, cond: FilterCondition) => {\n                    if (cond.operator === 'equals') return reservation.status === cond.value;\n                    if (cond.operator === 'notEquals') return reservation.status !== cond.value;\n                    return null;\n                },\n                'paymentStatus': (reservation: Reservation, cond: FilterCondition) => {\n                    if (cond.operator === 'equals') return reservation.paymentStatus === cond.value;\n                    if (cond.operator === 'notEquals') return reservation.paymentStatus !== cond.value;\n                    return null;\n                },\n                'checkInDate': (reservation: Reservation, cond: FilterCondition) => {\n                    return evaluateDateCondition(reservation.checkInDate, cond);\n                },\n                'checkOutDate': (reservation: Reservation, cond: FilterCondition) => {\n                    return evaluateDateCondition(reservation.checkOutDate, cond);\n                },\n                'arrivalTime': (reservation: Reservation, cond: FilterCondition) => {\n                    return evaluateDateCondition(reservation.arrivalTime, cond);\n                },\n                'amount': (reservation: Reservation, cond: FilterCondition) => {\n                    const amount = typeof reservation.amount === 'string' \n                        ? parseFloat(reservation.amount) \n                        : (reservation.amount || 0);\n                    const compareValue = parseFloat(String(cond.value));\n                    if (isNaN(compareValue)) return false;\n                    if (cond.operator === 'equals') return Math.abs(amount - compareValue) < 0.01;\n                    if (cond.operator === 'greaterThan') return amount > compareValue;\n                    if (cond.operator === 'lessThan') return amount < compareValue;\n                    return null;\n                },\n                'roomNumber': (reservation: Reservation, cond: FilterCondition) => {\n                    const value = (cond.value as string || '').toLowerCase();\n                    const roomNumber = (reservation.roomNumber || '').toLowerCase();\n                    if (cond.operator === 'equals') return reservation.roomNumber === cond.value;\n                    if (cond.operator === 'contains') return roomNumber.includes(value);\n                    if (cond.operator === 'startsWith') return roomNumber.startsWith(value);\n                    if (cond.operator === 'endsWith') return roomNumber.endsWith(value);\n                    return null;\n                },\n                'guestEmail': (reservation: Reservation, cond: FilterCondition) => {\n                    const value = (cond.value as string || '').toLowerCase();\n                    const guestEmail = (reservation.guestEmail || '').toLowerCase();\n                    if (cond.operator === 'equals') return reservation.guestEmail === cond.value;\n                    if (cond.operator === 'contains') return guestEmail.includes(value);\n                    if (cond.operator === 'startsWith') return guestEmail.startsWith(value);\n                    if (cond.operator === 'endsWith') return guestEmail.endsWith(value);\n                    return null;\n                },\n                'guestPhone': (reservation: Reservation, cond: FilterCondition) => {\n                    const value = (cond.value as string || '').toLowerCase();\n                    const guestPhone = (reservation.guestPhone || '').toLowerCase();\n                    if (cond.operator === 'equals') return reservation.guestPhone === cond.value;\n                    if (cond.operator === 'contains') return guestPhone.includes(value);\n                    if (cond.operator === 'startsWith') return guestPhone.startsWith(value);\n                    if (cond.operator === 'endsWith') return guestPhone.endsWith(value);\n                    return null;\n                },\n                'branch': (reservation: Reservation, cond: FilterCondition) => {\n                    const branchName = (reservation.branch?.name || '').toLowerCase();\n                    const value = (cond.value as string || '').toLowerCase();\n                    if (cond.operator === 'equals') return branchName === value;\n                    if (cond.operator === 'contains') return branchName.includes(value);\n                    return null;\n                },\n                'doorPin': (reservation: Reservation, cond: FilterCondition) => {\n                    const value = (cond.value as string || '').toLowerCase();\n                    const doorPin = (reservation.doorPin || '').toLowerCase();\n                    if (cond.operator === 'equals') return reservation.doorPin === cond.value;\n                    if (cond.operator === 'contains') return doorPin.includes(value);\n                    if (cond.operator === 'startsWith') return doorPin.startsWith(value);\n                    if (cond.operator === 'endsWith') return doorPin.endsWith(value);\n                    return null;\n                },\n                'onlineCheckInCompleted': (reservation: Reservation, cond: FilterCondition) => {\n                    const value = cond.value === 'true' || cond.value === true || cond.value === '1';\n                    if (cond.operator === 'equals') return reservation.onlineCheckInCompleted === value;\n                    if (cond.operator === 'notEquals') return reservation.onlineCheckInCompleted !== value;\n                    return null;\n                }\n            };\n\n            const getFieldValue = (reservation: Reservation, columnId: string): any => {\n                switch (columnId) {\n                    case 'guestName': return reservation.guestName || '';\n                    case 'status': return reservation.status || '';\n                    case 'paymentStatus': return reservation.paymentStatus || '';\n                    case 'roomNumber': return reservation.roomNumber || '';\n                    case 'branch': return reservation.branch?.name || '';\n                    case 'guestEmail': return reservation.guestEmail || '';\n                    case 'guestPhone': return reservation.guestPhone || '';\n                    case 'lobbyReservationId': return reservation.lobbyReservationId || '';\n                    case 'checkInDate': return reservation.checkInDate;\n                    case 'checkOutDate': return reservation.checkOutDate;\n                    case 'amount': return reservation.amount;\n                    case 'arrivalTime': return reservation.arrivalTime;\n                    case 'doorPin': return reservation.doorPin || '';\n                    case 'onlineCheckInCompleted': return reservation.onlineCheckInCompleted;\n                    default: {\n                        const value = (reservation as any)[columnId];\n                        if (value == null) return '';\n                        if (typeof value === 'string') return value;\n                        if (typeof value === 'number') return String(value);\n                        if (typeof value === 'boolean') return String(value);\n                        return String(value);\n                    }\n                }\n            };\n\n            filtered = applyFilters(\n                filtered,\n                reservationFilterConditions,\n                reservationFilterLogicalOperators,\n                getFieldValue,\n                columnEvaluators\n            );\n        }\n        \n        // Hilfsfunktion zum Extrahieren von Werten fr Sortierung\n        const getReservationSortValue = (reservation: Reservation, columnId: string): any => {\n            switch (columnId) {\n                case 'guestName':\n                    return (reservation.guestName || '').toLowerCase();\n                case 'status':\n                    return reservation.status.toLowerCase();\n                case 'paymentStatus':\n                    return reservation.paymentStatus.toLowerCase();\n                case 'checkInDate':\n                    return reservation.checkInDate ? new Date(reservation.checkInDate).getTime() : 0;\n                case 'checkOutDate':\n                    return reservation.checkOutDate ? new Date(reservation.checkOutDate).getTime() : 0;\n                case 'roomNumber':\n                    return (reservation.roomNumber || '').toLowerCase();\n                case 'branch':\n                case 'branch.name':\n                    return (reservation.branch?.name || '').toLowerCase();\n                case 'guestEmail':\n                    return (reservation.guestEmail || '').toLowerCase();\n                case 'guestPhone':\n                    return (reservation.guestPhone || '').toLowerCase();\n                case 'amount':\n                    return typeof reservation.amount === 'string' ? parseFloat(reservation.amount) : (reservation.amount || 0);\n                case 'arrivalTime':\n                    return reservation.arrivalTime ? new Date(reservation.arrivalTime).getTime() : 0;\n                default:\n                    return '';\n            }\n        };\n        \n        // Sortierung basierend auf Prioritten\n        const sorted = filtered.sort((a, b) => {\n            // 1. Prioritt: Table-Header-Sortierung (temporre berschreibung, auch wenn Filter aktiv)\n            if (viewMode === 'table' && reservationTableSortConfig.key) {\n                const valueA = getReservationSortValue(a, reservationTableSortConfig.key);\n                const valueB = getReservationSortValue(b, reservationTableSortConfig.key);\n                \n                let comparison = 0;\n                if (typeof valueA === 'number' && typeof valueB === 'number') {\n                    comparison = valueA - valueB;\n                } else {\n                    comparison = String(valueA).localeCompare(String(valueB));\n                }\n                \n                if (comparison !== 0) {\n                    return reservationTableSortConfig.direction === 'asc' ? comparison : -comparison;\n                }\n            }\n            \n            // 2. Prioritt: Filter-Sortierrichtungen (wenn Filter aktiv)\n            if (reservationFilterSortDirections.length > 0 && reservationFilterConditions.length > 0) {\n                // Sortiere nach Prioritt (1, 2, 3, ...)\n                const sortedByPriority = [...reservationFilterSortDirections].sort((sd1, sd2) => sd1.priority - sd2.priority);\n                \n                for (const sortDir of sortedByPriority) {\n                    const valueA = getReservationSortValue(a, sortDir.column);\n                    const valueB = getReservationSortValue(b, sortDir.column);\n                    \n                    let comparison = 0;\n                    if (typeof valueA === 'number' && typeof valueB === 'number') {\n                        comparison = valueA - valueB;\n                    } else {\n                        comparison = String(valueA).localeCompare(String(valueB));\n                    }\n                    \n                    if (sortDir.direction === 'desc') {\n                        comparison = -comparison;\n                    }\n                    \n                    if (comparison !== 0) {\n                        return comparison;\n                    }\n                }\n                return 0;\n            }\n            \n            // 3. Prioritt: Cards-Mode Multi-Sortierung (wenn kein Filter aktiv, Cards-Mode)\n            if (viewMode === 'cards' && reservationFilterConditions.length === 0) {\n                const sortableColumns = cardMetadataOrder.filter(colId => visibleCardMetadata.has(colId));\n                \n                for (const columnId of sortableColumns) {\n                    const direction = reservationCardSortDirections[columnId] || 'asc';\n                    const valueA = getReservationSortValue(a, columnId);\n                    const valueB = getReservationSortValue(b, columnId);\n                    \n                    let comparison = 0;\n                    if (typeof valueA === 'number' && typeof valueB === 'number') {\n                        comparison = valueA - valueB;\n                    } else {\n                        comparison = String(valueA).localeCompare(String(valueB));\n                    }\n                    \n                    if (direction === 'desc') {\n                        comparison = -comparison;\n                    }\n                    \n                    if (comparison !== 0) {\n                        return comparison;\n                    }\n                }\n                return 0;\n            }\n            \n            // 4. Prioritt: Tabellen-Mode Einzel-Sortierung (wenn kein Filter aktiv, Table-Mode)\n            if (viewMode === 'table' && reservationFilterConditions.length === 0 && reservationTableSortConfig.key) {\n                const valueA = getReservationSortValue(a, reservationTableSortConfig.key);\n                const valueB = getReservationSortValue(b, reservationTableSortConfig.key);\n                \n                let comparison = 0;\n                if (typeof valueA === 'number' && typeof valueB === 'number') {\n                    comparison = valueA - valueB;\n                } else {\n                    comparison = String(valueA).localeCompare(String(valueB));\n                }\n                \n                if (comparison !== 0) {\n                    return reservationTableSortConfig.direction === 'asc' ? comparison : -comparison;\n                }\n            }\n            \n            // 5. Fallback: Check-in-Datum (neueste zuerst)\n            return new Date(b.checkInDate).getTime() - new Date(a.checkInDate).getTime();\n        });\n        \n        console.log(' Gefilterte und sortierte Reservations:', sorted.length);\n        return sorted;\n    }, [reservations, reservationFilterStatus, reservationFilterPaymentStatus, reservationSearchTerm, reservationFilterConditions, reservationFilterLogicalOperators, reservationFilterSortDirections, viewMode, cardMetadataOrder, visibleCardMetadata, reservationCardSortDirections, reservationTableSortConfig]);\n    \n    // Filter- und Sortierlogik fr Tours\n    const filteredAndSortedTours = useMemo(() => {\n        console.log(' Filtere Tours:', tours.length, 'Tours vorhanden');\n        const validTours = tours.filter(tour => tour != null);\n        \n        let filtered = validTours.filter(tour => {\n            // Such-Filter\n            if (tourSearchTerm) {\n                const searchLower = tourSearchTerm.toLowerCase();\n                const matchesSearch = \n                    (tour.title && tour.title.toLowerCase().includes(searchLower)) ||\n                    (tour.description && tour.description.toLowerCase().includes(searchLower)) ||\n                    (tour.location && tour.location.toLowerCase().includes(searchLower));\n                \n                if (!matchesSearch) return false;\n            }\n            \n            return true;\n        });\n\n        // Erweiterte Filterbedingungen anwenden\n        if (tourFilterConditions.length > 0) {\n            const columnEvaluators: any = {\n                'title': (tour: Tour, cond: FilterCondition) => {\n                    const value = (cond.value as string || '').toLowerCase();\n                    const title = (tour.title || '').toLowerCase();\n                    if (cond.operator === 'equals') return tour.title === cond.value;\n                    if (cond.operator === 'contains') return title.includes(value);\n                    if (cond.operator === 'startsWith') return title.startsWith(value);\n                    if (cond.operator === 'endsWith') return title.endsWith(value);\n                    return null;\n                },\n                'type': (tour: Tour, cond: FilterCondition) => {\n                    if (cond.operator === 'equals') return tour.type === cond.value;\n                    if (cond.operator === 'notEquals') return tour.type !== cond.value;\n                    return null;\n                },\n                'isActive': (tour: Tour, cond: FilterCondition) => {\n                    const value = cond.value === 'true' || cond.value === true || cond.value === '1';\n                    if (cond.operator === 'equals') return tour.isActive === value;\n                    if (cond.operator === 'notEquals') return tour.isActive !== value;\n                    return null;\n                },\n                'price': (tour: Tour, cond: FilterCondition) => {\n                    const price = typeof tour.price === 'string' ? parseFloat(tour.price) : (tour.price || 0);\n                    const compareValue = typeof cond.value === 'string' ? parseFloat(cond.value) : (cond.value || 0);\n                    if (isNaN(price) || isNaN(compareValue)) return false;\n                    if (cond.operator === 'equals') return Math.abs(price - compareValue) < 0.01;\n                    if (cond.operator === 'greaterThan') return price > compareValue;\n                    if (cond.operator === 'lessThan') return price < compareValue;\n                    return null;\n                },\n                'location': (tour: Tour, cond: FilterCondition) => {\n                    const value = (cond.value as string || '').toLowerCase();\n                    const location = (tour.location || '').toLowerCase();\n                    if (cond.operator === 'equals') return tour.location === cond.value;\n                    if (cond.operator === 'contains') return location.includes(value);\n                    if (cond.operator === 'startsWith') return location.startsWith(value);\n                    if (cond.operator === 'endsWith') return location.endsWith(value);\n                    return null;\n                },\n                'branch': (tour: Tour, cond: FilterCondition) => {\n                    const branchName = (tour.branch?.name || '').toLowerCase();\n                    const value = (cond.value as string || '').toLowerCase();\n                    if (cond.operator === 'equals') return branchName === value;\n                    if (cond.operator === 'contains') return branchName.includes(value);\n                    return null;\n                },\n                'createdBy': (tour: Tour, cond: FilterCondition) => {\n                    const createdByName = tour.createdBy\n                        ? `${tour.createdBy.firstName} ${tour.createdBy.lastName}`\n                        : '';\n                    return evaluateUserRoleCondition(\n                        tour.createdById || null,\n                        null,\n                        cond,\n                        createdByName\n                    );\n                }\n            };\n\n            const getFieldValue = (tour: Tour, columnId: string): any => {\n                switch (columnId) {\n                    case 'title': return tour.title || '';\n                    case 'type': return tour.type || '';\n                    case 'price': return typeof tour.price === 'string' ? parseFloat(tour.price) : (tour.price || 0);\n                    case 'location': return tour.location || '';\n                    case 'duration': return tour.duration || 0;\n                    case 'branch': return tour.branch?.name || '';\n                    case 'createdBy': return tour.createdBy ? `${tour.createdBy.firstName} ${tour.createdBy.lastName}` : '';\n                    case 'isActive': return tour.isActive;\n                    default: return '';\n                }\n            };\n\n            filtered = applyFilters(\n                filtered,\n                tourFilterConditions,\n                tourFilterLogicalOperators,\n                getFieldValue,\n                columnEvaluators\n            );\n        }\n        \n        // Hilfsfunktion zum Extrahieren von Werten fr Sortierung\n        const getTourSortValue = (tour: Tour, columnId: string): any => {\n            switch (columnId) {\n                case 'title':\n                    return (tour.title || '').toLowerCase();\n                case 'type':\n                    return tour.type.toLowerCase();\n                case 'price':\n                    return typeof tour.price === 'string' ? parseFloat(tour.price) : (tour.price || 0);\n                case 'location':\n                    return (tour.location || '').toLowerCase();\n                case 'duration':\n                    return tour.duration || 0;\n                case 'branch':\n                    return (tour.branch?.name || '').toLowerCase();\n                case 'createdBy':\n                    return tour.createdBy ? `${tour.createdBy.firstName} ${tour.createdBy.lastName}`.toLowerCase() : '';\n                case 'isActive':\n                    return tour.isActive ? 1 : 0;\n                default:\n                    return '';\n            }\n        };\n        \n        // Sortierung basierend auf Prioritten\n        const sorted = filtered.sort((a, b) => {\n            // 1. Prioritt: Table-Header-Sortierung (temporre berschreibung, auch wenn Filter aktiv)\n            if (viewMode === 'table' && tourTableSortConfig.key) {\n                const valueA = getTourSortValue(a, tourTableSortConfig.key);\n                const valueB = getTourSortValue(b, tourTableSortConfig.key);\n                \n                let comparison = 0;\n                if (typeof valueA === 'number' && typeof valueB === 'number') {\n                    comparison = valueA - valueB;\n                } else {\n                    comparison = String(valueA).localeCompare(String(valueB));\n                }\n                \n                if (comparison !== 0) {\n                    return tourTableSortConfig.direction === 'asc' ? comparison : -comparison;\n                }\n            }\n            \n            // 2. Prioritt: Filter-Sortierrichtungen (wenn Filter aktiv)\n            if (tourFilterSortDirections.length > 0 && tourFilterConditions.length > 0) {\n                // Sortiere nach Prioritt (1, 2, 3, ...)\n                const sortedByPriority = [...tourFilterSortDirections].sort((sd1, sd2) => sd1.priority - sd2.priority);\n                \n                for (const sortDir of sortedByPriority) {\n                    const valueA = getTourSortValue(a, sortDir.column);\n                    const valueB = getTourSortValue(b, sortDir.column);\n                    \n                    let comparison = 0;\n                    if (typeof valueA === 'number' && typeof valueB === 'number') {\n                        comparison = valueA - valueB;\n                    } else {\n                        comparison = String(valueA).localeCompare(String(valueB));\n                    }\n                    \n                    if (sortDir.direction === 'desc') {\n                        comparison = -comparison;\n                    }\n                    \n                    if (comparison !== 0) {\n                        return comparison;\n                    }\n                }\n                return 0;\n            }\n            \n            // 3. Prioritt: Cards-Mode Multi-Sortierung (wenn kein Filter aktiv, Cards-Mode)\n            if (viewMode === 'cards' && tourFilterConditions.length === 0) {\n                const sortableColumns = ['title', 'type', 'price', 'location', 'duration', 'branch', 'createdBy', 'isActive'];\n                \n                for (const columnId of sortableColumns) {\n                    const direction = tourCardSortDirections[columnId] || 'asc';\n                    const valueA = getTourSortValue(a, columnId);\n                    const valueB = getTourSortValue(b, columnId);\n                    \n                    let comparison = 0;\n                    if (typeof valueA === 'number' && typeof valueB === 'number') {\n                        comparison = valueA - valueB;\n                    } else {\n                        comparison = String(valueA).localeCompare(String(valueB));\n                    }\n                    \n                    if (direction === 'desc') {\n                        comparison = -comparison;\n                    }\n                    \n                    if (comparison !== 0) {\n                        return comparison;\n                    }\n                }\n                return 0;\n            }\n            \n            // 4. Prioritt: Tabellen-Mode Einzel-Sortierung (wenn kein Filter aktiv, Table-Mode)\n            if (viewMode === 'table' && tourFilterConditions.length === 0 && tourTableSortConfig.key) {\n                const valueA = getTourSortValue(a, tourTableSortConfig.key);\n                const valueB = getTourSortValue(b, tourTableSortConfig.key);\n                \n                let comparison = 0;\n                if (typeof valueA === 'number' && typeof valueB === 'number') {\n                    comparison = valueA - valueB;\n                } else {\n                    comparison = String(valueA).localeCompare(String(valueB));\n                }\n                \n                if (comparison !== 0) {\n                    return tourTableSortConfig.direction === 'asc' ? comparison : -comparison;\n                }\n            }\n            \n            // 5. Fallback: Titel (alphabetisch)\n            const titleA = (a.title || '').toLowerCase();\n            const titleB = (b.title || '').toLowerCase();\n            return titleA.localeCompare(titleB);\n        });\n        \n        console.log(' Gefilterte und sortierte Tours:', sorted.length);\n        return sorted;\n    }, [tours, tourSearchTerm, tourFilterConditions, tourFilterLogicalOperators, tourFilterSortDirections, viewMode, tourTableSortConfig, tourCardSortDirections]);\n\n    // Handler fr das Verschieben von Spalten per Drag & Drop\n    const handleMoveColumn = (dragIndex: number, hoverIndex: number) => {\n        // Neue Spaltenreihenfolge erstellen\n        const newColumnOrder = [...settings.columnOrder];\n        const draggedColumn = newColumnOrder[dragIndex];\n        \n        // Spalten neu anordnen\n        newColumnOrder.splice(dragIndex, 1); // Entferne die gezogene Spalte\n        newColumnOrder.splice(hoverIndex, 0, draggedColumn); // Fge sie an der neuen Position ein\n        \n        // Aktualisiere die Spaltenreihenfolge\n        updateColumnOrder(newColumnOrder);\n    };\n\n    // Handler fr Drag & Drop direkt in der Tabelle\n    const handleDragStart = (columnId: string) => {\n        setDraggedColumn(columnId);\n    };\n\n    const handleDragOver = (e: React.DragEvent, columnId: string) => {\n        e.preventDefault();\n        if (draggedColumn && draggedColumn !== columnId) {\n            setDragOverColumn(columnId);\n        }\n    };\n\n    const handleDrop = (e: React.DragEvent, columnId: string) => {\n        e.preventDefault();\n        if (draggedColumn && draggedColumn !== columnId) {\n            const dragIndex = settings.columnOrder.indexOf(draggedColumn);\n            const hoverIndex = settings.columnOrder.indexOf(columnId);\n            \n            if (dragIndex > -1 && hoverIndex > -1) {\n                handleMoveColumn(dragIndex, hoverIndex);\n            }\n        }\n        setDraggedColumn(null);\n        setDragOverColumn(null);\n    };\n\n    const handleDragEnd = () => {\n        setDraggedColumn(null);\n        setDragOverColumn(null);\n    };\n\n    // Filtern und sortieren der Spalten gem den Benutzereinstellungen\n    // Sicherstellen, dass alle Spalten aus defaultColumnOrder in columnOrder enthalten sind\n    const completeColumnOrder = useMemo(() => {\n        const currentOrder = settings.columnOrder || [];\n        // Sicherstellen, dass keine undefined/null Werte im Array sind\n        const validOrder = currentOrder.filter(id => id != null && typeof id === 'string');\n        // Fehlende Spalten aus defaultColumnOrder hinzufgen (dynamisch basierend auf activeTab)\n        const defaultOrder = activeTab === 'todos' ? defaultColumnOrder : activeTab === 'reservations' ? defaultReservationColumnOrder : defaultTourColumnOrder;\n        const missingColumns = defaultOrder.filter(id => !validOrder.includes(id));\n        return [...validOrder, ...missingColumns];\n    }, [settings.columnOrder, activeTab, defaultColumnOrder, defaultReservationColumnOrder, defaultTourColumnOrder]);\n\n    const visibleColumnIds = completeColumnOrder.filter(id => id != null && typeof id === 'string' && isColumnVisible(id));\n\n    // Funktion zum Kopieren eines Tasks\n    const handleCopyTask = async (task: Task) => {\n        try {\n            // Kopie des Tasks erstellen mit angepasstem Titel\n            const copiedTaskData = {\n                title: `${task.title}-Kopie`,\n                description: task.description,\n                status: 'open', // Immer als \"offen\" erstellen\n                responsibleId: task.responsible ? task.responsible.id : null,\n                roleId: task.role ? task.role.id : null,\n                qualityControlId: task.qualityControl?.id || null,\n                branchId: task.branch.id,\n                dueDate: task.dueDate\n            };\n\n            // Task erstellen\n            const response = await axiosInstance.post(\n                API_ENDPOINTS.TASKS.BASE,\n                copiedTaskData\n            );\n\n            // Optimistisches Update: Neuen Task zur Liste hinzufgen statt vollstndigem Reload\n            setTasks(prevTasks => [response.data, ...prevTasks]);\n            \n            // Bearbeitungsmodal fr den kopierten Task ffnen\n            setSelectedTask(response.data);\n            setIsEditModalOpen(true);\n            \n        } catch (err) {\n            console.error('Fehler beim Kopieren des Tasks:', err);\n            // Einfachere Fehlerbehandlung ohne axios-Import\n            const axiosError = err as any;\n            setError(axiosError.response?.data?.message || axiosError.message || 'Ein unerwarteter Fehler ist aufgetreten');\n        }\n    };\n\n    const handleDeleteTask = async (taskId: number) => {\n        if (window.confirm(t('worktime.messages.taskDeleteConfirm'))) {\n            console.log(' Starte Lschung von Task:', taskId);\n            console.log(' Aktuelle Tasks vor Lschung:', tasks.length);\n            \n            // Optimistisches Update: Task sofort aus Liste entfernen fr sofortiges Feedback\n            // Sicherstellen, dass keine undefined/null Werte im Array bleiben\n            setTasks(prevTasks => {\n                const filtered = prevTasks.filter(task => task != null && task.id !== taskId);\n                console.log(' Tasks nach Filterung:', filtered.length, 'von', prevTasks.length);\n                return filtered;\n            });\n\n            try {\n                console.log(' Sende Delete-Request...');\n                await axiosInstance.delete(API_ENDPOINTS.TASKS.BY_ID(taskId));\n                console.log(' Delete erfolgreich');\n                // Erfolgs-Rckmeldung anzeigen\n                toast.success(t('worktime.messages.taskDeleted'));\n            } catch (error) {\n                // Rollback bei Fehler: Vollstndiges Reload\n                console.error(' Fehler beim Lschen der Aufgabe:', error);\n                loadTasks();\n                toast.error(t('worktime.messages.taskDeletedError'));\n            }\n        }\n    };\n\n    const handleSaveTask = async (task: Task) => {\n        try {\n            await axiosInstance.put(API_ENDPOINTS.TASKS.BY_ID(task.id), task);\n            // Aktualisiere die Aufgabenliste\n            loadTasks();\n            setIsEditModalOpen(false);\n            setSelectedTask(null);\n            toast.success(t('worktime.messages.taskUpdated'));\n        } catch (error) {\n            console.error('Fehler beim Speichern der Aufgabe:', error);\n                toast.error(t('worktime.messages.taskSaveError'));\n        }\n    };\n\n    return (\n        <div className=\"min-h-screen dark:bg-gray-900\">\n            <div className=\"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6\">\n                {/* Neu angeordnete UI-Elemente in einer Zeile */}\n                <div className=\"w-full mb-4\">\n                    {/* Auf mobilen Gerten wird diese Reihenfolge angezeigt - Tasks oben, Zeiterfassung unten */}\n                    <div className=\"block sm:hidden w-full\">\n                    {/* Tasks */}\n                        <div className=\"dashboard-tasks-wrapper bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 w-full mb-20\">\n                            <div className=\"flex items-center justify-between px-3 sm:px-4 md:px-6\">\n                                {/* Linke Seite: \"Neuer Task\"-Button */}\n                                <div className=\"flex items-center\">\n                                    {hasPermission('tasks', 'write', 'table') && (\n                                        <div className=\"relative group\">\n                                            <button \n                                                onClick={() => setIsCreateModalOpen(true)}\n                                                className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                                                style={{ width: '30.19px', height: '30.19px' }}\n                                                aria-label={t('tasks.createTask')}\n                                            >\n                                                <PlusIcon className=\"h-4 w-4\" />\n                                            </button>\n                                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                {t('tasks.createTask')}\n                                            </div>\n                                        </div>\n                                    )}\n                                </div>\n                                \n                                {/* Mitte: Tab-Navigation */}\n                                <div className=\"flex items-center\">\n                                    <nav className=\"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto overflow-y-hidden\">\n                                        <button\n                                            onClick={() => setActiveTab('todos')}\n                                            className={`py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 flex items-center gap-1.5 ${\n                                                activeTab === 'todos'\n                                                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                            }`}\n                                        >\n                                            <CheckCircleIcon className=\"h-4 w-4 sm:h-5 sm:w-5\" />\n                                            {t('tasks.title', \"To Do's\")}\n                                        </button>\n                                        {hasPermission('reservations', 'read', 'table') && (\n                                            <button\n                                                onClick={() => setActiveTab('reservations')}\n                                                className={`py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 flex items-center gap-1.5 ${\n                                                    activeTab === 'reservations'\n                                                        ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                                }`}\n                                            >\n                                                <CalendarIcon className=\"h-4 w-4 sm:h-5 sm:w-5\" />\n                                                {t('reservations.title', 'Reservations')}\n                                            </button>\n                                        )}\n                                        {hasPermission('tours', 'read', 'table') && (\n                                            <button\n                                                onClick={() => setActiveTab('tours')}\n                                                className={`py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 flex items-center gap-1.5 ${\n                                                    activeTab === 'tours'\n                                                        ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                                }`}\n                                            >\n                                                <MapIcon className=\"h-4 w-4 sm:h-5 sm:w-5\" />\n                                                {t('tours.title', 'Touren')}\n                                            </button>\n                                        )}\n                                    </nav>\n                                </div>\n                                \n                                {/* Rechte Seite: Suchfeld, Sync-Button (nur Reservations), Filter-Button, Status-Filter, Spalten-Konfiguration */}\n                                <div className=\"flex items-center gap-1.5\">\n                                    <input\n                                        type=\"text\"\n                                        placeholder={t('common.search') + '...'}\n                                        className=\"w-[120px] sm:w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n                                        value={activeTab === 'todos' ? searchTerm : activeTab === 'reservations' ? reservationSearchTerm : tourSearchTerm}\n                                        onChange={(e) => {\n                                            if (activeTab === 'todos') {\n                                                setSearchTerm(e.target.value);\n                                            } else if (activeTab === 'reservations') {\n                                                setReservationSearchTerm(e.target.value);\n                                            } else {\n                                                setTourSearchTerm(e.target.value);\n                                            }\n                                        }}\n                                    />\n                                    \n                                    {/* Sync-Button fr Reservations */}\n                                    {activeTab === 'reservations' && (\n                                        <div className=\"relative group\">\n                                            <button\n                                                onClick={async () => {\n                                                    try {\n                                                        setSyncingReservations(true);\n                                                        await axiosInstance.post(API_ENDPOINTS.RESERVATIONS.SYNC);\n                                                        showMessage(t('reservations.syncSuccess', 'Reservations erfolgreich synchronisiert'), 'success');\n                                                        await loadReservations();\n                                                    } catch (err: any) {\n                                                        console.error('Fehler beim Synchronisieren:', err);\n                                                        showMessage(\n                                                            err.response?.data?.message || t('reservations.syncError', 'Fehler beim Synchronisieren'),\n                                                            'error'\n                                                        );\n                                                    } finally {\n                                                        setSyncingReservations(false);\n                                                    }\n                                                }}\n                                                disabled={syncingReservations}\n                                                className=\"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n                                            >\n                                                <ArrowPathIcon className={`h-5 w-5 ${syncingReservations ? 'animate-spin' : ''}`} />\n                                            </button>\n                                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                {syncingReservations ? t('reservations.syncing', 'Synchronisiere...') : t('reservations.sync', 'Synchronisieren')}\n                                            </div>\n                                        </div>\n                                    )}\n                                    \n                                    {/* View-Mode Toggle */}\n                                    <div className=\"relative group\">\n                                        <button\n                                            className={`p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ${\n                                                viewMode === 'cards' ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : ''\n                                            }`}\n                                            onClick={() => updateViewMode(viewMode === 'table' ? 'cards' : 'table')}\n                                        >\n                                            {viewMode === 'table' ? (\n                                                <Squares2X2Icon className=\"h-5 w-5\" />\n                                            ) : (\n                                                <TableCellsIcon className=\"h-5 w-5\" />\n                                            )}\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {viewMode === 'table' ? t('common.viewAsCards') : t('common.viewAsTable')}\n                                        </div>\n                                    </div>\n                                    \n                                    {/* Filter-Button */}\n                                    <div className=\"relative group ml-1\">\n                                        <button\n                                            className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n                                            onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\n                                        >\n                                            <FunnelIcon className=\"h-5 w-5\" />\n                                            {getActiveFilterCount() > 0 && (\n                                                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\n                                                    {getActiveFilterCount()}\n                                                </span>\n                                            )}\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {t('common.filter')}\n                                        </div>\n                                    </div>\n                                    \n                                    {/* Export-Button fr Tours */}\n                                    {activeTab === 'tours' && hasPermission('tour_edit', 'write', 'button') && (\n                                        <div className=\"relative group\">\n                                            <button\n                                                onClick={() => setIsTourExportDialogOpen(true)}\n                                                className=\"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700\"\n                                            >\n                                                <ArrowDownTrayIcon className=\"h-5 w-5\" />\n                                            </button>\n                                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                {t('tours.export', 'Exportieren')}\n                                            </div>\n                                        </div>\n                                    )}\n                                    \n                                    {/* Spalten-Konfiguration */}\n                                    <div className=\"ml-1\">\n                                        <TableColumnConfig \n                                            columns={activeTab === 'todos'\n                                                ? (viewMode === 'cards'\n                                                    ? [\n                                                        { id: 'title', label: t('tasks.columns.title') },\n                                                        { id: 'status', label: t('tasks.columns.status') },\n                                                        { id: 'responsible', label: t('tasks.columns.responsible') },\n                                                        { id: 'qualityControl', label: t('tasks.columns.qualityControl') },\n                                                        { id: 'branch', label: t('tasks.columns.branch') },\n                                                        { id: 'dueDate', label: t('tasks.columns.dueDate') },\n                                                        { id: 'description', label: t('tasks.columns.description') }\n                                                    ]\n                                                    : availableColumns)\n                                                : activeTab === 'reservations'\n                                                ? (viewMode === 'cards'\n                                                    ? [\n                                                        { id: 'guestName', label: t('reservations.columns.guestName', 'Gast') },\n                                                        { id: 'status', label: t('reservations.columns.status', 'Status') },\n                                                        { id: 'paymentStatus', label: t('reservations.columns.paymentStatus', 'Zahlungsstatus') },\n                                                        { id: 'checkInDate', label: t('reservations.columns.checkInDate', 'Check-in') },\n                                                        { id: 'checkOutDate', label: t('reservations.columns.checkOutDate', 'Check-out') },\n                                                        { id: 'roomNumber', label: t('reservations.columns.roomNumber', 'Zimmer') },\n                                                        { id: 'guestEmail', label: t('reservations.columns.guestEmail', 'E-Mail') },\n                                                        { id: 'guestPhone', label: t('reservations.columns.guestPhone', 'Telefon') },\n                                                        { id: 'amount', label: t('reservations.columns.amount', 'Betrag') },\n                                                        { id: 'arrivalTime', label: t('reservations.columns.arrivalTime', 'Ankunftszeit') }\n                                                    ]\n                                                    : availableReservationColumns)\n                                                : activeTab === 'tours'\n                                                ? (viewMode === 'cards'\n                                                    ? [\n                                                        { id: 'title', label: t('tours.columns.title', 'Titel') },\n                                                        { id: 'type', label: t('tours.columns.type', 'Typ') },\n                                                        { id: 'price', label: t('tours.columns.price', 'Preis') },\n                                                        { id: 'location', label: t('tours.columns.location', 'Ort') },\n                                                        { id: 'duration', label: t('tours.columns.duration', 'Dauer') },\n                                                        { id: 'branch', label: t('tours.columns.branch', 'Niederlassung') },\n                                                        { id: 'createdBy', label: t('tours.columns.createdBy', 'Erstellt von') },\n                                                        { id: 'isActive', label: t('tours.columns.status', 'Status') }\n                                                    ]\n                                                    : availableTourColumns)\n                                                : []}\n                                            visibleColumns={viewMode === 'cards'\n                                                ? Array.from(visibleCardMetadata)\n                                                : visibleColumnIds}\n                                            columnOrder={viewMode === 'cards'\n                                                ? cardMetadataOrder\n                                                : settings.columnOrder}\n                                            onToggleColumnVisibility={(columnId) => {\n                                                if (viewMode === 'cards') {\n                                                    // Fr Cards: Mapping zurck zu Tabellen-Spalten\n                                                    const tableColumn = cardToTableMapping[columnId];\n                                                    if (tableColumn) {\n                                                        // Spezielle Logik fr responsibleAndQualityControl\n                                                        if (tableColumn === 'responsibleAndQualityControl') {\n                                                            // Prfe ob beide bereits ausgeblendet sind\n                                                            const otherCardMeta = columnId === 'responsible' ? 'qualityControl' : 'responsible';\n                                                            const otherHidden = hiddenCardMetadata.has(otherCardMeta);\n                                                            const currentlyHidden = settings.hiddenColumns.includes(tableColumn);\n                                                            \n                                                            if (currentlyHidden && !otherHidden) {\n                                                                // Eine der beiden wird wieder angezeigt, also responsibleAndQualityControl wieder anzeigen\n                                                                toggleColumnVisibility(tableColumn);\n                                                            } else if (!currentlyHidden && otherHidden) {\n                                                                // Die andere ist bereits ausgeblendet, also responsibleAndQualityControl ausblenden\n                                                                toggleColumnVisibility(tableColumn);\n                                                            } else if (!currentlyHidden) {\n                                                                // Erste wird ausgeblendet, responsibleAndQualityControl ausblenden\n                                                                toggleColumnVisibility(tableColumn);\n                                                            } else {\n                                                                // Beide sind ausgeblendet, eine wird wieder angezeigt\n                                                                toggleColumnVisibility(tableColumn);\n                                                            }\n                                                        } else {\n                                                            // Normale Spalte: direkt ein/ausblenden\n                                                            toggleColumnVisibility(tableColumn);\n                                                        }\n                                                    }\n                                                } else {\n                                                    toggleColumnVisibility(columnId);\n                                                }\n                                            }}\n                                            onMoveColumn={viewMode === 'cards'\n                                                ? (dragIndex: number, hoverIndex: number) => {\n                                                    const newCardOrder = [...cardMetadataOrder];\n                                                    const dragged = newCardOrder[dragIndex];\n                                                    newCardOrder.splice(dragIndex, 1);\n                                                    newCardOrder.splice(hoverIndex, 0, dragged);\n                                                    \n                                                    // Konvertiere zurck zu Tabellen-Spalten-Reihenfolge\n                                                    const newTableOrder: string[] = [];\n                                                    const usedTableColumns = new Set<string>();\n                                                    \n                                                    newCardOrder.forEach(cardMeta => {\n                                                        const tableCol = cardToTableMapping[cardMeta];\n                                                        if (tableCol && !usedTableColumns.has(tableCol)) {\n                                                            usedTableColumns.add(tableCol);\n                                                            newTableOrder.push(tableCol);\n                                                        }\n                                                    });\n                                                    \n                                                    // Fge fehlende Tabellen-Spalten hinzu\n                                                    availableColumns.forEach(col => {\n                                                        if (!newTableOrder.includes(col.id) && col.id !== 'actions') {\n                                                            newTableOrder.push(col.id);\n                                                        }\n                                                    });\n                                                    \n                                                    updateColumnOrder(newTableOrder);\n                                                }\n                                                : handleMoveColumn}\n                                            buttonTitle={viewMode === 'cards' ? t('tableColumn.sortAndDisplay') : t('tableColumn.configure')}\n                                            modalTitle={viewMode === 'cards' ? t('tableColumn.sortAndDisplay') : t('tableColumn.configure')}\n                                            sortDirections={viewMode === 'cards' && activeTab === 'todos'\n                                                ? taskCardSortDirections\n                                                : viewMode === 'cards' && activeTab === 'reservations' \n                                                ? reservationCardSortDirections \n                                                : undefined}\n                                            onSortDirectionChange={viewMode === 'cards' && activeTab === 'todos'\n                                                ? handleTaskCardSortDirectionChange\n                                                : viewMode === 'cards' && activeTab === 'reservations'\n                                                ? handleReservationCardSortDirectionChange\n                                                : undefined}\n                                            showSortDirection={viewMode === 'cards' && (activeTab === 'todos' || activeTab === 'reservations')}\n                                            onClose={() => {}}\n                                        />\n                                    </div>\n                                </div>\n                            </div>\n\n                            {/* Filter-Pane */}\n                            {isFilterModalOpen && (\n                                <div className={viewMode === 'cards' ? '-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6' : 'px-3 sm:px-4 md:px-6'}>\n                                    {activeTab === 'todos' ? (\n                                        <FilterPane\n                                            columns={[...availableColumns, ...filterOnlyColumns]}\n                                            onApply={applyFilterConditions}\n                                            onReset={resetFilterConditions}\n                                            savedConditions={filterConditions}\n                                            savedOperators={filterLogicalOperators}\n                                            savedSortDirections={filterSortDirections}\n                                            onSortDirectionsChange={setFilterSortDirections}\n                                            tableId={TODOS_TABLE_ID}\n                                        />\n                                    ) : (\n                                        <FilterPane\n                                            columns={[...availableReservationColumns, ...reservationFilterOnlyColumns]}\n                                            onApply={applyReservationFilterConditions}\n                                            onReset={resetReservationFilterConditions}\n                                            savedConditions={reservationFilterConditions}\n                                            savedOperators={reservationFilterLogicalOperators}\n                                            savedSortDirections={reservationFilterSortDirections}\n                                            onSortDirectionsChange={setReservationFilterSortDirections}\n                                            tableId={RESERVATIONS_TABLE_ID}\n                                        />\n                                    )}\n                                </div>\n                            )}\n\n                            {/* Gespeicherte Filter als Tags anzeigen */}\n                            {(\n                                <div className={viewMode === 'cards' ? '-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6' : 'px-3 sm:px-4 md:px-6'}>\n                                    <SavedFilterTags\n                                    tableId={activeTab === 'todos' ? TODOS_TABLE_ID : activeTab === 'reservations' ? RESERVATIONS_TABLE_ID : TOURS_TABLE_ID}\n                                    onSelectFilter={activeTab === 'todos' ? applyFilterConditions : activeTab === 'reservations' ? applyReservationFilterConditions : applyTourFilterConditions}\n                                    onReset={activeTab === 'todos' ? resetFilterConditions : activeTab === 'reservations' ? resetReservationFilterConditions : resetTourFilterConditions}\n                                    activeFilterName={activeTab === 'todos' ? activeFilterName : activeTab === 'reservations' ? reservationActiveFilterName : tourActiveFilterName}\n                                    selectedFilterId={activeTab === 'todos' ? selectedFilterId : activeTab === 'reservations' ? reservationSelectedFilterId : tourSelectedFilterId}\n                                    onFilterChange={activeTab === 'todos' ? handleFilterChange : activeTab === 'reservations' ? handleReservationFilterChange : handleTourFilterChange}\n                                    defaultFilterName={activeTab === 'todos' ? t('tasks.filters.current') : activeTab === 'reservations' ? t('reservations.filters.current', 'Aktuell') : t('tours.filters.current', 'Aktuell')}\n                                />\n                                </div>\n                            )}\n                            \n                            {/* Tabelle oder Cards - nur aktiven Tab rendern */}\n                            {activeTab === 'todos' && viewMode === 'table' ? (\n                                /* Tabellen-Ansicht - Tasks */\n                                <div className=\"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6\">\n                                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                                        <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                                            <tr>\n                                                {visibleColumnIds.map((columnId) => {\n                                                    const column = availableColumns.find(col => col.id === columnId);\n                                                    if (!column) return null;\n                                                    \n                                                    return (\n                                                        <th\n                                                            key={columnId}\n                                                            scope=\"col\"\n                                                            className={`px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider ${columnId === dragOverColumn ? 'bg-blue-100 dark:bg-blue-800' : ''}`}\n                                                            draggable={true}\n                                                            onDragStart={() => handleDragStart(columnId)}\n                                                            onDragOver={(e) => handleDragOver(e, columnId)}\n                                                            onDrop={(e) => handleDrop(e, columnId)}\n                                                            onDragEnd={handleDragEnd}\n                                                        >\n                                                            <div className=\"flex items-center\">\n                                                                {window.innerWidth <= 640 ? column.shortLabel : column.label}\n                                                                {columnId !== 'actions' && (\n                                                                    <button \n                                                                        onClick={() => handleSort(columnId as keyof Task)}\n                                                                        className=\"ml-1 focus:outline-none\"\n                                                                    >\n                                                                        <ArrowsUpDownIcon className=\"h-4 w-4 text-gray-400 dark:text-gray-500\" />\n                                                                    </button>\n                                                                )}\n                                                            </div>\n                                                        </th>\n                                                    );\n                                                })}\n                                            </tr>\n                                        </thead>\n                                        <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                                            {loading ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-4 text-center\">\n                                                        <div className=\"flex justify-center\">\n                                                            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100\"></div>\n                                                        </div>\n                                                    </td>\n                                                </tr>\n                                            ) : error ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-6 py-4 text-center text-red-600 dark:text-red-400\">\n                                                        {error}\n                                                    </td>\n                                                </tr>\n                                            ) : filteredAndSortedTasks.length === 0 ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-6 py-4 text-center text-gray-500 dark:text-gray-400\">\n                                                        <div className=\"flex flex-col items-center justify-center gap-4\">\n                                                        <ClipboardDocumentListIcon className=\"h-10 w-10 text-gray-400 dark:text-gray-500\" />\n                                                        <div className=\"text-sm\">{t('tasks.noTasksFound')}</div>\n                                                    </div>\n                                                </td>\n                                            </tr>\n                                        ) : (\n                                            <>\n                                            {filteredAndSortedTasks.slice(0, displayLimit).map(task => {\n                                            const expiryStatus = getExpiryStatus(task.dueDate, 'todo', undefined, task.title, task.description);\n                                            const expiryColors = getExpiryColorClasses(expiryStatus);\n                                            \n                                            return (\n                                                <tr \n                                                    key={task.id} \n                                                    className={`hover:bg-gray-50 dark:hover:bg-gray-700 ${\n                                                        expiryStatus !== 'none' ? `${expiryColors.bgClass} ${expiryColors.borderClass} border-l-4` : ''\n                                                    }`}\n                                                >\n                                                    {visibleColumnIds.map(columnId => {\n                                                    switch (columnId) {\n                                                        case 'title':\n                                                            return (\n                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4\">\n                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200 break-words flex items-center\">\n                                                                        {task.title}\n                                                                            {task.description && (\n                                                                                <div className=\"ml-2 relative group\">\n                                                                                    <button \n                                                                                        className=\"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300\"\n                                                                                    >\n                                                                                        <InformationCircleIcon className=\"h-5 w-5\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('tasks.showDescription')}\n                                                                                    </div>\n                                                                                    <div className=\"absolute left-0 mt-2 p-2 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 shadow-lg rounded-md border border-gray-200 dark:border-gray-700 w-144 max-h-96 overflow-y-auto min-w-[36rem] z-10 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none\">\n                                                                                        <MarkdownPreview content={task.description} showImagePreview={true} />\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            case 'status':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusColor(task.status, 'task')} dark:bg-opacity-30 status-col`}>\n                                                                            {task.status}\n                                                                        </span>\n                                                                    </td>\n                                                                );\n                                                            case 'responsibleAndQualityControl':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className=\"flex flex-col\">\n                                                                            <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 hidden sm:inline\">{t('tasks.columns.responsible')}:</span>\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 inline sm:hidden\">{t('tasks.columns.responsible').substring(0, 3)}:</span><br />\n                                                                                {task.responsible ? `${task.responsible.firstName} ${task.responsible.lastName}` : task.role ? task.role.name : '-'}\n                                                                            </div>\n                                                                            <div className=\"text-sm text-gray-900 dark:text-gray-200 mt-1\">\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 hidden sm:inline\">{t('tasks.qualityControlLabel')}</span>\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 inline sm:hidden\">{t('tasks.columns.qualityControl').substring(0, 2)}:</span><br />\n                                                                                {task.qualityControl ? `${task.qualityControl.firstName} ${task.qualityControl.lastName}` : '-'}\n                                                                            </div>\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            case 'branch':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className=\"text-sm text-gray-900 dark:text-gray-200\">{task.branch.name}</div>\n                                                                    </td>\n                                                                );\n                                                            case 'dueDate':\n                                                                const expiryStatusForDate = getExpiryStatus(task.dueDate, 'todo', undefined, task.title, task.description);\n                                                                const expiryColorsForDate = getExpiryColorClasses(expiryStatusForDate);\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className={`text-sm ${expiryStatusForDate !== 'none' ? expiryColorsForDate.textClass : 'text-gray-900 dark:text-gray-200'}`}>\n                                                                            {task.dueDate ? new Date(task.dueDate).toLocaleDateString() : '-'}\n                                                                            {expiryStatusForDate !== 'none' && (\n                                                                                <span className=\"ml-2 text-xs\"></span>\n                                                                            )}\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            case 'actions':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className=\"flex space-x-2 action-buttons\">\n                                                                            <div className=\"status-buttons\">\n                                                                                {renderStatusButtons(task)}\n                                                                            </div>\n                                                                            {hasPermission('tasks', 'write', 'table') && (\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={() => {\n                                                                                            setSelectedTask(task);\n                                                                                            setIsEditModalOpen(true);\n                                                                                        }}\n                                                                                        className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                    >\n                                                                                        <PencilIcon className=\"h-4 w-4\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('common.edit')}\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                            {hasPermission('tasks', 'both', 'table') && (\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={() => handleCopyTask(task)}\n                                                                                        className=\"p-1.5 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300\"\n                                                                                    >\n                                                                                        <DocumentDuplicateIcon className=\"h-4 w-4\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('tasks.actions.copy')}\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                            {hasPermission('tasks', 'delete', 'table') && (\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={() => handleDeleteTask(task.id)}\n                                                                                        className=\"p-1.5 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300\"\n                                                                                    >\n                                                                                        <TrashIcon className=\"h-4 w-4\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('common.delete')}\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            default:\n                                                                return null;\n                                                        }\n                                                    })}\n                                                    </tr>\n                                                );\n                                            })}\n                                            </>\n                                        )}\n                                    </tbody>\n                                </table>\n                            </div>\n                            ) : activeTab === 'todos' ? (\n                                /* Card-Ansicht - Tasks - ohne Box-Schattierung, Cards auf voller Breite */\n                                <div className=\"-mx-3 sm:-mx-4 md:-mx-6\">\n                                    {/*  PERFORMANCE: Skeleton-Loading fr LCP-Element (sofort sichtbar, auch ohne Daten) */}\n                                    {loading && tasks.length === 0 ? (\n                                        <CardGrid>\n                                            {Array(3).fill(null).map((_, i) => (\n                                                <div key={`skeleton-${i}`} className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-3 sm:p-4 md:p-5 lg:p-6 shadow-sm\">\n                                                    <div className=\"space-y-4\">\n                                                        {/* LCP-Element: Titel-Skeleton */}\n                                                        <div className=\"flex items-center gap-2 mb-2\">\n                                                            <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-12\"></div>\n                                                            <div className=\"h-6 bg-gray-200 dark:bg-gray-700 rounded flex-1 min-w-0\"></div>\n                                                        </div>\n                                                        {/* Status-Skeleton */}\n                                                        <div className=\"h-6 bg-gray-200 dark:bg-gray-700 rounded w-24\"></div>\n                                                        {/* Metadaten-Skeleton */}\n                                                        <div className=\"space-y-2\">\n                                                            <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4\"></div>\n                                                            <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2\"></div>\n                                                            <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-5/6\"></div>\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                            ))}\n                                        </CardGrid>\n                                    ) : error ? (\n                                        <div className=\"flex justify-center py-12 text-red-600 dark:text-red-400\">\n                                            {error}\n                                        </div>\n                                    ) : filteredAndSortedTasks.length === 0 ? (\n                                        <div className=\"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400\">\n                                            <ClipboardDocumentListIcon className=\"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500\" />\n                                            <div className=\"text-sm\">Keine To Do's gefunden</div>\n                                        </div>\n                                    ) : (\n                                        <CardGrid>\n                                            {filteredAndSortedTasks.slice(0, displayLimit).map(task => {\n                                                const expiryStatus = getExpiryStatus(task.dueDate, 'todo', undefined, task.title, task.description);\n                                                \n                                                // Metadaten basierend auf sichtbaren Einstellungen - strukturiert nach Position\n                                                const metadata: MetadataItem[] = [];\n                                                \n                                                // Links: Niederlassung\n                                                if (visibleCardMetadata.has('branch')) {\n                                                    metadata.push({\n                                                        icon: <BuildingOfficeIcon className=\"h-4 w-4\" />,\n                                                        label: t('tasks.columns.branch'),\n                                                        value: task.branch.name,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                \n                                                // Haupt-Metadaten: Verantwortlicher & Qualittskontrolle\n                                                if (visibleCardMetadata.has('responsible')) {\n                                                    // Benutzernamen auf 4 Zeichen krzen\n                                                    const responsibleValue = task.responsible ? `${task.responsible.firstName} ${task.responsible.lastName}` : (task.role ? task.role.name : '-');\n                                                    const shortenedName = responsibleValue.length > 4 && responsibleValue !== '-' ? responsibleValue.substring(0, 4) : responsibleValue;\n                                                    metadata.push({\n                                                        icon: <UserIcon className=\"h-4 w-4\" />,\n                                                        label: t('tasks.columns.responsible'),\n                                                        value: shortenedName,\n                                                        section: 'main'\n                                                    });\n                                                }\n                                                if (visibleCardMetadata.has('qualityControl')) {\n                                                    // Benutzernamen auf 4 Zeichen krzen\n                                                    const qualityControlValue = task.qualityControl ? `${task.qualityControl.firstName} ${task.qualityControl.lastName}` : '-';\n                                                    const shortenedName = qualityControlValue.length > 4 && qualityControlValue !== '-' ? qualityControlValue.substring(0, 4) : qualityControlValue;\n                                                    metadata.push({\n                                                        icon: <UserIcon className=\"h-4 w-4\" />,\n                                                        label: t('tasks.columns.qualityControl'),\n                                                        value: shortenedName,\n                                                        section: 'main-second'\n                                                    });\n                                                }\n                                                \n                                                // Rechts: Flligkeit (erste Zeile rechts, neben Status)\n                                                if (visibleCardMetadata.has('dueDate')) {\n                                                    const dueDateItem = createDueDateMetadataItem(\n                                                        task.dueDate,\n                                                        'todo',\n                                                        task.title,\n                                                        task.description,\n                                                        <CalendarIcon className=\"h-4 w-4\" />,\n                                                        t('tasks.columns.dueDate'),\n                                                        (date) => format(date, 'dd.MM.yyyy', { locale: de }),\n                                                        false // Keine Badge-Art, nur Text\n                                                    );\n                                                    metadata.push({\n                                                        ...dueDateItem,\n                                                        section: 'right-inline' // Neue Section fr inline rechts (neben Status)\n                                                    });\n                                                }\n                                                \n                                                // Full-Width: Beschreibung\n                                                if (visibleCardMetadata.has('description') && task.description) {\n                                                    metadata.push({\n                                                        label: t('tasks.columns.description'),\n                                                        value: '',\n                                                        descriptionContent: task.description,\n                                                        attachmentMetadata: task.attachments || [], // Attachment-Metadaten fr Vorschau\n                                                        section: 'full'\n                                                    });\n                                                }\n                                                \n                                                // Action-Buttons\n                                                const actionButtons = (\n                                                    <div className=\"flex items-center space-x-2\">\n                                                        {/* Status-Buttons */}\n                                                        <div className=\"status-buttons\">\n                                                            {renderStatusButtons(task)}\n                                                        </div>\n                                                        {hasPermission('tasks', 'write', 'table') && (\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    setSelectedTask(task);\n                                                                    setIsEditModalOpen(true);\n                                                                }}\n                                                                                    className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                >\n                                                                <PencilIcon className=\"h-4 w-4\" />\n                                                            </button>\n                                                        )}\n                                                        {hasPermission('tasks', 'both', 'table') && (\n                                                            <div className=\"relative group\">\n                                                                <button\n                                                                    onClick={(e) => {\n                                                                        e.stopPropagation();\n                                                                        handleCopyTask(task);\n                                                                    }}\n                                                                    className=\"p-1.5 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300\"\n                                                                >\n                                                                    <DocumentDuplicateIcon className=\"h-4 w-4\" />\n                                                                </button>\n                                                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                    {t('tasks.actions.copy')}\n                                                                </div>\n                                                            </div>\n                                                        )}\n                                                    </div>\n                                                );\n                                                \n                                                return (\n                                                    <DataCard\n                                                        key={task.id}\n                                                        title={\n                                                          <span>\n                                                            <span className=\"text-xs text-gray-600 dark:text-gray-400\">{task.id}:</span>{' '}\n                                                            <span>{task.title}</span>\n                                                          </span>\n                                                        }\n                                                        status={{\n                                                            label: getStatusText(task.status, 'task', t),\n                                                            color: getStatusColor(task.status, 'task'),\n                                                            onPreviousClick: undefined,\n                                                            onNextClick: undefined\n                                                        }}\n                                                        metadata={metadata}\n                                                        actions={actionButtons}\n                                                    />\n                                                );\n                                            })}\n                                        </CardGrid>\n                                    )}\n                                </div>\n                            ) : null}\n                            \n                            {/* \"Mehr anzeigen\" Button - Mobil - Tasks */}\n                            {activeTab === 'todos' && filteredAndSortedTasks.length > displayLimit && (\n                                <div className=\"mt-4 flex justify-center\">\n                                    <button\n                                        className=\"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-700 border border-blue-300 dark:border-gray-600 rounded-md hover:bg-blue-50 dark:hover:bg-gray-600\"\n                                        onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                                    >\n                                        {t('common.showMore')} ({filteredAndSortedTasks.length - displayLimit} {t('common.remaining')})\n                                    </button>\n                                </div>\n                            )}\n                            \n                            {/* Reservations Rendering - Cards */}\n                            {activeTab === 'reservations' && viewMode === 'cards' && (\n                                <div className=\"-mx-3 sm:-mx-4 md:-mx-6\">\n                                    {reservationsLoading ? (\n                                        <div className=\"flex justify-center py-12\">\n                                            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100\"></div>\n                                        </div>\n                                    ) : reservationsError ? (\n                                        <div className=\"flex justify-center py-12 text-red-600 dark:text-red-400\">\n                                            {reservationsError}\n                                        </div>\n                                    ) : filteredAndSortedReservations.length === 0 ? (\n                                        <div className=\"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400\">\n                                            <CalendarIcon className=\"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500\" />\n                                            <div className=\"text-sm\">\n                                                {reservationSearchTerm || reservationFilterStatus !== 'all' || reservationFilterPaymentStatus !== 'all'\n                                                    ? t('reservations.noResults', 'Keine Reservations gefunden')\n                                                    : t('reservations.noReservations', 'Keine Reservations vorhanden')}\n                                            </div>\n                                        </div>\n                                    ) : (\n                                        <CardGrid>\n                                            {filteredAndSortedReservations.slice(0, displayLimit).map(reservation => {\n                                                const formatDate = (dateString: string) => {\n                                                    try {\n                                                        // Extrahiere nur den Datumsteil (YYYY-MM-DD) und parse als lokales Datum\n                                                        // Dies verhindert Zeitzone-Konvertierung, die zu einem Tag-Versatz fhrt\n                                                        const date = new Date(dateString);\n                                                        // Verwende UTC-Methoden, um nur den Datumsteil zu extrahieren (ohne Zeitzone)\n                                                        const year = date.getUTCFullYear();\n                                                        const month = date.getUTCMonth();\n                                                        const day = date.getUTCDate();\n                                                        // Erstelle lokales Datum aus den UTC-Werten\n                                                        const localDate = new Date(year, month, day);\n                                                        return format(localDate, 'dd.MM.yyyy', { locale: de });\n                                                    } catch {\n                                                        return dateString;\n                                                    }\n                                                };\n                                                \n                                                // Metadaten fr Reservation-Card\n                                                const metadata: MetadataItem[] = [];\n                                                \n                                                // Haupt-Metadaten: Check-in/Check-out (rechts oben, unverndert)\n                                                metadata.push({\n                                                    icon: <CalendarIcon className=\"h-4 w-4\" />,\n                                                    label: t('reservations.checkInOut', 'Check-in/Check-out'),\n                                                    value: `${formatDate(reservation.checkInDate)} - ${formatDate(reservation.checkOutDate)}`,\n                                                    section: 'main'\n                                                });\n                                                \n                                                // Zweite Zeile: Zimmernummer\n                                                if (reservation.roomNumber) {\n                                                    metadata.push({\n                                                        icon: <HomeIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.roomNumber,\n                                                        section: 'main-second'\n                                                    });\n                                                }\n                                                \n                                                // Links: Telefon/Email unter Titel (gleiche Zeile wie Status)\n                                                if (reservation.guestEmail) {\n                                                    metadata.push({\n                                                        icon: <EnvelopeIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.guestEmail,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                if (reservation.guestPhone) {\n                                                    metadata.push({\n                                                        icon: <PhoneIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.guestPhone,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                \n                                                // Links: Branch (nach Telefon/Email)\n                                                if (reservation.branch) {\n                                                    metadata.push({\n                                                        icon: <BuildingOfficeIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.branch.name,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                \n                                                // Mitte: Zahlungslink (gleiche Hhe wie Payment Status)\n                                                if (reservation.paymentLink) {\n                                                    metadata.push({\n                                                        icon: <LinkIcon className=\"h-4 w-4\" />,\n                                                        value: (\n                                                            <a \n                                                                href={reservation.paymentLink} \n                                                                target=\"_blank\" \n                                                                rel=\"noopener noreferrer\"\n                                                                onClick={(e) => e.stopPropagation()}\n                                                                className=\"text-gray-900 dark:text-white break-all\"\n                                                            >\n                                                                {t('reservations.paymentLink', 'Zahlungslink')}\n                                                            </a>\n                                                        ),\n                                                        section: 'center'\n                                                    });\n                                                }\n                                                \n                                                // Mitte: Check-in Link (direkt unter Zahlungslink)\n                                                // WICHTIG: Verwende lobbyReservationId (LobbyPMS booking_id) als codigo, nicht die interne ID\n                                                const codigo = reservation.lobbyReservationId || reservation.id.toString();\n                                                const checkInLink = reservation.guestEmail \n                                                    ? `https://app.lobbypms.com/checkinonline/confirmar?codigo=${codigo}&email=${encodeURIComponent(reservation.guestEmail)}&lg=GB`\n                                                    : null;\n                                                if (checkInLink) {\n                                                    metadata.push({\n                                                    icon: <LinkIcon className=\"h-4 w-4\" />,\n                                                    value: (\n                                                        <div className=\"relative group\">\n                                                            <a \n                                                                href={checkInLink} \n                                                                target=\"_blank\" \n                                                                rel=\"noopener noreferrer\"\n                                                                onClick={(e) => e.stopPropagation()}\n                                                                className=\"text-gray-900 dark:text-white\"\n                                                            >\n                                                                {t('reservations.checkInLink', 'Check-in Link')}\n                                                            </a>\n                                                            <div className=\"absolute bottom-full mb-2 left-1/2 transform -translate-x-1/2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                {checkInLink}\n                                                            </div>\n                                                        </div>\n                                                    ),\n                                                    section: 'center'\n                                                    });\n                                                }\n                                                \n                                                // Rechts: Reservation Status als erstes Badge (mit Label)\n                                                metadata.push({\n                                                    label: t('reservations.status', 'Status'),\n                                                    value: (\n                                                        <span className={`px-2 py-1 rounded text-xs font-medium ${getReservationStatusColor(reservation.status)}`}>\n                                                            {t(`reservations.status.${reservation.status}`, reservation.status)}\n                                                        </span>\n                                                    ),\n                                                    section: 'right'\n                                                });\n                                                \n                                                // Rechts: Payment Status als zweites Badge (direkt unter Reservation Status)\n                                                metadata.push({\n                                                    label: t('reservations.paymentStatus', 'Zahlungsstatus'),\n                                                    value: (\n                                                        <span className={`px-2 py-1 rounded text-xs font-medium ${getPaymentStatusColor(reservation.paymentStatus)}`}>\n                                                            {t(`reservations.paymentStatus.${reservation.paymentStatus}`, reservation.paymentStatus)}\n                                                        </span>\n                                                    ),\n                                                    section: 'right'\n                                                });\n                                                \n                                                // Betrag und Whrung (wenn vorhanden)\n                                                if (reservation.amount) {\n                                                    const amountValue = typeof reservation.amount === 'string' \n                                                        ? parseFloat(reservation.amount).toFixed(2)\n                                                        : typeof reservation.amount === 'number'\n                                                        ? reservation.amount.toFixed(2)\n                                                        : '0.00';\n                                                    metadata.push({\n                                                        icon: <CurrencyDollarIcon className=\"h-4 w-4\" />,\n                                                        label: t('reservations.amount', 'Betrag'),\n                                                        value: `${amountValue} ${reservation.currency || 'COP'}`,\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Ankunftszeit (wenn vorhanden)\n                                                if (reservation.arrivalTime) {\n                                                    const formatDateTime = (dateString: string) => {\n                                                        try {\n                                                            return format(new Date(dateString), 'dd.MM.yyyy HH:mm', { locale: de });\n                                                        } catch {\n                                                            return dateString;\n                                                        }\n                                                    };\n                                                    metadata.push({\n                                                        icon: <ClockIcon className=\"h-4 w-4\" />,\n                                                        label: t('reservations.arrivalTime', 'Ankunftszeit'),\n                                                        value: formatDateTime(reservation.arrivalTime),\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Tr-PIN (wenn vorhanden)\n                                                if (reservation.doorPin) {\n                                                    metadata.push({\n                                                        icon: <KeyIcon className=\"h-4 w-4\" />,\n                                                        label: reservation.doorAppName || t('reservations.doorPin', 'Tr-PIN'),\n                                                        value: reservation.doorPin,\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Online Check-in Status\n                                                if (reservation.onlineCheckInCompleted) {\n                                                    metadata.push({\n                                                        icon: <CheckCircleIcon className=\"h-4 w-4 text-green-600\" />,\n                                                        label: t('reservations.onlineCheckIn', 'Online Check-in'),\n                                                        value: t('reservations.completed', 'Abgeschlossen'),\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Action-Button fr PIN-Generierung und Mitteilungsversand\n                                                const hasWritePermission = hasPermission('reservations', 'write', 'table');\n                                                // Debug: Log fr Berechtigungsprfung (nur fr erste Reservation) - IMMER loggen\n                                                if (reservation.id === filteredAndSortedReservations[0]?.id) {\n                                                    console.log('[Reservations] Berechtigungsprfung:', {\n                                                        hasWritePermission,\n                                                        reservationId: reservation.id,\n                                                        entity: 'reservations',\n                                                        accessLevel: 'write',\n                                                        entityType: 'table',\n                                                        actionButtonsWillBeCreated: hasWritePermission\n                                                    });\n                                                }\n                                                const actionButtons = hasWritePermission ? (\n                                                    <div className=\"flex items-center space-x-2\">\n                                                        {/* Einladung senden Button */}\n                                                        <div className=\"relative group\">\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    setSelectedReservationForInvitation(reservation);\n                                                                    setIsSendInvitationSidepaneOpen(true);\n                                                                }}\n                                                                className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                            >\n                                                                <PaperAirplaneIcon className=\"h-4 w-4\" />\n                                                            </button>\n                                                            <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                {t('reservations.sendInvitation.title')}\n                                                            </div>\n                                                        </div>\n                                                        \n                                                        {/* Key-Button fr PIN-Generierung */}\n                                                        <div className=\"relative group\">\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    setSelectedReservationForPasscode(reservation);\n                                                                    setIsSendPasscodeSidepaneOpen(true);\n                                                                }}\n                                                                className=\"p-1.5 text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-300\"\n                                                            >\n                                                                <KeyIcon className=\"h-4 w-4\" />\n                                                            </button>\n                                                            <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                {t('reservations.sendPasscode.title')}\n                                                            </div>\n                                                        </div>\n                                                    </div>\n                                                ) : null;\n                                                \n                                                // Expandable Content fr Details - zeigt alle Notification-Logs\n                                                const isExpanded = expandedReservationRows.has(reservation.id);\n                                                const expandableContent = (\n                                                    <div className=\"mt-2 pt-3\">\n                                                        <ReservationNotificationLogs reservationId={reservation.id} />\n                                                    </div>\n                                                );\n                                                \n                                                return (\n                                                    <DataCard\n                                                        key={reservation.id}\n                                                        title={reservation.guestName}\n                                                        subtitle={reservation.lobbyReservationId ? `ID: ${reservation.lobbyReservationId}` : undefined}\n                                                        metadata={metadata}\n                                                        actions={actionButtons}\n                                                        expandable={expandableContent ? {\n                                                            isExpanded: isExpanded,\n                                                            content: expandableContent,\n                                                            onToggle: () => toggleReservationExpanded(reservation.id)\n                                                        } : undefined}\n                                                    />\n                                                );\n                                            })}\n                                        </CardGrid>\n                                    )}\n                                </div>\n                            )}\n                            \n                            {/* Reservations Rendering - Tabelle (optional, analog zu Tasks) */}\n                            {activeTab === 'reservations' && viewMode === 'table' && (\n                                <div className=\"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6\">\n                                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                                        <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                                            <tr>\n                                                {visibleColumnIds.map((columnId) => {\n                                                    const column = availableReservationColumns.find(col => col.id === columnId);\n                                                    if (!column) return null;\n                                                    \n                                                    return (\n                                                        <th\n                                                            key={columnId}\n                                                            scope=\"col\"\n                                                            className={`px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider ${columnId === dragOverColumn ? 'bg-blue-100 dark:bg-blue-800' : ''}`}\n                                                            draggable={true}\n                                                            onDragStart={() => handleDragStart(columnId)}\n                                                            onDragOver={(e) => handleDragOver(e, columnId)}\n                                                            onDrop={(e) => handleDrop(e, columnId)}\n                                                            onDragEnd={handleDragEnd}\n                                                        >\n                                                            <div className=\"flex items-center\">\n                                                                {window.innerWidth <= 640 ? column.shortLabel : column.label}\n                                                                {columnId !== 'actions' && (\n                                                                    <button \n                                                                        onClick={() => handleReservationSort(columnId as ReservationSortConfig['key'])}\n                                                                        className=\"ml-1 focus:outline-none\"\n                                                                    >\n                                                                        <ArrowsUpDownIcon className=\"h-4 w-4 text-gray-400 dark:text-gray-500\" />\n                                                                    </button>\n                                                                )}\n                                                            </div>\n                                                        </th>\n                                                    );\n                                                })}\n                                            </tr>\n                                        </thead>\n                                        <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                                            {reservationsLoading ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-4 text-center\">\n                                                        <div className=\"flex justify-center\">\n                                                            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100\"></div>\n                                                        </div>\n                                                    </td>\n                                                </tr>\n                                            ) : reservationsError ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-6 py-4 text-center text-red-600 dark:text-red-400\">\n                                                        {reservationsError}\n                                                    </td>\n                                                </tr>\n                                            ) : filteredAndSortedReservations.length === 0 ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-6 py-4 text-center text-gray-500 dark:text-gray-400\">\n                                                        <div className=\"flex flex-col items-center justify-center gap-4\">\n                                                            <CalendarIcon className=\"h-10 w-10 text-gray-400 dark:text-gray-500\" />\n                                                            <div className=\"text-sm\">\n                                                                {reservationSearchTerm || reservationFilterStatus !== 'all' || reservationFilterPaymentStatus !== 'all'\n                                                                    ? t('reservations.noResults', 'Keine Reservations gefunden')\n                                                                    : t('reservations.noReservations', 'Keine Reservations vorhanden')}\n                                                            </div>\n                                                        </div>\n                                                    </td>\n                                                </tr>\n                                            ) : (\n                                                <>\n                                                    {filteredAndSortedReservations.slice(0, displayLimit).map(reservation => {\n                                                        const formatDate = (dateString: string) => {\n                                                            try {\n                                                                return format(new Date(dateString), 'dd.MM.yyyy', { locale: de });\n                                                            } catch {\n                                                                return dateString;\n                                                            }\n                                                        };\n                                                        \n                                                        return (\n                                                            <tr \n                                                                key={reservation.id} \n                                                                className=\"hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer\"\n                                                                onClick={() => navigate(`/reservations/${reservation.id}`)}\n                                                            >\n                                                                {visibleColumnIds.map(columnId => {\n                                                                    switch (columnId) {\n                                                                        case 'guestName':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200 break-words\">\n                                                                                        {reservation.guestName}\n                                                                                        {reservation.lobbyReservationId && (\n                                                                                            <div className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                                                                                ID: {reservation.lobbyReservationId}\n                                                                                            </div>\n                                                                                        )}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'status':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getReservationStatusColor(reservation.status)}`}>\n                                                                                        {t(`reservations.status.${reservation.status}`, reservation.status)}\n                                                                                    </span>\n                                                                                </td>\n                                                                            );\n                                                                        case 'paymentStatus':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getPaymentStatusColor(reservation.paymentStatus)}`}>\n                                                                                        {t(`reservations.paymentStatus.${reservation.paymentStatus}`, reservation.paymentStatus)}\n                                                                                    </span>\n                                                                                </td>\n                                                                            );\n                                                                        case 'checkInDate':\n                                                                        case 'checkOutDate':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {formatDate(columnId === 'checkInDate' ? reservation.checkInDate : reservation.checkOutDate)}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'roomNumber':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {reservation.roomNumber || '-'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'branch':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {reservation.branch?.name || '-'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'guestEmail':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {reservation.guestEmail || '-'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'guestPhone':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {reservation.guestPhone || '-'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'amount':\n                                                                            const amountValue = typeof reservation.amount === 'string' \n                                                                                ? parseFloat(reservation.amount).toFixed(2)\n                                                                                : typeof reservation.amount === 'number'\n                                                                                ? reservation.amount.toFixed(2)\n                                                                                : '0.00';\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {amountValue} {reservation.currency || 'COP'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'arrivalTime':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {reservation.arrivalTime ? format(new Date(reservation.arrivalTime), 'dd.MM.yyyy HH:mm', { locale: de }) : '-'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'actions':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"flex space-x-2 action-buttons\">\n                                                                                        {hasPermission('reservations', 'write', 'table') && (\n                                                                                            <>\n                                                                                                {/* Einladung senden Button */}\n                                                                                                <div className=\"relative group\">\n                                                                                                    <button\n                                                                                                        onClick={(e) => {\n                                                                                                            e.stopPropagation();\n                                                                                                            setSelectedReservationForInvitation(reservation);\n                                                                                                            setIsSendInvitationSidepaneOpen(true);\n                                                                                                        }}\n                                                                                                        className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                                    >\n                                                                                                        <PaperAirplaneIcon className=\"h-4 w-4\" />\n                                                                                                    </button>\n                                                                                                    <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                                        {t('reservations.sendInvitation.title')}\n                                                                                                    </div>\n                                                                                                </div>\n                                                                                                \n                                                                                                {/* Key-Button fr PIN-Generierung */}\n                                                                                                <div className=\"relative group\">\n                                                                                                    <button\n                                                                                                        onClick={(e) => {\n                                                                                                            e.stopPropagation();\n                                                                                                            setSelectedReservationForPasscode(reservation);\n                                                                                                            setIsSendPasscodeSidepaneOpen(true);\n                                                                                                        }}\n                                                                                                        className=\"p-1.5 text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-300\"\n                                                                                                    >\n                                                                                                        <KeyIcon className=\"h-4 w-4\" />\n                                                                                                    </button>\n                                                                                                    <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                                        {t('reservations.sendPasscode.title')}\n                                                                                                    </div>\n                                                                                                </div>\n                                                                                                \n                                                                                                {/* Details Button */}\n                                                                                                <div className=\"relative group\">\n                                                                                                    <button\n                                                                                                        onClick={(e) => {\n                                                                                                            e.stopPropagation();\n                                                                                                            navigate(`/reservations/${reservation.id}`);\n                                                                                                        }}\n                                                                                                        className=\"p-1.5 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                                                    >\n                                                                                                        <InformationCircleIcon className=\"h-4 w-4\" />\n                                                                                                    </button>\n                                                                                                    <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                                        {t('common.viewDetails')}\n                                                                                                    </div>\n                                                                                                </div>\n                                                                                            </>\n                                                                                        )}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        default:\n                                                                            return null;\n                                                                    }\n                                                                })}\n                                                            </tr>\n                                                        );\n                                                    })}\n                                                </>\n                                            )}\n                                        </tbody>\n                                    </table>\n                                </div>\n                            )}\n                            \n                            {/* \"Mehr anzeigen\" Button - Reservations */}\n                            {activeTab === 'reservations' && filteredAndSortedReservations.length > displayLimit && (\n                                <div className=\"mt-4 flex justify-center\">\n                                    <button\n                                        className=\"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-700 border border-blue-300 dark:border-gray-600 rounded-md hover:bg-blue-50 dark:hover:bg-gray-600\"\n                                        onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                                    >\n                                        {t('common.showMore')} ({filteredAndSortedReservations.length - displayLimit} {t('common.remaining')})\n                                    </button>\n                                </div>\n                            )}\n                        </div>\n                        \n                        {/* Zeiterfassung - auf Mobilgerten fixiert ber dem Footermen */}\n                        <div className=\"fixed bottom-13 left-0 right-0 w-full bg-white dark:bg-gray-800 z-9 shadow-lg border-t-0 dark:border-t dark:border-gray-700\">\n                            <WorktimeTracker />\n                        </div>\n                    </div>\n\n                    {/* Auf greren Gerten bleibt die ursprngliche Reihenfolge - Zeiterfassung oben, Tasks unten */}\n                    <div className=\"hidden sm:block\">\n                        {/* Zeiterfassung */}\n                        <div className=\"mb-8\">\n                            <WorktimeTracker />\n                        </div>\n                        \n                        {/* Tasks - vollstndiger Inhalt fr Desktop-Ansicht */}\n                        <div className=\"dashboard-tasks-wrapper bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 w-full mb-20\">\n                            <div className=\"flex items-center mb-4 justify-between px-3 sm:px-4 md:px-6\">\n                                {/* Linke Seite: \"Neuer Task/Reservation\"-Button */}\n                                <div className=\"flex items-center\">\n                                    {activeTab === 'todos' && hasPermission('tasks', 'write', 'table') && (\n                                        <div className=\"relative group\">\n                                            <button\n                                                onClick={() => setIsCreateModalOpen(true)}\n                                                className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                                                style={{ width: '30.19px', height: '30.19px' }}\n                                                aria-label={t('tasks.createTask')}\n                                                data-onboarding=\"create-task-button\"\n                                            >\n                                                <PlusIcon className=\"h-4 w-4\" />\n                                            </button>\n                                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                {t('tasks.createTask')}\n                                            </div>\n                                        </div>\n                                    )}\n                                    {activeTab === 'reservations' && hasPermission('reservations', 'write', 'table') && (\n                                        <div className=\"relative group\">\n                                            <button\n                                                onClick={() => setIsCreateReservationModalOpen(true)}\n                                                className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                                                style={{ width: '30.19px', height: '30.19px' }}\n                                                aria-label={t('reservations.createReservation.button', 'Neue Reservierung')}\n                                            >\n                                                <PlusIcon className=\"h-4 w-4\" />\n                                            </button>\n                                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                {t('reservations.createReservation.button', 'Neue Reservierung')}\n                                            </div>\n                                        </div>\n                                    )}\n                                    {activeTab === 'tours' && hasPermission('tour_create', 'write', 'button') && (\n                                        <div className=\"relative group\">\n                                            <button\n                                                onClick={() => setIsCreateTourModalOpen(true)}\n                                                className=\"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center\"\n                                                style={{ width: '30.19px', height: '30.19px' }}\n                                                aria-label={t('tours.create', 'Neue Tour erstellen')}\n                                            >\n                                                <PlusIcon className=\"h-4 w-4\" />\n                                            </button>\n                                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                {t('tours.create', 'Neue Tour erstellen')}\n                                            </div>\n                                        </div>\n                                    )}\n                                </div>\n                                \n                                {/* Mitte: Tab-Navigation */}\n                                <div className=\"flex items-center\">\n                                    <nav className=\"-mb-px flex space-x-4 sm:space-x-8 overflow-x-auto overflow-y-hidden\">\n                                        <button\n                                            onClick={() => setActiveTab('todos')}\n                                            className={`py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 flex items-center gap-1.5 ${\n                                                activeTab === 'todos'\n                                                    ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                            }`}\n                                        >\n                                            <CheckCircleIcon className=\"h-4 w-4 sm:h-5 sm:w-5\" />\n                                            {t('tasks.title', \"To Do's\")}\n                                        </button>\n                                        {hasPermission('reservations', 'read', 'table') && (\n                                            <button\n                                                onClick={() => setActiveTab('reservations')}\n                                                className={`py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 flex items-center gap-1.5 ${\n                                                    activeTab === 'reservations'\n                                                        ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                                }`}\n                                            >\n                                                <CalendarIcon className=\"h-4 w-4 sm:h-5 sm:w-5\" />\n                                                {t('reservations.title', 'Reservations')}\n                                            </button>\n                                        )}\n                                        {hasPermission('tours', 'read', 'table') && (\n                                            <button\n                                                onClick={() => setActiveTab('tours')}\n                                                className={`py-2 px-1 border-b-2 font-medium text-xs sm:text-sm flex-shrink-0 flex items-center gap-1.5 ${\n                                                    activeTab === 'tours'\n                                                        ? 'border-blue-500 text-blue-600 dark:text-blue-400'\n                                                        : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'\n                                                }`}\n                                            >\n                                                <MapIcon className=\"h-4 w-4 sm:h-5 sm:w-5\" />\n                                                {t('tours.title', 'Touren')}\n                                            </button>\n                                        )}\n                                    </nav>\n                                </div>\n                                \n                                {/* Rechte Seite: Suchfeld, Sync-Button (nur Reservations), Filter-Button, Status-Filter, Spalten-Konfiguration */}\n                                <div className=\"flex items-center gap-1.5\">\n                                    <input\n                                        type=\"text\"\n                                        placeholder={t('common.search') + '...'}\n                                        className=\"w-[120px] sm:w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n                                        value={activeTab === 'todos' ? searchTerm : activeTab === 'reservations' ? reservationSearchTerm : tourSearchTerm}\n                                        onChange={(e) => {\n                                            if (activeTab === 'todos') {\n                                                setSearchTerm(e.target.value);\n                                            } else if (activeTab === 'reservations') {\n                                                setReservationSearchTerm(e.target.value);\n                                            } else {\n                                                setTourSearchTerm(e.target.value);\n                                            }\n                                        }}\n                                    />\n                                    \n                                    {/* Sync-Button fr Reservations */}\n                                    {activeTab === 'reservations' && (\n                                        <div className=\"relative group\">\n                                            <button\n                                                onClick={async () => {\n                                                    try {\n                                                        setSyncingReservations(true);\n                                                        await axiosInstance.post(API_ENDPOINTS.RESERVATIONS.SYNC);\n                                                        showMessage(t('reservations.syncSuccess', 'Reservations erfolgreich synchronisiert'), 'success');\n                                                        await loadReservations();\n                                                    } catch (err: any) {\n                                                        console.error('Fehler beim Synchronisieren:', err);\n                                                        showMessage(\n                                                            err.response?.data?.message || t('reservations.syncError', 'Fehler beim Synchronisieren'),\n                                                            'error'\n                                                        );\n                                                    } finally {\n                                                        setSyncingReservations(false);\n                                                    }\n                                                }}\n                                                disabled={syncingReservations}\n                                                className=\"p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed\"\n                                            >\n                                                <ArrowPathIcon className={`h-5 w-5 ${syncingReservations ? 'animate-spin' : ''}`} />\n                                            </button>\n                                            <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                {syncingReservations ? t('reservations.syncing', 'Synchronisiere...') : t('reservations.sync', 'Synchronisieren')}\n                                            </div>\n                                        </div>\n                                    )}\n                                    \n                                    {/* View-Mode Toggle */}\n                                    <div className=\"relative group\">\n                                        <button\n                                            className={`p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 ${\n                                                viewMode === 'cards' ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : ''\n                                            }`}\n                                            onClick={() => updateViewMode(viewMode === 'table' ? 'cards' : 'table')}\n                                        >\n                                            {viewMode === 'table' ? (\n                                                <Squares2X2Icon className=\"h-5 w-5\" />\n                                            ) : (\n                                                <TableCellsIcon className=\"h-5 w-5\" />\n                                            )}\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {viewMode === 'table' ? t('common.viewAsCards') : t('common.viewAsTable')}\n                                        </div>\n                                    </div>\n                                    \n                                    {/* Filter-Button */}\n                                    <div className=\"relative group ml-1\">\n                                        <button\n                                            className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'hover:bg-gray-100 dark:hover:bg-gray-700'} relative`}\n                                            onClick={() => setIsFilterModalOpen(!isFilterModalOpen)}\n                                        >\n                                            <FunnelIcon className=\"h-5 w-5\" />\n                                            {getActiveFilterCount() > 0 && (\n                                                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 text-white rounded-full text-xs flex items-center justify-center\">\n                                                    {getActiveFilterCount()}\n                                                </span>\n                                            )}\n                                        </button>\n                                        <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                            {t('common.filter')}\n                                        </div>\n                                    </div>\n                                    \n                                    {/* Spalten-Konfiguration */}\n                                    <div className=\"ml-1\">\n                                        <TableColumnConfig\n                                            columns={activeTab === 'todos'\n                                                ? (viewMode === 'cards'\n                                                    ? [\n                                                        { id: 'title', label: t('tasks.columns.title') },\n                                                        { id: 'status', label: t('tasks.columns.status') },\n                                                        { id: 'responsible', label: t('tasks.columns.responsible') },\n                                                        { id: 'qualityControl', label: t('tasks.columns.qualityControl') },\n                                                        { id: 'branch', label: t('tasks.columns.branch') },\n                                                        { id: 'dueDate', label: t('tasks.columns.dueDate') },\n                                                        { id: 'description', label: t('tasks.columns.description') }\n                                                    ]\n                                                    : availableColumns)\n                                                : activeTab === 'reservations'\n                                                ? (viewMode === 'cards'\n                                                    ? [\n                                                        { id: 'guestName', label: t('reservations.columns.guestName', 'Gast') },\n                                                        { id: 'status', label: t('reservations.columns.status', 'Status') },\n                                                        { id: 'paymentStatus', label: t('reservations.columns.paymentStatus', 'Zahlungsstatus') },\n                                                        { id: 'checkInDate', label: t('reservations.columns.checkInDate', 'Check-in') },\n                                                        { id: 'checkOutDate', label: t('reservations.columns.checkOutDate', 'Check-out') },\n                                                        { id: 'roomNumber', label: t('reservations.columns.roomNumber', 'Zimmer') },\n                                                        { id: 'guestEmail', label: t('reservations.columns.guestEmail', 'E-Mail') },\n                                                        { id: 'guestPhone', label: t('reservations.columns.guestPhone', 'Telefon') },\n                                                        { id: 'amount', label: t('reservations.columns.amount', 'Betrag') },\n                                                        { id: 'arrivalTime', label: t('reservations.columns.arrivalTime', 'Ankunftszeit') }\n                                                    ]\n                                                    : availableReservationColumns)\n                                                : activeTab === 'tours'\n                                                ? (viewMode === 'cards'\n                                                    ? [\n                                                        { id: 'title', label: t('tours.columns.title', 'Titel') },\n                                                        { id: 'type', label: t('tours.columns.type', 'Typ') },\n                                                        { id: 'price', label: t('tours.columns.price', 'Preis') },\n                                                        { id: 'location', label: t('tours.columns.location', 'Ort') },\n                                                        { id: 'duration', label: t('tours.columns.duration', 'Dauer') },\n                                                        { id: 'branch', label: t('tours.columns.branch', 'Niederlassung') },\n                                                        { id: 'createdBy', label: t('tours.columns.createdBy', 'Erstellt von') },\n                                                        { id: 'isActive', label: t('tours.columns.status', 'Status') }\n                                                    ]\n                                                    : availableTourColumns)\n                                                : []}\n                                            visibleColumns={viewMode === 'cards'\n                                                ? Array.from(visibleCardMetadata)\n                                                : visibleColumnIds}\n                                            columnOrder={viewMode === 'cards'\n                                                ? cardMetadataOrder\n                                                : settings.columnOrder}\n                                            onToggleColumnVisibility={(columnId) => {\n                                                if (viewMode === 'cards') {\n                                                    if (activeTab === 'todos') {\n                                                        const tableColumn = cardToTableMapping[columnId];\n                                                        if (tableColumn) {\n                                                            // Spezielle Logik fr responsibleAndQualityControl\n                                                            if (tableColumn === 'responsibleAndQualityControl') {\n                                                                // Prfe ob beide bereits ausgeblendet sind\n                                                                const otherCardMeta = columnId === 'responsible' ? 'qualityControl' : 'responsible';\n                                                                const otherHidden = hiddenCardMetadata.has(otherCardMeta);\n                                                                const currentlyHidden = settings.hiddenColumns.includes(tableColumn);\n                                                                \n                                                                if (currentlyHidden && !otherHidden) {\n                                                                    // Eine der beiden wird wieder angezeigt, also responsibleAndQualityControl wieder anzeigen\n                                                                    toggleColumnVisibility(tableColumn);\n                                                                } else if (!currentlyHidden && otherHidden) {\n                                                                    // Die andere ist bereits ausgeblendet, also responsibleAndQualityControl ausblenden\n                                                                    toggleColumnVisibility(tableColumn);\n                                                                } else if (!currentlyHidden) {\n                                                                    // Erste wird ausgeblendet, responsibleAndQualityControl ausblenden\n                                                                    toggleColumnVisibility(tableColumn);\n                                                                } else {\n                                                                    // Beide sind ausgeblendet, eine wird wieder angezeigt\n                                                                    toggleColumnVisibility(tableColumn);\n                                                                }\n                                                            } else {\n                                                                // Normale Spalte: direkt ein/ausblenden\n                                                                toggleColumnVisibility(tableColumn);\n                                                            }\n                                                        }\n                                                    } else if (activeTab === 'reservations') {\n                                                        // Reservations: 1:1 Mapping\n                                                        const tableColumn = reservationCardToTableMapping[columnId];\n                                                        if (tableColumn) {\n                                                            toggleColumnVisibility(tableColumn);\n                                                        }\n                                                    } else if (activeTab === 'tours') {\n                                                        // Tours: 1:1 Mapping\n                                                        toggleColumnVisibility(columnId);\n                                                    }\n                                                } else {\n                                                    toggleColumnVisibility(columnId);\n                                                }\n                                            }}\n                                            onMoveColumn={viewMode === 'cards'\n                                                ? (dragIndex: number, hoverIndex: number) => {\n                                                    const newCardOrder = [...cardMetadataOrder];\n                                                    const dragged = newCardOrder[dragIndex];\n                                                    newCardOrder.splice(dragIndex, 1);\n                                                    newCardOrder.splice(hoverIndex, 0, dragged);\n                                                    \n                                                    const newTableOrder: string[] = [];\n                                                    const usedTableColumns = new Set<string>();\n                                                    \n                                                    if (activeTab === 'todos') {\n                                                        newCardOrder.forEach(cardMeta => {\n                                                            const tableCol = cardToTableMapping[cardMeta];\n                                                            if (tableCol && !usedTableColumns.has(tableCol)) {\n                                                                usedTableColumns.add(tableCol);\n                                                                newTableOrder.push(tableCol);\n                                                            }\n                                                        });\n                                                        \n                                                        availableColumns.forEach(col => {\n                                                            if (!newTableOrder.includes(col.id) && col.id !== 'actions') {\n                                                                newTableOrder.push(col.id);\n                                                            }\n                                                        });\n                                                    } else if (activeTab === 'reservations') {\n                                                        // Reservations: 1:1 Mapping\n                                                        newCardOrder.forEach(cardMeta => {\n                                                            const tableCol = reservationCardToTableMapping[cardMeta];\n                                                            if (tableCol && !usedTableColumns.has(tableCol)) {\n                                                                usedTableColumns.add(tableCol);\n                                                                newTableOrder.push(tableCol);\n                                                            }\n                                                        });\n                                                        \n                                                        availableReservationColumns.forEach(col => {\n                                                            if (!newTableOrder.includes(col.id) && col.id !== 'actions') {\n                                                                newTableOrder.push(col.id);\n                                                            }\n                                                        });\n                                                    } else if (activeTab === 'tours') {\n                                                        // Tours: 1:1 Mapping\n                                                        newCardOrder.forEach(cardMeta => {\n                                                            if (!usedTableColumns.has(cardMeta)) {\n                                                                usedTableColumns.add(cardMeta);\n                                                                newTableOrder.push(cardMeta);\n                                                            }\n                                                        });\n                                                        \n                                                        availableTourColumns.forEach(col => {\n                                                            if (!newTableOrder.includes(col.id) && col.id !== 'actions') {\n                                                                newTableOrder.push(col.id);\n                                                            }\n                                                        });\n                                                    }\n                                                    \n                                                    updateColumnOrder(newTableOrder);\n                                                }\n                                                : handleMoveColumn}\n                                            buttonTitle={viewMode === 'cards' ? t('tableColumn.sortAndDisplay') : t('tableColumn.configure')}\n                                            modalTitle={viewMode === 'cards' ? t('tableColumn.sortAndDisplay') : t('tableColumn.configure')}\n                                            sortDirections={viewMode === 'cards' && activeTab === 'todos'\n                                                ? taskCardSortDirections\n                                                : viewMode === 'cards' && activeTab === 'reservations' \n                                                ? reservationCardSortDirections \n                                                : viewMode === 'cards' && activeTab === 'tours'\n                                                ? tourCardSortDirections\n                                                : undefined}\n                                            onSortDirectionChange={viewMode === 'cards' && activeTab === 'todos'\n                                                ? handleTaskCardSortDirectionChange\n                                                : viewMode === 'cards' && activeTab === 'reservations'\n                                                ? handleReservationCardSortDirectionChange\n                                                : viewMode === 'cards' && activeTab === 'tours'\n                                                ? handleTourCardSortDirectionChange\n                                                : undefined}\n                                            showSortDirection={viewMode === 'cards' && (activeTab === 'todos' || activeTab === 'reservations' || activeTab === 'tours')}\n                                            onClose={() => {}}\n                                        />\n                                    </div>\n                                </div>\n                            </div>\n\n                            {/* Filter-Pane */}\n                            {isFilterModalOpen && (\n                                <div className={viewMode === 'cards' ? '-mx-3 sm:-mx-4 md:-mx-6 px-3 sm:px-4 md:px-6' : 'px-3 sm:px-4 md:px-6'}>\n                                    {activeTab === 'todos' ? (\n                                        <FilterPane\n                                            columns={[...availableColumns, ...filterOnlyColumns]}\n                                            onApply={applyFilterConditions}\n                                            onReset={resetFilterConditions}\n                                            savedConditions={filterConditions}\n                                            savedOperators={filterLogicalOperators}\n                                            savedSortDirections={filterSortDirections}\n                                            onSortDirectionsChange={setFilterSortDirections}\n                                            tableId={TODOS_TABLE_ID}\n                                        />\n                                    ) : (\n                                        <FilterPane\n                                            columns={[...availableReservationColumns, ...reservationFilterOnlyColumns]}\n                                            onApply={applyReservationFilterConditions}\n                                            onReset={resetReservationFilterConditions}\n                                            savedConditions={reservationFilterConditions}\n                                            savedOperators={reservationFilterLogicalOperators}\n                                            savedSortDirections={reservationFilterSortDirections}\n                                            onSortDirectionsChange={setReservationFilterSortDirections}\n                                            tableId={RESERVATIONS_TABLE_ID}\n                                        />\n                                    )}\n                                </div>\n                            )}\n\n                            {/* Gespeicherte Filter als Tags anzeigen */}\n                            <SavedFilterTags\n                                tableId={activeTab === 'todos' ? TODOS_TABLE_ID : activeTab === 'reservations' ? RESERVATIONS_TABLE_ID : TOURS_TABLE_ID}\n                                onSelectFilter={activeTab === 'todos' ? applyFilterConditions : activeTab === 'reservations' ? applyReservationFilterConditions : applyTourFilterConditions}\n                                onReset={activeTab === 'todos' ? resetFilterConditions : activeTab === 'reservations' ? resetReservationFilterConditions : resetTourFilterConditions}\n                                activeFilterName={activeTab === 'todos' ? activeFilterName : activeTab === 'reservations' ? reservationActiveFilterName : tourActiveFilterName}\n                                selectedFilterId={activeTab === 'todos' ? selectedFilterId : activeTab === 'reservations' ? reservationSelectedFilterId : tourSelectedFilterId}\n                                onFilterChange={activeTab === 'todos' ? handleFilterChange : activeTab === 'reservations' ? handleReservationFilterChange : handleTourFilterChange}\n                                defaultFilterName={activeTab === 'todos' ? t('tasks.filters.current') : activeTab === 'reservations' ? t('reservations.filters.current', 'Aktuell') : t('tours.filters.current', 'Aktuell')}\n                            />\n\n                            {/* Tabelle oder Cards */}\n                            {activeTab === 'todos' && viewMode === 'table' ? (\n                                /* Tabellen-Ansicht - Tasks */\n                                <div className=\"overflow-x-auto\">\n                                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\" data-onboarding=\"task-list\">\n                                        <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                                            <tr>\n                                                {visibleColumnIds.map((columnId) => {\n                                                    const column = availableColumns.find(col => col.id === columnId);\n                                                    if (!column) return null;\n\n                                                    return (\n                                                        <th \n                                                            key={columnId}\n                                                            scope=\"col\"\n                                                            className={`px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider ${columnId === dragOverColumn ? 'bg-blue-100 dark:bg-blue-800' : ''}`}\n                                                            draggable={true}\n                                                            onDragStart={() => handleDragStart(columnId)}\n                                                            onDragOver={(e) => handleDragOver(e, columnId)}\n                                                            onDrop={(e) => handleDrop(e, columnId)}\n                                                            onDragEnd={handleDragEnd}\n                                                        >\n                                                            <div className=\"flex items-center\">\n                                                                {window.innerWidth <= 640 ? column.shortLabel : column.label}\n                                                                {columnId !== 'actions' && (\n                                                                    <button \n                                                                        onClick={() => handleSort(columnId as keyof Task)}\n                                                                        className=\"ml-1 focus:outline-none\"\n                                                                    >\n                                                                        <ArrowsUpDownIcon className=\"h-4 w-4 text-gray-400 dark:text-gray-500\" />\n                                                                    </button>\n                                                                )}\n                                                            </div>\n                                                        </th>\n                                                    );\n                                                })}\n                                            </tr>\n                                        </thead>\n                                        <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                                            {loading ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-4 text-center\">\n                                                        <div className=\"flex justify-center\">\n                                                            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100\"></div>\n                                                        </div>\n                                                    </td>\n                                                </tr>\n                                            ) : error ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-6 py-4 text-center text-red-600 dark:text-red-400\">\n                                                        {error}\n                                                    </td>\n                                                </tr>\n                                            ) : filteredAndSortedTasks.length === 0 ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-6 py-4 text-center text-gray-500 dark:text-gray-400\">\n                                                        <div className=\"flex flex-col items-center justify-center gap-4\">\n                                                        <ClipboardDocumentListIcon className=\"h-10 w-10 text-gray-400 dark:text-gray-500\" />\n                                                        <div className=\"text-sm\">{t('tasks.noTasksFound')}</div>\n                                                    </div>\n                                                </td>\n                                            </tr>\n                                        ) : (\n                                            <>\n                                            {filteredAndSortedTasks.slice(0, displayLimit).map(task => {\n                                            const expiryStatus = getExpiryStatus(task.dueDate, 'todo', undefined, task.title, task.description);\n                                            const expiryColors = getExpiryColorClasses(expiryStatus);\n                                            \n                                            return (\n                                                <tr \n                                                    key={task.id} \n                                                    className={`hover:bg-gray-50 dark:hover:bg-gray-700 ${\n                                                        expiryStatus !== 'none' ? `${expiryColors.bgClass} ${expiryColors.borderClass} border-l-4` : ''\n                                                    }`}\n                                                >\n                                                    {visibleColumnIds.map(columnId => {\n                                                    switch (columnId) {\n                                                        case 'title':\n                                                            return (\n                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4\">\n                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200 break-words flex items-center\">\n                                                                        {task.title}\n                                                                            {task.description && (\n                                                                                <div className=\"ml-2 relative group\">\n                                                                                    <button \n                                                                                        className=\"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300\"\n                                                                                    >\n                                                                                        <InformationCircleIcon className=\"h-5 w-5\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('tasks.showDescription')}\n                                                                                    </div>\n                                                                                    <div className=\"absolute left-0 mt-2 p-2 bg-white dark:bg-gray-800 text-gray-800 dark:text-gray-200 shadow-lg rounded-md border border-gray-200 dark:border-gray-700 w-144 max-h-96 overflow-y-auto min-w-[36rem] z-10 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none\">\n                                                                                        <MarkdownPreview content={task.description} showImagePreview={true} />\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            case 'status':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusColor(task.status, 'task')} dark:bg-opacity-30 status-col`}>\n                                                                            {task.status}\n                                                                        </span>\n                                                                    </td>\n                                                                );\n                                                            case 'responsibleAndQualityControl':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className=\"flex flex-col\">\n                                                                            <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 hidden sm:inline\">{t('tasks.columns.responsible')}:</span>\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 inline sm:hidden\">{t('tasks.columns.responsible').substring(0, 3)}:</span><br />\n                                                                                {task.responsible ? `${task.responsible.firstName} ${task.responsible.lastName}` : task.role ? task.role.name : '-'}\n                                                                            </div>\n                                                                            <div className=\"text-sm text-gray-900 dark:text-gray-200 mt-1\">\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 hidden sm:inline\">{t('tasks.qualityControlLabel')}</span>\n                                                                                <span className=\"text-xs text-gray-500 dark:text-gray-400 inline sm:hidden\">{t('tasks.columns.qualityControl').substring(0, 2)}:</span><br />\n                                                                                {task.qualityControl ? `${task.qualityControl.firstName} ${task.qualityControl.lastName}` : '-'}\n                                                                            </div>\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            case 'branch':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className=\"text-sm text-gray-900 dark:text-gray-200\">{task.branch.name}</div>\n                                                                    </td>\n                                                                );\n                                                            case 'dueDate':\n                                                                const expiryStatusForDate2 = getExpiryStatus(task.dueDate, 'todo', undefined, task.title, task.description);\n                                                                const expiryColorsForDate2 = getExpiryColorClasses(expiryStatusForDate2);\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className={`text-sm ${expiryStatusForDate2 !== 'none' ? expiryColorsForDate2.textClass : 'text-gray-900 dark:text-gray-200'}`}>\n                                                                            {task.dueDate ? new Date(task.dueDate).toLocaleDateString() : '-'}\n                                                                            {expiryStatusForDate2 !== 'none' && (\n                                                                                <span className=\"ml-2 text-xs\"></span>\n                                                                            )}\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            case 'actions':\n                                                                return (\n                                                                    <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                        <div className=\"flex space-x-2 action-buttons\">\n                                                                            <div className=\"status-buttons\">\n                                                                                {renderStatusButtons(task)}\n                                                                            </div>\n                                                                            {hasPermission('tasks', 'write', 'table') && (\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={() => {\n                                                                                            setSelectedTask(task);\n                                                                                            setIsEditModalOpen(true);\n                                                                                        }}\n                                                                                        className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                    >\n                                                                                        <PencilIcon className=\"h-4 w-4\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('common.edit')}\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                            {hasPermission('tasks', 'both', 'table') && (\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={() => handleCopyTask(task)}\n                                                                                        className=\"p-1.5 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300\"\n                                                                                    >\n                                                                                        <DocumentDuplicateIcon className=\"h-4 w-4\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('tasks.actions.copy')}\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                            {hasPermission('tasks', 'delete', 'table') && (\n                                                                                <div className=\"relative group\">\n                                                                                    <button\n                                                                                        onClick={() => handleDeleteTask(task.id)}\n                                                                                        className=\"p-1.5 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300\"\n                                                                                    >\n                                                                                        <TrashIcon className=\"h-4 w-4\" />\n                                                                                    </button>\n                                                                                    <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                        {t('common.delete')}\n                                                                                    </div>\n                                                                                </div>\n                                                                            )}\n                                                                        </div>\n                                                                    </td>\n                                                                );\n                                                            default:\n                                                                return null;\n                                                        }\n                                                    })}\n                                                    </tr>\n                                                );\n                                            })}\n                                            </>\n                                        )}\n                                    </tbody>\n                                </table>\n                            </div>\n                            ) : activeTab === 'todos' ? (\n                                /* Card-Ansicht - Tasks - ohne Box-Schattierung, Cards auf voller Breite */\n                                <div className=\"-mx-3 sm:-mx-4 md:-mx-6\">\n                                    {/*  PERFORMANCE: Skeleton-Loading fr LCP-Element (sofort sichtbar, auch ohne Daten) */}\n                                    {loading && tasks.length === 0 ? (\n                                        <CardGrid>\n                                            {Array(3).fill(null).map((_, i) => (\n                                                <div key={`skeleton-${i}`} className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-3 sm:p-4 md:p-5 lg:p-6 shadow-sm\">\n                                                    <div className=\"space-y-4\">\n                                                        {/* LCP-Element: Titel-Skeleton */}\n                                                        <div className=\"flex items-center gap-2 mb-2\">\n                                                            <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-12\"></div>\n                                                            <div className=\"h-6 bg-gray-200 dark:bg-gray-700 rounded flex-1 min-w-0\"></div>\n                                                        </div>\n                                                        {/* Status-Skeleton */}\n                                                        <div className=\"h-6 bg-gray-200 dark:bg-gray-700 rounded w-24\"></div>\n                                                        {/* Metadaten-Skeleton */}\n                                                        <div className=\"space-y-2\">\n                                                            <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4\"></div>\n                                                            <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/2\"></div>\n                                                            <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-5/6\"></div>\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                            ))}\n                                        </CardGrid>\n                                    ) : error ? (\n                                        <div className=\"flex justify-center py-12 text-red-600 dark:text-red-400\">\n                                            {error}\n                                        </div>\n                                    ) : filteredAndSortedTasks.length === 0 ? (\n                                        <div className=\"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400\">\n                                            <ClipboardDocumentListIcon className=\"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500\" />\n                                            <div className=\"text-sm\">Keine To Do's gefunden</div>\n                                        </div>\n                                    ) : (\n                                        <CardGrid>\n                                            {filteredAndSortedTasks.slice(0, displayLimit).map(task => {\n                                                const expiryStatus = getExpiryStatus(task.dueDate, 'todo', undefined, task.title, task.description);\n                                                \n                                                // Metadaten basierend auf sichtbaren Einstellungen - strukturiert nach Position\n                                                const metadata: MetadataItem[] = [];\n                                                \n                                                // Links: Niederlassung\n                                                if (visibleCardMetadata.has('branch')) {\n                                                    metadata.push({\n                                                        icon: <BuildingOfficeIcon className=\"h-4 w-4\" />,\n                                                        label: t('tasks.columns.branch'),\n                                                        value: task.branch.name,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                \n                                                // Haupt-Metadaten: Verantwortlicher & Qualittskontrolle\n                                                if (visibleCardMetadata.has('responsible')) {\n                                                    // Benutzernamen auf 4 Zeichen krzen\n                                                    const responsibleValue = task.responsible ? `${task.responsible.firstName} ${task.responsible.lastName}` : (task.role ? task.role.name : '-');\n                                                    const shortenedName = responsibleValue.length > 4 && responsibleValue !== '-' ? responsibleValue.substring(0, 4) : responsibleValue;\n                                                    metadata.push({\n                                                        icon: <UserIcon className=\"h-4 w-4\" />,\n                                                        label: t('tasks.columns.responsible'),\n                                                        value: shortenedName,\n                                                        section: 'main'\n                                                    });\n                                                }\n                                                if (visibleCardMetadata.has('qualityControl')) {\n                                                    // Benutzernamen auf 4 Zeichen krzen\n                                                    const qualityControlValue = task.qualityControl ? `${task.qualityControl.firstName} ${task.qualityControl.lastName}` : '-';\n                                                    const shortenedName = qualityControlValue.length > 4 && qualityControlValue !== '-' ? qualityControlValue.substring(0, 4) : qualityControlValue;\n                                                    metadata.push({\n                                                        icon: <UserIcon className=\"h-4 w-4\" />,\n                                                        label: t('tasks.columns.qualityControl'),\n                                                        value: shortenedName,\n                                                        section: 'main-second'\n                                                    });\n                                                }\n                                                \n                                                // Rechts: Flligkeit (erste Zeile rechts, neben Status)\n                                                if (visibleCardMetadata.has('dueDate')) {\n                                                    const dueDateItem = createDueDateMetadataItem(\n                                                        task.dueDate,\n                                                        'todo',\n                                                        task.title,\n                                                        task.description,\n                                                        <CalendarIcon className=\"h-4 w-4\" />,\n                                                        t('tasks.columns.dueDate'),\n                                                        (date) => format(date, 'dd.MM.yyyy', { locale: de }),\n                                                        false // Keine Badge-Art, nur Text\n                                                    );\n                                                    metadata.push({\n                                                        ...dueDateItem,\n                                                        section: 'right-inline' // Neue Section fr inline rechts (neben Status)\n                                                    });\n                                                }\n                                                \n                                                // Full-Width: Beschreibung\n                                                if (visibleCardMetadata.has('description') && task.description) {\n                                                    metadata.push({\n                                                        label: t('tasks.columns.description'),\n                                                        value: '',\n                                                        descriptionContent: task.description,\n                                                        attachmentMetadata: task.attachments || [], // Attachment-Metadaten fr Vorschau\n                                                        section: 'full'\n                                                    });\n                                                }\n                                                \n                                                // Action-Buttons\n                                                const actionButtons = (\n                                                    <div className=\"flex items-center space-x-2\">\n                                                        {/* Status-Buttons */}\n                                                        <div className=\"status-buttons\">\n                                                            {renderStatusButtons(task)}\n                                                        </div>\n                                                        {hasPermission('tasks', 'write', 'table') && (\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    setSelectedTask(task);\n                                                                    setIsEditModalOpen(true);\n                                                                }}\n                                                                                    className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                >\n                                                                <PencilIcon className=\"h-4 w-4\" />\n                                                            </button>\n                                                        )}\n                                                        {hasPermission('tasks', 'both', 'table') && (\n                                                            <div className=\"relative group\">\n                                                                <button\n                                                                    onClick={(e) => {\n                                                                        e.stopPropagation();\n                                                                        handleCopyTask(task);\n                                                                    }}\n                                                                    className=\"p-1.5 text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-300\"\n                                                                >\n                                                                    <DocumentDuplicateIcon className=\"h-4 w-4\" />\n                                                                </button>\n                                                                <div className=\"absolute left-full ml-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                    {t('tasks.actions.copy')}\n                                                                </div>\n                                                            </div>\n                                                        )}\n                                                    </div>\n                                                );\n                                                \n                                                return (\n                                                    <DataCard\n                                                        key={task.id}\n                                                        title={\n                                                          <span>\n                                                            <span className=\"text-xs text-gray-600 dark:text-gray-400\">{task.id}:</span>{' '}\n                                                            <span>{task.title}</span>\n                                                          </span>\n                                                        }\n                                                        status={{\n                                                            label: getStatusText(task.status, 'task', t),\n                                                            color: getStatusColor(task.status, 'task'),\n                                                            onPreviousClick: undefined,\n                                                            onNextClick: undefined\n                                                        }}\n                                                        metadata={metadata}\n                                                        actions={actionButtons}\n                                                    />\n                                                );\n                                            })}\n                                        </CardGrid>\n                                    )}\n                                </div>\n                            ) : null}\n                            \n                            {/* \"Mehr anzeigen\" Button - Desktop - Tasks */}\n                            {activeTab === 'todos' && filteredAndSortedTasks.length > displayLimit && (\n                                <div className=\"mt-4 flex justify-center\">\n                                    <button\n                                        className=\"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-700 border border-blue-300 dark:border-gray-600 rounded-md hover:bg-blue-50 dark:hover:bg-gray-600\"\n                                        onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                                    >\n                                        {t('common.showMore')} ({filteredAndSortedTasks.length - displayLimit} {t('common.remaining')})\n                                    </button>\n                                </div>\n                            )}\n                            \n                            {/* Reservations Rendering - Desktop - Cards */}\n                            {activeTab === 'reservations' && viewMode === 'cards' && (\n                                <div className=\"-mx-3 sm:-mx-4 md:-mx-6\">\n                                    {reservationsLoading ? (\n                                        <div className=\"flex justify-center py-12\">\n                                            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100\"></div>\n                                        </div>\n                                    ) : reservationsError ? (\n                                        <div className=\"flex justify-center py-12 text-red-600 dark:text-red-400\">\n                                            {reservationsError}\n                                        </div>\n                                    ) : filteredAndSortedReservations.length === 0 ? (\n                                        <div className=\"flex flex-col items-center justify-center py-12 text-gray-500 dark:text-gray-400\">\n                                            <CalendarIcon className=\"h-10 w-10 mb-4 text-gray-400 dark:text-gray-500\" />\n                                            <div className=\"text-sm\">\n                                                {reservationSearchTerm || reservationFilterStatus !== 'all' || reservationFilterPaymentStatus !== 'all'\n                                                    ? t('reservations.noResults', 'Keine Reservations gefunden')\n                                                    : t('reservations.noReservations', 'Keine Reservations vorhanden')}\n                                            </div>\n                                        </div>\n                                    ) : (\n                                        <CardGrid>\n                                            {filteredAndSortedReservations.slice(0, displayLimit).map(reservation => {\n                                                const formatDate = (dateString: string) => {\n                                                    try {\n                                                        // Extrahiere nur den Datumsteil (YYYY-MM-DD) und parse als lokales Datum\n                                                        // Dies verhindert Zeitzone-Konvertierung, die zu einem Tag-Versatz fhrt\n                                                        const date = new Date(dateString);\n                                                        // Verwende UTC-Methoden, um nur den Datumsteil zu extrahieren (ohne Zeitzone)\n                                                        const year = date.getUTCFullYear();\n                                                        const month = date.getUTCMonth();\n                                                        const day = date.getUTCDate();\n                                                        // Erstelle lokales Datum aus den UTC-Werten\n                                                        const localDate = new Date(year, month, day);\n                                                        return format(localDate, 'dd.MM.yyyy', { locale: de });\n                                                    } catch {\n                                                        return dateString;\n                                                    }\n                                                };\n                                                \n                                                // Metadaten fr Reservation-Card\n                                                const metadata: MetadataItem[] = [];\n                                                \n                                                // Haupt-Metadaten: Check-in/Check-out (rechts oben, unverndert)\n                                                metadata.push({\n                                                    icon: <CalendarIcon className=\"h-4 w-4\" />,\n                                                    label: t('reservations.checkInOut', 'Check-in/Check-out'),\n                                                    value: `${formatDate(reservation.checkInDate)} - ${formatDate(reservation.checkOutDate)}`,\n                                                    section: 'main'\n                                                });\n                                                \n                                                // Zweite Zeile: Zimmernummer\n                                                if (reservation.roomNumber) {\n                                                    metadata.push({\n                                                        icon: <HomeIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.roomNumber,\n                                                        section: 'main-second'\n                                                    });\n                                                }\n                                                \n                                                // Links: Telefon/Email unter Titel (gleiche Zeile wie Status)\n                                                if (reservation.guestEmail) {\n                                                    metadata.push({\n                                                        icon: <EnvelopeIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.guestEmail,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                if (reservation.guestPhone) {\n                                                    metadata.push({\n                                                        icon: <PhoneIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.guestPhone,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                \n                                                // Links: Branch (nach Telefon/Email)\n                                                if (reservation.branch) {\n                                                    metadata.push({\n                                                        icon: <BuildingOfficeIcon className=\"h-4 w-4\" />,\n                                                        value: reservation.branch.name,\n                                                        section: 'left'\n                                                    });\n                                                }\n                                                \n                                                // Mitte: Zahlungslink (gleiche Hhe wie Payment Status)\n                                                if (reservation.paymentLink) {\n                                                    metadata.push({\n                                                        icon: <LinkIcon className=\"h-4 w-4\" />,\n                                                        value: (\n                                                            <a \n                                                                href={reservation.paymentLink} \n                                                                target=\"_blank\" \n                                                                rel=\"noopener noreferrer\"\n                                                                onClick={(e) => e.stopPropagation()}\n                                                                className=\"text-gray-900 dark:text-white break-all\"\n                                                            >\n                                                                {t('reservations.paymentLink', 'Zahlungslink')}\n                                                            </a>\n                                                        ),\n                                                        section: 'center'\n                                                    });\n                                                }\n                                                \n                                                // Mitte: Check-in Link (direkt unter Zahlungslink)\n                                                // WICHTIG: Verwende lobbyReservationId (LobbyPMS booking_id) als codigo, nicht die interne ID\n                                                const codigo = reservation.lobbyReservationId || reservation.id.toString();\n                                                const checkInLink = reservation.guestEmail \n                                                    ? `https://app.lobbypms.com/checkinonline/confirmar?codigo=${codigo}&email=${encodeURIComponent(reservation.guestEmail)}&lg=GB`\n                                                    : null;\n                                                if (checkInLink) {\n                                                    metadata.push({\n                                                    icon: <LinkIcon className=\"h-4 w-4\" />,\n                                                    value: (\n                                                        <div className=\"relative group\">\n                                                            <a \n                                                                href={checkInLink} \n                                                                target=\"_blank\" \n                                                                rel=\"noopener noreferrer\"\n                                                                onClick={(e) => e.stopPropagation()}\n                                                                className=\"text-gray-900 dark:text-white\"\n                                                            >\n                                                                {t('reservations.checkInLink', 'Check-in Link')}\n                                                            </a>\n                                                            <div className=\"absolute bottom-full mb-2 left-1/2 transform -translate-x-1/2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                {checkInLink}\n                                                            </div>\n                                                        </div>\n                                                    ),\n                                                    section: 'center'\n                                                    });\n                                                }\n                                                \n                                                // Rechts: Reservation Status als erstes Badge (mit Label)\n                                                metadata.push({\n                                                    label: t('reservations.status', 'Status'),\n                                                    value: (\n                                                        <span className={`px-2 py-1 rounded text-xs font-medium ${getReservationStatusColor(reservation.status)}`}>\n                                                            {t(`reservations.status.${reservation.status}`, reservation.status)}\n                                                        </span>\n                                                    ),\n                                                    section: 'right'\n                                                });\n                                                \n                                                // Rechts: Payment Status als zweites Badge (direkt unter Reservation Status)\n                                                metadata.push({\n                                                    label: t('reservations.paymentStatus', 'Zahlungsstatus'),\n                                                    value: (\n                                                        <span className={`px-2 py-1 rounded text-xs font-medium ${getPaymentStatusColor(reservation.paymentStatus)}`}>\n                                                            {t(`reservations.paymentStatus.${reservation.paymentStatus}`, reservation.paymentStatus)}\n                                                        </span>\n                                                    ),\n                                                    section: 'right'\n                                                });\n                                                \n                                                // Betrag und Whrung (wenn vorhanden)\n                                                if (reservation.amount) {\n                                                    const amountValue = typeof reservation.amount === 'string' \n                                                        ? parseFloat(reservation.amount).toFixed(2)\n                                                        : typeof reservation.amount === 'number'\n                                                        ? reservation.amount.toFixed(2)\n                                                        : '0.00';\n                                                    metadata.push({\n                                                        icon: <CurrencyDollarIcon className=\"h-4 w-4\" />,\n                                                        label: t('reservations.amount', 'Betrag'),\n                                                        value: `${amountValue} ${reservation.currency || 'COP'}`,\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Ankunftszeit (wenn vorhanden)\n                                                if (reservation.arrivalTime) {\n                                                    const formatDateTime = (dateString: string) => {\n                                                        try {\n                                                            return format(new Date(dateString), 'dd.MM.yyyy HH:mm', { locale: de });\n                                                        } catch {\n                                                            return dateString;\n                                                        }\n                                                    };\n                                                    metadata.push({\n                                                        icon: <ClockIcon className=\"h-4 w-4\" />,\n                                                        label: t('reservations.arrivalTime', 'Ankunftszeit'),\n                                                        value: formatDateTime(reservation.arrivalTime),\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Tr-PIN (wenn vorhanden)\n                                                if (reservation.doorPin) {\n                                                    metadata.push({\n                                                        icon: <KeyIcon className=\"h-4 w-4\" />,\n                                                        label: reservation.doorAppName || t('reservations.doorPin', 'Tr-PIN'),\n                                                        value: reservation.doorPin,\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Online Check-in Status\n                                                if (reservation.onlineCheckInCompleted) {\n                                                    metadata.push({\n                                                        icon: <CheckCircleIcon className=\"h-4 w-4 text-green-600\" />,\n                                                        label: t('reservations.onlineCheckIn', 'Online Check-in'),\n                                                        value: t('reservations.completed', 'Abgeschlossen'),\n                                                        section: 'right'\n                                                    });\n                                                }\n                                                \n                                                // Action-Buttons fr Einladung senden und PIN-Generierung\n                                                const hasWritePermission = hasPermission('reservations', 'write', 'table');\n                                                const actionButtons = hasWritePermission ? (\n                                                    <div className=\"flex items-center space-x-2\">\n                                                        {/* Einladung senden Button */}\n                                                        <div className=\"relative group\">\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    setSelectedReservationForInvitation(reservation);\n                                                                    setIsSendInvitationSidepaneOpen(true);\n                                                                }}\n                                                                className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                            >\n                                                                <PaperAirplaneIcon className=\"h-4 w-4\" />\n                                                            </button>\n                                                            <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                {t('reservations.sendInvitation.title')}\n                                                            </div>\n                                                        </div>\n                                                        \n                                                        {/* Key-Button fr PIN-Generierung */}\n                                                        <div className=\"relative group\">\n                                                            <button\n                                                                onClick={(e) => {\n                                                                    e.stopPropagation();\n                                                                    setSelectedReservationForPasscode(reservation);\n                                                                    setIsSendPasscodeSidepaneOpen(true);\n                                                                }}\n                                                                className=\"p-1.5 text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-300\"\n                                                            >\n                                                                <KeyIcon className=\"h-4 w-4\" />\n                                                            </button>\n                                                            <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                {t('reservations.sendPasscode.title')}\n                                                            </div>\n                                                        </div>\n                                                    </div>\n                                                ) : null;\n                                                \n                                                // Expandable Content fr Details - zeigt alle Notification-Logs\n                                                const isExpanded = expandedReservationRows.has(reservation.id);\n                                                const expandableContent = (\n                                                    <div className=\"mt-2 pt-3\">\n                                                        <ReservationNotificationLogs reservationId={reservation.id} />\n                                                    </div>\n                                                );\n                                                \n                                                return (\n                                                    <DataCard\n                                                        key={reservation.id}\n                                                        title={reservation.guestName}\n                                                        subtitle={reservation.lobbyReservationId ? `ID: ${reservation.lobbyReservationId}` : undefined}\n                                                        metadata={metadata}\n                                                        actions={actionButtons}\n                                                        expandable={expandableContent ? {\n                                                            isExpanded: isExpanded,\n                                                            content: expandableContent,\n                                                            onToggle: () => toggleReservationExpanded(reservation.id)\n                                                        } : undefined}\n                                                    />\n                                                );\n                                            })}\n                                        </CardGrid>\n                                    )}\n                                </div>\n                            )}\n                            \n                            {/* Reservations Rendering - Desktop - Tabelle */}\n                            {activeTab === 'reservations' && viewMode === 'table' && (\n                                <div className=\"overflow-x-auto\">\n                                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                                        <thead className=\"bg-gray-50 dark:bg-gray-700\">\n                                            <tr>\n                                                {visibleColumnIds.map((columnId) => {\n                                                    const column = availableReservationColumns.find(col => col.id === columnId);\n                                                    if (!column) return null;\n                                                    \n                                                    return (\n                                                        <th\n                                                            key={columnId}\n                                                            scope=\"col\"\n                                                            className={`px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider ${columnId === dragOverColumn ? 'bg-blue-100 dark:bg-blue-800' : ''}`}\n                                                            draggable={true}\n                                                            onDragStart={() => handleDragStart(columnId)}\n                                                            onDragOver={(e) => handleDragOver(e, columnId)}\n                                                            onDrop={(e) => handleDrop(e, columnId)}\n                                                            onDragEnd={handleDragEnd}\n                                                        >\n                                                            <div className=\"flex items-center\">\n                                                                {window.innerWidth <= 640 ? column.shortLabel : column.label}\n                                                                {columnId !== 'actions' && (\n                                                                    <button \n                                                                        onClick={() => handleReservationSort(columnId as ReservationSortConfig['key'])}\n                                                                        className=\"ml-1 focus:outline-none\"\n                                                                    >\n                                                                        <ArrowsUpDownIcon className=\"h-4 w-4 text-gray-400 dark:text-gray-500\" />\n                                                                    </button>\n                                                                )}\n                                                            </div>\n                                                        </th>\n                                                    );\n                                                })}\n                                            </tr>\n                                        </thead>\n                                        <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                                            {reservationsLoading ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-4 text-center\">\n                                                        <div className=\"flex justify-center\">\n                                                            <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900 dark:border-gray-100\"></div>\n                                                        </div>\n                                                    </td>\n                                                </tr>\n                                            ) : reservationsError ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-6 py-4 text-center text-red-600 dark:text-red-400\">\n                                                        {reservationsError}\n                                                    </td>\n                                                </tr>\n                                            ) : filteredAndSortedReservations.length === 0 ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-6 py-4 text-center text-gray-500 dark:text-gray-400\">\n                                                        <div className=\"flex flex-col items-center justify-center gap-4\">\n                                                            <CalendarIcon className=\"h-10 w-10 text-gray-400 dark:text-gray-500\" />\n                                                            <div className=\"text-sm\">\n                                                                {reservationSearchTerm || reservationFilterStatus !== 'all' || reservationFilterPaymentStatus !== 'all'\n                                                                    ? t('reservations.noResults', 'Keine Reservations gefunden')\n                                                                    : t('reservations.noReservations', 'Keine Reservations vorhanden')}\n                                                            </div>\n                                                        </div>\n                                                    </td>\n                                                </tr>\n                                            ) : (\n                                                <>\n                                                    {filteredAndSortedReservations.slice(0, displayLimit).map(reservation => {\n                                                        const formatDate = (dateString: string) => {\n                                                            try {\n                                                                return format(new Date(dateString), 'dd.MM.yyyy', { locale: de });\n                                                            } catch {\n                                                                return dateString;\n                                                            }\n                                                        };\n                                                        \n                                                        return (\n                                                            <tr \n                                                                key={reservation.id} \n                                                                className=\"hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer\"\n                                                                onClick={() => navigate(`/reservations/${reservation.id}`)}\n                                                            >\n                                                                {visibleColumnIds.map(columnId => {\n                                                                    switch (columnId) {\n                                                                        case 'guestName':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200 break-words\">\n                                                                                        {reservation.guestName}\n                                                                                        {reservation.lobbyReservationId && (\n                                                                                            <div className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                                                                                ID: {reservation.lobbyReservationId}\n                                                                                            </div>\n                                                                                        )}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'status':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getReservationStatusColor(reservation.status)}`}>\n                                                                                        {t(`reservations.status.${reservation.status}`, reservation.status)}\n                                                                                    </span>\n                                                                                </td>\n                                                                            );\n                                                                        case 'paymentStatus':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getPaymentStatusColor(reservation.paymentStatus)}`}>\n                                                                                        {t(`reservations.paymentStatus.${reservation.paymentStatus}`, reservation.paymentStatus)}\n                                                                                    </span>\n                                                                                </td>\n                                                                            );\n                                                                        case 'checkInDate':\n                                                                        case 'checkOutDate':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {formatDate(columnId === 'checkInDate' ? reservation.checkInDate : reservation.checkOutDate)}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'roomNumber':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {reservation.roomNumber || '-'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'branch':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {reservation.branch?.name || '-'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'guestEmail':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {reservation.guestEmail || '-'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'guestPhone':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {reservation.guestPhone || '-'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'amount':\n                                                                            const amountValue = typeof reservation.amount === 'string' \n                                                                                ? parseFloat(reservation.amount).toFixed(2)\n                                                                                : typeof reservation.amount === 'number'\n                                                                                ? reservation.amount.toFixed(2)\n                                                                                : '0.00';\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {amountValue} {reservation.currency || 'COP'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'arrivalTime':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                        {reservation.arrivalTime ? format(new Date(reservation.arrivalTime), 'dd.MM.yyyy HH:mm', { locale: de }) : '-'}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        case 'actions':\n                                                                            return (\n                                                                                <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                    <div className=\"flex space-x-2 action-buttons\">\n                                                                                        {hasPermission('reservations', 'write', 'table') && (\n                                                                                            <>\n                                                                                                {/* Einladung senden Button */}\n                                                                                                <div className=\"relative group\">\n                                                                                                    <button\n                                                                                                        onClick={(e) => {\n                                                                                                            e.stopPropagation();\n                                                                                                            setSelectedReservationForInvitation(reservation);\n                                                                                                            setIsSendInvitationSidepaneOpen(true);\n                                                                                                        }}\n                                                                                                        className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                                    >\n                                                                                                        <PaperAirplaneIcon className=\"h-4 w-4\" />\n                                                                                                    </button>\n                                                                                                    <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                                        {t('reservations.sendInvitation.title')}\n                                                                                                    </div>\n                                                                                                </div>\n                                                                                                \n                                                                                                {/* Key-Button fr PIN-Generierung */}\n                                                                                                <div className=\"relative group\">\n                                                                                                    <button\n                                                                                                        onClick={(e) => {\n                                                                                                            e.stopPropagation();\n                                                                                                            setSelectedReservationForPasscode(reservation);\n                                                                                                            setIsSendPasscodeSidepaneOpen(true);\n                                                                                                        }}\n                                                                                                        className=\"p-1.5 text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-300\"\n                                                                                                    >\n                                                                                                        <KeyIcon className=\"h-4 w-4\" />\n                                                                                                    </button>\n                                                                                                    <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                                        {t('reservations.sendPasscode.title')}\n                                                                                                    </div>\n                                                                                                </div>\n                                                                                                \n                                                                                                {/* Details Button */}\n                                                                                                <div className=\"relative group\">\n                                                                                                    <button\n                                                                                                        onClick={(e) => {\n                                                                                                            e.stopPropagation();\n                                                                                                            navigate(`/reservations/${reservation.id}`);\n                                                                                                        }}\n                                                                                                        className=\"p-1.5 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                                                    >\n                                                                                                        <InformationCircleIcon className=\"h-4 w-4\" />\n                                                                                                    </button>\n                                                                                                    <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                                        {t('common.viewDetails')}\n                                                                                                    </div>\n                                                                                                </div>\n                                                                                            </>\n                                                                                        )}\n                                                                                    </div>\n                                                                                </td>\n                                                                            );\n                                                                        default:\n                                                                            return null;\n                                                                    }\n                                                                })}\n                                                            </tr>\n                                                        );\n                                                    })}\n                                                </>\n                                            )}\n                                        </tbody>\n                                    </table>\n                                </div>\n                            )}\n                            \n                            {/* \"Mehr anzeigen\" Button - Desktop - Reservations */}\n                            {activeTab === 'reservations' && filteredAndSortedReservations.length > displayLimit && (\n                                <div className=\"mt-4 flex justify-center\">\n                                    <button\n                                        className=\"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-700 border border-blue-300 dark:border-gray-600 rounded-md hover:bg-blue-50 dark:hover:bg-gray-600\"\n                                        onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                                    >\n                                        {t('common.showMore')} ({filteredAndSortedReservations.length - displayLimit} {t('common.remaining')})\n                                    </button>\n                                </div>\n                            )}\n                            \n                            {/* Tours Tab Content - Table View */}\n                            {activeTab === 'tours' && viewMode === 'table' && (\n                                <div className=\"overflow-x-auto -mx-3 sm:-mx-4 md:-mx-6\">\n                                    <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                                        <thead className=\"bg-gray-50 dark:bg-gray-800\">\n                                            <tr>\n                                                {visibleColumnIds.map(columnId => {\n                                                    const column = availableTourColumns.find(col => col.id === columnId);\n                                                    if (!column) return null;\n                                                    \n                                                    return (\n                                                        <th\n                                                            key={columnId}\n                                                            scope=\"col\"\n                                                            className={`px-3 sm:px-4 md:px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider ${columnId === dragOverColumn ? 'bg-blue-100 dark:bg-blue-800' : ''}`}\n                                                            draggable={true}\n                                                            onDragStart={() => handleDragStart(columnId)}\n                                                            onDragOver={(e) => handleDragOver(e, columnId)}\n                                                            onDrop={(e) => handleDrop(e, columnId)}\n                                                            onDragEnd={handleDragEnd}\n                                                        >\n                                                            <div className=\"flex items-center\">\n                                                                {window.innerWidth <= 640 ? column.shortLabel : column.label}\n                                                                {columnId !== 'actions' && (\n                                                                    <button \n                                                                        onClick={() => handleTourSort(columnId as TourSortConfig['key'])}\n                                                                        className=\"ml-1 focus:outline-none\"\n                                                                    >\n                                                                        <ArrowsUpDownIcon className=\"h-4 w-4 text-gray-400 dark:text-gray-500\" />\n                                                                    </button>\n                                                                )}\n                                                            </div>\n                                                        </th>\n                                                    );\n                                                })}\n                                            </tr>\n                                        </thead>\n                                        <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                                            {toursLoading ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-8 text-center text-gray-500 dark:text-gray-400\">\n                                                        {t('common.loading')}\n                                                    </td>\n                                                </tr>\n                                            ) : toursError ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-8 text-center text-red-500 dark:text-red-400\">\n                                                        {toursError}\n                                                    </td>\n                                                </tr>\n                                            ) : filteredAndSortedTours.length === 0 ? (\n                                                <tr>\n                                                    <td colSpan={visibleColumnIds.length} className=\"px-3 sm:px-4 md:px-6 py-8 text-center text-gray-500 dark:text-gray-400\">\n                                                        {t('tours.noTours')}\n                                                    </td>\n                                                </tr>\n                                            ) : (\n                                                <>\n                                                    {filteredAndSortedTours.slice(0, displayLimit).map(tour => (\n                                                        <tr \n                                                            key={tour.id} \n                                                            className=\"hover:bg-gray-50 dark:hover:bg-gray-700\"\n                                                        >\n                                                            {visibleColumnIds.map(columnId => {\n                                                                switch (columnId) {\n                                                                    case 'title':\n                                                                        return (\n                                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4\">\n                                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200 break-words\">\n                                                                                    {tour.title}\n                                                                                </div>\n                                                                            </td>\n                                                                        );\n                                                                    case 'type':\n                                                                        return (\n                                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                    {tour.type === TourType.OWN ? t('tours.typeOwn') : t('tours.typeExternal')}\n                                                                                </div>\n                                                                            </td>\n                                                                        );\n                                                                    case 'price':\n                                                                        return (\n                                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                    {tour.price ? `${Number(tour.price).toLocaleString()} ${tour.currency || 'COP'}` : '-'}\n                                                                                </div>\n                                                                            </td>\n                                                                        );\n                                                                    case 'location':\n                                                                        return (\n                                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                    {tour.location || '-'}\n                                                                                </div>\n                                                                            </td>\n                                                                        );\n                                                                    case 'duration':\n                                                                        return (\n                                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                    {tour.duration ? `${tour.duration} ${t('common.hours', 'h')}` : '-'}\n                                                                                </div>\n                                                                            </td>\n                                                                        );\n                                                                    case 'branch':\n                                                                        return (\n                                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                    {tour.branch?.name || '-'}\n                                                                                </div>\n                                                                            </td>\n                                                                        );\n                                                                    case 'createdBy':\n                                                                        return (\n                                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                <div className=\"text-sm text-gray-900 dark:text-gray-200\">\n                                                                                    {tour.createdBy ? `${tour.createdBy.firstName} ${tour.createdBy.lastName}` : '-'}\n                                                                                </div>\n                                                                            </td>\n                                                                        );\n                                                                    case 'isActive':\n                                                                        return (\n                                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                <span className={`px-2 py-1 text-xs rounded ${\n                                                                                    tour.isActive \n                                                                                        ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' \n                                                                                        : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200'\n                                                                                }`}>\n                                                                                    {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                                                                </span>\n                                                                            </td>\n                                                                        );\n                                                                    case 'actions':\n                                                                        return (\n                                                                            <td key={columnId} className=\"px-3 sm:px-4 md:px-6 py-4 whitespace-nowrap\">\n                                                                                <div className=\"flex space-x-2 action-buttons\">\n                                                                                    <div className=\"relative group\">\n                                                                                        <button\n                                                                                            onClick={(e) => {\n                                                                                                e.stopPropagation();\n                                                                                                setSelectedTourId(tour.id);\n                                                                                                setIsTourDetailsModalOpen(true);\n                                                                                            }}\n                                                                                            className=\"p-1.5 text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-300\"\n                                                                                        >\n                                                                                            <InformationCircleIcon className=\"h-4 w-4\" />\n                                                                                        </button>\n                                                                                        <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                            {t('common.viewDetails', 'Details anzeigen')}\n                                                                                        </div>\n                                                                                    </div>\n                                                                                    {hasPermission('tour_edit', 'write', 'button') && (\n                                                                                        <div className=\"relative group\">\n                                                                                            <button\n                                                                                                onClick={(e) => {\n                                                                                                    e.stopPropagation();\n                                                                                                    setSelectedTour(tour);\n                                                                                                    setIsEditTourModalOpen(true);\n                                                                                                }}\n                                                                                                className=\"p-1.5 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                                                                                            >\n                                                                                                <PencilIcon className=\"h-4 w-4\" />\n                                                                                            </button>\n                                                                                            <div className=\"absolute right-full mr-2 px-2 py-1 bg-gray-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap pointer-events-none z-50\">\n                                                                                                {t('tours.edit', 'Bearbeiten')}\n                                                                                            </div>\n                                                                                        </div>\n                                                                                    )}\n                                                                                </div>\n                                                                            </td>\n                                                                        );\n                                                                    default:\n                                                                        return null;\n                                                                }\n                                                            })}\n                                                        </tr>\n                                                    ))}\n                                                </>\n                                            )}\n                                        </tbody>\n                                    </table>\n                                </div>\n                            )}\n                            \n                            {/* Tours Tab Content - Card View */}\n                            {activeTab === 'tours' && viewMode === 'cards' && (\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                                    {toursLoading ? (\n                                        <div className=\"col-span-full text-center py-8 text-gray-500 dark:text-gray-400\">\n                                            {t('common.loading')}\n                                        </div>\n                                    ) : toursError ? (\n                                        <div className=\"col-span-full text-center py-8 text-red-500 dark:text-red-400\">\n                                            {toursError}\n                                        </div>\n                                    ) : filteredAndSortedTours.length === 0 ? (\n                                        <div className=\"col-span-full text-center py-8 text-gray-500 dark:text-gray-400\">\n                                            {t('tours.noTours')}\n                                        </div>\n                                    ) : (\n                                        filteredAndSortedTours.slice(0, displayLimit).map((tour) => (\n                                            <div\n                                                key={tour.id}\n                                                className=\"bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 p-4 hover:shadow-md transition-shadow\"\n                                            >\n                                                <div className=\"flex items-start justify-between mb-2\">\n                                                    <h4 className=\"text-lg font-semibold dark:text-white\">{tour.title}</h4>\n                                                    <span className={`px-2 py-1 text-xs rounded ${\n                                                        tour.isActive \n                                                            ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' \n                                                            : 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200'\n                                                    }`}>\n                                                        {tour.isActive ? t('tours.statusActive') : t('tours.statusInactive')}\n                                                    </span>\n                                                </div>\n                                                \n                                                {tour.description && (\n                                                    <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-2 line-clamp-2\">\n                                                        {tour.description}\n                                                    </p>\n                                                )}\n\n                                                <div className=\"flex items-center justify-between mt-4\">\n                                                    <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                                        <span className=\"font-medium\">{t('tours.type')}:</span>{' '}\n                                                        {tour.type === TourType.OWN ? t('tours.typeOwn') : t('tours.typeExternal')}\n                                                    </div>\n                                                    {tour.price && (\n                                                        <div className=\"text-sm font-semibold dark:text-white\">\n                                                            {Number(tour.price).toLocaleString()} {tour.currency || 'COP'}\n                                                        </div>\n                                                    )}\n                                                </div>\n                                                \n                                                {hasPermission('tour_edit', 'write', 'button') && (\n                                                    <div className=\"mt-4 flex justify-end\">\n                                                        <button\n                                                            onClick={() => {\n                                                                setSelectedTour(tour);\n                                                                setIsEditTourModalOpen(true);\n                                                            }}\n                                                            className=\"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 text-sm\"\n                                                        >\n                                                            {t('tours.edit', 'Bearbeiten')}\n                                                        </button>\n                                                    </div>\n                                                )}\n                                            </div>\n                                        ))\n                                    )}\n                                </div>\n                            )}\n                            \n                            {/* \"Mehr anzeigen\" Button - Desktop - Tours */}\n                            {activeTab === 'tours' && filteredAndSortedTours.length > displayLimit && (\n                                <div className=\"mt-4 flex justify-center\">\n                                    <button\n                                        className=\"px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-700 border border-blue-300 dark:border-gray-600 rounded-md hover:bg-blue-50 dark:hover:bg-gray-600\"\n                                        onClick={() => setDisplayLimit(prevLimit => prevLimit + 10)}\n                                    >\n                                        {t('common.showMore')} ({filteredAndSortedTours.length - displayLimit} {t('common.remaining')})\n                                    </button>\n                                </div>\n                            )}\n                            \n                        </div>\n                    </div>\n                </div>\n            </div>\n            \n            {/* Die Modals fr beide Ansichten (mobil und desktop) */}\n            <CreateTaskModal \n                isOpen={isCreateModalOpen}\n                onClose={() => setIsCreateModalOpen(false)}\n                onTaskCreated={(newTask) => {\n                    // Optimistisches Update: Neuen Task zur Liste hinzufgen statt vollstndigem Reload\n                    if (newTask != null) {\n                        setTasks(prevTasks => {\n                            const validTasks = prevTasks.filter(task => task != null);\n                            return [newTask, ...validTasks];\n                        });\n                        setIsEditModalOpen(true);\n                        setSelectedTask(newTask);\n                    }\n                }}\n            />\n            \n            {selectedTask && (\n                <EditTaskModal\n                    isOpen={isEditModalOpen}\n                    onClose={() => {\n                        setIsEditModalOpen(false);\n                        setSelectedTask(null);\n                    }}\n                    onTaskUpdated={(updatedTask) => {\n                        // Optimistisches Update: Task in Liste aktualisieren statt vollstndigem Reload\n                        if (updatedTask != null) {\n                            setTasks(prevTasks => \n                                prevTasks\n                                    .filter(task => task != null)\n                                    .map(task => \n                                        task.id === updatedTask.id ? updatedTask : task\n                                    )\n                            );\n                            setIsEditModalOpen(false);\n                            setSelectedTask(null);\n                            toast.success(t('worktime.messages.taskUpdated'));\n                        }\n                    }}\n                    task={selectedTask}\n                />\n            )}\n            \n            {/* Create Reservation Modal */}\n            <CreateReservationModal\n                isOpen={isCreateReservationModalOpen}\n                onClose={() => setIsCreateReservationModalOpen(false)}\n                onReservationCreated={async (newReservation) => {\n                    // Wechsle zum Reservations-Tab\n                    setActiveTab('reservations');\n                    // Lade Reservations neu, um den aktualisierten Status zu erhalten\n                    await loadReservations();\n                }}\n            />\n            \n            {/* Send Invitation Sidepane */}\n            {selectedReservationForInvitation && (\n                <SendInvitationSidepane\n                    isOpen={isSendInvitationSidepaneOpen}\n                    onClose={() => {\n                        setIsSendInvitationSidepaneOpen(false);\n                        setSelectedReservationForInvitation(null);\n                    }}\n                    reservation={selectedReservationForInvitation}\n                    onSuccess={async () => {\n                        // Lade Reservations neu, um den aktualisierten Status zu erhalten\n                        await loadReservations();\n                    }}\n                />\n            )}\n\n            {/* Send Passcode Sidepane */}\n            {selectedReservationForPasscode && (\n                <SendPasscodeSidepane\n                    isOpen={isSendPasscodeSidepaneOpen}\n                    onClose={() => {\n                        setIsSendPasscodeSidepaneOpen(false);\n                        setSelectedReservationForPasscode(null);\n                    }}\n                    reservation={selectedReservationForPasscode}\n                    onSuccess={async () => {\n                        // Lade Reservations neu, um den aktualisierten Status zu erhalten\n                        await loadReservations();\n                    }}\n                />\n            )}\n            \n            {/* Create Tour Modal */}\n            <CreateTourModal\n                isOpen={isCreateTourModalOpen}\n                onClose={() => setIsCreateTourModalOpen(false)}\n                onTourCreated={async (newTour) => {\n                    setTours(prev => [newTour, ...prev]);\n                    setIsCreateTourModalOpen(false);\n                    await loadTours();\n                }}\n            />\n            \n            {/* Edit Tour Modal */}\n            {selectedTour && (\n                <EditTourModal\n                    isOpen={isEditTourModalOpen}\n                    onClose={() => {\n                        setIsEditTourModalOpen(false);\n                        setSelectedTour(null);\n                    }}\n                    onTourUpdated={async (updatedTour) => {\n                        setTours(prev => prev.map(t => t.id === updatedTour.id ? updatedTour : t));\n                        setIsEditTourModalOpen(false);\n                        setSelectedTour(null);\n                        await loadTours();\n                    }}\n                    tour={selectedTour}\n                />\n            )}\n            \n            {/* Tour Details Modal */}\n            {selectedTourId && (\n                <TourDetailsModal\n                    isOpen={isTourDetailsModalOpen}\n                    onClose={() => {\n                        setIsTourDetailsModalOpen(false);\n                        setSelectedTourId(null);\n                    }}\n                    tourId={selectedTourId}\n                    onTourUpdated={async (updatedTour) => {\n                        setTours(prev => prev.map(t => t.id === updatedTour.id ? updatedTour : t));\n                        await loadTours();\n                    }}\n                />\n            )}\n            \n            {/* Tour Bookings Modal */}\n            {selectedTourId && (\n                <TourBookingsModal\n                    isOpen={isTourBookingsModalOpen}\n                    onClose={() => {\n                        setIsTourBookingsModalOpen(false);\n                        setSelectedTourId(null);\n                    }}\n                    tourId={selectedTourId}\n                />\n            )}\n            \n            {/* Tour Export Dialog */}\n            <TourExportDialog\n                isOpen={isTourExportDialogOpen}\n                onClose={() => setIsTourExportDialogOpen(false)}\n                tourCount={filteredAndSortedTours.length}\n            />\n            \n            {/* Tour Bookings Tab Content */}\n            {activeTab === 'tourBookings' && (\n                <div className=\"space-y-4\">\n                    {tourBookingsLoading ? (\n                        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                            {t('common.loading')}\n                        </div>\n                    ) : tourBookingsError ? (\n                        <div className=\"text-center py-8 text-red-500 dark:text-red-400\">\n                            {tourBookingsError}\n                        </div>\n                    ) : tourBookings.length === 0 ? (\n                        <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\n                            {t('tourBookings.noBookings', 'Keine Buchungen vorhanden')}\n                        </div>\n                    ) : (\n                        <div className=\"overflow-x-auto\">\n                            <table className=\"min-w-full divide-y divide-gray-200 dark:divide-gray-700\">\n                                <thead className=\"bg-gray-50 dark:bg-gray-800\">\n                                    <tr>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                                            {t('tourBookings.tour', 'Tour')}\n                                        </th>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                                            {t('tourBookings.customerName', 'Kunde')}\n                                        </th>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                                            {t('tourBookings.tourDate', 'Tour-Datum')}\n                                        </th>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                                            {t('tourBookings.numberOfParticipants', 'Teilnehmer')}\n                                        </th>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                                            {t('tourBookings.totalPrice', 'Gesamtpreis')}\n                                        </th>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                                            {t('tourBookings.paymentStatus', 'Zahlungsstatus')}\n                                        </th>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                                            {t('tourBookings.status', 'Status')}\n                                        </th>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                                            {t('tourBookings.bookedBy', 'Gebucht von')}\n                                        </th>\n                                        <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider\">\n                                            {t('common.actions', 'Aktionen')}\n                                        </th>\n                                    </tr>\n                                </thead>\n                                <tbody className=\"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700\">\n                                    {tourBookings\n                                        .filter(booking => {\n                                            if (!tourBookingsSearchTerm) return true;\n                                            const search = tourBookingsSearchTerm.toLowerCase();\n                                            return (\n                                                booking.customerName?.toLowerCase().includes(search) ||\n                                                booking.customerEmail?.toLowerCase().includes(search) ||\n                                                booking.tour?.title?.toLowerCase().includes(search) ||\n                                                booking.customerPhone?.includes(search)\n                                            );\n                                        })\n                                        .map((booking) => (\n                                            <tr key={booking.id} className=\"hover:bg-gray-50 dark:hover:bg-gray-700\">\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\n                                                    <div className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                                                        {booking.tour?.title || '-'}\n                                                    </div>\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\n                                                    <div className=\"text-sm text-gray-900 dark:text-white\">\n                                                        {booking.customerName}\n                                                    </div>\n                                                    {booking.customerEmail && (\n                                                        <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                                            {booking.customerEmail}\n                                                        </div>\n                                                    )}\n                                                    {booking.customerPhone && (\n                                                        <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                                            {booking.customerPhone}\n                                                        </div>\n                                                    )}\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\n                                                    <div className=\"text-sm text-gray-900 dark:text-white\">\n                                                        {format(new Date(booking.tourDate), 'dd.MM.yyyy', { locale: de })}\n                                                    </div>\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\n                                                    <div className=\"text-sm text-gray-900 dark:text-white\">\n                                                        {booking.numberOfParticipants}\n                                                    </div>\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\n                                                    <div className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                                                        {Number(booking.totalPrice).toLocaleString()} {booking.currency}\n                                                    </div>\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\n                                                    <span className={`px-2 py-1 text-xs rounded-full ${\n                                                        booking.paymentStatus === 'paid' ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' :\n                                                        booking.paymentStatus === 'partially_paid' ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200' :\n                                                        booking.paymentStatus === 'pending' ? 'bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200' :\n                                                        'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200'\n                                                    }`}>\n                                                        {t(`tourBookings.paymentStatus.${booking.paymentStatus}`, booking.paymentStatus)}\n                                                    </span>\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\n                                                    <span className={`px-2 py-1 text-xs rounded-full ${\n                                                        booking.status === 'confirmed' ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' :\n                                                        booking.status === 'cancelled' ? 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200' :\n                                                        booking.status === 'completed' ? 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200' :\n                                                        'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200'\n                                                    }`}>\n                                                        {t(`tourBookings.status.${booking.status}`, booking.status)}\n                                                    </span>\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap\">\n                                                    {booking.bookedBy ? (\n                                                        <div className=\"text-sm text-gray-900 dark:text-white\">\n                                                            {booking.bookedBy.firstName} {booking.bookedBy.lastName}\n                                                        </div>\n                                                    ) : (\n                                                        <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                                                            -\n                                                        </div>\n                                                    )}\n                                                </td>\n                                                <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\n                                                    <button\n                                                        onClick={() => {\n                                                            setSelectedBookingForLink(booking);\n                                                            setIsTourReservationLinkModalOpen(true);\n                                                        }}\n                                                        className=\"text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-300 mr-3\"\n                                                    >\n                                                        <LinkIcon className=\"h-5 w-5\" />\n                                                    </button>\n                                                </td>\n                                            </tr>\n                                        ))}\n                                </tbody>\n                            </table>\n                        </div>\n                    )}\n                </div>\n            )}\n            \n            {/* Tour Reservation Link Modal */}\n            {selectedBookingForLink && (\n                <TourReservationLinkModal\n                    isOpen={isTourReservationLinkModalOpen}\n                    onClose={() => {\n                        setIsTourReservationLinkModalOpen(false);\n                        setSelectedBookingForLink(null);\n                    }}\n                    booking={selectedBookingForLink}\n                    onLinked={async () => {\n                        await loadTourBookings();\n                    }}\n                />\n            )}\n        </div>\n    );\n};\n\nexport default Worktracker; ","/**\r\n * Reservation Types fr Frontend\r\n */\r\n\r\nexport enum ReservationStatus {\r\n  CONFIRMED = 'confirmed',\r\n  NOTIFICATION_SENT = 'notification_sent',\r\n  CHECKED_IN = 'checked_in',\r\n  CHECKED_OUT = 'checked_out',\r\n  CANCELLED = 'cancelled',\r\n  NO_SHOW = 'no_show'\r\n}\r\n\r\nexport enum PaymentStatus {\r\n  PENDING = 'pending',\r\n  PAID = 'paid',\r\n  PARTIALLY_PAID = 'partially_paid',\r\n  REFUNDED = 'refunded'\r\n}\r\n\r\nexport interface Reservation {\r\n  id: number;\r\n  lobbyReservationId?: string | null;\r\n  guestName: string;\r\n  guestEmail?: string | null;\r\n  guestPhone?: string | null;\r\n  checkInDate: string; // ISO date string\r\n  checkOutDate: string; // ISO date string\r\n  arrivalTime?: string | null; // ISO datetime string\r\n  roomNumber?: string | null;\r\n  roomDescription?: string | null;\r\n  status: ReservationStatus;\r\n  paymentStatus: PaymentStatus;\r\n  amount?: number | string | null; // Betrag der Reservierung\r\n  currency?: string | null; // Whrung (COP, USD, EUR, etc.)\r\n  paymentLink?: string | null;\r\n  doorPin?: string | null;\r\n  doorAppName?: string | null;\r\n  ttlLockId?: string | null;\r\n  ttlLockPassword?: string | null;\r\n  onlineCheckInCompleted: boolean;\r\n  onlineCheckInCompletedAt?: string | null; // ISO datetime string\r\n  sireRegistered: boolean;\r\n  sireRegistrationId?: string | null;\r\n  sireRegisteredAt?: string | null; // ISO datetime string\r\n  sireRegistrationError?: string | null;\r\n  sentMessage?: string | null; // Versendete WhatsApp-Nachricht\r\n  sentMessageAt?: string | null; // ISO datetime string\r\n  guestNationality?: string | null;\r\n  guestPassportNumber?: string | null;\r\n  guestBirthDate?: string | null; // ISO date string\r\n  organizationId: number;\r\n  branchId?: number | null;\r\n  branch?: {\r\n    id: number;\r\n    name: string;\r\n  } | null;\r\n  taskId?: number | null;\r\n  createdAt: string; // ISO datetime string\r\n  updatedAt: string; // ISO datetime string\r\n}\r\n\r\nexport interface ReservationSyncHistory {\r\n  id: number;\r\n  reservationId: number;\r\n  syncType: 'created' | 'updated' | 'status_changed';\r\n  syncData?: any;\r\n  success: boolean;\r\n  errorMessage?: string | null;\r\n  syncedAt: string; // ISO datetime string\r\n}\r\n\r\n","import axiosInstance from '../config/axios.ts';\r\nimport { Reservation } from '../types/reservation.ts';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\n\r\n// WICHTIG: axiosInstance hat bereits baseURL mit /api, daher nur /reservations hier\r\nconst API_BASE = '/reservations';\r\n\r\nexport interface CreateReservationData {\r\n  guestName: string;\r\n  contact: string; // Telefonnummer oder Email\r\n  amount: number;\r\n  currency?: string; // Default: \"COP\"\r\n}\r\n\r\nexport const reservationService = {\r\n  /**\r\n   * Erstellt eine neue Reservierung\r\n   */\r\n  async create(data: CreateReservationData): Promise<Reservation> {\r\n    console.log('[reservationService] POST zu:', API_BASE);\r\n    console.log('[reservationService] Daten:', data);\r\n    const response = await axiosInstance.post(API_BASE, data);\r\n    console.log('[reservationService] Response:', response);\r\n    return response.data.data || response.data;\r\n  },\r\n\r\n  /**\r\n   * Holt eine Reservierung nach ID\r\n   */\r\n  async getById(id: number): Promise<Reservation> {\r\n    const response = await axiosInstance.get(`${API_BASE}/${id}`);\r\n    return response.data.data || response.data;\r\n  },\r\n\r\n  /**\r\n   * Aktualisiert Kontaktinformation (Telefonnummer oder Email)\r\n   */\r\n  async updateGuestContact(id: number, contact: string): Promise<Reservation> {\r\n    const response = await axiosInstance.put(`${API_BASE}/${id}/guest-contact`, {\r\n      contact\r\n    });\r\n    return response.data.data || response.data;\r\n  },\r\n\r\n  /**\r\n   * Generiert PIN-Code und sendet Mitteilung (unabhngig von Zahlungsstatus/Check-in-Status)\r\n   */\r\n  async generatePinAndSend(id: number): Promise<Reservation> {\r\n    const response = await axiosInstance.post(API_ENDPOINTS.RESERVATION.GENERATE_PIN_AND_SEND(id));\r\n    return response.data.data || response.data;\r\n  },\r\n\r\n  /**\r\n   * Sendet Reservation-Einladung manuell (mit optionalen Parametern)\r\n   */\r\n  async sendInvitation(\r\n    id: number,\r\n    options?: {\r\n      guestPhone?: string;\r\n      guestEmail?: string;\r\n      customMessage?: string;\r\n      amount?: number;\r\n      currency?: string;\r\n    }\r\n  ): Promise<Reservation> {\r\n    const response = await axiosInstance.post(\r\n      API_ENDPOINTS.RESERVATION.SEND_INVITATION(id),\r\n      options || {}\r\n    );\r\n    return response.data.data || response.data;\r\n  },\r\n\r\n  /**\r\n   * Sendet TTLock Passcode mit anpassbaren Kontaktdaten\r\n   */\r\n  async sendPasscode(\r\n    id: number,\r\n    options?: {\r\n      guestPhone?: string;\r\n      guestEmail?: string;\r\n      customMessage?: string;\r\n    }\r\n  ): Promise<Reservation> {\r\n    const response = await axiosInstance.post(\r\n      API_ENDPOINTS.RESERVATION.SEND_PASSCODE(id),\r\n      options || {}\r\n    );\r\n    return response.data.data || response.data;\r\n  },\r\n\r\n  /**\r\n   * Holt Notification-Logs fr eine Reservierung\r\n   */\r\n  async getNotificationLogs(id: number): Promise<ReservationNotificationLog[]> {\r\n    const response = await axiosInstance.get(\r\n      API_ENDPOINTS.RESERVATION.NOTIFICATION_LOGS(id)\r\n    );\r\n    return response.data.data || response.data;\r\n  }\r\n};\r\n\r\nexport interface ReservationNotificationLog {\r\n  id: number;\r\n  reservationId: number;\r\n  notificationType: 'invitation' | 'pin' | 'checkin_confirmation';\r\n  channel: 'whatsapp' | 'email' | 'both';\r\n  success: boolean;\r\n  sentAt: string; // ISO datetime string\r\n  sentTo?: string | null;\r\n  message?: string | null;\r\n  paymentLink?: string | null;\r\n  checkInLink?: string | null;\r\n  errorMessage?: string | null;\r\n  createdAt: string; // ISO datetime string\r\n}\r\n\r\n","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { reservationService, ReservationNotificationLog } from '../../services/reservationService.ts';\r\nimport { format } from 'date-fns';\r\nimport { de, es, enUS } from 'date-fns/locale';\r\nimport {\r\n  CheckCircleIcon,\r\n  XCircleIcon,\r\n  PaperAirplaneIcon,\r\n  EnvelopeIcon,\r\n  PhoneIcon,\r\n  KeyIcon,\r\n  ClockIcon\r\n} from '@heroicons/react/24/outline';\r\n\r\ninterface ReservationNotificationLogsProps {\r\n  reservationId: number;\r\n  refreshKey?: number; // Optional: Wird erhht, wenn Logs neu geladen werden sollen\r\n}\r\n\r\nconst ReservationNotificationLogs: React.FC<ReservationNotificationLogsProps> = ({\r\n  reservationId,\r\n  refreshKey\r\n}) => {\r\n  const { t, i18n } = useTranslation();\r\n  const [logs, setLogs] = useState<ReservationNotificationLog[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  const getLocale = () => {\r\n    switch (i18n.language) {\r\n      case 'de': return de;\r\n      case 'es': return es;\r\n      default: return enUS;\r\n    }\r\n  };\r\n\r\n  const formatDateTime = (dateString: string) => {\r\n    try {\r\n      return format(new Date(dateString), 'dd.MM.yyyy HH:mm', { locale: getLocale() });\r\n    } catch {\r\n      return dateString;\r\n    }\r\n  };\r\n\r\n  const getNotificationTypeLabel = (type: string) => {\r\n    switch (type) {\r\n      case 'invitation':\r\n        return t('reservations.notificationLogs.type.invitation', 'Einladung');\r\n      case 'pin':\r\n        return t('reservations.notificationLogs.type.pin', 'PIN-Code');\r\n      case 'checkin_confirmation':\r\n        return t('reservations.notificationLogs.type.checkinConfirmation', 'Check-in-Besttigung');\r\n      default:\r\n        return type;\r\n    }\r\n  };\r\n\r\n  const getChannelIcon = (channel: string) => {\r\n    switch (channel) {\r\n      case 'whatsapp':\r\n        return <PhoneIcon className=\"h-4 w-4\" />;\r\n      case 'email':\r\n        return <EnvelopeIcon className=\"h-4 w-4\" />;\r\n      case 'both':\r\n        return (\r\n          <div className=\"flex items-center space-x-1\">\r\n            <PhoneIcon className=\"h-4 w-4\" />\r\n            <EnvelopeIcon className=\"h-4 w-4\" />\r\n          </div>\r\n        );\r\n      default:\r\n        return <PaperAirplaneIcon className=\"h-4 w-4\" />;\r\n    }\r\n  };\r\n\r\n  const getNotificationTypeIcon = (type: string) => {\r\n    switch (type) {\r\n      case 'pin':\r\n        return <KeyIcon className=\"h-4 w-4\" />;\r\n      case 'invitation':\r\n        return <PaperAirplaneIcon className=\"h-4 w-4\" />;\r\n      case 'checkin_confirmation':\r\n        return <CheckCircleIcon className=\"h-4 w-4\" />;\r\n      default:\r\n        return <PaperAirplaneIcon className=\"h-4 w-4\" />;\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const loadLogs = async () => {\r\n      try {\r\n        setLoading(true);\r\n        setError(null);\r\n        const logsData = await reservationService.getNotificationLogs(reservationId);\r\n        setLogs(logsData);\r\n      } catch (err: any) {\r\n        console.error('Fehler beim Laden der Notification-Logs:', err);\r\n        setError(err.response?.data?.message || t('reservations.notificationLogs.loadError', 'Fehler beim Laden der Logs'));\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    loadLogs();\r\n  }, [reservationId, t, refreshKey]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-4\">\r\n        <div className=\"animate-pulse space-y-3\">\r\n          <div className=\"h-4 bg-gray-200 dark:bg-gray-700 rounded w-1/4\"></div>\r\n          <div className=\"h-20 bg-gray-200 dark:bg-gray-700 rounded\"></div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-4\">\r\n        <div className=\"text-red-600 dark:text-red-400 text-sm\">\r\n          {error}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (logs.length === 0) {\r\n    return (\r\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-4\">\r\n        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\">\r\n          {t('reservations.notificationLogs.title', 'Benachrichtigungs-Historie')}\r\n        </h3>\r\n        <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n          {t('reservations.notificationLogs.noLogs', 'Keine Logs vorhanden')}\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-4\">\r\n      <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\r\n        {t('reservations.notificationLogs.title', 'Benachrichtigungs-Historie')}\r\n      </h3>\r\n      \r\n      <div className=\"space-y-3\">\r\n        {logs.map((log) => (\r\n          <div\r\n            key={log.id}\r\n            className={`border rounded-lg p-3 ${\r\n              log.success\r\n                ? 'border-green-200 dark:border-green-800 bg-green-50 dark:bg-green-900/20'\r\n                : 'border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20'\r\n            }`}\r\n          >\r\n            <div className=\"flex items-start justify-between mb-2\">\r\n              <div className=\"flex items-center space-x-2\">\r\n                {log.success ? (\r\n                  <CheckCircleIcon className=\"h-5 w-5 text-green-600 dark:text-green-400\" />\r\n                ) : (\r\n                  <XCircleIcon className=\"h-5 w-5 text-red-600 dark:text-red-400\" />\r\n                )}\r\n                <div className=\"flex items-center space-x-2\">\r\n                  {getNotificationTypeIcon(log.notificationType)}\r\n                  <span className=\"text-sm font-medium text-gray-900 dark:text-white\">\r\n                    {getNotificationTypeLabel(log.notificationType)}\r\n                  </span>\r\n                </div>\r\n                <div className=\"flex items-center space-x-1 text-gray-500 dark:text-gray-400\">\r\n                  {getChannelIcon(log.channel)}\r\n                </div>\r\n              </div>\r\n              <div className=\"flex items-center space-x-1 text-xs text-gray-500 dark:text-gray-400\">\r\n                <ClockIcon className=\"h-4 w-4\" />\r\n                <span>{formatDateTime(log.sentAt)}</span>\r\n              </div>\r\n            </div>\r\n\r\n            {log.sentTo && (\r\n              <div className=\"text-xs text-gray-600 dark:text-gray-300 mb-1\">\r\n                <span className=\"font-medium\">{t('reservations.notificationLogs.sentTo', 'Gesendet an')}:</span> {log.sentTo}\r\n              </div>\r\n            )}\r\n\r\n            {log.message && (\r\n              <div className=\"text-xs text-gray-600 dark:text-gray-300 mb-2 mt-2 p-2 bg-white dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600\">\r\n                <div className=\"font-medium mb-1\">{t('reservations.notificationLogs.message', 'Nachricht')}:</div>\r\n                <div className=\"whitespace-pre-wrap break-words\">{log.message}</div>\r\n              </div>\r\n            )}\r\n\r\n            {(log.paymentLink || log.checkInLink) && (\r\n              <div className=\"flex flex-wrap gap-2 mt-2\">\r\n                {log.paymentLink && (\r\n                  <a\r\n                    href={log.paymentLink}\r\n                    target=\"_blank\"\r\n                    rel=\"noopener noreferrer\"\r\n                    className=\"text-xs text-blue-600 dark:text-blue-400 hover:underline\"\r\n                  >\r\n                    {t('reservations.notificationLogs.paymentLink', 'Zahlungslink')}\r\n                  </a>\r\n                )}\r\n                {log.checkInLink && (\r\n                  <a\r\n                    href={log.checkInLink}\r\n                    target=\"_blank\"\r\n                    rel=\"noopener noreferrer\"\r\n                    className=\"text-xs text-blue-600 dark:text-blue-400 hover:underline\"\r\n                  >\r\n                    {t('reservations.notificationLogs.checkInLink', 'Check-in-Link')}\r\n                  </a>\r\n                )}\r\n              </div>\r\n            )}\r\n\r\n            {log.errorMessage && (\r\n              <div className=\"mt-2 p-2 bg-red-100 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded text-xs text-red-700 dark:text-red-300\">\r\n                <div className=\"font-medium mb-1\">{t('reservations.notificationLogs.error', 'Fehler')}:</div>\r\n                <div>{log.errorMessage}</div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ReservationNotificationLogs;\r\n\r\n"],"names":["_ref","onArticleSelected","excludeArticleIds","selectedArticles","onArticleRemove","articles","setArticles","useState","selectedArticleId","setSelectedArticleId","selectedArticlePreview","setSelectedArticlePreview","loading","setLoading","error","setError","useEffect","async","filteredArticles","axiosInstance","get","API_ENDPOINTS","CEREBRO","ARTICLES","BASE","data","filter","article","includes","id","err","_axiosError$response","_axiosError$response$","console","axiosError","response","message","fetchAllArticles","_jsxs","className","children","_jsx","value","onChange","e","articleId","parseInt","target","isNaN","find","BY_ID","fetchArticleDetails","map","title","type","onClick","handleArticleConfirm","selectedArticle","disabled","content","substring","length","href","concat","slug","rel","TaskForm","_ref2","setTitle","description","setDescription","assigneeType","setAssigneeType","responsibleId","setResponsibleId","roleId","setRoleId","qualityControlId","setQualityControlId","branchId","setBranchId","dueDate","setDueDate","users","roles","branches","handleSubmit","handleClose","onArticleSelect","uploading","temporaryAttachments","onFileUpload","onRemoveAttachment","textareaRef","fileInputRef","handlePaste","handleDrop","handleDragOver","t","useTranslation","activeTab","setActiveTab","onSubmit","noValidate","_Fragment","htmlFor","required","ref","rows","onPaste","onDrop","onDragOver","placeholder","_fileInputRef$current","current","click","xmlns","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","d","attachment","index","fileName","fileType","startsWith","file","src","URL","createObjectURL","alt","name","checked","Number","Array","isArray","user","firstName","lastName","role","branch","CerebroArticleSelector","a","XMarkIcon","ArrowPathIcon","CheckIcon","isOpen","onClose","onTaskCreated","useAuth","openSidepane","closeSidepane","useSidepane","isLargeScreen","setIsLargeScreen","window","innerWidth","setUsers","setRoles","setBranches","isMobile","setIsMobile","setSelectedArticles","setTemporaryAttachments","setUploading","useRef","fetchUsers","fetchRoles","fetchBranches","getDefaultDueDate","date","Date","setDate","getDate","toISOString","split","checkScreenSize","addEventListener","removeEventListener","localStorage","getItem","log","USERS","DROPDOWN","code","ROLES","_axiosError$response2","_axiosError$response3","BRANCHES","_axiosError$response4","_axiosError$response5","items","event","clipboardData","i","item","indexOf","preventDefault","getAsFile","handleTemporaryAttachment","stopPropagation","dataTransfer","files","newAttachment","fileSize","size","prev","insertText","cursorPos","selectionStart","textBefore","textAfter","setTimeout","newPos","selectionEnd","focus","_axiosError$response6","_axiosError$response7","handleFileUpload","handleRemoveTemporaryAttachment","attachmentToRemove","_","escapedFileName","replace","uploadText","imagePattern","RegExp","linkPattern","newDescription","qualityControl","responsible","taskData","status","post","TASKS","newTaskId","Promise","all","LINK_CARTICLE","formData","FormData","append","ATTACHMENTS","taskId","headers","uploadTemporaryAttachments","_axiosError$response8","_axiosError$response9","handleAddArticle","handleRemoveArticle","Dialog","open","Panel","Title","style","opacity","transition","pointerEvents","_task$title","_task$title2","_task$title3","_task$title4","_task$description","task","showMessage","useMessage","isLifecycleTask","autoGeneratedData","jsonMatch","match","JSON","parse","forEach","line","key","trim","Object","keys","taskType","ClipboardDocumentIcon","defaultValue","dataString","stringify","navigator","clipboard","writeText","entries","String","emailTemplate","setEmailTemplate","emailSent","setEmailSent","generating","setGenerating","EnvelopeIcon","template","_error$response","_error$response$data","resolve","_error$response2","_error$response2$data","PaperAirplaneIcon","onComplete","setFormData","registrationNumber","provider","registrationDate","notes","socialSecurityType","getSocialSecurityType","_task$title5","_task$title6","_task$title7","_task$title8","userId","extractUserId","userIdMatch","put","LIFECYCLE","SOCIAL_SECURITY","completedAt","_objectSpread","_task$qualityControl","_task$branch","onTaskUpdated","hasPermission","usePermissions","text","originalDescription","setStatus","attachments","setAttachments","uploadedDuringEdit","setUploadedDuringEdit","dateString","getTime","formatDate","confirmDelete","setConfirmDelete","linkedArticles","setLinkedArticles","canDeleteTask","handleResize","attachmentId","delete","ATTACHMENT","cleanup","fetchLinkedArticles","fetchAttachments","CARTICLES","uploadFileAndInsertLink","getTaskAttachmentUrl","_axiosError$response10","_axiosError$response11","finalDescription","imageAttachments","att","_att$fileType","existingImagePattern","existingImages","exec","push","imageUrl","imageMarkdown","test","existingImage","updatedTaskResponse","filePath","uploadedAt","url","_axiosError$response12","_axiosError$response13","handleDelete","undefined","_axiosError$response14","_axiosError$response15","_axiosError$response16","_axiosError$response17","UNLINK_CARTICLE","_axiosError$response18","_axiosError$response19","renderForm","renderAttachments","renderTemporaryAttachments","TaskDataBox","EmailTemplateBox","SocialSecurityCompletionBox","TrashIcon","responseType","Blob","link","document","createElement","setAttribute","body","appendChild","remove","_axiosError$response22","_axiosError$response23","handleDownloadAttachment","escapedAttachmentUrl","_axiosError$response20","_axiosError$response21","handleDeleteAttachment","_attachment$fileType","onReservationCreated","guestName","setGuestName","contact","setContact","amount","setAmount","currency","setCurrency","contactType","setContactType","handleContactChange","detectContactType","handleAmountChange","parseFloat","newReservation","reservationService","create","_err$response","_err$response2","_err$response3","_err$response3$data","errorMessage","TourType","TourBookingStatus","onTourCreated","setType","OWN","isActive","setIsActive","duration","setDuration","maxParticipants","setMaxParticipants","minParticipants","setMinParticipants","price","setPrice","location","setLocation","meetingPoint","setMeetingPoint","setIncludes","excludes","setExcludes","requirements","setRequirements","totalCommission","setTotalCommission","totalCommissionPercent","setTotalCommissionPercent","sellerCommissionPercent","setSellerCommissionPercent","sellerCommissionFixed","setSellerCommissionFixed","externalProviderId","setExternalProviderId","externalBookingUrl","setExternalBookingUrl","imageFile","setImageFile","imagePreview","setImagePreview","galleryFiles","setGalleryFiles","galleryPreviews","setGalleryPreviews","uploadingImage","setUploadingImage","tourProviders","setTourProviders","loadingData","setLoadingData","_API_ENDPOINTS$TOUR_P","_branchesRes$data","_providersRes$data","branchesRes","providersRes","TOUR_PROVIDERS","loadData","tourData","TOURS","success","createdTour","UPLOAD_IMAGE","imgErr","UPLOAD_GALLERY","galleryErr","updatedResponse","_err$response$data","EXTERNAL","min","step","max","_tour$isActive","_tour$galleryUrls","onTourUpdated","tour","API_BASE_URL","galleryUrls","_tour$isActive2","_tour$galleryUrls2","_err$response2$data","accept","_e$target$files","reader","FileReader","onloadend","result","readAsDataURL","multiple","from","preview","currentGallery","DELETE_GALLERY_IMAGE","newIndex","removeGalleryImage","tourId","setTour","loadTour","ClockIcon","UsersIcon","CurrencyDollarIcon","toLocaleString","MapPinIcon","BuildingOfficeIcon","createdBy","UserIcon","createdAt","format","locale","de","externalProvider","availableFrom","availableTo","bookings","setBookings","loadBookings","BOOKINGS","getStatusColor","CONFIRMED","CANCELLED","COMPLETED","NO_SHOW","getPaymentStatusColor","booking","customerName","customerEmail","customerPhone","tourDate","bookingDate","numberOfParticipants","totalPrice","amountPaid","amountPending","paymentStatus","bookedBy","tourCount","selectedFields","setSelectedFields","exporting","setExporting","setFormat","availableFields","label","selectAll","f","deselectAll","field","toggleField","fieldId","fieldsParam","join","EXPORT","params","fields","tours","blob","download","removeChild","revokeObjectURL","csvContent","row","cell","ArrowDownTrayIcon","onLinked","reservations","setReservations","selectedReservationId","setSelectedReservationId","tourPrice","setTourPrice","accommodationPrice","setAccommodationPrice","loadingReservations","setLoadingReservations","existingLinks","setExistingLinks","loadReservations","loadExistingLinks","RESERVATION","TOUR_RESERVATIONS","BY_BOOKING","selectedReservation","r","reservationAmount","isValid","LinkIcon","bookingId","reservationId","res","resAmount","currentTourPrice","reservation","checkInDate","checkOutDate","_link$reservation","confirm","linkId","handleDeleteLink","onSuccess","guestPhone","setGuestPhone","guestEmail","setGuestEmail","customMessage","setCustomMessage","previewMessage","setPreviewMessage","email","checkInLink","codigo","lobbyReservationId","toString","baseUrl","URLSearchParams","paymentLink","sendInvitation","alreadySent","sentMessageAt","passcode","doorPin","ttlLockPassword","roomNumber","roomDescription","sendPasscode","WorktimeTracker","isTracking","setIsTracking","startTime","setStartTime","elapsedTime","setElapsedTime","activeWorktime","setActiveWorktime","isLoading","setIsLoading","showWorkTimeModal","setShowWorkTimeModal","statusError","setStatusError","contextTracking","updateTrackingStatus","checkTrackingStatus","useWorktime","selectedBranch","setSelectedBranch","useBranch","organization","useOrganization","isDifferentOrganization","useMemo","organizationId","useCallback","token","WORKTIME","ACTIVE","active","startISOString","endsWith","startTimeDate","diff","totalSeconds","Math","floor","hours","minutes","seconds","padStart","intervalId","setInterval","clearInterval","handleStartTracking","alert","START","getTimezoneOffset","handleStopTracking","STOP","endTime","_error$response$data2","branchName","_branches$find","b","force","ExclamationTriangleIcon","openWorkTimeModal","ListBulletIcon","day","month","getMonth","year","getFullYear","getHours","getMinutes","getSeconds","formatStartDate","now","WorktimeModal","closeWorkTimeModal","defaultColumnOrder","TODOS_TABLE_ID","RESERVATIONS_TABLE_ID","TOURS_TABLE_ID","defaultCardSortDirections","defaultReservationCardSortDirections","arrivalTime","tableToCardMapping","cardToTableMapping","reservationTableToCardMapping","reservationCardToTableMapping","Worktracker","permissions","useLocation","navigate","useNavigate","availableColumns","shortLabel","filterOnlyColumns","availableReservationColumns","reservationFilterOnlyColumns","availableTourColumns","tasks","setTasks","allTasks","setAllTasks","searchTerm","setSearchTerm","statusFilter","setStatusFilter","reservationsLoading","setReservationsLoading","reservationsError","setReservationsError","reservationSearchTerm","setReservationSearchTerm","reservationFilterStatus","setReservationFilterStatus","reservationFilterPaymentStatus","setReservationFilterPaymentStatus","setTours","allTours","setAllTours","toursLoading","setToursLoading","toursError","setToursError","tourSearchTerm","setTourSearchTerm","tourFilterConditions","setTourFilterConditions","tourFilterLogicalOperators","setTourFilterLogicalOperators","tourFilterSortDirections","setTourFilterSortDirections","tourActiveFilterName","setTourActiveFilterName","tourSelectedFilterId","setTourSelectedFilterId","isCreateTourModalOpen","setIsCreateTourModalOpen","isEditTourModalOpen","setIsEditTourModalOpen","isTourDetailsModalOpen","setIsTourDetailsModalOpen","isTourBookingsModalOpen","setIsTourBookingsModalOpen","isTourExportDialogOpen","setIsTourExportDialogOpen","selectedTour","setSelectedTour","selectedTourId","setSelectedTourId","isCreateReservationModalOpen","setIsCreateReservationModalOpen","syncingReservations","setSyncingReservations","generatingPinForReservation","setGeneratingPinForReservation","selectedReservationForInvitation","setSelectedReservationForInvitation","isSendInvitationSidepaneOpen","setIsSendInvitationSidepaneOpen","selectedReservationForPasscode","setSelectedReservationForPasscode","isSendPasscodeSidepaneOpen","setIsSendPasscodeSidepaneOpen","tourBookings","setTourBookings","allTourBookings","setAllTourBookings","tourBookingsLoading","setTourBookingsLoading","tourBookingsError","setTourBookingsError","tourBookingsSearchTerm","setTourBookingsSearchTerm","selectedBookingForLink","setSelectedBookingForLink","isTourReservationLinkModalOpen","setIsTourReservationLinkModalOpen","reservationFilterConditions","setReservationFilterConditions","reservationFilterLogicalOperators","setReservationFilterLogicalOperators","reservationFilterSortDirections","setReservationFilterSortDirections","reservationActiveFilterName","setReservationActiveFilterName","reservationSelectedFilterId","setReservationSelectedFilterId","filterConditions","setFilterConditions","filterLogicalOperators","setFilterLogicalOperators","filterSortDirections","setFilterSortDirections","activeFilterName","setActiveFilterName","selectedFilterId","setSelectedFilterId","isFilterModalOpen","setIsFilterModalOpen","tableSortConfig","setTableSortConfig","direction","reservationTableSortConfig","setReservationTableSortConfig","tourTableSortConfig","setTourTableSortConfig","isCreateModalOpen","setIsCreateModalOpen","isEditModalOpen","setIsEditModalOpen","selectedTask","setSelectedTask","copiedTask","setCopiedTask","settings","tasksSettings","isLoadingTasksSettings","updateColumnOrder","updateTasksColumnOrder","updateHiddenColumns","updateTasksHiddenColumns","toggleColumnVisibility","toggleTasksColumnVisibility","isColumnVisible","isTasksColumnVisible","updateViewMode","updateTasksViewMode","useTableSettings","defaultHiddenColumns","defaultViewMode","defaultReservationColumnOrder","reservationsSettings","isLoadingReservationsSettings","updateReservationsColumnOrder","updateReservationsHiddenColumns","toggleReservationsColumnVisibility","isReservationsColumnVisible","updateReservationsViewMode","defaultTourColumnOrder","toursSettings","isLoadingToursSettings","updateToursColumnOrder","updateToursHiddenColumns","toggleToursColumnVisibility","isToursColumnVisible","updateToursViewMode","draggedColumn","setDraggedColumn","dragOverColumn","setDragOverColumn","displayLimit","setDisplayLimit","expandedReservationRows","setExpandedReservationRows","Set","viewMode","cardMetadataOrder","columnOrder","cardMetadata","tableCol","cardMeta","getCardMetadataFromColumnOrder","getReservationCardMetadataFromColumnOrder","hiddenCardMetadata","hiddenTableColumns","add","getHiddenCardMetadata","hiddenColumns","getReservationHiddenCardMetadata","visibleCardMetadata","meta","has","taskCardSortDirections","setTaskCardSortDirections","handleTaskCardSortDirectionChange","columnId","reservationCardSortDirections","setReservationCardSortDirections","handleReservationCardSortDirectionChange","defaultTourCardSortDirections","tourCardSortDirections","setTourCardSortDirections","toggleReservationExpanded","newSet","querySelectorAll","wrapper","classList","hasLoadedRef","loadTasks","filterId","background","arguments","conditions","operators","tasksWithAttachments","_response$data","reservationsData","loadTours","toursData","loadTourBookings","_response$data2","TOUR_BOOKINGS","bookingsData","applyTourFilterConditions","sortDirections","resetTourFilterConditions","handleTourFilterChange","filterName","editTaskId","search","SAVED_FILTERS","BY_TABLE","aktuellFilter","column","priority","conditionIndex","findIndex","c","applyFilterConditions","setInitialFilterAndLoad","existingFilters","Authorization","archivFilterExists","some","aktuellFilterExists","archivFilter","tableId","operator","createStandardFilters","handleStatusChange","newStatus","prevTasks","patch","toast","isResponsibleForTask","_user$roles","userRole","_userRole$role","_task$role","isQualityControlForTask","handleSort","handleReservationSort","renderStatusButtons","buttons","ArrowLeftIcon","ArrowRightIcon","getActiveFilterCount","validSortDirections","resetFilterConditions","applyReservationFilterConditions","resetReservationFilterConditions","handleFilterChange","handleReservationFilterChange","getStatusPriority","getReservationStatusColor","ReservationStatus","NOTIFICATION_SENT","CHECKED_IN","CHECKED_OUT","PaymentStatus","PAID","PARTIALLY_PAID","REFUNDED","PENDING","filteredAndSortedTasks","tasksToFilter","filtered","searchLower","toLowerCase","columnEvaluators","cond","_task$responsible","_task$role2","responsibleName","evaluateUserRoleCondition","_task$qualityControl2","qualityControlName","responsibleAndQualityControl","_task$responsible2","_task$role3","_task$qualityControl3","evaluateResponsibleAndQualityControl","evaluateDateCondition","getFieldValue","applyFilters","getSortValue","MAX_SAFE_INTEGER","sorted","sort","valueA","valueB","comparison","localeCompare","sortedByPriority","sd1","sd2","sortDir","sortableColumns","colId","aDate","bDate","aStatusPrio","bStatusPrio","filteredAndSortedReservations","validReservations","compareValue","abs","_reservation$branch","onlineCheckInCompleted","_reservation$branch2","getReservationSortValue","_reservation$branch3","filteredAndSortedTours","_tour$branch","createdByName","createdById","_tour$branch2","getTourSortValue","_tour$branch3","titleA","titleB","handleMoveColumn","dragIndex","hoverIndex","newColumnOrder","splice","handleDragStart","handleDragEnd","visibleColumnIds","validOrder","missingColumns","handleCopyTask","_task$qualityControl4","copiedTaskData","handleDeleteTask","width","height","PlusIcon","CheckCircleIcon","CalendarIcon","MapIcon","RESERVATIONS","SYNC","_err$response4","_err$response4$data","Squares2X2Icon","TableCellsIcon","FunnelIcon","TableColumnConfig","columns","visibleColumns","onToggleColumnVisibility","tableColumn","otherCardMeta","onMoveColumn","newCardOrder","dragged","newTableOrder","usedTableColumns","col","buttonTitle","modalTitle","onSortDirectionChange","showSortDirection","FilterPane","onApply","onReset","savedConditions","savedOperators","savedSortDirections","onSortDirectionsChange","SavedFilterTags","onSelectFilter","onFilterChange","defaultFilterName","scope","draggable","onDragStart","onDragEnd","ArrowsUpDownIcon","colSpan","ClipboardDocumentListIcon","slice","expiryStatus","getExpiryStatus","expiryColors","getExpiryColorClasses","bgClass","borderClass","InformationCircleIcon","MarkdownPreview","showImagePreview","expiryStatusForDate","expiryColorsForDate","textClass","toLocaleDateString","PencilIcon","DocumentDuplicateIcon","CardGrid","metadata","icon","section","responsibleValue","shortenedName","qualityControlValue","dueDateItem","createDueDateMetadataItem","descriptionContent","attachmentMetadata","actionButtons","DataCard","getStatusText","color","onPreviousClick","onNextClick","actions","prevLimit","_filteredAndSortedRes","getUTCFullYear","getUTCMonth","getUTCDate","localDate","_unused","HomeIcon","PhoneIcon","encodeURIComponent","amountValue","toFixed","formatDateTime","_unused2","KeyIcon","doorAppName","hasWritePermission","entity","accessLevel","entityType","actionButtonsWillBeCreated","isExpanded","expandableContent","ReservationNotificationLogs","subtitle","expandable","onToggle","_unused3","_reservation$branch4","_err$response5","_err$response5$data","handleTourCardSortDirectionChange","expiryStatusForDate2","expiryColorsForDate2","_unused4","_unused5","_unused6","_reservation$branch5","handleTourSort","_tour$branch4","CreateTaskModal","newTask","validTasks","EditTaskModal","updatedTask","CreateReservationModal","SendInvitationSidepane","SendPasscodeSidepane","CreateTourModal","newTour","EditTourModal","updatedTour","TourDetailsModal","TourBookingsModal","TourExportDialog","_booking$customerName","_booking$customerEmai","_booking$tour","_booking$tour$title","_booking$customerPhon","_booking$tour2","TourReservationLinkModal","API_BASE","getById","updateGuestContact","generatePinAndSend","GENERATE_PIN_AND_SEND","options","SEND_INVITATION","SEND_PASSCODE","getNotificationLogs","NOTIFICATION_LOGS","refreshKey","i18n","logs","setLogs","getLocale","language","es","enUS","getNotificationTypeLabel","getChannelIcon","channel","getNotificationTypeIcon","logsData","loadLogs","XCircleIcon","notificationType","sentAt","sentTo"],"sourceRoot":""}