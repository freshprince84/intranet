{"version":3,"file":"static/js/556.c75c6512.chunk.js","mappings":"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","sources":["../node_modules/@heroicons/react/24/outline/esm/PlayIcon.js","api/clientApi.ts","components/EditClientModal.tsx","components/ClientSelectModal.tsx","components/CreateClientModal.tsx","api/consultationApi.ts","components/ConsultationTracker.tsx","components/LinkTaskModal.tsx","components/InvoiceSuccessModal.tsx","components/CreateInvoiceModal.tsx","components/ConsultationList.tsx","pages/Consultations.tsx","utils/dateUtils.ts","../node_modules/@heroicons/react/24/outline/esm/StopIcon.js","../node_modules/@heroicons/react/24/outline/esm/ChevronDownIcon.js","../node_modules/@heroicons/react/24/outline/esm/DocumentTextIcon.js","../node_modules/@heroicons/react/24/outline/esm/ChartBarIcon.js","../node_modules/@heroicons/react/24/outline/esm/CheckCircleIcon.js","../node_modules/@heroicons/react/24/outline/esm/ClockIcon.js","../node_modules/@heroicons/react/24/outline/esm/MagnifyingGlassIcon.js","../node_modules/@heroicons/react/24/outline/esm/FunnelIcon.js","../node_modules/@heroicons/react/24/outline/esm/DocumentArrowDownIcon.js","../node_modules/@heroicons/react/24/outline/esm/EyeIcon.js","../node_modules/@heroicons/react/24/outline/esm/LinkIcon.js"],"sourcesContent":["import * as React from \"react\";\nfunction PlayIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(PlayIcon);\nexport default ForwardRef;","import axiosInstance from '../config/axios.ts';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\n\r\n/**\r\n * API-Funktionen fr die Client-Verwaltung\r\n */\r\n\r\nexport interface CreateClientData {\r\n  name: string;\r\n  company?: string;\r\n  email?: string;\r\n  phone?: string;\r\n  address?: string;\r\n  notes?: string;\r\n}\r\n\r\nexport interface UpdateClientData {\r\n  name?: string;\r\n  company?: string;\r\n  email?: string;\r\n  phone?: string;\r\n  address?: string;\r\n  notes?: string;\r\n  isActive?: boolean;\r\n}\r\n\r\n/**\r\n * Holt alle Clients\r\n * @returns Liste aller Clients\r\n */\r\nexport const getClients = async () => {\r\n  try {\r\n    const response = await axiosInstance.get(API_ENDPOINTS.CLIENTS.BASE);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Laden der Clients:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Holt einen einzelnen Client mit seinen Beratungen\r\n * @param clientId ID des Clients\r\n * @returns Client mit seinen letzten Beratungen\r\n */\r\nexport const getClientById = async (clientId: number) => {\r\n  try {\r\n    const response = await axiosInstance.get(API_ENDPOINTS.CLIENTS.BY_ID(clientId));\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Laden des Clients:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Erstellt einen neuen Client\r\n * @param data Client-Daten\r\n * @returns Der erstellte Client\r\n */\r\nexport const createClient = async (data: CreateClientData) => {\r\n  try {\r\n    const response = await axiosInstance.post(API_ENDPOINTS.CLIENTS.BASE, data);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Erstellen des Clients:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Aktualisiert einen bestehenden Client\r\n * @param clientId ID des Clients\r\n * @param data Update-Daten\r\n * @returns Der aktualisierte Client\r\n */\r\nexport const updateClient = async (clientId: number, data: UpdateClientData) => {\r\n  try {\r\n    const response = await axiosInstance.put(API_ENDPOINTS.CLIENTS.BY_ID(clientId), data);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Aktualisieren des Clients:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Lscht einen Client\r\n * @param clientId ID des Clients\r\n * @returns Status der Lschoperation\r\n */\r\nexport const deleteClient = async (clientId: number) => {\r\n  try {\r\n    const response = await axiosInstance.delete(API_ENDPOINTS.CLIENTS.BY_ID(clientId));\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Lschen des Clients:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Holt die zuletzt beratenen Clients\r\n * @returns Liste der zuletzt beratenen Clients\r\n */\r\nexport const getRecentClients = async () => {\r\n  try {\r\n    const response = await axiosInstance.get(API_ENDPOINTS.CLIENTS.RECENT);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Laden der zuletzt beratenen Clients:', error);\r\n    throw error;\r\n  }\r\n}; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, TrashIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { Client } from '../types/client.ts';\nimport { toast } from 'react-toastify';\nimport * as clientApi from '../api/clientApi.ts';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\n\ninterface EditClientModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onClientUpdated?: (client: Client) => void;\n  onClientDeleted?: (clientId: number) => void;\n  client: Client | null;\n}\n\nconst EditClientModal: React.FC<EditClientModalProps> = ({\n  isOpen,\n  onClose,\n  onClientUpdated,\n  onClientDeleted,\n  client\n}) => {\n  const { t } = useTranslation();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [formData, setFormData] = useState({\n    name: '',\n    company: '',\n    email: '',\n    phone: '',\n    address: '',\n    notes: '',\n    isActive: true\n  });\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [loading, setLoading] = useState(false);\n  const [confirmDelete, setConfirmDelete] = useState(false);\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n\n  // Lade Client-Daten wenn Modal geffnet wird\n  useEffect(() => {\n    if (isOpen && client) {\n      setFormData({\n        name: client.name || '',\n        company: client.company || '',\n        email: client.email || '',\n        phone: client.phone || '',\n        address: client.address || '',\n        notes: client.notes || '',\n        isActive: client.isActive !== undefined ? client.isActive : true\n      });\n      setConfirmDelete(false);\n      setErrors({});\n    }\n  }, [isOpen, client]);\n\n  // berprfung der Bildschirmgre\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    checkScreenSize();\n    window.addEventListener('resize', checkScreenSize);\n    \n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const validateForm = () => {\n    const newErrors: Record<string, string> = {};\n    \n    if (!formData.name.trim()) {\n      newErrors.name = 'Name ist erforderlich';\n    }\n    \n    if (formData.email && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(formData.email)) {\n      newErrors.email = 'Ungltige E-Mail-Adresse';\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) return;\n    \n    if (!client) return;\n    \n    try {\n      setLoading(true);\n      const updated = await clientApi.updateClient(client.id, {\n        name: formData.name,\n        company: formData.company || undefined,\n        email: formData.email || undefined,\n        phone: formData.phone || undefined,\n        address: formData.address || undefined,\n        notes: formData.notes || undefined,\n        isActive: formData.isActive\n      });\n      \n      toast.success('Client erfolgreich aktualisiert');\n      onClientUpdated?.(updated);\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || 'Fehler beim Aktualisieren des Clients');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDelete = async () => {\n    if (!confirmDelete) {\n      setConfirmDelete(true);\n      return;\n    }\n    \n    if (!client) return;\n    \n    try {\n      setLoading(true);\n      await clientApi.deleteClient(client.id);\n      \n      toast.success('Client erfolgreich gelscht');\n      onClientDeleted?.(client.id);\n      onClose();\n    } catch (error: any) {\n      const errorMessage = error.response?.data?.message || 'Fehler beim Lschen des Clients';\n      const errorDetails = error.response?.data?.details;\n      const errorSuggestion = error.response?.data?.suggestion;\n      \n      // Zeige detaillierte Fehlermeldung bei Verknpfungen\n      if (error.response?.status === 409 && errorDetails) {\n        const details = Object.entries(errorDetails)\n          .filter(([_, count]) => (count as number) > 0)\n          .map(([key, count]) => `${count as number} ${key === 'workTimes' ? 'Zeiteintrge' : key === 'consultationInvoices' ? 'Rechnungen' : 'Monatsberichte'}`)\n          .join(', ');\n        \n        toast.error(`${errorMessage}. Verknpfungen: ${details}. ${errorSuggestion || ''}`);\n      } else {\n        toast.error(errorMessage);\n      }\n      \n      setConfirmDelete(false);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    const { name, value, type } = e.target;\n    const checked = (e.target as HTMLInputElement).checked;\n    \n    setFormData(prev => ({\n      ...prev,\n      [name]: type === 'checkbox' ? checked : value\n    }));\n    \n    // Fehler fr dieses Feld lschen\n    if (errors[name]) {\n      setErrors(prev => ({ ...prev, [name]: '' }));\n    }\n  };\n\n  const handleClose = () => {\n    setConfirmDelete(false);\n    setErrors({});\n    onClose();\n  };\n\n  if (!client) return null;\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                Client bearbeiten\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              <div className=\"space-y-4\">\n                {/* Name */}\n                <div>\n                  <label htmlFor=\"name_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Name *\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"name_mobile\"\n                    name=\"name\"\n                    value={formData.name}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                      errors.name \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.name && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n                  )}\n                </div>\n\n                {/* Firma */}\n                <div>\n                  <label htmlFor=\"company_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Firma\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"company_mobile\"\n                    name=\"company\"\n                    value={formData.company}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* E-Mail */}\n                <div>\n                  <label htmlFor=\"email_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    E-Mail\n                  </label>\n                  <input\n                    type=\"email\"\n                    id=\"email_mobile\"\n                    name=\"email\"\n                    value={formData.email}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                      errors.email \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.email && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.email}</p>\n                  )}\n                </div>\n\n                {/* Telefon */}\n                <div>\n                  <label htmlFor=\"phone_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Telefon\n                  </label>\n                  <input\n                    type=\"tel\"\n                    id=\"phone_mobile\"\n                    name=\"phone\"\n                    value={formData.phone}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* Adresse */}\n                <div>\n                  <label htmlFor=\"address_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Adresse\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"address_mobile\"\n                    name=\"address\"\n                    value={formData.address}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* Notizen */}\n                <div>\n                  <label htmlFor=\"notes_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Notizen\n                  </label>\n                  <textarea\n                    id=\"notes_mobile\"\n                    name=\"notes\"\n                    rows={3}\n                    value={formData.notes}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* Aktiv-Status */}\n                <div className=\"flex items-center\">\n                  <input\n                    type=\"checkbox\"\n                    id=\"isActive_mobile\"\n                    name=\"isActive\"\n                    checked={formData.isActive}\n                    onChange={handleChange}\n                    className=\"rounded border-gray-300 text-blue-600 dark:bg-gray-700 dark:text-gray-300\"\n                  />\n                  <label htmlFor=\"isActive_mobile\" className=\"ml-2 block text-sm text-gray-700 dark:text-gray-300\">\n                    Aktiv\n                  </label>\n                </div>\n              </div>\n\n              {/* Buttons */}\n              <div className=\"mt-6 flex items-center justify-between\">\n                <button\n                  type=\"button\"\n                  onClick={handleDelete}\n                  disabled={loading}\n                  className={`inline-flex items-center px-4 py-2 border ${\n                    confirmDelete\n                      ? 'border-red-300 text-red-700 bg-red-50 dark:border-red-600 dark:text-red-400 dark:bg-red-900/20'\n                      : 'border-red-300 text-red-700 bg-white hover:bg-red-50 dark:border-red-600 dark:text-red-400 dark:bg-gray-700 dark:hover:bg-gray-600'\n                  } text-sm font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed`}\n                >\n                  <TrashIcon className=\"h-5 w-5 mr-2\" />\n                  {confirmDelete ? 'Wirklich lschen?' : 'Lschen'}\n                </button>\n\n                <div className=\"flex space-x-3\">\n                  <button\n                    type=\"button\"\n                    onClick={handleClose}\n                    className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                    title={t('common.cancel')}\n                  >\n                    <XMarkIcon className=\"h-5 w-5\" />\n                  </button>\n                  <button\n                    type=\"submit\"\n                    disabled={loading}\n                    className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n                    title={loading ? 'Speichere...' : 'Speichern'}\n                  >\n                    {loading ? (\n                      <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                    ) : (\n                      <CheckIcon className=\"h-5 w-5\" />\n                    )}\n                  </button>\n                </div>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            Client bearbeiten\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {Object.keys(errors).length > 0 && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {Object.values(errors).map((error, idx) => (\n                <p key={idx}>{error}</p>\n              ))}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            {/* Name */}\n            <div>\n              <label htmlFor=\"name\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Name *\n              </label>\n              <input\n                type=\"text\"\n                id=\"name\"\n                name=\"name\"\n                value={formData.name}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                  errors.name \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.name && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n              )}\n            </div>\n\n            {/* Firma */}\n            <div>\n              <label htmlFor=\"company\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Firma\n              </label>\n              <input\n                type=\"text\"\n                id=\"company\"\n                name=\"company\"\n                value={formData.company}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* E-Mail */}\n            <div>\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                E-Mail\n              </label>\n              <input\n                type=\"email\"\n                id=\"email\"\n                name=\"email\"\n                value={formData.email}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                  errors.email \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.email && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.email}</p>\n              )}\n            </div>\n\n            {/* Telefon */}\n            <div>\n              <label htmlFor=\"phone\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Telefon\n              </label>\n              <input\n                type=\"tel\"\n                id=\"phone\"\n                name=\"phone\"\n                value={formData.phone}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* Adresse */}\n            <div>\n              <label htmlFor=\"address\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Adresse\n              </label>\n              <input\n                type=\"text\"\n                id=\"address\"\n                name=\"address\"\n                value={formData.address}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* Notizen */}\n            <div>\n              <label htmlFor=\"notes\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Notizen\n              </label>\n              <textarea\n                id=\"notes\"\n                name=\"notes\"\n                rows={3}\n                value={formData.notes}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* Aktiv-Status */}\n            <div className=\"flex items-center\">\n              <input\n                type=\"checkbox\"\n                id=\"isActive\"\n                name=\"isActive\"\n                checked={formData.isActive}\n                onChange={handleChange}\n                className=\"rounded border-gray-300 text-blue-600 dark:bg-gray-700 dark:text-gray-300\"\n              />\n              <label htmlFor=\"isActive\" className=\"ml-2 block text-sm text-gray-700 dark:text-gray-300\">\n                Aktiv\n              </label>\n            </div>\n\n            {/* Buttons */}\n            <div className=\"flex items-center justify-between pt-4\">\n              <button\n                type=\"button\"\n                onClick={handleDelete}\n                disabled={loading}\n                className={`p-2 rounded-md ${\n                  confirmDelete\n                    ? 'bg-red-600 text-white dark:bg-red-700 dark:text-white hover:bg-red-700 dark:hover:bg-red-600'\n                    : 'text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300'\n                } disabled:opacity-50 disabled:cursor-not-allowed`}\n                title={confirmDelete ? 'Lschen besttigen' : 'Client lschen'}\n              >\n                {confirmDelete ? (\n                  <CheckIcon className=\"h-5 w-5\" />\n                ) : (\n                  <TrashIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n\n              <div className=\"flex gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors\"\n                  title={t('common.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n                  title={loading ? 'Speichere...' : 'Speichern'}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default EditClientModal;\n\n","import React, { useState, useEffect } from 'react';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { MagnifyingGlassIcon, XMarkIcon, PlusIcon, PencilIcon, TrashIcon } from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\nimport axiosInstance from '../config/axios.ts';\r\nimport { Client } from '../types/client.ts';\r\nimport { toast } from 'react-toastify';\r\nimport * as clientApi from '../api/clientApi.ts';\r\nimport EditClientModal from './EditClientModal.tsx';\r\n\r\ninterface ClientSelectModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onSelect: (client: Client) => void;\r\n  onCreateNew: () => void;\r\n}\r\n\r\nconst ClientSelectModal: React.FC<ClientSelectModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  onSelect,\r\n  onCreateNew\r\n}) => {\r\n  const [clients, setClients] = useState<Client[]>([]);\r\n  const [filteredClients, setFilteredClients] = useState<Client[]>([]);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n  const [editingClient, setEditingClient] = useState<Client | null>(null);\r\n  const [isEditModalOpen, setIsEditModalOpen] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      loadClients();\r\n    }\r\n  }, [isOpen]);\r\n\r\n  useEffect(() => {\r\n    if (searchTerm) {\r\n      const filtered = clients.filter(client => \r\n        client.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n        (client.company && client.company.toLowerCase().includes(searchTerm.toLowerCase())) ||\r\n        (client.email && client.email.toLowerCase().includes(searchTerm.toLowerCase()))\r\n      );\r\n      setFilteredClients(filtered);\r\n    } else {\r\n      setFilteredClients(clients);\r\n    }\r\n  }, [searchTerm, clients]);\r\n\r\n  const loadClients = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await axiosInstance.get(API_ENDPOINTS.CLIENTS.BASE);\r\n      setClients(response.data);\r\n      setFilteredClients(response.data);\r\n    } catch (error) {\r\n      // Stille Behandlung - Fehler wird im UI durch leere Liste sichtbar\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleEdit = (client: Client, e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    setEditingClient(client);\r\n    setIsEditModalOpen(true);\r\n  };\r\n\r\n  const handleDelete = async (client: Client, e: React.MouseEvent) => {\r\n    e.stopPropagation();\r\n    \r\n    if (!window.confirm(`Mchten Sie den Client \"${client.name}\" wirklich lschen?`)) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await clientApi.deleteClient(client.id);\r\n      toast.success('Client erfolgreich gelscht');\r\n      loadClients(); // Liste neu laden\r\n    } catch (error: any) {\r\n      toast.error(error.response?.data?.message || 'Fehler beim Lschen des Clients');\r\n    }\r\n  };\r\n\r\n  const handleClientUpdated = (updatedClient: Client) => {\r\n    // Aktualisiere lokale Liste\r\n    const index = clients.findIndex(c => c.id === updatedClient.id);\r\n    if (index !== -1) {\r\n      const newClients = [...clients];\r\n      newClients[index] = updatedClient;\r\n      setClients(newClients);\r\n      setFilteredClients(newClients);\r\n    }\r\n    setIsEditModalOpen(false);\r\n    setEditingClient(null);\r\n  };\r\n\r\n  return (\r\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n      <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n      \r\n      <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n        <Dialog.Panel className=\"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n          <div className=\"p-6\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <Dialog.Title className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                Client auswhlen\r\n              </Dialog.Title>\r\n              <button\r\n                onClick={onClose}\r\n                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\r\n              >\r\n                <XMarkIcon className=\"h-6 w-6\" />\r\n              </button>\r\n            </div>\r\n\r\n            {/* Suchfeld */}\r\n            <div className=\"relative mb-4\">\r\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                <MagnifyingGlassIcon className=\"h-5 w-5 text-gray-400\" />\r\n              </div>\r\n              <input\r\n                type=\"text\"\r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                className=\"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md leading-5 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm\"\r\n                placeholder=\"Client suchen...\"\r\n                autoFocus\r\n              />\r\n            </div>\r\n\r\n            {/* Client-Liste */}\r\n            <div className=\"max-h-96 overflow-y-auto\">\r\n              {loading ? (\r\n                <div className=\"text-center py-4 text-gray-500 dark:text-gray-400\">\r\n                  Lade Clients...\r\n                </div>\r\n              ) : filteredClients.length === 0 ? (\r\n                <div className=\"text-center py-8\">\r\n                  <p className=\"text-gray-500 dark:text-gray-400 mb-4\">\r\n                    {searchTerm ? 'Keine Clients gefunden' : 'Noch keine Clients vorhanden'}\r\n                  </p>\r\n                  <button\r\n                    onClick={onCreateNew}\r\n                    className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n                  >\r\n                    <PlusIcon className=\"h-5 w-5 mr-2\" />\r\n                    Neuen Client anlegen\r\n                  </button>\r\n                </div>\r\n              ) : (\r\n                <ul className=\"divide-y divide-gray-200 dark:divide-gray-700\">\r\n                  {filteredClients.map((client) => (\r\n                    <li key={client.id}>\r\n                      <div className=\"flex items-center\">\r\n                        <button\r\n                          onClick={() => onSelect(client)}\r\n                          className=\"flex-1 px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-700 text-left transition-colors\"\r\n                        >\r\n                          <div>\r\n                            <p className=\"text-sm font-medium text-gray-900 dark:text-white\">\r\n                              {client.name}\r\n                            </p>\r\n                            {client.company && (\r\n                              <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                                {client.company}\r\n                              </p>\r\n                            )}\r\n                            {client.email && (\r\n                              <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                                {client.email}\r\n                              </p>\r\n                            )}\r\n                          </div>\r\n                        </button>\r\n                        <div className=\"flex items-center space-x-2 px-2\">\r\n                          <button\r\n                            onClick={(e) => handleEdit(client, e)}\r\n                            className=\"p-2 text-gray-600 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors\"\r\n                            title=\"Client bearbeiten\"\r\n                          >\r\n                            <PencilIcon className=\"h-5 w-5\" />\r\n                          </button>\r\n                          <button\r\n                            onClick={(e) => handleDelete(client, e)}\r\n                            className=\"p-2 text-gray-600 dark:text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors\"\r\n                            title=\"Client lschen\"\r\n                          >\r\n                            <TrashIcon className=\"h-5 w-5\" />\r\n                          </button>\r\n                        </div>\r\n                      </div>\r\n                    </li>\r\n                  ))}\r\n                </ul>\r\n              )}\r\n            </div>\r\n\r\n            {/* Footer mit \"Neuer Client\" Button */}\r\n            {filteredClients.length > 0 && (\r\n              <div className=\"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700\">\r\n                <button\r\n                  onClick={onCreateNew}\r\n                  className=\"w-full inline-flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\r\n                >\r\n                  <PlusIcon className=\"h-5 w-5 mr-2\" />\r\n                  Neuen Client anlegen\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </Dialog.Panel>\r\n      </div>\r\n\r\n      {/* Edit Modal */}\r\n      {editingClient && (\r\n        <EditClientModal\r\n          isOpen={isEditModalOpen}\r\n          onClose={() => {\r\n            setIsEditModalOpen(false);\r\n            setEditingClient(null);\r\n          }}\r\n          onClientUpdated={handleClientUpdated}\r\n          onClientDeleted={(clientId) => {\r\n            // Ldt Liste neu nach Lschung\r\n            loadClients();\r\n            setIsEditModalOpen(false);\r\n            setEditingClient(null);\r\n          }}\r\n          client={editingClient}\r\n        />\r\n      )}\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default ClientSelectModal; ","import React, { useState, useEffect } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { Client } from '../types/client.ts';\nimport { toast } from 'react-toastify';\nimport { useSidepane } from '../contexts/SidepaneContext.tsx';\n\ninterface CreateClientModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSave: (client: Client) => void;\n}\n\nconst CreateClientModal: React.FC<CreateClientModalProps> = ({\n  isOpen,\n  onClose,\n  onSave\n}) => {\n  const { t } = useTranslation();\n  const { openSidepane, closeSidepane } = useSidepane();\n  const [isLargeScreen, setIsLargeScreen] = useState(window.innerWidth > 1070);\n  const [formData, setFormData] = useState({\n    name: '',\n    company: '',\n    email: '',\n    phone: '',\n    address: '',\n    notes: ''\n  });\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [loading, setLoading] = useState(false);\n  const [isMobile, setIsMobile] = useState(window.innerWidth < 640);\n\n  const validateForm = () => {\n    const newErrors: Record<string, string> = {};\n    \n    if (!formData.name.trim()) {\n      newErrors.name = 'Name ist erforderlich';\n    }\n    \n    if (formData.email && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(formData.email)) {\n      newErrors.email = 'Ungltige E-Mail-Adresse';\n    }\n    \n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!validateForm()) return;\n    \n    try {\n      setLoading(true);\n      const response = await axiosInstance.post(API_ENDPOINTS.CLIENTS.BASE, {\n        ...formData,\n        company: formData.company || null,\n        email: formData.email || null,\n        phone: formData.phone || null,\n        address: formData.address || null,\n        notes: formData.notes || null\n      });\n      \n      toast.success('Client erfolgreich angelegt');\n      onSave(response.data);\n      \n      // Form zurcksetzen\n      setFormData({\n        name: '',\n        company: '',\n        email: '',\n        phone: '',\n        address: '',\n        notes: ''\n      });\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || 'Fehler beim Anlegen des Clients');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // berprfung der Bildschirmgre\n  useEffect(() => {\n    const checkScreenSize = () => {\n      setIsMobile(window.innerWidth < 640);\n      setIsLargeScreen(window.innerWidth > 1070);\n    };\n    \n    // Initial prfen\n    checkScreenSize();\n    \n    // Event-Listener fr Grennderungen\n    window.addEventListener('resize', checkScreenSize);\n    \n    // Cleanup\n    return () => {\n      window.removeEventListener('resize', checkScreenSize);\n    };\n  }, []);\n\n  // Sidepane-Status verwalten\n  useEffect(() => {\n    if (isOpen) {\n      openSidepane();\n    } else {\n      closeSidepane();\n    }\n    \n    return () => {\n      closeSidepane();\n    };\n  }, [isOpen, openSidepane, closeSidepane]);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n    // Fehler fr dieses Feld lschen\n    if (errors[name]) {\n      setErrors(prev => ({ ...prev, [name]: '' }));\n    }\n  };\n\n  const handleClose = () => {\n    // Form zurcksetzen\n    setFormData({\n      name: '',\n      company: '',\n      email: '',\n      phone: '',\n      address: '',\n      notes: ''\n    });\n    setErrors({});\n    onClose();\n  };\n\n  // Fr Mobile (unter 640px) - klassisches Modal\n  if (isMobile) {\n    return (\n      <Dialog open={isOpen} onClose={handleClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700\">\n              <Dialog.Title className=\"text-lg font-semibold dark:text-white\">\n                Neuen Client anlegen\n              </Dialog.Title>\n              <button\n                onClick={handleClose}\n                className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n              >\n                <XMarkIcon className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            <form onSubmit={handleSubmit} className=\"p-4\">\n              <div className=\"space-y-4\">\n                {/* Name */}\n                <div>\n                  <label htmlFor=\"name_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Name *\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"name_mobile\"\n                    name=\"name\"\n                    value={formData.name}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                      errors.name \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.name && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n                  )}\n                </div>\n\n                {/* Firma */}\n                <div>\n                  <label htmlFor=\"company_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Firma\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"company_mobile\"\n                    name=\"company\"\n                    value={formData.company}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* E-Mail */}\n                <div>\n                  <label htmlFor=\"email_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    E-Mail\n                  </label>\n                  <input\n                    type=\"email\"\n                    id=\"email_mobile\"\n                    name=\"email\"\n                    value={formData.email}\n                    onChange={handleChange}\n                    className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                      errors.email \n                        ? 'border-red-300 dark:border-red-600' \n                        : 'border-gray-300 dark:border-gray-600'\n                    }`}\n                  />\n                  {errors.email && (\n                    <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.email}</p>\n                  )}\n                </div>\n\n                {/* Telefon */}\n                <div>\n                  <label htmlFor=\"phone_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Telefon\n                  </label>\n                  <input\n                    type=\"tel\"\n                    id=\"phone_mobile\"\n                    name=\"phone\"\n                    value={formData.phone}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* Adresse */}\n                <div>\n                  <label htmlFor=\"address_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Adresse\n                  </label>\n                  <input\n                    type=\"text\"\n                    id=\"address_mobile\"\n                    name=\"address\"\n                    value={formData.address}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                {/* Notizen */}\n                <div>\n                  <label htmlFor=\"notes_mobile\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                    Notizen\n                  </label>\n                  <textarea\n                    id=\"notes_mobile\"\n                    name=\"notes\"\n                    rows={3}\n                    value={formData.notes}\n                    onChange={handleChange}\n                    className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n              </div>\n\n              {/* Buttons */}\n              <div className=\"flex justify-end pt-4 gap-2\">\n                <button\n                  type=\"button\"\n                  onClick={handleClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('common.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? 'Speichere...' : 'Speichern'}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <CheckIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  // Fr Desktop (ab 640px) - Sidepane\n  // WICHTIG: Sidepane muss IMMER gerendert bleiben fr Transition\n  return (\n    <>\n      {/* Backdrop - nur wenn offen und <= 1070px */}\n      {isOpen && !isLargeScreen && (\n        <div \n          className=\"fixed inset-0 bg-black/10 transition-opacity sidepane-overlay sidepane-backdrop z-40\" \n          aria-hidden=\"true\" \n          onClick={handleClose}\n          style={{\n            opacity: isOpen ? 1 : 0,\n            transition: 'opacity 300ms ease-out'\n          }}\n        />\n      )}\n      \n      {/* Sidepane - IMMER gerendert, Position wird via Transform gendert */}\n      <div \n        className={`fixed top-16 bottom-0 right-0 max-w-sm w-full bg-white dark:bg-gray-800 shadow-xl sidepane-panel sidepane-panel-container transform z-50 flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`}\n        style={{\n          transition: 'transform 350ms cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n          pointerEvents: isOpen ? 'auto' : 'none'\n        }}\n        aria-hidden={!isOpen}\n        role=\"dialog\"\n        aria-modal={isOpen}\n      >\n        <div className=\"flex items-center justify-between p-4 border-b dark:border-gray-700 flex-shrink-0\">\n          <h2 className=\"text-lg font-semibold dark:text-white\">\n            Neuen Client anlegen\n          </h2>\n          <button\n            onClick={handleClose}\n            className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300\"\n          >\n            <XMarkIcon className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <div className=\"p-4 overflow-y-auto flex-1 min-h-0\">\n          {Object.keys(errors).length > 0 && (\n            <div className=\"mb-4 p-2 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300 rounded\">\n              {Object.values(errors).map((error, idx) => (\n                <p key={idx}>{error}</p>\n              ))}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\n            {/* Name */}\n            <div>\n              <label htmlFor=\"name\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Name *\n              </label>\n              <input\n                type=\"text\"\n                id=\"name\"\n                name=\"name\"\n                value={formData.name}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                  errors.name \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.name && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.name}</p>\n              )}\n            </div>\n\n            {/* Firma */}\n            <div>\n              <label htmlFor=\"company\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Firma\n              </label>\n              <input\n                type=\"text\"\n                id=\"company\"\n                name=\"company\"\n                value={formData.company}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* E-Mail */}\n            <div>\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                E-Mail\n              </label>\n              <input\n                type=\"email\"\n                id=\"email\"\n                name=\"email\"\n                value={formData.email}\n                onChange={handleChange}\n                className={`mt-1 block w-full rounded-md border shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white ${\n                  errors.email \n                    ? 'border-red-300 dark:border-red-600' \n                    : 'border-gray-300 dark:border-gray-600'\n                }`}\n              />\n              {errors.email && (\n                <p className=\"mt-1 text-sm text-red-600 dark:text-red-400\">{errors.email}</p>\n              )}\n            </div>\n\n            {/* Telefon */}\n            <div>\n              <label htmlFor=\"phone\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Telefon\n              </label>\n              <input\n                type=\"tel\"\n                id=\"phone\"\n                name=\"phone\"\n                value={formData.phone}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* Adresse */}\n            <div>\n              <label htmlFor=\"address\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Adresse\n              </label>\n              <input\n                type=\"text\"\n                id=\"address\"\n                name=\"address\"\n                value={formData.address}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* Notizen */}\n            <div>\n              <label htmlFor=\"notes\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Notizen\n              </label>\n              <textarea\n                id=\"notes\"\n                name=\"notes\"\n                rows={3}\n                value={formData.notes}\n                onChange={handleChange}\n                className=\"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n              />\n            </div>\n\n            {/* Buttons */}\n            <div className=\"flex justify-end pt-4 gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleClose}\n                className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                title={t('common.cancel')}\n              >\n                <XMarkIcon className=\"h-5 w-5\" />\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                title={loading ? 'Speichere...' : 'Speichern'}\n              >\n                {loading ? (\n                  <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                ) : (\n                  <CheckIcon className=\"h-5 w-5\" />\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default CreateClientModal; ","import axiosInstance from '../config/axios.ts';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\n\r\n/**\r\n * API-Funktionen fr das Consultation-Modul\r\n */\r\n\r\nexport interface StartConsultationData {\r\n  branchId: number;\r\n  clientId: number;\r\n  notes?: string;\r\n  startTime?: string;\r\n}\r\n\r\nexport interface StopConsultationData {\r\n  endTime?: string;\r\n  notes?: string;\r\n}\r\n\r\nexport interface UpdateNotesData {\r\n  notes: string;\r\n}\r\n\r\nexport interface LinkTaskData {\r\n  taskId: number;\r\n}\r\n\r\nexport interface CreateTaskData {\r\n  title: string;\r\n  description: string;\r\n  dueDate?: string;\r\n  branchId: number;\r\n  qualityControlId?: number;\r\n}\r\n\r\nexport interface UpdateTimeData {\r\n  startTime?: string;\r\n  endTime?: string;\r\n}\r\n\r\n/**\r\n * Startet eine neue Beratung\r\n * @param data Beratungsdaten (branchId, clientId, notes, startTime)\r\n * @returns Die erstellte Beratung\r\n */\r\nexport const startConsultation = async (data: StartConsultationData) => {\r\n  try {\r\n    const response = await axiosInstance.post(API_ENDPOINTS.CONSULTATIONS.START, data);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Starten der Beratung:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Stoppt eine laufende Beratung\r\n * @param data Stopp-Daten (endTime, notes)\r\n * @returns Die aktualisierte Beratung\r\n */\r\nexport const stopConsultation = async (data: StopConsultationData) => {\r\n  try {\r\n    const response = await axiosInstance.post(API_ENDPOINTS.CONSULTATIONS.STOP, data);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Stoppen der Beratung:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Holt alle Beratungen des aktuellen Benutzers\r\n * @param clientId Optionale Client-ID zum Filtern\r\n * @param from Optionales Start-Datum\r\n * @param to Optionales End-Datum\r\n * @returns Liste der Beratungen\r\n */\r\nexport const getConsultations = async (clientId?: number, from?: string, to?: string) => {\r\n  try {\r\n    const params = new URLSearchParams();\r\n    if (clientId) params.append('clientId', clientId.toString());\r\n    if (from) params.append('from', from);\r\n    if (to) params.append('to', to);\r\n    \r\n    const url = params.toString() \r\n      ? `${API_ENDPOINTS.CONSULTATIONS.BASE}?${params}`\r\n      : API_ENDPOINTS.CONSULTATIONS.BASE;\r\n      \r\n    const response = await axiosInstance.get(url);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Laden der Beratungen:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Aktualisiert die Notizen einer Beratung\r\n * @param consultationId ID der Beratung\r\n * @param data Notizen-Daten\r\n * @returns Die aktualisierte Beratung\r\n */\r\nexport const updateConsultationNotes = async (consultationId: number, data: UpdateNotesData) => {\r\n  try {\r\n    const response = await axiosInstance.patch(\r\n      API_ENDPOINTS.CONSULTATIONS.UPDATE_NOTES(consultationId), \r\n      data\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Aktualisieren der Notizen:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Verknpft einen Task mit einer Beratung\r\n * @param consultationId ID der Beratung\r\n * @param data Task-Verknpfungsdaten\r\n * @returns Status der Verknpfung\r\n */\r\nexport const linkTaskToConsultation = async (consultationId: number, data: LinkTaskData) => {\r\n  try {\r\n    const response = await axiosInstance.post(\r\n      API_ENDPOINTS.CONSULTATIONS.LINK_TASK(consultationId), \r\n      data\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Verknpfen des Tasks:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Erstellt einen neuen Task fr eine Beratung\r\n * @param consultationId ID der Beratung\r\n * @param data Task-Erstellungsdaten\r\n * @returns Der erstellte Task\r\n */\r\nexport const createTaskForConsultation = async (consultationId: number, data: CreateTaskData) => {\r\n  try {\r\n    const response = await axiosInstance.post(\r\n      API_ENDPOINTS.CONSULTATIONS.CREATE_TASK(consultationId), \r\n      data\r\n    );\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Erstellen des Tasks:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Lscht eine Beratung\r\n * @param consultationId ID der Beratung\r\n * @returns Status der Lschoperation\r\n */\r\nexport const deleteConsultation = async (consultationId: number) => {\r\n  try {\r\n    const response = await axiosInstance.delete(API_ENDPOINTS.CONSULTATIONS.BY_ID(consultationId));\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Lschen der Beratung:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n/**\r\n * Aktualisiert die Start- oder Endzeit einer Beratung\r\n * @param consultationId ID der Beratung\r\n * @param data Zeit-Update-Daten (startTime oder endTime)\r\n * @returns Die aktualisierte Beratung\r\n */\r\nexport const updateConsultationTime = async (consultationId: number, data: UpdateTimeData) => {\r\n  try {\r\n    /* KONSISTENTE API-BEHANDLUNG:\r\n     * Diese Funktion kapselt die Zeit-Update-Logik und macht sie testbar und wartbar.\r\n     * Verwendet den WorkTime-Endpoint, da Consultations erweiterte WorkTime-Eintrge sind.\r\n     */\r\n    const response = await axiosInstance.put(`${API_ENDPOINTS.WORKTIME.BASE}/${consultationId}`, data);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error('Fehler beim Aktualisieren der Zeit:', error);\r\n    throw error;\r\n  }\r\n}; ","import React, { useState, useEffect, useRef, useLayoutEffect, useCallback, useMemo } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { PlayIcon, StopIcon, PlusIcon, ClockIcon, UserGroupIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { formatTime, calculateDuration } from '../utils/dateUtils.ts';\nimport { useAuth } from '../hooks/useAuth.tsx';\nimport { useBranch } from '../contexts/BranchContext.tsx';\nimport { toast } from 'react-toastify';\nimport ClientSelectModal from './ClientSelectModal.tsx';\nimport CreateClientModal from './CreateClientModal.tsx';\nimport { Client, Consultation } from '../types/client.ts';\nimport * as consultationApi from '../api/consultationApi.ts';\nimport * as clientApi from '../api/clientApi.ts';\n\n// Union-Type fr Client und Placeholder\ntype ClientOrPlaceholder = Client | {\n  id: string;\n  name: string;\n  isPlaceholder: boolean;\n  status?: 'past' | 'planned';\n  lastConsultationDate?: string;\n};\n\n// Type Guard fr Placeholder\nconst isPlaceholder = (client: ClientOrPlaceholder): client is { id: string; name: string; isPlaceholder: boolean; status?: 'past' | 'planned'; lastConsultationDate?: string; } => {\n  return 'isPlaceholder' in client && client.isPlaceholder === true;\n};\n\ninterface ConsultationTrackerProps {\n  onConsultationChange: () => void;\n  onConsultationStarted?: (clientName: string) => void;\n}\n\nconst ConsultationTracker: React.FC<ConsultationTrackerProps> = ({ onConsultationChange, onConsultationStarted }) => {\n  const { t } = useTranslation();\n  const { user } = useAuth();\n  const { selectedBranch } = useBranch();\n  const [activeConsultation, setActiveConsultation] = useState<Consultation | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [isStarting, setIsStarting] = useState(false);\n  const [isClientSelectModalOpen, setIsClientSelectModalOpen] = useState(false);\n  const [isCreateClientModalOpen, setIsCreateClientModalOpen] = useState(false);\n  const [selectedClient, setSelectedClient] = useState<Client | null>(null);\n  const [recentClients, setRecentClients] = useState<Client[]>([]);\n  const [notes, setNotes] = useState('');\n  const [lastStartedClientId, setLastStartedClientId] = useState<number | null>(null);\n  \n  // Responsive Tag-Display States (optimiert)\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [visibleTagCount, setVisibleTagCount] = useState(3); // Fallback fr SSR\n  const [containerWidth, setContainerWidth] = useState(0);\n  const resizeTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n  // Manuelle Erfassung States\n  const [isManualEntry, setIsManualEntry] = useState(false);\n  const [manualStartTime, setManualStartTime] = useState('');\n  const [manualEndTime, setManualEndTime] = useState('');\n\n  useEffect(() => {\n    checkActiveConsultation();\n    loadRecentClients();\n  }, []);\n\n  const checkActiveConsultation = async () => {\n    try {\n      const response = await axiosInstance.get(API_ENDPOINTS.WORKTIME.ACTIVE);\n      if (response.data && response.data.clientId) {\n        setActiveConsultation(response.data);\n        setNotes(response.data.notes || '');\n      }\n    } catch (error) {\n      // Stille Behandlung - normale Situation wenn keine aktive Beratung luft\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadRecentClients = async () => {\n    try {\n      console.log('=== FRONTEND: loadRecentClients() called ===');\n      const clients = await clientApi.getRecentClients();\n      console.log('=== FRONTEND: received clients:', clients);\n      setRecentClients(clients || []);\n    } catch (error) {\n      console.error('=== FRONTEND: loadRecentClients() ERROR ===', error);\n      // Stille Behandlung - normale Situation wenn noch keine Clients beraten wurden\n    }\n  };\n\n  const handleStartConsultation = async (clientId: number, notes?: string) => {\n    if (!selectedBranch) {\n      toast.error(t('consultations.selectBranch'));\n      return;\n    }\n\n    try {\n      setIsStarting(true);\n      \n      // Zeitzone-korrigierte aktuelle Zeit (gleiche Logik wie bei stopConsultation)\n      const correctedStartTime = new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000);\n      \n      const consultation = await consultationApi.startConsultation({\n        branchId: selectedBranch,\n        clientId,\n        notes: notes || '',\n        startTime: correctedStartTime.toISOString()\n      });\n\n      setActiveConsultation(consultation);\n      setNotes(notes || '');\n      setSelectedClient(null);\n      setIsClientSelectModalOpen(false);\n      \n      // Speichere den zuletzt gestarteten Client fr Tag-Priorisierung\n      setLastStartedClientId(clientId);\n      \n      // Sende Event fr SavedFilterTags Aktualisierung\n      window.dispatchEvent(new CustomEvent('consultationChanged'));\n      \n      // Entfernt: Frontend LRU-Logic - Backend sortiert bereits korrekt nach startTime DESC\n      // Lade Recent Clients neu vom Server (Backend liefert bereits richtige Sortierung)\n      loadRecentClients();\n      \n      // Callback fr Parent-Komponente - bergebe die neue Consultation\n      onConsultationChange?.(consultation);\n      \n      // Callback fr Filter-Wechsel (wenn Client-Name verfgbar)\n      if (onConsultationStarted && consultation.client?.name) {\n        onConsultationStarted(consultation.client.name);\n      }\n      \n      toast.success(t('consultations.started'));\n    } catch (error) {\n      console.error('Fehler beim Starten der Beratung:', error);\n      toast.error(t('consultations.startError'));\n    } finally {\n      setIsStarting(false);\n    }\n  };\n\n  const stopConsultation = async () => {\n    try {\n      const correctedEndTime = new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000);\n      \n      const stoppedConsultation = await consultationApi.stopConsultation({\n        endTime: correctedEndTime.toISOString(),\n        notes: notes || undefined\n      });\n      setActiveConsultation(null);\n      setNotes('');\n      toast.success(t('consultations.stopped'));\n      // Recent Clients nach dem Stoppen aktualisieren\n      loadRecentClients();\n      // Beratungsliste aktualisieren - bergebe die aktualisierte Consultation\n      onConsultationChange?.(stoppedConsultation);\n      // Sende Event fr SavedFilterTags Aktualisierung\n      console.log(' ConsultationTracker: Sending consultationChanged event (stop)');\n      window.dispatchEvent(new CustomEvent('consultationChanged'));\n    } catch (error: any) {\n      toast.error(error.response?.data?.message || t('consultations.stopError'));\n    }\n  };\n\n  const handleClientSelect = (client: Client) => {\n    setSelectedClient(client);\n    setIsClientSelectModalOpen(false);\n    if (!isManualEntry) {\n      handleStartConsultation(client.id, notes);\n    }\n  };\n\n  const handleCreateClient = () => {\n    setIsClientSelectModalOpen(false);\n    setIsCreateClientModalOpen(true);\n  };\n\n  const handleClientCreated = (client: Client) => {\n    setIsCreateClientModalOpen(false);\n    setSelectedClient(client);\n    // Entfernt: Automatischer Beratungsstart nach Client-Erstellung\n    // Client wird nur gespeichert, Beratung muss manuell gestartet werden\n    \n    // Recent Clients neu laden um den neuen Client anzuzeigen\n    loadRecentClients();\n    \n    // Success-Toast fr Client-Erstellung (wird bereits im Modal angezeigt)\n    // toast.success(`Client \"${client.name}\" wurde angelegt`);\n  };\n\n  /* CLAUDE-ANCHOR: CONSULTATION-MANUAL-SAVE-001 - Timezone-sichere manuelle Beratungserfassung */\n  const handleManualSave = async () => {\n    if (!selectedClient) {\n      toast.error('Bitte whlen Sie einen Client aus');\n      return;\n    }\n    if (!manualStartTime || !manualEndTime) {\n      toast.error('Bitte geben Sie Start- und Endzeit an');\n      return;\n    }\n    if (!selectedBranch) {\n      toast.error(t('consultations.selectBranch'));\n      return;\n    }\n\n    try {\n      setIsStarting(true);\n      \n      /* KRITISCHE TIMEZONE-BEHANDLUNG:\n       * Problem: Inkonsistenz zwischen normaler und manueller Beratung!\n       * \n       * NORMAL WORKING ():\n       * const correctedTime = new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000);\n       * \n       * MANUAL BROKEN ():\n       * convertDatetimeLocalToApi() fhrt zu 5h Versatz\n       * \n       * LSUNG: Gleiche getTimezoneOffset-Logik fr beide verwenden!\n       * \n       * datetime-local Input: \"2024-01-15T14:01\"\n       *  new Date(\"2024-01-15T14:01\") erstellt lokales Date-Objekt\n       *  getTimezoneOffset() korrigiert zur gleichen Zeit wie bei normaler Beratung\n       *  KONSISTENTE Zeitbehandlung!\n       */\n      \n      //  KORRIGIERT: Verwende gleiche Logik wie bei normalem Start/Stop\n      const manualStart = new Date(manualStartTime);\n      const correctedStartTime = new Date(manualStart.getTime() - manualStart.getTimezoneOffset() * 60000);\n      \n      const manualEnd = new Date(manualEndTime);\n      const correctedEndTime = new Date(manualEnd.getTime() - manualEnd.getTimezoneOffset() * 60000);\n      \n      // Starte die Beratung mit der korrigierten Startzeit\n      const consultation = await consultationApi.startConsultation({\n        branchId: selectedBranch,\n        clientId: selectedClient.id,\n        notes: notes || '',\n        startTime: correctedStartTime.toISOString()  //  Konsistent mit normaler Beratung\n      });\n      \n      // Beende sie sofort mit der korrigierten Endzeit\n      const stoppedConsultation = await consultationApi.stopConsultation({\n        endTime: correctedEndTime.toISOString(),      //  Konsistent mit normaler Beratung\n        notes: notes || ''\n      });\n      \n      // Reset der Eingaben\n      setIsManualEntry(false);\n      setManualStartTime('');\n      setManualEndTime('');\n      setNotes('');\n      setSelectedClient(null);\n      \n      // Speichere den zuletzt gestarteten Client fr Tag-Priorisierung\n      setLastStartedClientId(selectedClient.id);\n      \n      // Sende Event fr SavedFilterTags Aktualisierung\n      console.log(' ConsultationTracker: Sending consultationChanged event (start)');\n      window.dispatchEvent(new CustomEvent('consultationChanged'));\n      \n      // Lade Recent Clients neu\n      loadRecentClients();\n      \n      // Callback fr Parent-Komponente - bergebe die beendete Consultation\n      onConsultationChange?.(stoppedConsultation);\n      \n      // Callback fr Filter-Wechsel\n      if (onConsultationStarted && selectedClient.name) {\n        onConsultationStarted(selectedClient.name);\n      }\n      \n      toast.success(t('consultations.manualSaveSuccess'));\n    } catch (error) {\n      console.error('Fehler beim Erfassen der Beratung:', error);\n      toast.error(t('consultations.manualSaveError'));\n    } finally {\n      setIsStarting(false);\n    }\n  };\n\n  const updateNotes = async () => {\n    if (!activeConsultation) return;\n    \n    try {\n      await consultationApi.updateConsultationNotes(activeConsultation.id, { notes });\n    } catch (error) {\n      // Stille Behandlung - Auto-Save sollte nicht strend sein\n    }\n  };\n\n  // Auto-save Notizen alle 30 Sekunden\n  useEffect(() => {\n    if (!activeConsultation || !notes) return;\n    \n    const timeout = setTimeout(() => {\n      updateNotes();\n    }, 30000);\n    \n    return () => clearTimeout(timeout);\n  }, [notes, activeConsultation]);\n\n  // Recent Clients aktualisieren wenn Fenster wieder fokussiert wird\n  useEffect(() => {\n    const handleFocus = () => {\n      loadRecentClients();\n    };\n\n    window.addEventListener('focus', handleFocus);\n    \n    return () => {\n      window.removeEventListener('focus', handleFocus);\n    };\n  }, []);\n\n  // Optimierte Tag-Breiten-Berechnung mit useMemo\n  const averageTagWidth = useMemo(() => {\n    if (recentClients.length === 0) return 85; // Reduzierter Fallback\n    \n    return recentClients.reduce((sum, client) => {\n      // Przisere Schtzung: ~6px pro Zeichen + 24px Padding\n      return sum + (client.name.length * 6 + 24);\n    }, 0) / recentClients.length;\n  }, [recentClients]);\n\n  // Optimierte Sichtbarkeits-Berechnung mit useCallback (vereinfacht ohne Dropdown)\n  const calculateVisibleTags = useCallback(() => {\n    if (!containerRef.current || recentClients.length === 0) return;\n\n    const container = containerRef.current;\n    const currentWidth = container.clientWidth;\n    \n    // Nur neu berechnen wenn sich die Breite signifikant gendert hat (>= 40px)\n    if (Math.abs(currentWidth - containerWidth) < 40) return;\n    \n    setContainerWidth(currentWidth);\n    \n    // Moderate responsive Abstnde fr bessere Tag-Anzeige\n    const isMobile = currentWidth < 768; // md breakpoint\n    const PLUS_BUTTON_WIDTH = 32; // Reduziert von 42\n    const GAPS_AND_MARGINS = isMobile ? 8 : 20; // Mobile: 8px, Desktop: 20px (weniger extrem)\n    const BUFFER = 12; // Reduziert von 16\n    \n    const availableWidth = currentWidth - PLUS_BUTTON_WIDTH - GAPS_AND_MARGINS - BUFFER;\n    \n    // Berechne maximal mgliche Tags (einfach soviele wie reinpassen)\n    const maxPossibleTags = Math.max(1, Math.floor(availableWidth / averageTagWidth));\n    \n    // Zeige soviele Tags wie reinpassen, maximal aber die verfgbaren\n    setVisibleTagCount(Math.min(maxPossibleTags, recentClients.length));\n  }, [recentClients, averageTagWidth, containerWidth]);\n\n  // Debounced ResizeObserver fr bessere Performance\n  const handleResize = useCallback(() => {\n    if (resizeTimeoutRef.current) {\n      clearTimeout(resizeTimeoutRef.current);\n    }\n    \n    resizeTimeoutRef.current = setTimeout(() => {\n      calculateVisibleTags();\n    }, 150); // 150ms Debounce fr smooth responsive behavior\n  }, [calculateVisibleTags]);\n\n  // Optimierter ResizeObserver\n  useEffect(() => {\n    if (!containerRef.current) return;\n\n    const resizeObserver = new ResizeObserver(handleResize);\n    resizeObserver.observe(containerRef.current);\n    \n    // Auch Window-Resize berwachen fr bessere Abdeckung\n    window.addEventListener('resize', handleResize);\n\n    return () => {\n      resizeObserver.disconnect();\n      window.removeEventListener('resize', handleResize);\n      if (resizeTimeoutRef.current) {\n        clearTimeout(resizeTimeoutRef.current);\n      }\n    };\n  }, [handleResize]);\n\n  // Initial calculation nach Client-nderungen\n  useLayoutEffect(() => {\n    calculateVisibleTags();\n  }, [calculateVisibleTags]);\n\n  // Optimistische Tag-Anzeige fr bessere UX\n  const showOptimisticTags = recentClients.length === 0 && loading;\n  const optimisticTags = useMemo(() => {\n    if (!showOptimisticTags) return [];\n    return Array(3).fill(null).map((_, i) => ({\n      id: `placeholder-${i}`,\n      name: '', // Placeholder\n      isPlaceholder: true,\n      status: undefined,\n      lastConsultationDate: undefined\n    }));\n  }, [showOptimisticTags]);\n\n  const displayTags = showOptimisticTags ? optimisticTags : recentClients;\n  const currentVisibleCount = showOptimisticTags ? optimisticTags.length : visibleTagCount;\n\n  // Sortiere displayTags: Zuletzt gestarteter Client zuerst\n  const sortedDisplayTags = useMemo(() => {\n    if (showOptimisticTags || !lastStartedClientId) {\n      return displayTags;\n    }\n    \n    // Finde den zuletzt gestarteten Client\n    const lastStartedClient = displayTags.find(client => client.id === lastStartedClientId);\n    if (!lastStartedClient) {\n      return displayTags;\n    }\n    \n    // Setze den zuletzt gestarteten Client an die erste Position\n    const otherClients = displayTags.filter(client => client.id !== lastStartedClientId);\n    return [lastStartedClient, ...otherClients];\n  }, [displayTags, lastStartedClientId, showOptimisticTags]);\n\n  if (loading) {\n    return (\n      <div className=\"bg-white dark:bg-gray-800 shadow-lg rounded-lg p-6\">\n        <div className=\"animate-pulse\">\n          <div className=\"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/4 mb-4\"></div>\n          <div className=\"h-12 bg-gray-200 dark:bg-gray-700 rounded mb-2\"></div>\n          <div className=\"h-12 bg-gray-200 dark:bg-gray-700 rounded\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h2 className=\"text-xl font-semibold text-gray-900 dark:text-white flex items-center pl-2 sm:pl-0\">\n            <UserGroupIcon className=\"h-6 w-6 mr-2 sm:h-6 sm:w-6 sm:mr-2\" />\n            {t('consultations.trackerTitle')}\n          </h2>\n          {activeConsultation && (\n            <div className=\"flex items-center text-green-600 dark:text-green-400\">\n              <ClockIcon className=\"h-5 w-5 mr-2 animate-pulse\" />\n              <span className=\"font-medium\">\n                {calculateDuration(activeConsultation.startTime, null)} - {activeConsultation.client?.name}\n              </span>\n            </div>\n          )}\n        </div>\n\n        {/* Aktive Beratung oder Start-Buttons */}\n        {activeConsultation ? (\n          <div className=\"space-y-4\">\n            <div className=\"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4\">\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\">{t('consultations.activeWith')}</p>\n              <p className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                {activeConsultation.client?.name}\n              </p>\n              <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\n                {t('consultations.startedAt')}: {formatTime(activeConsultation.startTime)}\n              </p>\n            </div>\n\n            {/* Notizen-Bereich */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                {t('consultations.notesForConsultation')}\n              </label>\n              <textarea\n                value={notes}\n                onChange={(e) => setNotes(e.target.value)}\n                onBlur={updateNotes}\n                className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:text-white\"\n                rows={3}\n                placeholder={t('consultations.notesPlaceholder')}\n              />\n            </div>\n\n            <button\n              onClick={stopConsultation}\n              className=\"w-full flex items-center justify-center px-4 py-3 border border-transparent text-base font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\"\n            >\n              <StopIcon className=\"h-5 w-5 mr-2\" />\n              {t('consultations.stop')}\n            </button>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {/* Zuletzt beratene Clients als Tags mit vereinfachtem responsive Layout (ohne Dropdown) */}\n            {(sortedDisplayTags.length > 0) && !isManualEntry && (\n              <div>\n                <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  {sortedDisplayTags.some(c => !isPlaceholder(c) && c.status === 'planned') ? \n                    t('consultations.recentAndPlanned') : \n                    t('consultations.recent')\n                  }\n                </p>\n                <div ref={containerRef} className=\"flex items-center gap-0.5 md:gap-6\">\n                  {/* Neuer Client Button - links positioniert mit extremen responsiven Abstnden */}\n                  <button\n                    onClick={() => setIsCreateClientModalOpen(true)}\n                    disabled={showOptimisticTags}\n                    className={`bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 p-1.5 rounded-full hover:bg-blue-50 dark:hover:bg-gray-600 border border-blue-200 dark:border-gray-600 shadow-sm flex items-center justify-center flex-shrink-0 ${showOptimisticTags ? 'opacity-50 cursor-not-allowed' : ''}`}\n                    style={{ width: '30.19px', height: '30.19px' }}\n                    title={t('consultations.createClient')}\n                    aria-label={t('consultations.createClient')}\n                  >\n                    <PlusIcon className=\"h-4 w-4\" />\n                  </button>\n                  \n                  {/* Soviele Client-Tags wie reinpassen (ohne Dropdown) */}\n                  <div className=\"flex items-center gap-2 flex-1 min-w-0\">\n                    {sortedDisplayTags.slice(0, currentVisibleCount).map((client, index) => {\n                      const isPast = !isPlaceholder(client) && client.status === 'past';\n                      const isPlanned = !isPlaceholder(client) && client.status === 'planned';\n                      \n                      return (\n                        <button\n                          key={client.id}\n                          onClick={() => !isPlaceholder(client) && handleStartConsultation(Number(client.id), notes)}\n                          disabled={isPlaceholder(client)}\n                          className={`inline-flex items-center px-3 py-2 rounded-full text-sm font-medium flex-shrink-0 transition-colors ${\n                            isPlaceholder(client) \n                              ? 'bg-gray-200 dark:bg-gray-600 text-gray-400 dark:text-gray-500 animate-pulse cursor-default'\n                              : isPlanned\n                                ? 'bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 hover:bg-blue-200 dark:hover:bg-blue-900/50 cursor-pointer border border-blue-200 dark:border-blue-700'\n                                : 'bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-200 dark:hover:bg-gray-600 cursor-pointer'\n                          }`}\n                          title={\n                            isPlaceholder(client) \n                              ? t('common.loading')\n                              : isPlanned\n                                ? t('consultations.plannedWith', { \n                                    clientName: client.name, \n                                    date: client.lastConsultationDate ? new Date(client.lastConsultationDate).toLocaleDateString('de-DE', { day: '2-digit', month: '2-digit', hour: '2-digit', minute: '2-digit' }) : ''\n                                  })\n                                : t('consultations.startWith', { \n                                    clientName: client.name,\n                                    date: client.lastConsultationDate ? new Date(client.lastConsultationDate).toLocaleDateString('de-DE') : ''\n                                  })\n                          }\n                        >\n                          {isPlanned && !isPlaceholder(client) && (\n                            <svg className=\"h-3 w-3 mr-1.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                              <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z\" clipRule=\"evenodd\"/>\n                            </svg>\n                          )}\n                          <span className=\"truncate max-w-[120px]\">\n                            {isPlaceholder(client) ? (\n                              <span className=\"inline-block w-16 h-4 bg-gray-300 dark:bg-gray-500 rounded animate-pulse\"></span>\n                            ) : (\n                              client.name\n                            )}\n                          </span>\n                        </button>\n                      );\n                    })}\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Start-Buttons */}\n            <div className=\"flex gap-6\">\n              <button\n                onClick={() => setIsClientSelectModalOpen(true)}\n                className=\"w-2/3 flex items-center justify-center px-4 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n                title={t('consultations.start')}\n              >\n                <PlayIcon className=\"h-5 w-5\" />\n              </button>\n\n              <button\n                onClick={() => {\n                  setIsManualEntry(!isManualEntry);\n                  setSelectedClient(null);\n                  setManualStartTime('');\n                  setManualEndTime('');\n                  setNotes('');\n                }}\n                className={`w-1/3 flex items-center justify-center px-4 py-3 border text-base font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${\n                  isManualEntry\n                    ? 'border-blue-500 text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20'\n                    : 'border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600'\n                }`}\n                title={t('consultations.plan')}\n              >\n                <ClockIcon className=\"h-5 w-5\" />\n              </button>\n            </div>\n\n            {/* Manuelle Erfassung / Planen */}\n            {isManualEntry && (\n              <div className=\"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 space-y-3\">\n                <h3 className=\"text-sm font-medium text-gray-900 dark:text-white mb-3\">\n                  {t('consultations.planConsultation')}\n                </h3>\n                \n                {/* Client-Auswahl */}\n                <div>\n                  <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('consultations.columns.client')}\n                  </label>\n                  {selectedClient ? (\n                    <div className=\"flex items-center justify-between bg-white dark:bg-gray-800 rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2\">\n                      <span className=\"text-sm text-gray-900 dark:text-white\">{selectedClient.name}</span>\n                      <button\n                        onClick={() => setIsClientSelectModalOpen(true)}\n                        className=\"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300\"\n                      >\n                        {t('consultations.change')}\n                      </button>\n                    </div>\n                  ) : (\n                    <button\n                      onClick={() => setIsClientSelectModalOpen(true)}\n                      className=\"w-full text-left bg-white dark:bg-gray-800 rounded-md border border-gray-300 dark:border-gray-600 px-3 py-2 text-sm text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700\"\n                    >\n                      {t('consultations.selectClientPlaceholder')}\n                    </button>\n                  )}\n                </div>\n\n                {/* Zeit-Inputs */}\n                <div className=\"grid grid-cols-2 gap-3\">\n                  <div>\n                    <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('consultations.columns.startTime')}\n                    </label>\n                    <input\n                      type=\"datetime-local\"\n                      value={manualStartTime}\n                      onChange={(e) => setManualStartTime(e.target.value)}\n                      className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                    />\n                  </div>\n                  <div>\n                    <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                      {t('consultations.columns.endTime')}\n                    </label>\n                    <input\n                      type=\"datetime-local\"\n                      value={manualEndTime}\n                      onChange={(e) => setManualEndTime(e.target.value)}\n                      className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                    />\n                  </div>\n                </div>\n\n                {/* Notizen */}\n                <div>\n                  <label className=\"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    {t('consultations.columns.notes')}\n                  </label>\n                  <textarea\n                    value={notes}\n                    onChange={(e) => setNotes(e.target.value)}\n                    className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm dark:bg-gray-700 dark:text-white\"\n                    rows={2}\n                    placeholder={t('consultations.optionalNotes')}\n                  />\n                </div>\n\n                {/* Speichern-Button */}\n                <div className=\"flex justify-end\">\n                  <button\n                    onClick={handleManualSave}\n                    disabled={!selectedClient || !manualStartTime || !manualEndTime}\n                    className=\"px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  >\n                    {t('consultations.saveConsultation')}\n                  </button>\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n\n      {/* Modals */}\n      <ClientSelectModal\n        isOpen={isClientSelectModalOpen}\n        onClose={() => setIsClientSelectModalOpen(false)}\n        onSelect={handleClientSelect}\n        onCreateNew={handleCreateClient}\n      />\n\n      <CreateClientModal\n        isOpen={isCreateClientModalOpen}\n        onClose={() => setIsCreateClientModalOpen(false)}\n        onSave={handleClientCreated}\n      />\n    </>\n  );\n};\n\nexport default ConsultationTracker; ","import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { XMarkIcon, MagnifyingGlassIcon } from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\nimport axiosInstance from '../config/axios.ts';\r\nimport { toast } from 'react-toastify';\r\n\r\ninterface Task {\r\n  id: number;\r\n  title: string;\r\n  status: string;\r\n  responsible?: {\r\n    firstName: string;\r\n    lastName: string;\r\n  };\r\n}\r\n\r\ninterface LinkTaskModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  consultationId: number;\r\n  onTaskLinked: () => void;\r\n}\r\n\r\nconst LinkTaskModal: React.FC<LinkTaskModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  consultationId,\r\n  onTaskLinked\r\n}) => {\r\n  const { t } = useTranslation();\r\n  const [tasks, setTasks] = useState<Task[]>([]);\r\n  const [filteredTasks, setFilteredTasks] = useState<Task[]>([]);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n  const [selectedTaskId, setSelectedTaskId] = useState<number | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      loadTasks();\r\n    }\r\n  }, [isOpen]);\r\n\r\n  useEffect(() => {\r\n    if (searchTerm) {\r\n      const filtered = tasks.filter(task => \r\n        task.title.toLowerCase().includes(searchTerm.toLowerCase())\r\n      );\r\n      setFilteredTasks(filtered);\r\n    } else {\r\n      setFilteredTasks(tasks);\r\n    }\r\n  }, [searchTerm, tasks]);\r\n\r\n  const loadTasks = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await axiosInstance.get(API_ENDPOINTS.TASKS.BASE);\r\n      // Filtere nur offene und in Bearbeitung befindliche Tasks\r\n      const activeTasks = response.data.filter((task: Task) => \r\n        task.status === 'open' || task.status === 'in_progress'\r\n      );\r\n      setTasks(activeTasks);\r\n      setFilteredTasks(activeTasks);\r\n    } catch (error) {\r\n      toast.error(t('consultations.linkTask.loadError'));\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleLinkTask = async () => {\r\n    if (!selectedTaskId) {\r\n      toast.error(t('consultations.linkTask.selectTask'));\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await axiosInstance.post(\r\n        API_ENDPOINTS.CONSULTATIONS.LINK_TASK(consultationId),\r\n        { taskId: selectedTaskId }\r\n      );\r\n      \r\n      toast.success(t('consultations.linkTask.success'));\r\n      onTaskLinked();\r\n      onClose();\r\n    } catch (error: any) {\r\n      toast.error(error.response?.data?.message || t('consultations.linkTask.error'));\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n      <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n      \r\n      <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n        <Dialog.Panel className=\"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n          <div className=\"p-6\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <Dialog.Title className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                {t('consultations.linkTask.title')}\r\n              </Dialog.Title>\r\n              <button\r\n                onClick={onClose}\r\n                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\r\n              >\r\n                <XMarkIcon className=\"h-6 w-6\" />\r\n              </button>\r\n            </div>\r\n\r\n            {/* Suchfeld */}\r\n            <div className=\"relative mb-4\">\r\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                <MagnifyingGlassIcon className=\"h-5 w-5 text-gray-400\" />\r\n              </div>\r\n              <input\r\n                type=\"text\"\r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                className=\"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md leading-5 bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm\"\r\n                placeholder={t('consultations.linkTask.searchPlaceholder')}\r\n                autoFocus\r\n              />\r\n            </div>\r\n\r\n            {/* Task-Liste */}\r\n            <div className=\"max-h-96 overflow-y-auto\">\r\n              {loading ? (\r\n                <div className=\"text-center py-4 text-gray-500 dark:text-gray-400\">\r\n                  {t('common.loading')}\r\n                </div>\r\n              ) : filteredTasks.length === 0 ? (\r\n                <div className=\"text-center py-8 text-gray-500 dark:text-gray-400\">\r\n                  {t('consultations.linkTask.noTasksFound')}\r\n                </div>\r\n              ) : (\r\n                <div className=\"space-y-2\">\r\n                  {filteredTasks.map((task) => (\r\n                    <label\r\n                      key={task.id}\r\n                      className=\"flex items-center p-3 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer\"\r\n                    >\r\n                      <input\r\n                        type=\"radio\"\r\n                        name=\"task\"\r\n                        value={task.id}\r\n                        checked={selectedTaskId === task.id}\r\n                        onChange={() => setSelectedTaskId(task.id)}\r\n                        className=\"mr-3\"\r\n                      />\r\n                      <div className=\"flex-1\">\r\n                        <p className=\"font-medium text-gray-900 dark:text-white\">\r\n                          {task.title}\r\n                        </p>\r\n                        {task.responsible && (\r\n                          <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                            {t('tasks.columns.responsible')}: {task.responsible.firstName} {task.responsible.lastName}\r\n                          </p>\r\n                        )}\r\n                      </div>\r\n                      <span className={`px-2 py-1 text-xs rounded-full ${\r\n                        task.status === 'open' \r\n                          ? 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300'\r\n                          : 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300'\r\n                      }`}>\r\n                        {task.status === 'open' ? t('tasks.status.open') : t('tasks.status.in_progress')}\r\n                      </span>\r\n                    </label>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Buttons */}\r\n            <div className=\"mt-6 flex items-center justify-end space-x-3\">\r\n              <button\r\n                type=\"button\"\r\n                onClick={onClose}\r\n                className=\"px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600\"\r\n              >\r\n                {t('common.cancel')}\r\n              </button>\r\n              <button\r\n                onClick={handleLinkTask}\r\n                disabled={!selectedTaskId}\r\n                className=\"px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              >\r\n                {t('consultations.linkTask.link')}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </Dialog.Panel>\r\n      </div>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default LinkTaskModal; ","import React, { useState } from 'react';\r\nimport { Dialog } from '@headlessui/react';\r\nimport { \r\n  CheckCircleIcon, \r\n  XMarkIcon, \r\n  DocumentArrowDownIcon,\r\n  EyeIcon \r\n} from '@heroicons/react/24/outline';\r\nimport { API_ENDPOINTS } from '../config/api.ts';\r\nimport axiosInstance from '../config/axios.ts';\r\nimport { toast } from 'react-toastify';\r\n\r\ninterface InvoiceSuccessModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  invoiceId: number;\r\n  invoiceNumber: string;\r\n  totalAmount: string;\r\n  clientName: string;\r\n}\r\n\r\nconst InvoiceSuccessModal: React.FC<InvoiceSuccessModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  invoiceId,\r\n  invoiceNumber,\r\n  totalAmount,\r\n  clientName\r\n}) => {\r\n  const [downloadingPdf, setDownloadingPdf] = useState(false);\r\n\r\n  const handleDownloadPdf = async () => {\r\n    try {\r\n      setDownloadingPdf(true);\r\n      \r\n      const response = await axiosInstance.get(\r\n        API_ENDPOINTS.CONSULTATION_INVOICES.GENERATE_PDF(invoiceId),\r\n        { \r\n          responseType: 'blob',\r\n          headers: {\r\n            'Accept': 'application/pdf'\r\n          }\r\n        }\r\n      );\r\n      \r\n      // Erstelle Blob und Download-Link\r\n      const blob = new Blob([response.data], { type: 'application/pdf' });\r\n      const url = window.URL.createObjectURL(blob);\r\n      const link = document.createElement('a');\r\n      link.href = url;\r\n      link.download = `Rechnung_${invoiceNumber}.pdf`;\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n      window.URL.revokeObjectURL(url);\r\n      \r\n      toast.success('PDF erfolgreich heruntergeladen');\r\n    } catch (error: any) {\r\n      console.error('Fehler beim Download der PDF:', error);\r\n      toast.error(error.response?.data?.message || 'Fehler beim Download der PDF');\r\n    } finally {\r\n      setDownloadingPdf(false);\r\n    }\r\n  };\r\n\r\n  const handleViewInvoiceManagement = () => {\r\n    // TODO: Navigation zur Rechnungsverwaltung (wird in Phase 5 implementiert)\r\n    toast.info('Rechnungsverwaltung wird in Phase 5 implementiert');\r\n    onClose();\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\r\n      <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\r\n      \r\n      <div className=\"fixed inset-0 flex items-center justify-center p-4\">\r\n        <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\r\n          <div className=\"p-6\">\r\n            {/* Header mit Success Icon */}\r\n            <div className=\"flex items-center justify-between mb-6\">\r\n              <div className=\"flex items-center\">\r\n                <CheckCircleIcon className=\"h-8 w-8 text-green-500 mr-3\" />\r\n                <Dialog.Title className=\"text-lg font-medium text-gray-900 dark:text-white\">\r\n                  Rechnung erstellt\r\n                </Dialog.Title>\r\n              </div>\r\n              <button\r\n                onClick={onClose}\r\n                className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\r\n              >\r\n                <XMarkIcon className=\"h-6 w-6\" />\r\n              </button>\r\n            </div>\r\n\r\n            {/* Success Inhalt */}\r\n            <div className=\"space-y-4\">\r\n              <div className=\"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4\">\r\n                <h3 className=\"font-medium text-green-800 dark:text-green-200 mb-2\">\r\n                  Rechnung erfolgreich erstellt\r\n                </h3>\r\n                <div className=\"text-sm text-green-700 dark:text-green-300 space-y-1\">\r\n                  <p><strong>Rechnungsnummer:</strong> {invoiceNumber}</p>\r\n                  <p><strong>Kunde:</strong> {clientName}</p>\r\n                  <p><strong>Betrag:</strong> CHF {totalAmount}</p>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Hinweise */}\r\n              <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\r\n                <h4 className=\"font-medium text-blue-800 dark:text-blue-200 mb-2\">\r\n                  Nchste Schritte\r\n                </h4>\r\n                <ul className=\"text-sm text-blue-700 dark:text-blue-300 space-y-1\">\r\n                  <li> PDF herunterladen und an Kunde senden</li>\r\n                  <li> Beratungen sind nun als abgerechnet markiert</li>\r\n                  <li> Rechnung in der Rechnungsverwaltung verwalten</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Aktionen */}\r\n            <div className=\"mt-6 flex flex-col space-y-3\">\r\n              <button\r\n                onClick={handleDownloadPdf}\r\n                disabled={downloadingPdf}\r\n                className=\"w-full flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n              >\r\n                {downloadingPdf ? (\r\n                  <>\r\n                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\r\n                    PDF wird generiert...\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <DocumentArrowDownIcon className=\"h-5 w-5 mr-2\" />\r\n                    PDF herunterladen\r\n                  </>\r\n                )}\r\n              </button>\r\n\r\n              <button\r\n                onClick={handleViewInvoiceManagement}\r\n                className=\"w-full flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600\"\r\n              >\r\n                <EyeIcon className=\"h-5 w-5 mr-2\" />\r\n                Zur Rechnungsverwaltung\r\n              </button>\r\n\r\n              <button\r\n                onClick={onClose}\r\n                className=\"w-full px-4 py-2 text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200\"\r\n              >\r\n                Schlieen\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </Dialog.Panel>\r\n      </div>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default InvoiceSuccessModal; ","import React, { useState, useEffect, useCallback } from 'react';\nimport { Dialog } from '@headlessui/react';\nimport { XMarkIcon, CheckIcon, ArrowPathIcon, DocumentTextIcon } from '@heroicons/react/24/outline';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { toast } from 'react-toastify';\nimport { Consultation } from '../types/client.ts';\nimport { calculateDuration, formatTime } from '../utils/dateUtils.ts';\nimport { format } from 'date-fns';\nimport InvoiceSuccessModal from './InvoiceSuccessModal.tsx';\n\ninterface CreateInvoiceModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  consultations: Consultation[];\n  onInvoiceCreated: (invoiceId: number) => void;\n}\n\ninterface InvoiceSettings {\n  companyName: string;\n  companyAddress: string;\n  companyZip: string;\n  companyCity: string;\n  companyCountry: string;\n  companyPhone?: string;\n  companyEmail?: string;\n  vatNumber?: string;\n  iban: string;\n  defaultHourlyRate: number;\n  defaultVatRate?: number;\n  invoicePrefix: string;\n  nextInvoiceNumber: number;\n}\n\ninterface CreatedInvoice {\n  id: number;\n  invoiceNumber: string;\n  total: number;\n  clientName: string;\n}\n\nconst CreateInvoiceModal: React.FC<CreateInvoiceModalProps> = ({\n  isOpen,\n  onClose,\n  consultations,\n  onInvoiceCreated\n}) => {\n  const { t } = useTranslation();\n  const { hasPermission } = usePermissions();\n  const [loading, setLoading] = useState(false);\n  const [settings, setSettings] = useState<InvoiceSettings | null>(null);\n  const [createdInvoice, setCreatedInvoice] = useState<CreatedInvoice | null>(null);\n  const [showSuccessModal, setShowSuccessModal] = useState(false);\n  const [formData, setFormData] = useState({\n    issueDate: format(new Date(), 'yyyy-MM-dd'),\n    dueDate: format(new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), 'yyyy-MM-dd'),\n    hourlyRate: 0,\n    vatRate: 0,\n    notes: ''\n  });\n\n  // Berechtigungsprfung\n  const canCreateInvoices = hasPermission('invoice_create', 'write', 'button');\n  \n  // loadInvoiceSettings Funktion MUSS vor useEffect definiert werden\n  const loadInvoiceSettings = useCallback(async () => {\n    try {\n      setLoading(true);\n      const response = await axiosInstance.get(API_ENDPOINTS.INVOICE_SETTINGS.BASE);\n      const settingsData = response.data;\n      \n      setSettings(settingsData);\n      setFormData(prev => ({\n        ...prev,\n        hourlyRate: settingsData.defaultHourlyRate || 0,\n        vatRate: settingsData.defaultVatRate || 0\n      }));\n    } catch (error: any) {\n      console.error('Fehler beim Laden der Rechnungseinstellungen:', error);\n      if (error.response?.status === 404) {\n        toast.error('Bitte konfigurieren Sie zuerst Ihre Rechnungseinstellungen');\n      } else {\n        toast.error('Fehler beim Laden der Rechnungseinstellungen');\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n  \n  // useEffect MUSS vor allen frhen Returns stehen!\n  useEffect(() => {\n    if (isOpen) {\n      loadInvoiceSettings();\n    }\n  }, [isOpen, loadInvoiceSettings]);\n\n  // Berechtigungsprfung - NACH useEffect\n  if (!canCreateInvoices) {\n    return (\n      <Dialog open={isOpen} onClose={onClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6\">\n            <div className=\"text-center\">\n              <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-4\">\n                Keine Berechtigung\n              </h3>\n              <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\n                Sie haben keine Berechtigung, Rechnungen zu erstellen.\n              </p>\n              <button\n                onClick={onClose}\n                className=\"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400\"\n              >\n                Schlieen\n              </button>\n            </div>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n    );\n  }\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!settings) {\n      toast.error('Rechnungseinstellungen konnten nicht geladen werden');\n      return;\n    }\n\n    if (consultations.length === 0) {\n      toast.error('Keine Beratungen zum Abrechnen vorhanden');\n      return;\n    }\n\n    // Validiere, dass alle Consultations den gleichen Client haben\n    const uniqueClientIds = [...new Set(consultations.map(c => c.clientId))];\n    if (uniqueClientIds.length > 1) {\n      toast.error('Alle Beratungen mssen den gleichen Kunden haben');\n      return;\n    }\n\n    const clientId = uniqueClientIds[0];\n    if (!clientId) {\n      toast.error('Kein gltiger Kunde in den Beratungen gefunden');\n      return;\n    }\n\n    try {\n      setLoading(true);\n\n      const response = await axiosInstance.post(\n        API_ENDPOINTS.CONSULTATION_INVOICES.CREATE_FROM_CONSULTATIONS,\n        {\n          consultationIds: consultations.map(c => c.id),\n          clientId: clientId,\n          issueDate: formData.issueDate,\n          dueDate: formData.dueDate,\n          hourlyRate: formData.hourlyRate,\n          vatRate: formData.vatRate || 0,\n          notes: formData.notes\n        }\n      );\n      \n      const invoice = response.data;\n      const clientName = consultations[0]?.client?.name || 'Unbekannt';\n      \n      setCreatedInvoice({\n        id: invoice.id,\n        invoiceNumber: invoice.invoiceNumber,\n        total: invoice.total,\n        clientName: clientName\n      });\n      \n      setShowSuccessModal(true);\n      onInvoiceCreated(invoice.id);\n      \n    } catch (error: any) {\n      toast.error(error.response?.data?.message || 'Fehler beim Erstellen der Rechnung');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n    const { name, value } = e.target;\n    setFormData(prev => ({ ...prev, [name]: value }));\n  };\n\n  const handleCloseAll = () => {\n    setShowSuccessModal(false);\n    setCreatedInvoice(null);\n    onClose();\n  };\n\n  // Berechnungen fr die Kostenbersicht\n  const totalHours = consultations.reduce((sum, consultation) => {\n    if (consultation.endTime) {\n      const duration = calculateDuration(consultation.startTime, consultation.endTime);\n      const hours = parseFloat(duration.replace('h', '').replace(',', '.'));\n      return sum + hours;\n    }\n    return sum;\n  }, 0);\n\n  const estimatedTotal = totalHours * formData.hourlyRate;\n  const vatAmount = formData.vatRate > 0 ? (estimatedTotal * formData.vatRate / 100) : 0;\n  const totalWithVat = estimatedTotal + vatAmount;\n\n  if (!isOpen) return null;\n\n  return (\n    <>\n      <Dialog open={isOpen && !showSuccessModal} onClose={onClose} className=\"relative z-50\">\n        <div className=\"fixed inset-0 bg-black/30\" aria-hidden=\"true\" />\n        \n        <div className=\"fixed inset-0 flex items-center justify-center p-4\">\n          <Dialog.Panel className=\"mx-auto max-w-2xl w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl\">\n            <form onSubmit={handleSubmit} className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-6\">\n                <Dialog.Title className=\"text-lg font-medium text-gray-900 dark:text-white\">\n                  Rechnung erstellen\n                </Dialog.Title>\n                <button\n                  type=\"button\"\n                  onClick={onClose}\n                  className=\"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300\"\n                >\n                  <XMarkIcon className=\"h-6 w-6\" />\n                </button>\n              </div>\n\n              {/* Beratungen bersicht */}\n              <div className=\"mb-6 bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4\">\n                <h3 className=\"font-medium text-gray-900 dark:text-white mb-3\">\n                  Zu verrechnende Beratungen\n                </h3>\n                <div className=\"space-y-2 max-h-40 overflow-y-auto\">\n                  {consultations.map((consultation) => (\n                    <div key={consultation.id} className=\"flex justify-between items-center text-sm\">\n                      <div>\n                        <span className=\"text-gray-900 dark:text-white\">\n                          {consultation.client?.name} - {formatTime(consultation.startTime)}\n                        </span>\n                      </div>\n                      <span className=\"text-gray-600 dark:text-gray-400\">\n                        {calculateDuration(consultation.startTime, consultation.endTime)}\n                      </span>\n                    </div>\n                  ))}\n                </div>\n                <div className=\"mt-3 pt-3 border-t border-gray-200 dark:border-gray-600 flex justify-between text-sm font-medium\">\n                  <span>Gesamtdauer:</span>\n                  <span>{totalHours.toFixed(2)}h</span>\n                </div>\n              </div>\n\n              {/* Rechnungsdetails */}\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Rechnungsdatum\n                  </label>\n                  <input\n                    type=\"date\"\n                    name=\"issueDate\"\n                    value={formData.issueDate}\n                    onChange={handleChange}\n                    className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Flligkeitsdatum\n                  </label>\n                  <input\n                    type=\"date\"\n                    name=\"dueDate\"\n                    value={formData.dueDate}\n                    onChange={handleChange}\n                    className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    Stundensatz (CHF)\n                  </label>\n                  <input\n                    type=\"number\"\n                    name=\"hourlyRate\"\n                    value={formData.hourlyRate}\n                    onChange={handleChange}\n                    step=\"0.01\"\n                    min=\"0\"\n                    className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                    MwSt.-Satz (%)\n                  </label>\n                  <input\n                    type=\"number\"\n                    name=\"vatRate\"\n                    value={formData.vatRate}\n                    onChange={handleChange}\n                    step=\"0.1\"\n                    min=\"0\"\n                    max=\"100\"\n                    className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                  />\n                </div>\n              </div>\n\n              {/* Notizen */}\n              <div className=\"mb-6\">\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Zustzliche Notizen\n                </label>\n                <textarea\n                  name=\"notes\"\n                  value={formData.notes}\n                  onChange={handleChange}\n                  rows={3}\n                  className=\"w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white\"\n                  placeholder=\"Optionale Notizen zur Rechnung...\"\n                />\n              </div>\n\n              {/* Kostenbersicht */}\n              <div className=\"mb-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\n                <h3 className=\"font-medium text-blue-800 dark:text-blue-200 mb-3\">\n                  Kostenbersicht\n                </h3>\n                <div className=\"space-y-2 text-sm\">\n                  <div className=\"flex justify-between\">\n                    <span>Beratungszeit ({totalHours.toFixed(2)}h  CHF {formData.hourlyRate}):</span>\n                    <span>CHF {estimatedTotal.toFixed(2)}</span>\n                  </div>\n                  {formData.vatRate > 0 && (\n                    <div className=\"flex justify-between\">\n                      <span>MwSt. ({formData.vatRate}%):</span>\n                      <span>CHF {vatAmount.toFixed(2)}</span>\n                    </div>\n                  )}\n                  <div className=\"border-t border-blue-200 dark:border-blue-700 pt-2 flex justify-between font-medium\">\n                    <span>Gesamtbetrag:</span>\n                    <span>CHF {totalWithVat.toFixed(2)}</span>\n                  </div>\n                </div>\n              </div>\n\n              {/* Buttons */}\n              <div className=\"flex items-center justify-end space-x-3\">\n                <button\n                  type=\"button\"\n                  onClick={onClose}\n                  className=\"p-2 text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                  title={t('common.cancel')}\n                >\n                  <XMarkIcon className=\"h-5 w-5\" />\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={loading || !settings || totalHours === 0}\n                  className=\"p-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-blue-700 dark:hover:bg-blue-800 disabled:opacity-50 disabled:cursor-not-allowed\"\n                  title={loading ? 'Erstelle Rechnung...' : 'Rechnung erstellen'}\n                >\n                  {loading ? (\n                    <ArrowPathIcon className=\"h-5 w-5 animate-spin\" />\n                  ) : (\n                    <DocumentTextIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </form>\n          </Dialog.Panel>\n        </div>\n      </Dialog>\n\n      {/* Success Modal */}\n      {showSuccessModal && createdInvoice && (\n        <InvoiceSuccessModal\n          isOpen={showSuccessModal}\n          onClose={handleCloseAll}\n          invoiceId={createdInvoice.id}\n          invoiceNumber={createdInvoice.invoiceNumber}\n          totalAmount={Number(createdInvoice.total).toFixed(2)}\n          clientName={createdInvoice.clientName}\n        />\n      )}\n    </>\n  );\n};\n\nexport default CreateInvoiceModal; ","import React, { useState, useEffect, useMemo, useImperativeHandle, forwardRef, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { \n  ClockIcon, \n  FunnelIcon,\n  XMarkIcon,\n  LinkIcon,\n  TrashIcon,\n  DocumentTextIcon,\n  ChartBarIcon,\n  CheckIcon\n} from '@heroicons/react/24/outline';\nimport { useNavigate } from 'react-router-dom';\nimport { API_ENDPOINTS } from '../config/api.ts';\nimport axiosInstance from '../config/axios.ts';\nimport { \n  formatTime, \n  calculateDuration, \n  formatTotalDuration, \n  isConsultationInvoiced, \n  getConsultationInvoiceInfo,\n  getInvoiceStatusText,\n  getInvoiceStatusColor \n} from '../utils/dateUtils.ts';\nimport { Consultation, Client } from '../types/client.ts';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport { toast } from 'react-toastify';\nimport LinkTaskModal from './LinkTaskModal.tsx';\nimport FilterPane from './FilterPane.tsx';\nimport SavedFilterTags from './SavedFilterTags.tsx';\nimport { FilterCondition } from './FilterRow.tsx';\nimport * as consultationApi from '../api/consultationApi.ts';\nimport * as clientApi from '../api/clientApi.ts';\nimport { format } from 'date-fns';\nimport { de } from 'date-fns/locale';\nimport CreateInvoiceModal from './CreateInvoiceModal.tsx';\n\n// TableID fr gespeicherte Filter\nconst CONSULTATIONS_TABLE_ID = 'consultations-table';\n\ninterface ConsultationListProps {\n  onConsultationChange?: () => void;\n}\n\n// Ref-Interface fr imperatives Handle\nexport interface ConsultationListRef {\n  refresh: () => void;\n  addConsultation?: (consultation: Consultation) => void;\n  updateConsultation?: (consultation: Consultation) => void;\n  removeConsultation?: (consultationId: number) => void;\n  activateClientFilter?: (clientName: string) => void;\n}\n\nconst ConsultationList = forwardRef<ConsultationListRef, ConsultationListProps>(({ onConsultationChange }, ref) => {\n  const { t } = useTranslation();\n  const { hasPermission } = usePermissions();\n  const navigate = useNavigate();\n  const [consultations, setConsultations] = useState<Consultation[]>([]);\n  const [recentClients, setRecentClients] = useState<Client[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [isFilterPanelOpen, setIsFilterPanelOpen] = useState(false);\n  const [filterConditions, setFilterConditions] = useState<FilterCondition[]>([]);\n  const [filterLogicalOperators, setFilterLogicalOperators] = useState<('AND' | 'OR')[]>([]);\n  const [editingNotesId, setEditingNotesId] = useState<number | null>(null);\n  const [editingNotes, setEditingNotes] = useState('');\n  const [editingTimeId, setEditingTimeId] = useState<number | null>(null);\n  const [editingTimeType, setEditingTimeType] = useState<'startTime' | 'endTime' | null>(null);\n  const [editingTimeValue, setEditingTimeValue] = useState('');\n  const [linkTaskModalOpen, setLinkTaskModalOpen] = useState(false);\n  const [selectedConsultationId, setSelectedConsultationId] = useState<number | null>(null);\n\n  // Filter State Management\n  const [activeFilterName, setActiveFilterName] = useState<string>(t('consultations.filters.today'));\n  const [selectedFilterId, setSelectedFilterId] = useState<number | null>(null);\n\n  // Invoice Creation State\n  const [showCreateInvoiceModal, setShowCreateInvoiceModal] = useState(false);\n\n  const loadConsultations = async () => {\n    try {\n      setLoading(true);\n      const consultations = await consultationApi.getConsultations();\n      setConsultations(consultations || []);\n      setError(null);\n    } catch (error) {\n      console.error('Fehler beim Laden der Beratungen:', error);\n      setError(t('consultations.loadError'));\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadRecentClients = async () => {\n    try {\n      const clients = await clientApi.getRecentClients();\n      setRecentClients(clients || []);\n    } catch (error) {\n      // Stille Behandlung - normale Situation wenn noch keine Clients beraten wurden\n    }\n  };\n\n  // Imperatives Handle fr Ref-basierte Refresh-Funktion\n  useImperativeHandle(ref, () => ({\n    refresh: loadConsultations,\n    addConsultation: (consultation: Consultation) => {\n      // Optimistisches Update: Fge Consultation zur Liste hinzu\n      setConsultations(prev => [consultation, ...prev]);\n    },\n    updateConsultation: (consultation: Consultation) => {\n      // Optimistisches Update: Aktualisiere Consultation in der Liste\n      setConsultations(prev => \n        prev.map(c => c.id === consultation.id ? consultation : c)\n      );\n    },\n    removeConsultation: (consultationId: number) => {\n      // Optimistisches Update: Entferne Consultation aus der Liste\n      setConsultations(prev => prev.filter(c => c.id !== consultationId));\n    },\n    activateClientFilter: createAndActivateClientFilter\n  }));\n\n  // Initial load\n  useEffect(() => {\n    loadConsultations();\n    loadRecentClients();\n  }, []);\n\n  // Initialer Default-Filter\n  useEffect(() => {\n    const setInitialFilter = async () => {\n      try {\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(CONSULTATIONS_TABLE_ID));\n        const filters = response.data;\n        \n        const heuteFilter = filters.find((filter: any) => filter.name === 'Heute');\n        if (heuteFilter) {\n          setActiveFilterName(t('consultations.filters.today'));\n          setSelectedFilterId(heuteFilter.id);\n          applyFilterConditions(heuteFilter.conditions, heuteFilter.operators);\n        }\n      } catch (error) {\n        console.error('Fehler beim Setzen des initialen Filters:', error);\n      }\n    };\n\n    setInitialFilter();\n  }, []);\n\n  // Filter Change Handler\n  const handleFilterChange = (name: string, id: number | null, conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setActiveFilterName(name);\n    setSelectedFilterId(id);\n    applyFilterConditions(conditions, operators);\n  };\n\n  // Client-Filter erstellen und aktivieren\n  const createAndActivateClientFilter = async (clientName: string) => {\n    try {\n      // Prfe ob Client-Filter bereits existiert\n      const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(CONSULTATIONS_TABLE_ID));\n      const existingFilters = response.data;\n      \n      let clientFilter = existingFilters.find((filter: any) => filter.name === clientName);\n      \n      if (!clientFilter) {\n        // Erstelle neuen Client-Filter\n        const newFilter = {\n          tableId: CONSULTATIONS_TABLE_ID,\n          name: clientName,\n          conditions: [\n            { column: 'client', operator: 'equals', value: clientName }\n          ],\n          operators: []\n        };\n        \n        const createResponse = await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, newFilter);\n        clientFilter = createResponse.data;\n        \n        // Refresh die Filter-Liste\n        if ((window as any).refreshSavedFilters) {\n          (window as any).refreshSavedFilters();\n        }\n      }\n      \n      // Aktiviere den Client-Filter\n      if (clientFilter) {\n        setActiveFilterName(clientName);\n        setSelectedFilterId(clientFilter.id);\n        applyFilterConditions(clientFilter.conditions, clientFilter.operators);\n      }\n    } catch (error) {\n      console.error('Fehler beim Erstellen/Aktivieren des Client-Filters:', error);\n    }\n  };\n\n  useEffect(() => {\n    const createStandardFilters = async () => {\n      try {\n        const token = localStorage.getItem('token');\n        if (!token) return;\n\n        // Prfe, ob Standard-Filter bereits existieren\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(CONSULTATIONS_TABLE_ID));\n        const existingFilters = response.data;\n\n        // Lsche veralteten \"Alle\" Filter falls vorhanden\n        const alleFilter = existingFilters.find((filter: any) => filter.name === 'Alle');\n        if (alleFilter) {\n          try {\n            await axiosInstance.delete(API_ENDPOINTS.SAVED_FILTERS.BY_ID(alleFilter.id));\n            console.log('Veralteter \"Alle\" Filter gelscht');\n          } catch (error) {\n            console.error('Fehler beim Lschen des \"Alle\" Filters:', error);\n          }\n        }\n\n        // Lsche veralteten \"Diese Woche\" Filter falls vorhanden\n        const dieseWocheFilter = existingFilters.find((filter: any) => filter.name === 'Diese Woche');\n        if (dieseWocheFilter) {\n          try {\n            await axiosInstance.delete(API_ENDPOINTS.SAVED_FILTERS.BY_ID(dieseWocheFilter.id));\n            console.log('Veralteter \"Diese Woche\" Filter gelscht');\n          } catch (error) {\n            console.error('Fehler beim Lschen des \"Diese Woche\" Filters:', error);\n          }\n        }\n\n        const archivFilterExists = existingFilters.some((filter: any) => filter.name === 'Archiv');\n        const heuteFilterExists = existingFilters.some((filter: any) => filter.name === 'Heute');\n        const wocheFilterExists = existingFilters.some((filter: any) => filter.name === 'Woche');\n        const nichtAbgerechnetFilterExists = existingFilters.some((filter: any) => filter.name === 'Nicht abgerechnet');\n\n        // Erstelle \"Archiv\"-Filter (zeigt nur vergangene Beratungen - strikt vor heute)\n        if (!archivFilterExists) {\n          const today = new Date().toISOString().split('T')[0];\n          const archivFilter = {\n            tableId: CONSULTATIONS_TABLE_ID,\n            name: 'Archiv',\n            conditions: [\n              { column: 'startTime', operator: 'before', value: today }\n            ],\n            operators: []\n          };\n          try {\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, archivFilter);\n          } catch (error) {\n            console.error('Fehler beim Erstellen des Archiv-Filters:', error);\n          }\n        }\n\n        // Erstelle \"Heute\"-Filter\n        if (!heuteFilterExists) {\n          const heuteFilter = {\n            tableId: CONSULTATIONS_TABLE_ID,\n            name: t('consultations.filters.today'),\n            conditions: [\n              { column: 'startTime', operator: 'equals', value: '__TODAY__' }\n            ],\n            operators: []\n          };\n          try {\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, heuteFilter);\n          } catch (error) {\n            console.error('Fehler beim Erstellen des Heute-Filters:', error);\n          }\n        }\n\n        // Erstelle \"Woche\"-Filter (von heute bis heute + 7 Tage)\n        if (!wocheFilterExists) {\n          const wocheFilter = {\n            tableId: CONSULTATIONS_TABLE_ID,\n            name: t('consultations.filters.week'),\n            conditions: [\n              { column: 'startTime', operator: 'after', value: '__TODAY__' },\n              { column: 'startTime', operator: 'before', value: '__WEEK_FROM_TODAY__' }\n            ],\n            operators: ['AND']\n          };\n          try {\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, wocheFilter);\n          } catch (error) {\n            console.error('Fehler beim Erstellen des Woche-Filters:', error);\n          }\n        }\n\n        // Erstelle \"Nicht abgerechnet\"-Filter\n        if (!nichtAbgerechnetFilterExists) {\n          const nichtAbgerechnetFilter = {\n            tableId: CONSULTATIONS_TABLE_ID,\n            name: t('consultations.filters.unbilled'),\n            conditions: [\n              { column: 'invoiceStatus', operator: 'equals', value: 'nicht abgerechnet' }\n            ],\n            operators: []\n          };\n          try {\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, nichtAbgerechnetFilter);\n          } catch (error) {\n            console.error('Fehler beim Erstellen des Nicht abgerechnet-Filters:', error);\n          }\n        }\n      } catch (error) {\n        console.error('Fehler beim Erstellen der Standard-Filter:', error);\n      }\n    };\n\n    createStandardFilters();\n  }, []); // Nur einmal beim ersten Laden\n\n  // Aktualisiere bestehende Filter die alte statische Datumswerte haben\n  useEffect(() => {\n    const updateExistingFilters = async () => {\n      try {\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(CONSULTATIONS_TABLE_ID));\n        const existingFilters = response.data;\n\n        // Finde \"Heute\" Filter mit statischem Datum\n        const heuteFilter = existingFilters.find((filter: any) => filter.name === 'Heute');\n        if (heuteFilter && heuteFilter.conditions.length > 0) {\n          const condition = heuteFilter.conditions[0];\n          // Prfe ob es ein statisches Datum ist (Format: YYYY-MM-DD) anstatt unseres Markers\n          if (condition.value && condition.value !== '__TODAY__' && /^\\d{4}-\\d{2}-\\d{2}$/.test(condition.value)) {\n            console.log('Aktualisiere Heute-Filter mit dynamischem Marker...');\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, {\n              tableId: CONSULTATIONS_TABLE_ID,\n              name: t('consultations.filters.today'),\n              conditions: [\n                { column: 'startTime', operator: 'equals', value: '__TODAY__' }\n              ],\n              operators: []\n            });\n          }\n        }\n\n        // Finde \"Woche\" Filter mit statischen Datums\n        const wocheFilter = existingFilters.find((filter: any) => filter.name === 'Woche');\n        if (wocheFilter && wocheFilter.conditions.length >= 2) {\n          const firstCondition = wocheFilter.conditions[0];\n          const secondCondition = wocheFilter.conditions[1];\n          \n          // Prfe ob es statische Datumsangaben sind\n          const hasStaticDates = (\n            firstCondition.value !== '__TODAY__' && /^\\d{4}-\\d{2}-\\d{2}$/.test(firstCondition.value)\n          ) || (\n            secondCondition.value !== '__WEEK_FROM_TODAY__' && /^\\d{4}-\\d{2}-\\d{2}$/.test(secondCondition.value)\n          );\n\n          if (hasStaticDates) {\n            console.log('Aktualisiere Woche-Filter mit dynamischen Markern...');\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, {\n              tableId: CONSULTATIONS_TABLE_ID,\n              name: t('consultations.filters.week'),\n              conditions: [\n                { column: 'startTime', operator: 'after', value: '__TODAY__' },\n                { column: 'startTime', operator: 'before', value: '__WEEK_FROM_TODAY__' }\n              ],\n              operators: ['AND']\n            });\n          }\n        }\n      } catch (error) {\n        console.error('Fehler beim Aktualisieren bestehender Filter:', error);\n      }\n    };\n\n    // Nach kurzer Verzgerung ausfhren, damit die Standard-Filter-Erstellung abgeschlossen ist\n    const timeoutId = setTimeout(() => {\n      updateExistingFilters();\n    }, 1000);\n\n    return () => clearTimeout(timeoutId);\n  }, []); // Nur einmal beim ersten Laden\n\n  // Separater Effect fr Client-Filter-Management\n  useEffect(() => {\n    const updateClientFilters = async () => {\n      if (recentClients.length === 0) return; // Warte bis Recent Clients geladen sind\n      \n      try {\n        const token = localStorage.getItem('token');\n        if (!token) return;\n\n        // Hole aktuelle Filter\n        const response = await axiosInstance.get(API_ENDPOINTS.SAVED_FILTERS.BY_TABLE(CONSULTATIONS_TABLE_ID));\n        const existingFilters = response.data;\n\n        // Finde alle bestehenden Client-Filter (alle Filter auer den Standard-Filtern)\n        const existingClientFilters = existingFilters.filter((filter: any) => \n          ![t('consultations.filters.archive'), t('consultations.filters.today'), t('consultations.filters.week')].includes(filter.name)\n        );\n        \n        // Aktuelle Recent Client Namen\n        const currentRecentClientNames = recentClients.map(client => client.name);\n        \n        // Lsche veraltete Client-Filter (die nicht mehr in Recent Clients sind)\n        for (const existingFilter of existingClientFilters) {\n          if (!currentRecentClientNames.includes(existingFilter.name)) {\n            try {\n              await axiosInstance.delete(API_ENDPOINTS.SAVED_FILTERS.BY_ID(existingFilter.id));\n              console.log(`Veralteter Client-Filter gelscht: ${existingFilter.name}`);\n            } catch (error) {\n              console.error(`Fehler beim Lschen des veralteten Client-Filters ${existingFilter.name}:`, error);\n            }\n          }\n        }\n        \n        // Erstelle neue Client-Filter fr aktuelle Recent Clients\n        for (const client of recentClients) {\n          const clientFilterName = client.name;\n          const clientFilterExists = existingFilters.some((filter: any) => filter.name === clientFilterName);\n          \n          if (!clientFilterExists) {\n            const clientFilter = {\n              tableId: CONSULTATIONS_TABLE_ID,\n              name: clientFilterName,\n              conditions: [\n                { column: 'client', operator: 'equals', value: client.name }\n              ],\n              operators: []\n            };\n            await axiosInstance.post(API_ENDPOINTS.SAVED_FILTERS.BASE, clientFilter);\n            console.log(`Neuer Client-Filter erstellt: ${clientFilterName}`);\n          }\n        }\n      } catch (error) {\n        console.error('Fehler beim Aktualisieren der Client-Filter:', error);\n      }\n    };\n\n    // Debounce um Race Conditions zu vermeiden\n    const timeoutId = setTimeout(() => {\n      updateClientFilters();\n    }, 500);\n\n    return () => clearTimeout(timeoutId);\n  }, [recentClients]);\n\n  const applyFilterConditions = (conditions: FilterCondition[], operators: ('AND' | 'OR')[]) => {\n    setFilterConditions(conditions);\n    setFilterLogicalOperators(operators);\n  };\n\n  const resetFilterConditions = () => {\n    setFilterConditions([]);\n    setFilterLogicalOperators([]);\n  };\n\n  const getActiveFilterCount = () => {\n    return filterConditions.length;\n  };\n\n  const updateNotes = async (consultationId: number, notes: string) => {\n    try {\n      await consultationApi.updateConsultationNotes(consultationId, { notes });\n      setConsultations(prev => \n        prev.map(consultation => \n          consultation.id === consultationId \n            ? { ...consultation, notes }\n            : consultation\n        )\n      );\n      toast.success(t('consultations.notesUpdated'));\n    } catch (error) {\n      console.error('Fehler beim Aktualisieren der Notizen:', error);\n      toast.error(t('consultations.notesUpdateError'));\n    }\n  };\n\n  const handleNotesEdit = (consultation: Consultation) => {\n    setEditingNotesId(consultation.id);\n    setEditingNotes(consultation.notes || '');\n  };\n\n  const handleNotesSave = (consultationId: number) => {\n    updateNotes(consultationId, editingNotes);\n    setEditingNotesId(null);\n  };\n\n  const handleNotesCancel = () => {\n    setEditingNotesId(null);\n    setEditingNotes('');\n  };\n\n  const handleTimeEdit = (consultation: Consultation, timeType: 'startTime' | 'endTime') => {\n    setEditingTimeId(consultation.id);\n    setEditingTimeType(timeType);\n    const currentTime = timeType === 'startTime' ? consultation.startTime : consultation.endTime;\n    if (currentTime) {\n      /* TIMEZONE-PROBLEM BEHOBEN:\n       * \n       * PROBLEM: Doppelte Timezone-Konvertierung!\n       * - DB-Zeit: \"2025-05-31T11:35:33.542Z\" (UTC)\n       * - new Date() konvertiert automatisch: 11:35 UTC  06:35 lokale Zeit\n       * - getTimezoneOffset-Addition: 06:35 + 5h = 11:35 lokale Zeit\n       * - Aber datetime-local zeigt: 16:35 (FALSCH!)\n       * \n       * LSUNG: UTC-Zeit direkt verwenden ohne zustzliche Konvertierung\n       * - DB-Zeit \"11:35 UTC\" soll im Input als \"11:35\" angezeigt werden\n       * - Keine getTimezoneOffset-Addition ntig!\n       */\n      \n      //  KORREKT: Direkte UTC-Zeit-Nutzung ohne doppelte Konvertierung\n      const dbTime = new Date(currentTime);\n      \n      // Verwende die UTC-Komponenten direkt fr datetime-local Input\n      const year = dbTime.getUTCFullYear();\n      const month = String(dbTime.getUTCMonth() + 1).padStart(2, '0');\n      const day = String(dbTime.getUTCDate()).padStart(2, '0');\n      const hours = String(dbTime.getUTCHours()).padStart(2, '0');\n      const minutes = String(dbTime.getUTCMinutes()).padStart(2, '0');\n      \n      const inputValue = `${year}-${month}-${day}T${hours}:${minutes}`;\n      \n      console.log(' DEBUG handleTimeEdit (KORRIGIERT):');\n      console.log('- DB Zeit (UTC):', currentTime);\n      console.log('- Extrahierte UTC-Komponenten:', `${hours}:${minutes}`);\n      console.log('- inputValue fr datetime-local:', inputValue);\n      \n      setEditingTimeValue(inputValue);\n    }\n  };\n\n  /* CLAUDE-ANCHOR: CONSULTATION-TIME-SAVE-001 - Timezone-sichere Zeitspeicherung */\n  const handleTimeSave = async (consultationId: number) => {\n    if (!editingTimeType || !editingTimeValue) return;\n    \n    try {\n      /* KONSISTENTE API-ARCHITEKTUR:\n       * Verwende die zentralisierte consultationApi.updateConsultationTime Funktion\n       * anstatt direkter axiosInstance Calls fr bessere Wartbarkeit und Testbarkeit\n       */\n      \n      //  KORREKT: Datetime-local Input direkt als UTC verwenden\n      const timeString = `${editingTimeValue}:00.000Z`;  // \"2025-05-31T11:35:00.000Z\"\n      \n      console.log(' DEBUG handleTimeSave (REFACTORED):');\n      console.log('- editingTimeValue (Input):', editingTimeValue);\n      console.log('- timeString fr API (UTC):', timeString);\n      console.log('- editingTimeType:', editingTimeType);\n      \n      //  REFACTORED: Verwende zentralisierte API-Funktion\n      const response = await consultationApi.updateConsultationTime(consultationId, {\n        [editingTimeType]: timeString\n      });\n      \n      setConsultations(prev => \n        prev.map(consultation => \n          consultation.id === consultationId \n            ? { ...consultation, [editingTimeType]: timeString }\n            : consultation\n        )\n      );\n      \n      toast.success(t('consultations.timeUpdated'));\n      setEditingTimeId(null);\n      setEditingTimeType(null);\n      setEditingTimeValue('');\n    } catch (error: any) {\n      console.error('Fehler beim Aktualisieren der Zeit:', error);\n      toast.error(`${t('consultations.timeUpdateError')}: ${error.response?.data?.message || error.message}`);\n    }\n  };\n\n  const handleTimeCancel = () => {\n    setEditingTimeId(null);\n    setEditingTimeType(null);\n    setEditingTimeValue('');\n  };\n\n  const handleLinkTask = (consultationId: number) => {\n    setSelectedConsultationId(consultationId);\n    setLinkTaskModalOpen(true);\n  };\n\n  const handleTaskLinked = (consultationId: number) => {\n    // Nach Task-Link: Lade nur die betroffene Consultation neu\n    // Fr jetzt: Reload der betroffenen Consultation (spter knnte optimiert werden)\n    loadConsultations();\n    onConsultationChange?.();\n  };\n\n  // Prfung ob Rechnung erstellt werden kann\n  const canCreateInvoice = () => {\n    // Prfe zuerst die Berechtigung\n    const canCreate = hasPermission('invoice_create', 'write', 'button');\n    if (!canCreate) return false;\n    \n    const hasConsultations = filteredConsultations.length > 0;\n    if (!hasConsultations) return false;\n    \n    // Filter mssen aktiv sein (auer Standard-Filter)\n    const hasActiveFilters = filterConditions.length > 0 || searchTerm.trim() !== '';\n    if (!hasActiveFilters) return false;\n    \n    // Alle Beratungen mssen abgeschlossen sein (endTime vorhanden)\n    const allCompleted = filteredConsultations.every(c => c.endTime);\n    if (!allCompleted) return false;\n    \n    // Keine bereits abgerechneten Beratungen\n    const hasInvoicedConsultations = filteredConsultations.some(c => isConsultationInvoiced(c));\n    if (hasInvoicedConsultations) return false;\n    \n    return true;\n  };\n\n  const handleCreateInvoice = () => {\n    setShowCreateInvoiceModal(true);\n  };\n\n  const handleDeleteConsultation = async (consultationId: number) => {\n    // Besttigungsdialog\n    if (!window.confirm(t('consultations.confirmDelete'))) {\n      return;\n    }\n\n    try {\n      await consultationApi.deleteConsultation(consultationId);\n      \n      // Entferne die Beratung aus der lokalen Liste\n      setConsultations(prev => prev.filter(consultation => consultation.id !== consultationId));\n      \n      toast.success(t('consultations.deleteSuccess'));\n      \n      // Informiere die bergeordnete Komponente ber die nderung\n      onConsultationChange?.();\n    } catch (error: any) {\n      console.error('Fehler beim Lschen der Beratung:', error);\n      const errorMessage = error.response?.data?.message || t('consultations.deleteError');\n      toast.error(errorMessage);\n    }\n  };\n\n  const applyFiltersAndSearch = useCallback((consultations: Consultation[]) => {\n    let filtered = consultations;\n\n    // Suchterm-Filter\n    if (searchTerm) {\n      const search = searchTerm.toLowerCase();\n      filtered = filtered.filter(consultation => \n        consultation.client?.name?.toLowerCase().includes(search) ||\n        consultation.notes?.toLowerCase().includes(search) ||\n        consultation.branch?.name?.toLowerCase().includes(search)\n      );\n    }\n\n    // Erweiterte Filter\n    if (filterConditions.length > 0) {\n      filtered = filtered.filter((consultation) => {\n        let result = true;\n        \n        for (let i = 0; i < filterConditions.length; i++) {\n          const condition = filterConditions[i];\n          let conditionResult = false;\n          \n          switch (condition.column) {\n            case 'client':\n              conditionResult = consultation.client?.name?.toLowerCase().includes(String(condition.value).toLowerCase()) || false;\n              break;\n            case 'branch':\n              conditionResult = consultation.branch?.name?.toLowerCase().includes(String(condition.value).toLowerCase()) || false;\n              break;\n            case 'notes':\n              conditionResult = consultation.notes?.toLowerCase().includes(String(condition.value).toLowerCase()) || false;\n              break;\n            case 'startTime':\n              const consultationDate = new Date(consultation.startTime).toISOString().split('T')[0];\n              let filterDate = String(condition.value);\n              \n              // Dynamische Datums-Marker verarbeiten\n              if (filterDate === '__TODAY__') {\n                //  KORREKT: Lokale Zeit verwenden (Timezone-Dokumentation befolgen)\n                const localToday = new Date();\n                const correctedToday = new Date(localToday.getTime() - localToday.getTimezoneOffset() * 60000);\n                filterDate = correctedToday.toISOString().split('T')[0];\n              } else if (filterDate === '__WEEK_FROM_TODAY__') {\n                //  KORREKT: Lokale Zeit verwenden (Timezone-Dokumentation befolgen)\n                const localToday = new Date();\n                const correctedToday = new Date(localToday.getTime() - localToday.getTimezoneOffset() * 60000);\n                const weekFromToday = new Date(correctedToday);\n                weekFromToday.setDate(correctedToday.getDate() + 7); // Heute + 7 Tage\n                filterDate = weekFromToday.toISOString().split('T')[0];\n              }\n              \n              switch (condition.operator) {\n                case 'after':\n                  conditionResult = consultationDate >= filterDate;\n                  break;\n                case 'before':\n                  conditionResult = consultationDate < filterDate;\n                  break;\n                case 'equals':\n                  conditionResult = consultationDate === filterDate;\n                  break;\n                default:\n                  conditionResult = false;\n              }\n              break;\n            case 'duration':\n              const duration = calculateDurationInMinutes(consultation.startTime, consultation.endTime);\n              const filterValue = Number(condition.value) * 60; // Convert hours to minutes\n              switch (condition.operator) {\n                case 'greater_than':\n                  conditionResult = duration > filterValue;\n                  break;\n                case 'less_than':\n                  conditionResult = duration < filterValue;\n                  break;\n                case 'equals':\n                  conditionResult = Math.abs(duration - filterValue) < 30; // 30-minute tolerance\n                  break;\n                default:\n                  conditionResult = false;\n              }\n              break;\n            case 'invoiceStatus':\n              const isInvoiced = isConsultationInvoiced(consultation);\n              const isInMonthlyReport = isConsultationInMonthlyReport(consultation);\n              const filterValueLower = String(condition.value).toLowerCase();\n              \n              if (filterValueLower === 'abgerechnet' || filterValueLower === 'invoiced' || filterValueLower === 'ja') {\n                conditionResult = isInvoiced || isInMonthlyReport;\n              } else if (filterValueLower === 'nicht abgerechnet' || filterValueLower === 'not invoiced' || filterValueLower === 'nein') {\n                conditionResult = !isInvoiced && !isInMonthlyReport;\n              } else if (filterValueLower === 'einzelrechnung' || filterValueLower === 'invoice') {\n                conditionResult = isInvoiced;\n              } else if (filterValueLower === 'monatsbericht' || filterValueLower === 'monthly report') {\n                conditionResult = isInMonthlyReport;\n              } else {\n                // Exact status match wenn ein spezifischer Status eingegeben wurde\n                if (isInvoiced) {\n                  const invoiceInfo = getConsultationInvoiceInfo(consultation);\n                  const statusText = invoiceInfo ? getInvoiceStatusText(invoiceInfo.status as any).toLowerCase() : '';\n                  conditionResult = statusText.includes(filterValueLower);\n                } else if (isInMonthlyReport) {\n                  const monthlyReportInfo = getConsultationMonthlyReportInfo(consultation);\n                  if (monthlyReportInfo) {\n                    const statusText = monthlyReportInfo.status === 'GENERATED' ? 'erstellt' : \n                                     monthlyReportInfo.status === 'SENT' ? 'gesendet' : 'archiviert';\n                    conditionResult = statusText.includes(filterValueLower);\n                  } else {\n                    conditionResult = false;\n                  }\n                } else {\n                  conditionResult = false;\n                }\n              }\n              break;\n            default:\n              conditionResult = false;\n          }\n          \n          if (i === 0) {\n            result = conditionResult;\n          } else {\n            const operator = filterLogicalOperators[i - 1];\n            if (operator === 'AND') {\n              result = result && conditionResult;\n            } else {\n              result = result || conditionResult;\n            }\n          }\n        }\n        \n        return result;\n      });\n    }\n\n    return filtered;\n  }, [consultations, searchTerm, filterConditions, filterLogicalOperators]);\n\n  const calculateDurationInMinutes = (startTime: string, endTime: string | null): number => {\n    if (!endTime) return 0;\n    const start = new Date(startTime);\n    const end = new Date(endTime);\n    return (end.getTime() - start.getTime()) / (1000 * 60);\n  };\n\n  // Timeline-Markierungen generieren\n  const generateTimelineMarkers = (consultations: Consultation[]) => {\n    const markers: Array<{\n      id: string;\n      type: 'day' | 'midday';\n      date: string;\n      label: string;\n      position: number; // Index position in der gefilterten Liste\n    }> = [];\n\n    consultations.forEach((consultation, index) => {\n      const currentDate = new Date(consultation.startTime);\n      const currentDay = format(currentDate, 'yyyy-MM-dd', { locale: de });\n      const currentHour = currentDate.getUTCHours(); // UTC verwenden statt getHours()\n      \n      // Prfe vorherige Beratung fr Tagesbergang\n      if (index > 0) {\n        const prevDate = new Date(consultations[index - 1].startTime);\n        const prevDay = format(prevDate, 'yyyy-MM-dd', { locale: de });\n        \n        if (currentDay !== prevDay) {\n          markers.push({\n            id: `day-${currentDay}`,\n            type: 'day',\n            date: currentDay,\n            label: format(currentDate, 'EEE, dd.MM.', { locale: de }),\n            position: index\n          });\n        }\n      } else if (index === 0) {\n        // Erste Beratung bekommt immer eine Tagesmarkierung\n        markers.push({\n          id: `day-${currentDay}`,\n          type: 'day', \n          date: currentDay,\n          label: format(currentDate, 'EEE, dd.MM.', { locale: de }),\n          position: index\n        });\n      }\n\n      // Prfe fr Mittag-Markierung (12:00 bergang) - jetzt mit UTC\n      if (index > 0) {\n        const prevDate = new Date(consultations[index - 1].startTime);\n        const prevHour = prevDate.getUTCHours(); // UTC verwenden statt getHours()\n        const prevDay = format(prevDate, 'yyyy-MM-dd', { locale: de });\n        \n        // Mittag-Markierung nur wenn am gleichen Tag und bergang ber 12:00 UTC\n        if (currentDay === prevDay && prevHour < 12 && currentHour >= 12) {\n          markers.push({\n            id: `midday-${currentDay}`,\n            type: 'midday',\n            date: currentDay,\n            label: t('consultations.midday'),\n            position: index\n          });\n        }\n      }\n    });\n\n    return markers;\n  };\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const filteredConsultations = useMemo(() => {\n    return applyFiltersAndSearch(consultations).sort((a, b) => {\n      return new Date(a.startTime).getTime() - new Date(b.startTime).getTime();\n    });\n  }, [consultations, filterConditions, filterLogicalOperators]);\n\n  // Total-Dauer aller sichtbaren Beratungen berechnen\n  const totalDuration = useMemo(() => {\n    return formatTotalDuration(filteredConsultations);\n  }, [filteredConsultations]);\n\n  // Timeline-Markierungen berechnen\n  const timelineMarkers = useMemo(() => {\n    return generateTimelineMarkers(filteredConsultations);\n  }, [filteredConsultations]);\n\n  // Helper function to check if consultation is billed in monthly report\n  const isConsultationInMonthlyReport = (consultation: Consultation): boolean => {\n    return consultation.monthlyReportId !== null && consultation.monthlyReportId !== undefined;\n  };\n\n  // Helper function to get monthly report info\n  const getConsultationMonthlyReportInfo = (consultation: Consultation) => {\n    return consultation.monthlyReport;\n  };\n\n  // Helper function to get the billing status\n  const getConsultationBillingStatus = (consultation: Consultation) => {\n    const isInvoiced = isConsultationInvoiced(consultation);\n    const isInMonthlyReport = isConsultationInMonthlyReport(consultation);\n    \n    if (isInvoiced) {\n      const invoiceInfo = getConsultationInvoiceInfo(consultation);\n      return {\n        type: 'invoice' as const,\n        status: t('consultations.invoice'),\n        info: invoiceInfo\n      };\n    } else if (isInMonthlyReport) {\n      const monthlyReportInfo = getConsultationMonthlyReportInfo(consultation);\n      return {\n        type: 'monthly' as const,\n        status: t('consultations.monthlyReport'),\n        info: monthlyReportInfo\n      };\n    }\n    \n    return null;\n  };\n\n  // Navigation functions\n  const navigateToMonthlyReports = (reportId?: number) => {\n    const url = reportId \n      ? `/payroll?tab=monthly-reports&reportId=${reportId}`\n      : '/payroll?tab=monthly-reports';\n    navigate(url);\n  };\n\n  const navigateToInvoices = (invoiceId?: number) => {\n    const url = invoiceId \n      ? `/payroll?tab=invoices&invoiceId=${invoiceId}`\n      : '/payroll?tab=invoices';\n    navigate(url);\n  };\n\n  const navigateToTask = (taskId: number) => {\n    navigate(`/worktracker?editTask=${taskId}`);\n  };\n\n  if (loading) return <div className=\"p-4\">{t('common.loading')}</div>;\n  if (error) return <div className=\"p-4 text-red-600\">{error}</div>;\n\n  return (\n    <>\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-300 dark:border-gray-700 p-6\">\n        {/* Header */}\n        <div className=\"flex items-center mb-6 justify-between px-2 sm:px-0\">\n          <div className=\"flex items-center\">\n            <ClockIcon className=\"h-6 w-6 mr-2 dark:text-white\" />\n            <div>\n              <h2 className=\"text-xl font-semibold dark:text-white\">{t('consultations.listTitle')}</h2>\n              {/* Total-Anzeige */}\n              <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-0.5\">\n                {t('consultations.count', { count: filteredConsultations.length })} - {t('consultations.total')}: {totalDuration}\n              </p>\n            </div>\n          </div>\n          \n          <div className=\"flex items-center gap-1.5\">\n            <input\n              type=\"text\"\n              placeholder={t('common.searchPlaceholder')}\n              className=\"w-[200px] px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n            />\n            \n            <button\n              className={`p-2 rounded-md ${getActiveFilterCount() > 0 ? 'bg-blue-50 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400' : 'hover:bg-gray-100 dark:hover:bg-gray-700'} ml-1 relative`}\n              onClick={() => setIsFilterPanelOpen(!isFilterPanelOpen)}\n              title={t('consultations.advancedFilters')}\n            >\n              <FunnelIcon className=\"h-5 w-5\" />\n              {getActiveFilterCount() > 0 && (\n                <span className=\"absolute -top-1 -right-1 w-4 h-4 bg-blue-600 dark:bg-blue-500 text-white rounded-full text-xs flex items-center justify-center\">\n                  {getActiveFilterCount()}\n                </span>\n              )}\n            </button>\n\n            {/* Rechnung erstellen Button */}\n            {canCreateInvoice() && (\n              <button\n                onClick={handleCreateInvoice}\n                className=\"p-2 bg-green-600 hover:bg-green-700 text-white rounded-md transition-colors ml-2\"\n                title={t('consultations.createInvoiceFromFiltered')}\n              >\n                <DocumentTextIcon className=\"h-5 w-5\" />\n              </button>\n            )}\n          </div>\n        </div>\n\n        {/* Filter-Pane */}\n        {isFilterPanelOpen && (\n          <div className=\"px-2 sm:px-0\">\n            <FilterPane\n              columns={[\n                { id: 'client', label: t('consultations.columns.client') },\n                { id: 'branch', label: t('consultations.columns.branch') },\n                { id: 'notes', label: t('consultations.columns.notes') },\n                { id: 'startTime', label: t('consultations.columns.date') },\n                { id: 'duration', label: t('consultations.columns.durationHours') },\n                { id: 'invoiceStatus', label: t('consultations.columns.invoiceStatus') }\n              ]}\n              onApply={applyFilterConditions}\n              onReset={resetFilterConditions}\n              savedConditions={filterConditions}\n              savedOperators={filterLogicalOperators}\n              tableId={CONSULTATIONS_TABLE_ID}\n            />\n          </div>\n        )}\n        \n        {/* Gespeicherte Filter als Tags anzeigen */}\n        <div className=\"px-2 sm:px-0\">\n          <SavedFilterTags\n            tableId={CONSULTATIONS_TABLE_ID}\n            onSelectFilter={applyFilterConditions}\n            onReset={resetFilterConditions}\n            activeFilterName={activeFilterName}\n            selectedFilterId={selectedFilterId}\n            onFilterChange={handleFilterChange}\n          />\n        </div>\n\n        {/* Timeline + Cards Layout */}\n        <div className=\"space-y-0.5 sm:space-y-1\">\n          {filteredConsultations.length === 0 ? (\n            <div className=\"text-center py-12 px-2 sm:px-0\">\n              <ClockIcon className=\"h-12 w-12 text-gray-400 dark:text-gray-500 mx-auto mb-4\" />\n              <div>\n                <p className=\"font-medium text-gray-900 dark:text-white\">{t('consultations.noConsultationsFound')}</p>\n                <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\n                  {searchTerm || filterConditions.length > 0\n                    ? t('consultations.tryOtherFilters')\n                    : t('consultations.noConsultationsYet')}\n                </p>\n              </div>\n            </div>\n          ) : (\n            filteredConsultations.map((consultation, index) => {\n              const dayMarker = timelineMarkers.find(m => m.type === 'day' && m.position === index);\n              const middayMarker = timelineMarkers.find(m => m.type === 'midday' && m.position === index);\n              \n              return (\n                <div key={consultation.id} className=\"relative\">\n                  {/* Tagesmarkierung ber der Card */}\n                  {dayMarker && (\n                    <div className=\"flex items-center mb-3 px-2 sm:px-0\">\n                      <div className=\"flex items-center\">\n                        <div className=\"w-3 h-3 rounded-full bg-blue-500 dark:bg-blue-400 border-2 border-white dark:border-gray-800\"></div>\n                        <div className=\"ml-3 text-sm font-medium text-gray-700 dark:text-gray-300\">\n                          {dayMarker.label}\n                        </div>\n                      </div>\n                      <div className=\"flex-1 ml-4 h-px bg-gray-200 dark:bg-gray-600\"></div>\n                    </div>\n                  )}\n                  \n                  {/* Mittag-Markierung */}\n                  {middayMarker && (\n                    <div className=\"flex items-center mb-3 px-2 sm:px-0\">\n                      <div className=\"flex items-center\">\n                        <div className=\"w-1.5 h-1.5 rounded-full bg-gray-400 dark:bg-gray-500\"></div>\n                        <div className=\"ml-3 text-xs text-gray-500 dark:text-gray-400\">\n                          {middayMarker.label}\n                        </div>\n                      </div>\n                      <div className=\"flex-1 ml-4 h-px bg-gray-300 dark:bg-gray-600\"></div>\n                    </div>\n                  )}\n\n                  {/* Card ohne Timeline-Punkt */}\n                  <div className=\"bg-white dark:bg-gray-800 shadow rounded-lg md:border md:border-gray-200 md:dark:border-gray-700 hover:shadow-md transition-shadow\">\n                    {/* Card Content - 1/3 left, 2/3 right auf allen Bildschirmgren */}\n                    <div className=\"p-4\">\n                      <div className=\"grid grid-cols-3 gap-4\">\n                        {/* Left: Compact Info - 1/3 auf allen Bildschirmgren */}\n                        <div className=\"col-span-1 space-y-3\">\n                          {/* Client Header */}\n                          <div className=\"flex items-center space-x-2\">\n                            <div className=\"min-w-0 flex-1\">\n                              <h3 className=\"font-medium text-gray-900 dark:text-white text-sm truncate\">\n                                {consultation.client?.name}\n                              </h3>\n                              {consultation.client?.company && (\n                                <p className=\"text-xs text-gray-500 dark:text-gray-400 truncate\">\n                                  {consultation.client.company}\n                                </p>\n                              )}\n                            </div>\n                          </div>\n\n                          {/* Billing Status Indicator */}\n                          {(() => {\n                            const billingStatus = getConsultationBillingStatus(consultation);\n                            \n                            if (billingStatus) {\n                              if (billingStatus.type === 'invoice') {\n                                // Individual invoice\n                                return (\n                                  <div className=\"flex items-center space-x-2\">\n                                    <div className=\"flex items-center space-x-1\">\n                                      <DocumentTextIcon className=\"h-4 w-4 text-green-600 dark:text-green-400\" />\n                                      <button \n                                        onClick={() => navigateToInvoices(billingStatus.info?.id)}\n                                        className=\"text-xs text-green-700 dark:text-green-400 font-medium hover:underline cursor-pointer\"\n                                      >\n                                        {t('consultations.invoice')}\n                                      </button>\n                                    </div>\n                                    {billingStatus.info && 'invoiceNumber' in billingStatus.info && (\n                                      <div className=\"flex items-center space-x-1\">\n                                        <button\n                                          onClick={() => navigateToInvoices(billingStatus.info?.id)}\n                                          className={`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium hover:opacity-80 cursor-pointer ${getInvoiceStatusColor(billingStatus.info.status as any)}`}\n                                          title={`Rechnung ${billingStatus.info.invoiceNumber} vom ${format(new Date(billingStatus.info.issueDate), 'dd.MM.yyyy', { locale: de })}`}\n                                        >\n                                          {getInvoiceStatusText(billingStatus.info.status as any)}\n                                        </button>\n                                      </div>\n                                    )}\n                                  </div>\n                                );\n                              } else if (billingStatus.type === 'monthly') {\n                                // Monthly report\n                                return (\n                                  <div className=\"flex items-center space-x-2\">\n                                    <div className=\"flex items-center space-x-1\">\n                                      <ChartBarIcon className=\"h-4 w-4 text-green-600 dark:text-green-400\" />\n                                      <button \n                                        onClick={() => navigateToMonthlyReports(billingStatus.info?.id)}\n                                        className=\"text-xs text-green-700 dark:text-green-400 font-medium hover:underline cursor-pointer\"\n                                      >\n                                        {t('consultations.monthlyReport')}\n                                      </button>\n                                    </div>\n                                    {billingStatus.info && 'reportNumber' in billingStatus.info && (\n                                      <div className=\"flex items-center space-x-1\">\n                                        <button \n                                          onClick={() => navigateToMonthlyReports(billingStatus.info?.id)}\n                                          className=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300 hover:opacity-80 cursor-pointer\"\n                                          title={`Monatsbericht ${billingStatus.info.reportNumber}`}\n                                        >\n                                          {billingStatus.info.status === 'GENERATED' ? t('analytics.monthlyReports.status.generated') : \n                                           billingStatus.info.status === 'SENT' ? t('analytics.monthlyReports.status.sent') : t('analytics.monthlyReports.status.archived')}\n                                        </button>\n                                      </div>\n                                    )}\n                                  </div>\n                                );\n                              }\n                            }\n                            \n                            return null;\n                          })()}\n\n                          {/* Time Range - Single compact field */}\n                          <div>\n                            <p className=\"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1\">{t('consultations.columns.time')}</p>\n                            <div className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                              {editingTimeId === consultation.id && editingTimeType === 'startTime' ? (\n                                <div className=\"flex items-center space-x-1\">\n                                  <input\n                                    type=\"datetime-local\"\n                                    value={editingTimeValue}\n                                    onChange={(e) => setEditingTimeValue(e.target.value)}\n                                    className=\"text-xs rounded border-gray-300 dark:border-gray-600 dark:bg-gray-700 w-full\"\n                                  />\n                                  <button\n                                    onClick={() => handleTimeSave(consultation.id)}\n                                    className=\"p-0.5 text-green-600 hover:text-green-700\"\n                                    title={t('common.save')}\n                                  >\n                                    <svg className=\"h-3 w-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                                    </svg>\n                                  </button>\n                                  <button\n                                    onClick={handleTimeCancel}\n                                    className=\"p-0.5 text-red-600 hover:text-red-700\"\n                                    title={t('common.cancel')}\n                                  >\n                                    <XMarkIcon className=\"h-3 w-3\" />\n                                  </button>\n                                </div>\n                              ) : editingTimeId === consultation.id && editingTimeType === 'endTime' ? (\n                                <div className=\"flex items-center space-x-1\">\n                                  <input\n                                    type=\"datetime-local\"\n                                    value={editingTimeValue}\n                                    onChange={(e) => setEditingTimeValue(e.target.value)}\n                                    className=\"text-xs rounded border-gray-300 dark:border-gray-600 dark:bg-gray-700 w-full\"\n                                  />\n                                  <button\n                                    onClick={() => handleTimeSave(consultation.id)}\n                                    className=\"p-0.5 text-green-600 hover:text-green-700\"\n                                    title={t('common.save')}\n                                  >\n                                    <svg className=\"h-3 w-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                                    </svg>\n                                  </button>\n                                  <button\n                                    onClick={handleTimeCancel}\n                                    className=\"p-0.5 text-red-600 hover:text-red-700\"\n                                    title={t('common.cancel')}\n                                  >\n                                    <XMarkIcon className=\"h-3 w-3\" />\n                                  </button>\n                                </div>\n                              ) : (\n                                <div className=\"flex items-center space-x-1\">\n                                  <button\n                                    onClick={() => handleTimeEdit(consultation, 'startTime')}\n                                    className=\"text-blue-600 hover:text-blue-700 dark:text-blue-400 hover:underline\"\n                                  >\n                                    {formatTime(consultation.startTime)}\n                                  </button>\n                                  <span className=\"text-gray-400\">-</span>\n                                  {consultation.endTime ? (\n                                    <button\n                                      onClick={() => handleTimeEdit(consultation, 'endTime')}\n                                      className=\"text-blue-600 hover:text-blue-700 dark:text-blue-400 hover:underline\"\n                                    >\n                                      {formatTime(consultation.endTime)}\n                                    </button>\n                                  ) : (\n                                    <div className=\"flex items-center\">\n                                      <div className=\"w-1.5 h-1.5 bg-green-500 rounded-full mr-1 animate-pulse\"></div>\n                                      <span className=\"text-green-600 dark:text-green-400 text-xs\">{t('consultations.active')}</span>\n                                    </div>\n                                  )}\n                                </div>\n                              )}\n                            </div>\n                          </div>\n\n                          {/* Duration */}\n                          <div>\n                            <p className=\"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1\">{t('consultations.columns.duration')}</p>\n                            <p className=\"text-sm font-medium text-gray-900 dark:text-white\">\n                              {calculateDuration(consultation.startTime, consultation.endTime)}\n                            </p>\n                          </div>\n\n                          {/* Tasks - Compact */}\n                          {consultation.taskLinks && consultation.taskLinks.length > 0 && (\n                            <div>\n                              <p className=\"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1\">\n                                {t('consultations.tasks', { count: consultation.taskLinks.length })}\n                              </p>\n                              <div className=\"space-y-1\">\n                                {consultation.taskLinks.slice(0, 2).map((taskLink) => (\n                                  <button\n                                    key={taskLink.id}\n                                    onClick={() => navigateToTask(taskLink.task.id)}\n                                    className=\"flex items-center text-xs text-blue-700 dark:text-blue-300 bg-blue-50 dark:bg-blue-900/20 rounded px-2 py-1 hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors cursor-pointer w-full text-left\"\n                                  >\n                                    <LinkIcon className=\"h-3 w-3 mr-1 flex-shrink-0\" />\n                                    <span className=\"truncate\">{taskLink.task.title}</span>\n                                  </button>\n                                ))}\n                                {consultation.taskLinks.length > 2 && (\n                                  <button\n                                    onClick={() => {\n                                      // Navigate to first task if more than 2 tasks\n                                      if (consultation.taskLinks && consultation.taskLinks.length > 0) {\n                                        navigateToTask(consultation.taskLinks[0].task.id);\n                                      }\n                                    }}\n                                    className=\"text-xs text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 cursor-pointer\"\n                                  >\n                                    {t('consultations.moreTasks', { count: consultation.taskLinks.length - 2 })}\n                                  </button>\n                                )}\n                              </div>\n                            </div>\n                          )}\n                        </div>\n\n                        {/* Right: Notes - 2/3 auf allen Bildschirmgren */}\n                        <div className=\"col-span-2 relative\">\n                          {/* Action Icons in der rechten oberen Ecke */}\n                          <div className=\"absolute top-0 right-0 flex items-center space-x-1 z-10\">\n                            {hasPermission('consultations', 'write') && (\n                              <button\n                                onClick={() => handleLinkTask(consultation.id)}\n                                className=\"p-1 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 rounded\"\n                                title={t('consultations.linkTask')}\n                              >\n                                <LinkIcon className=\"h-4 w-4\" />\n                              </button>\n                            )}\n                            {hasPermission('consultations', 'write') && consultation.endTime && (\n                              <button\n                                onClick={() => handleDeleteConsultation(consultation.id)}\n                                className=\"p-1 text-gray-400 hover:text-red-600 dark:hover:text-red-400 rounded\"\n                                title={t('consultations.delete')}\n                              >\n                                <TrashIcon className=\"h-4 w-4\" />\n                              </button>\n                            )}\n                          </div>\n                          \n                          <p className=\"text-xs font-medium text-gray-500 dark:text-gray-400 mb-2\">{t('consultations.columns.notes')}</p>\n                          {editingNotesId === consultation.id ? (\n                            <div className=\"space-y-2\">\n                              <textarea\n                                value={editingNotes}\n                                onChange={(e) => setEditingNotes(e.target.value)}\n                                className=\"w-full rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-sm resize-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500\"\n                                rows={3}\n                                placeholder={t('consultations.notesPlaceholder')}\n                              />\n                              <div className=\"flex justify-end space-x-2\">\n                                <button\n                                  onClick={handleNotesCancel}\n                                  className=\"p-1.5 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md\"\n                                  title={t('common.cancel')}\n                                >\n                                  <XMarkIcon className=\"h-4 w-4\" />\n                                </button>\n                                <button\n                                  onClick={() => handleNotesSave(consultation.id)}\n                                  className=\"p-1.5 bg-blue-600 text-white hover:bg-blue-700 rounded-md\"\n                                  title={t('common.save')}\n                                >\n                                  <CheckIcon className=\"h-4 w-4\" />\n                                </button>\n                              </div>\n                            </div>\n                          ) : (\n                            <div \n                              className=\"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded p-2 min-h-[60px] border border-dashed border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500 transition-colors\"\n                              onClick={() => handleNotesEdit(consultation)}\n                            >\n                              {consultation.notes ? (\n                                <p className=\"text-sm text-gray-900 dark:text-white whitespace-pre-wrap leading-relaxed\">\n                                  {consultation.notes}\n                                </p>\n                              ) : (\n                                <div className=\"flex items-center justify-center h-full text-center\">\n                                  <span className=\"text-xs text-gray-400 dark:text-gray-500\">\n                                    {t('consultations.addNotes')}\n                                  </span>\n                                </div>\n                              )}\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              );\n            })\n          )}\n        </div>\n      </div>\n\n      {/* Link Task Modal */}\n      {linkTaskModalOpen && selectedConsultationId && (\n        <LinkTaskModal\n          isOpen={linkTaskModalOpen}\n          onClose={() => {\n            setLinkTaskModalOpen(false);\n            setSelectedConsultationId(null);\n          }}\n          consultationId={selectedConsultationId}\n          onTaskLinked={handleTaskLinked}\n        />\n      )}\n\n      {/* Create Invoice Modal */}\n      {showCreateInvoiceModal && (\n        <CreateInvoiceModal\n          isOpen={showCreateInvoiceModal}\n          onClose={() => setShowCreateInvoiceModal(false)}\n          consultations={filteredConsultations}\n          onInvoiceCreated={(invoiceId) => {\n            setShowCreateInvoiceModal(false);\n            // Nach Rechnungserstellung: Markiere betroffene Consultations als abgerechnet\n            // Fr jetzt: Reload der Liste (spter knnte optimiert werden)\n            loadConsultations();\n            toast.success(t('consultations.invoiceCreated'));\n          }}\n        />\n      )}\n    </>\n  );\n});\n\nexport default ConsultationList; ","import React, { useCallback, useRef } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { usePermissions } from '../hooks/usePermissions.ts';\nimport ConsultationTracker from '../components/ConsultationTracker.tsx';\nimport ConsultationList, { ConsultationListRef } from '../components/ConsultationList.tsx';\n\nconst Consultations: React.FC = () => {\n  const { t } = useTranslation();\n  const { hasPermission } = usePermissions();\n  const consultationListRef = useRef<ConsultationListRef>(null);\n\n  // Callback-Funktion fr das Neuladen der Beratungsliste (normale Aktionen)\n  const handleConsultationChange = useCallback((consultation?: any) => {\n    if (consultation && consultation.id) {\n      // Wenn eine Consultation bergeben wurde, verwenden wir den imperativen Handle\n      // um die Consultation zur Liste hinzuzufgen oder zu aktualisieren\n      // Prfe: Wenn endTime vorhanden, ist es ein Update (Stop), sonst ein Add (Start)\n      if (consultation.endTime) {\n        // Consultation wurde beendet - Update\n        consultationListRef.current?.updateConsultation?.(consultation);\n      } else {\n        // Consultation wurde gestartet - Add\n        consultationListRef.current?.addConsultation?.(consultation);\n      }\n    } else {\n      // Fallback: Vollstndiges Reload wenn keine Consultation bergeben\n      consultationListRef.current?.refresh();\n    }\n  }, []);\n\n  // Callback-Funktion fr das Starten einer Beratung (Filter wechseln)\n  const handleConsultationStarted = useCallback((clientName: string) => {\n    // Triggert ein Neuladen der Beratungsliste UND wechselt zum Client-Filter\n    consultationListRef.current?.refresh();\n    consultationListRef.current?.activateClientFilter?.(clientName);\n  }, []);\n\n  // Prfe Berechtigungen\n  if (!hasPermission('consultations', 'read')) {\n    return (\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <div className=\"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-md p-4\">\n          <div className=\"flex\">\n            <div className=\"ml-3\">\n              <h3 className=\"text-sm font-medium text-red-800 dark:text-red-200\">\n                {t('consultations.noPermission')}\n              </h3>\n              <div className=\"mt-2 text-sm text-red-700 dark:text-red-300\">\n                <p>{t('consultations.noPermissionMessage')}</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen dark:bg-gray-900\">\n      <div className=\"max-w-7xl mx-auto py-0 px-2 -mt-6 sm:-mt-3 lg:-mt-3 sm:px-4 lg:px-6\">\n        <div className=\"space-y-6\">\n        {/* Consultation Tracker */}\n        <ConsultationTracker \n          onConsultationChange={handleConsultationChange}\n          onConsultationStarted={handleConsultationStarted}\n        />\n\n        {/* Consultation List */}\n        <ConsultationList \n          ref={consultationListRef}\n          onConsultationChange={handleConsultationChange}\n        />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Consultations; ","import { format, parseISO, differenceInMinutes, parse, getWeek, getYear, addDays, startOfWeek } from 'date-fns';\nimport { de } from 'date-fns/locale';\n\n/**\n * Utility-Funktionen fr die Datums- und Zeitverarbeitung im Frontend.\n * Diese Funktionen sorgen fr eine konsistente Handhabung von Datum und Zeit\n * in allen Komponenten.\n */\n\n/**\n * Formatiert ein Datum fr die Anzeige im deutschen Format.\n * @param dateString Das zu formatierende Datum im Format YYYY-MM-DD\n * @returns Formatiertes Datum im Format DD.MM.YYYY oder '-' bei Fehler\n */\nexport const formatDate = (dateString: string): string => {\n    if (!dateString) return '-';\n    \n    try {\n        // Wir erstellen ein neues Date-Objekt und setzen die Uhrzeit auf 12:00 Mittag\n        // um Probleme mit Zeitzonen zu vermeiden\n        const dateParts = dateString.split('-');\n        if (dateParts.length !== 3) return '-';\n        \n        const year = parseInt(dateParts[0]);\n        const month = parseInt(dateParts[1]) - 1; // Monate sind 0-basiert in JavaScript\n        const day = parseInt(dateParts[2]);\n        \n        const date = new Date(year, month, day, 12, 0, 0);\n        \n        return date.toLocaleDateString('de-DE', {\n            day: '2-digit',\n            month: '2-digit',\n            year: 'numeric'\n        });\n    } catch (error) {\n        console.error('Fehler beim Formatieren des Datums:', error);\n        return '-';\n    }\n};\n\n/**\n * Formatiert eine Zeit fr die Anzeige basierend auf UTC.\n * @param dateString Das zu formatierende Datum im ISO-Format\n * @returns Formatierte Zeit im Format HH:MM oder '-' bei Fehler\n */\nexport const formatTime = (dateString: string): string => {\n    if (!dateString) return '-';\n    \n    try {\n        // Direkt aus dem ISO-String die Uhrzeit extrahieren ohne Umrechnung\n        const date = parseISO(dateString);\n        \n        // Verwende UTC-Stunden und -Minuten, um die DB-Zeit direkt zu zeigen\n        const hours = date.getUTCHours().toString().padStart(2, '0');\n        const minutes = date.getUTCMinutes().toString().padStart(2, '0');\n        \n        return `${hours}:${minutes}`;\n    } catch (error) {\n        console.error(`Fehler beim Formatieren der Zeit fr ${dateString}:`, error);\n        return '-';\n    }\n};\n\n/**\n * Berechnet die Dauer zwischen zwei Zeitpunkten und formatiert sie als \"Nh Nm\".\n * @param startTime Startzeit im ISO-Format\n * @param endTime Endzeit im ISO-Format\n * @returns Formatierte Dauer als \"Nh Nm\" oder '-' bei Fehler\n */\nexport const calculateDuration = (startTime: string, endTime: string | null): string => {\n    if (!startTime || !endTime) return '-';\n    \n    try {\n        // Entferne das 'Z' am Ende der ISO-Strings, um Zeitzonenumrechnungen zu verhindern\n        const startISOString = startTime.endsWith('Z') \n            ? startTime.substring(0, startTime.length - 1)\n            : startTime;\n        \n        const endISOString = endTime.endsWith('Z') \n            ? endTime.substring(0, endTime.length - 1)\n            : endTime;\n        \n        const start = new Date(startISOString);\n        const end = new Date(endISOString);\n        \n        const durationMs = end.getTime() - start.getTime();\n        const durationMinutes = Math.floor(durationMs / (1000 * 60));\n        \n        const hours = Math.floor(durationMinutes / 60);\n        const minutes = durationMinutes % 60;\n        \n        return `${hours}h ${minutes}m`;\n    } catch (error) {\n        console.error('Fehler bei der Dauerberechnung:', error);\n        return '-';\n    }\n};\n\n/**\n * Konvertiert ein Wochenformat (YYYY-Www) in ein Datum (YYYY-MM-DD) fr den Montag dieser Woche.\n * @param weekString Wochenformat im Format YYYY-Www\n * @returns Datum des Montags der Woche im Format YYYY-MM-DD\n */\nexport const convertWeekToDate = (weekString: string): string => {\n    try {\n        // Format: YYYY-Www\n        const year = parseInt(weekString.substring(0, 4));\n        const week = parseInt(weekString.substring(6));\n        \n        // Alternative Methode zur Berechnung des Montags fr eine Kalenderwoche\n        // Statt parse mit yyyy und ww (was einen Fehler verursacht) verwenden wir\n        // einen direkten Algorithmus zur Berechnung\n        \n        // 1. Beginne mit dem ersten Tag des Jahres\n        const firstDayOfYear = new Date(Date.UTC(year, 0, 1, 12, 0, 0));\n        \n        // 2. Finde den ersten Donnerstag des Jahres (fr ISO-Wochen)\n        // Verschiebe den Tag, bis wir am ersten Donnerstag sind\n        const dayOfWeek = firstDayOfYear.getUTCDay(); // 0 = Sonntag, 4 = Donnerstag\n        const daysToThursday = dayOfWeek <= 4 ? 4 - dayOfWeek : 11 - dayOfWeek; // Falls Sonntag ist 7\n        const firstThursday = new Date(Date.UTC(year, 0, 1 + daysToThursday, 12, 0, 0));\n        \n        // 3. Der erste Donnerstag ist immer in der ersten Woche\n        // Jetzt berechnen wir den Donnerstag der gewnschten Woche\n        const targetThursday = new Date(Date.UTC(\n            firstThursday.getUTCFullYear(),\n            firstThursday.getUTCMonth(),\n            firstThursday.getUTCDate() + (7 * (week - 1)),\n            12, 0, 0\n        ));\n        \n        // 4. Berechne den Montag dieser Woche (3 Tage vor dem Donnerstag)\n        const monday = new Date(Date.UTC(\n            targetThursday.getUTCFullYear(),\n            targetThursday.getUTCMonth(),\n            targetThursday.getUTCDate() - 3,\n            12, 0, 0\n        ));\n        \n        // Formatiere das Datum als YYYY-MM-DD\n        const formattedDate = format(monday, 'yyyy-MM-dd');\n        \n        // Protokolliere das berechnete Datum fr Debug-Zwecke\n        console.log(`Konvertierte Woche ${weekString} zu Datum: ${formattedDate} (Wochentag: ${format(monday, 'EEEE', { locale: de })})`);\n        \n        // Zustzliche Sicherheitsberprfung: Stelle sicher, dass es ein Montag ist\n        if (format(monday, 'EEEE', { locale: de }) !== 'Montag') {\n            console.warn(`Berechnetes Datum ist kein Montag! Korrigiere...`);\n            // Finde den nchsten Montag\n            const correctedMonday = startOfWeek(monday, { weekStartsOn: 1 });\n            return format(correctedMonday, 'yyyy-MM-dd');\n        }\n        \n        return formattedDate;\n    } catch (error) {\n        console.error('Fehler beim Konvertieren des Wochendatums:', error);\n        // Im Fehlerfall den letzten Montag als Fallback verwenden\n        const fallbackMonday = startOfWeek(new Date(), { weekStartsOn: 1 });\n        return format(fallbackMonday, 'yyyy-MM-dd');\n    }\n};\n\n/**\n * Prft, ob ein Worktime-Eintrag fr den ausgewhlten Tag relevant ist.\n * @param worktime Der Worktime-Eintrag\n * @param selectedDate Ausgewhltes Datum im Format YYYY-MM-DD\n * @returns true, wenn der Eintrag fr den ausgewhlten Tag relevant ist\n */\nexport const isWorktimeRelevantForSelectedDate = (worktime: any, selectedDate: string): boolean => {\n    try {\n        if (!worktime || !worktime.startTime) return false;\n        \n        // Extrahiere nur den Datumsteil (YYYY-MM-DD) aus dem startTime ISO-String\n        const dateOnly = worktime.startTime.split('T')[0];\n        \n        // Vergleiche mit selectedDate\n        return dateOnly === selectedDate;\n    } catch (error) {\n        console.error(\"Fehler beim Prfen der Relevanz eines Worktime-Eintrags:\", error);\n        return false;\n    }\n};\n\n/**\n * Berechnet die Wochentage von Montag bis Sonntag basierend auf einem Startdatum.\n * @param weekStartDate Montag der Woche im Format YYYY-MM-DD\n * @returns Array von Objekten mit date und day Eigenschaften\n */\nexport const getWeekDays = (weekStartDate: string): Array<{ date: string; day: string }> => {\n    if (!weekStartDate) return [];\n    \n    // Beginne mit dem angegebenen Datum als Montag\n    const weekStart = new Date(weekStartDate);\n    \n    // Berechne alle 7 Tage der Woche\n    const weekDays: Array<{ date: string; day: string }> = [];\n    for (let i = 0; i < 7; i++) {\n        const day = addDays(weekStart, i);\n        const dayInfo = {\n            date: format(day, 'yyyy-MM-dd'),\n            day: format(day, 'EEEE', { locale: de })\n        };\n        weekDays.push(dayInfo);\n    }\n    \n    return weekDays;\n};\n\n/**\n * Formatiert ein ISO-DateTime fr die Anzeige im deutschen Format mit Uhrzeit.\n * Diese Funktion wird speziell fr Cerebro-Artikel verwendet.\n * @param dateTimeString Das zu formatierende Datum im ISO-Format (z.B. 2023-06-15T14:30:00Z)\n * @returns Formatiertes Datum und Uhrzeit im Format DD.MM.YYYY HH:MM\n */\nexport const formatDateTimeForCerebro = (dateTimeString: string): string => {\n    if (!dateTimeString) return '-';\n    \n    try {\n        const date = new Date(dateTimeString);\n        \n        // Datum und Uhrzeit im deutschen Format\n        return date.toLocaleDateString('de-DE', {\n            day: '2-digit',\n            month: '2-digit',\n            year: 'numeric',\n            hour: '2-digit',\n            minute: '2-digit'\n        });\n    } catch (error) {\n        console.error('Fehler beim Formatieren des Datums und der Zeit:', error);\n        return '-';\n    }\n};\n\n/**\n * Berechnet die Quinzena (15-Tage-Periode) fr ein gegebenes Datum.\n * Quinzenas sind monatsbasiert:\n * - Erste Quinzena: 1.-15. des Monats\n * - Zweite Quinzena: 16. bis letzter Tag des Monats\n * @param date Datum im Format YYYY-MM-DD\n * @returns Quinzena-String im Format YYYY-MM-Qq (z.B. \"2025-01-Q1\" fr erste Quinzena Januar)\n */\nexport const getQuinzenaFromDate = (date: string): string => {\n    try {\n        const dateObj = new Date(date + 'T12:00:00');\n        const year = dateObj.getFullYear();\n        const month = dateObj.getMonth() + 1; // 1-12\n        const day = dateObj.getDate();\n        \n        // Erste Quinzena: 1.-15., Zweite Quinzena: 16.-Monatsende\n        const quinzena = day <= 15 ? 1 : 2;\n        \n        return `${year}-${String(month).padStart(2, '0')}-Q${quinzena}`;\n    } catch (error) {\n        console.error('Fehler beim Berechnen der Quinzena:', error);\n        const today = new Date();\n        const year = today.getFullYear();\n        const month = today.getMonth() + 1;\n        return `${year}-${String(month).padStart(2, '0')}-Q1`;\n    }\n};\n\n/**\n * Konvertiert eine Quinzena (YYYY-MM-Qq) in das Startdatum (erster Tag der Quinzena).\n * @param quinzenaString Quinzena im Format YYYY-MM-Qq (z.B. \"2025-01-Q1\")\n * @returns Datum des ersten Tages der Quinzena im Format YYYY-MM-DD\n */\nexport const convertQuinzenaToDate = (quinzenaString: string): string => {\n    try {\n        // Format: YYYY-MM-Qq oder YYYY-Qqq (fr Rckwrtskompatibilitt)\n        let year: number, month: number, quinzena: number;\n        \n        if (quinzenaString.includes('-Q')) {\n            // Format: YYYY-MM-Qq oder YYYY-Qqq\n            const parts = quinzenaString.split('-Q');\n            const datePart = parts[0];\n            quinzena = parseInt(parts[1]);\n            \n            if (datePart.includes('-')) {\n                // Format: YYYY-MM-Qq\n                const dateParts = datePart.split('-');\n                year = parseInt(dateParts[0]);\n                month = parseInt(dateParts[1]);\n            } else {\n                // Format: YYYY-Qqq (Rckwrtskompatibilitt - berechne Monat basierend auf Quinzena)\n                year = parseInt(datePart);\n                // Fr alte Format: Q1 = Jan, Q2 = Feb, etc. (vereinfacht)\n                month = Math.ceil(quinzena / 2);\n            }\n        } else {\n            throw new Error('Ungltiges Quinzena-Format');\n        }\n        \n        // Erste Quinzena beginnt am 1., zweite am 16.\n        const startDay = quinzena === 1 ? 1 : 16;\n        \n        const quinzenaStart = new Date(Date.UTC(year, month - 1, startDay, 12, 0, 0));\n        return format(quinzenaStart, 'yyyy-MM-dd');\n    } catch (error) {\n        console.error('Fehler beim Konvertieren der Quinzena:', error);\n        const fallback = startOfWeek(new Date(), { weekStartsOn: 1 });\n        return format(fallback, 'yyyy-MM-dd');\n    }\n};\n\n/**\n * Berechnet alle Tage einer Quinzena basierend auf einem Startdatum.\n * Erste Quinzena: 15 Tage (1.-15.), Zweite Quinzena: variabel (16.-Monatsende)\n * @param quinzenaStartDate Erster Tag der Quinzena im Format YYYY-MM-DD\n * @returns Array von Objekten mit date und day Eigenschaften\n */\nexport const getQuinzenaDays = (quinzenaStartDate: string): Array<{ date: string; day: string }> => {\n    if (!quinzenaStartDate) return [];\n    \n    const start = new Date(quinzenaStartDate);\n    const year = start.getFullYear();\n    const month = start.getMonth(); // 0-11\n    const day = start.getDate();\n    \n    // Bestimme Anzahl der Tage in der Quinzena\n    let daysCount: number;\n    if (day === 1) {\n        // Erste Quinzena: immer 15 Tage\n        daysCount = 15;\n    } else {\n        // Zweite Quinzena: 16. bis Monatsende\n        // Berechne letzter Tag des Monats\n        const lastDayOfMonth = new Date(year, month + 1, 0).getDate();\n        daysCount = lastDayOfMonth - 15; // 16. bis Monatsende\n    }\n    \n    const quinzenaDays: Array<{ date: string; day: string }> = [];\n    \n    for (let i = 0; i < daysCount; i++) {\n        const currentDay = addDays(start, i);\n        const dayInfo = {\n            date: format(currentDay, 'yyyy-MM-dd'),\n            day: format(currentDay, 'EEEE', { locale: de })\n        };\n        quinzenaDays.push(dayInfo);\n    }\n    \n    return quinzenaDays;\n};\n\n/**\n * Berechnet die aktuelle Quinzena im Format YYYY-MM-Qq.\n * @returns Quinzena-String im Format YYYY-MM-Qq (z.B. \"2025-01-Q1\")\n */\nexport const getCurrentQuinzena = (): string => {\n    const today = new Date();\n    return getQuinzenaFromDate(format(today, 'yyyy-MM-dd'));\n};\n\n/**\n * Hilfsfunktionen fr die Datumsbehandlung im Frontend\n */\n\n/**\n * Erstellt ein Date-Objekt ohne Zeitzonenverschiebung\n * @param dateString Ein ISO-Zeitstring\n * @returns Date-Objekt mit korrigiertem Zeitzonenversatz\n */\nexport const createLocalDate = (dateString: string): Date => {\n  const date = new Date(dateString);\n  // Korrigiere den Zeitzonenversatz\n  return new Date(date.getTime() + date.getTimezoneOffset() * 60000);\n};\n\n/* CLAUDE-ANCHOR: TIMEZONE-CONVERSION-001 - Zentrale Timezone-sichere Konvertierung fr datetime-local Inputs */\n/**\n * KRITISCH: Konvertiert datetime-local Input-Werte korrekt fr die API.\n * \n * PROBLEM: datetime-local gibt lokale Zeit zurck (z.B. \"2024-01-15T14:01\")\n * Wenn wir einfach \":00.000\" anhngen, wird es als UTC interpretiert  5h Unterschied!\n * \n * LSUNG: Explizit als lokale Zeit interpretieren und korrekt formatieren.\n * \n * @param datetimeLocalValue Wert aus datetime-local Input (Format: \"YYYY-MM-DDTHH:mm\")\n * @returns ISO-String der als lokale Zeit interpretiert wird (ohne 'Z' Suffix)\n * \n * @example\n * Input: \"2024-01-15T14:01\" (User gibt 14:01 ein)\n * Output: \"2024-01-15T14:01:00.000\" (wird als lokale Zeit gespeichert)\n * Nicht: \"2024-01-15T14:01:00.000Z\" (wrde als UTC interpretiert)\n */\nexport const convertDatetimeLocalToApi = (datetimeLocalValue: string): string => {\n    if (!datetimeLocalValue) {\n        throw new Error('Datetime-local Wert ist erforderlich');\n    }\n    \n    try {\n        // datetime-local Format: \"YYYY-MM-DDTHH:mm\"\n        // Wir fgen nur Sekunden und Millisekunden hinzu, KEIN 'Z' Suffix\n        const apiFormat = `${datetimeLocalValue}:00.000`;\n        \n        // Zustzliche Validierung: Prfe ob das Format gltig ist\n        if (!/^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{3}$/.test(apiFormat)) {\n            throw new Error(`Ungltiges Datumsformat: ${apiFormat}`);\n        }\n        \n        return apiFormat;\n    } catch (error) {\n        console.error('Fehler bei der Datetime-Local Konvertierung:', error);\n        throw new Error(`Konvertierung von datetime-local fehlgeschlagen: ${datetimeLocalValue}`);\n    }\n};\n\n/**\n * KRITISCH: Konvertiert API-Zeitstempel zurck zu datetime-local Format.\n * \n * Wird verwendet beim Bearbeiten von Zeiten - konvertiert DB-Zeit zurck zu Input-Format.\n * Behandelt sowohl UTC-Timestamps (mit 'Z') als auch lokale Timestamps (ohne 'Z').\n * \n * @param apiTimestamp Zeitstempel aus der API (ISO-String)\n * @returns Formatiert fr datetime-local Input (Format: \"YYYY-MM-DDTHH:mm\")\n * \n * @example\n * Input: \"2024-01-15T14:01:00.000Z\" (UTC aus DB)\n * Output: \"2024-01-15T14:01\" (fr datetime-local Input)\n */\nexport const convertApiToDatetimeLocal = (apiTimestamp: string): string => {\n    if (!apiTimestamp) {\n        throw new Error('API-Timestamp ist erforderlich');\n    }\n    \n    try {\n        // Entferne das 'Z' am Ende des Strings, damit JS den Zeitstempel nicht als UTC interpretiert\n        // Dies ist wichtig fr konsistente Zeitbehandlung\n        const localISOString = apiTimestamp.endsWith('Z')\n            ? apiTimestamp.substring(0, apiTimestamp.length - 1)\n            : apiTimestamp;\n        \n        const date = new Date(localISOString);\n        \n        // Validierung: Prfe ob das Datum gltig ist\n        if (isNaN(date.getTime())) {\n            throw new Error(`Ungltiger Zeitstempel: ${apiTimestamp}`);\n        }\n        \n        // Formatiere fr datetime-local Input: \"YYYY-MM-DDTHH:mm\"\n        const formattedDate = format(date, 'yyyy-MM-dd');\n        const formattedTime = format(date, 'HH:mm');\n        \n        return `${formattedDate}T${formattedTime}`;\n    } catch (error) {\n        console.error('Fehler bei der API-zu-Datetime-Local Konvertierung:', error);\n        throw new Error(`Konvertierung von API-Timestamp fehlgeschlagen: ${apiTimestamp}`);\n    }\n};\n\n/**\n * Formatiert die Gesamtdauer einer Liste von Beratungen in Stunden und Minuten.\n * Bercksichtigt nur abgeschlossene Beratungen (mit endTime).\n * \n * @param consultations Array von Consultation-Objekten\n * @returns Formatierte Gesamtdauer als \"Xh Ym\" oder \"0h 0m\" bei leerer Liste\n * \n * @example\n * // Bei Beratungen mit Gesamtdauer von 125 Minuten\n * formatTotalDuration(consultations) // \"2h 5m\"\n */\nexport const formatTotalDuration = (consultations: Array<{ startTime: string; endTime: string | null }>): string => {\n    try {\n        // Berechne die Gesamtdauer in Minuten\n        const totalMinutes = consultations.reduce((total, consultation) => {\n            // Nur abgeschlossene Beratungen bercksichtigen\n            if (!consultation.endTime) return total;\n            \n            // Berechne Dauer dieser Beratung in Minuten\n            const startTime = consultation.startTime.endsWith('Z') \n                ? consultation.startTime.substring(0, consultation.startTime.length - 1)\n                : consultation.startTime;\n            \n            const endTime = consultation.endTime.endsWith('Z') \n                ? consultation.endTime.substring(0, consultation.endTime.length - 1)\n                : consultation.endTime;\n            \n            const start = new Date(startTime);\n            const end = new Date(endTime);\n            \n            const durationMs = end.getTime() - start.getTime();\n            const durationMinutes = Math.floor(durationMs / (1000 * 60));\n            \n            return total + durationMinutes;\n        }, 0);\n        \n        // Konvertiere zu Stunden und Minuten\n        const hours = Math.floor(totalMinutes / 60);\n        const minutes = totalMinutes % 60;\n        \n        return `${hours}h ${minutes}m`;\n    } catch (error) {\n        console.error('Fehler bei der Formatierung der Gesamtdauer:', error);\n        return '0h 0m';\n    }\n};\n\n/**\n * Prft, ob eine Beratung bereits abgerechnet wurde.\n * \n * @param consultation Consultation-Objekt\n * @returns true wenn abgerechnet, false wenn nicht\n */\nexport const isConsultationInvoiced = (consultation: { invoiceItems?: Array<{ invoice: { status: string } }> }): boolean => {\n    return !!(consultation.invoiceItems && consultation.invoiceItems.length > 0);\n};\n\n/**\n * Holt die Rechnungsinformationen einer Beratung.\n * \n * @param consultation Consultation-Objekt\n * @returns Rechnungsinfo oder null wenn nicht abgerechnet\n */\nexport const getConsultationInvoiceInfo = (consultation: { invoiceItems?: Array<{ invoice: { id: number; invoiceNumber: string; status: string; issueDate: string; total: number } }> }) => {\n    if (!consultation.invoiceItems || consultation.invoiceItems.length === 0) {\n        return null;\n    }\n    \n    // Nimm die erste (und normalerweise einzige) Rechnung\n    const firstItem = consultation.invoiceItems[0];\n    return firstItem.invoice;\n};\n\n/**\n * Erstellt einen benutzerfreundlichen Text fr den Rechnungsstatus.\n * \n * @param status Rechnungsstatus\n * @returns Deutscher Status-Text\n */\nexport const getInvoiceStatusText = (status: 'DRAFT' | 'SENT' | 'PAID' | 'OVERDUE' | 'CANCELLED'): string => {\n    const statusMap = {\n        'DRAFT': 'Entwurf',\n        'SENT': 'Gesendet',\n        'PAID': 'Bezahlt',\n        'OVERDUE': 'berfllig',\n        'CANCELLED': 'Storniert'\n    };\n    return statusMap[status] || status;\n};\n\n/**\n * Gibt die Farbe fr einen Rechnungsstatus zurck.\n * \n * @param status Rechnungsstatus\n * @returns CSS-Klassen fr die Statusfarbe\n */\nexport const getInvoiceStatusColor = (status: 'DRAFT' | 'SENT' | 'PAID' | 'OVERDUE' | 'CANCELLED'): string => {\n    const colorMap = {\n        'DRAFT': 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300',\n        'SENT': 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300',\n        'PAID': 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300',\n        'OVERDUE': 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300',\n        'CANCELLED': 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300'\n    };\n    return colorMap[status] || 'bg-gray-100 text-gray-800';\n}; ","import * as React from \"react\";\nfunction StopIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M5.25 7.5A2.25 2.25 0 0 1 7.5 5.25h9a2.25 2.25 0 0 1 2.25 2.25v9a2.25 2.25 0 0 1-2.25 2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-9Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(StopIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction ChevronDownIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"m19.5 8.25-7.5 7.5-7.5-7.5\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(ChevronDownIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction DocumentTextIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(DocumentTextIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction ChartBarIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(ChartBarIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction CheckCircleIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(CheckCircleIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction ClockIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(ClockIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction MagnifyingGlassIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(MagnifyingGlassIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction FunnelIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 0 1-.659 1.591l-5.432 5.432a2.25 2.25 0 0 0-.659 1.591v2.927a2.25 2.25 0 0 1-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 0 0-.659-1.591L3.659 7.409A2.25 2.25 0 0 1 3 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0 1 12 3Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(FunnelIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction DocumentArrowDownIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(DocumentArrowDownIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction EyeIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(EyeIcon);\nexport default ForwardRef;","import * as React from \"react\";\nfunction LinkIcon({\n  title,\n  titleId,\n  ...props\n}, svgRef) {\n  return /*#__PURE__*/React.createElement(\"svg\", Object.assign({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fill: \"none\",\n    viewBox: \"0 0 24 24\",\n    strokeWidth: 1.5,\n    stroke: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, /*#__PURE__*/React.createElement(\"path\", {\n    strokeLinecap: \"round\",\n    strokeLinejoin: \"round\",\n    d: \"M13.19 8.688a4.5 4.5 0 0 1 1.242 7.244l-4.5 4.5a4.5 4.5 0 0 1-6.364-6.364l1.757-1.757m13.35-.622 1.757-1.757a4.5 4.5 0 0 0-6.364-6.364l-4.5 4.5a4.5 4.5 0 0 0 1.242 7.244\"\n  }));\n}\nconst ForwardRef = /*#__PURE__*/ React.forwardRef(LinkIcon);\nexport default ForwardRef;"],"names":["PlayIcon","_ref","svgRef","title","titleId","props","_objectWithoutProperties","_excluded","React","Object","assign","xmlns","fill","viewBox","strokeWidth","stroke","ref","id","strokeLinecap","strokeLinejoin","d","deleteClient","async","axiosInstance","delete","API_ENDPOINTS","CLIENTS","BY_ID","clientId","data","error","console","getRecentClients","get","RECENT","isOpen","onClose","onClientUpdated","onClientDeleted","client","t","useTranslation","openSidepane","closeSidepane","useSidepane","isLargeScreen","setIsLargeScreen","useState","window","innerWidth","formData","setFormData","name","company","email","phone","address","notes","isActive","errors","setErrors","loading","setLoading","confirmDelete","setConfirmDelete","isMobile","setIsMobile","useEffect","undefined","checkScreenSize","addEventListener","removeEventListener","handleSubmit","e","preventDefault","validateForm","newErrors","trim","test","keys","length","updated","put","clientApi","toast","success","_error$response","_error$response$data","response","message","handleDelete","_error$response2","_error$response2$data","_error$response3","_error$response3$data","_error$response4","_error$response4$data","_error$response5","errorMessage","errorDetails","details","errorSuggestion","suggestion","status","entries","filter","_ref2","_","count","map","_ref3","key","concat","join","handleChange","value","type","target","checked","prev","_objectSpread","handleClose","_jsxs","Dialog","open","className","children","_jsx","Panel","Title","onClick","XMarkIcon","onSubmit","htmlFor","onChange","rows","disabled","TrashIcon","ArrowPathIcon","CheckIcon","_Fragment","style","opacity","transition","pointerEvents","role","values","idx","onSelect","onCreateNew","clients","setClients","filteredClients","setFilteredClients","searchTerm","setSearchTerm","editingClient","setEditingClient","isEditModalOpen","setIsEditModalOpen","loadClients","filtered","toLowerCase","includes","BASE","MagnifyingGlassIcon","placeholder","autoFocus","PlusIcon","handleEdit","stopPropagation","PencilIcon","confirm","EditClientModal","updatedClient","index","findIndex","c","newClients","onSave","post","startConsultation","CONSULTATIONS","START","stopConsultation","STOP","updateConsultationNotes","consultationId","patch","UPDATE_NOTES","isPlaceholder","_activeConsultation$c","_activeConsultation$c2","onConsultationChange","onConsultationStarted","user","useAuth","selectedBranch","useBranch","activeConsultation","setActiveConsultation","isStarting","setIsStarting","isClientSelectModalOpen","setIsClientSelectModalOpen","isCreateClientModalOpen","setIsCreateClientModalOpen","selectedClient","setSelectedClient","recentClients","setRecentClients","setNotes","lastStartedClientId","setLastStartedClientId","containerRef","useRef","visibleTagCount","setVisibleTagCount","containerWidth","setContainerWidth","resizeTimeoutRef","isManualEntry","setIsManualEntry","manualStartTime","setManualStartTime","manualEndTime","setManualEndTime","checkActiveConsultation","loadRecentClients","WORKTIME","ACTIVE","log","handleStartConsultation","_consultation$client","correctedStartTime","Date","getTime","getTimezoneOffset","consultation","consultationApi","branchId","startTime","toISOString","dispatchEvent","CustomEvent","updateNotes","timeout","setTimeout","clearTimeout","handleFocus","averageTagWidth","useMemo","reduce","sum","calculateVisibleTags","useCallback","current","currentWidth","clientWidth","Math","abs","availableWidth","maxPossibleTags","max","floor","min","handleResize","resizeObserver","ResizeObserver","observe","disconnect","useLayoutEffect","showOptimisticTags","optimisticTags","Array","i","lastConsultationDate","displayTags","currentVisibleCount","sortedDisplayTags","lastStartedClient","find","UserGroupIcon","ClockIcon","calculateDuration","formatTime","onBlur","correctedEndTime","stoppedConsultation","endTime","StopIcon","some","width","height","slice","isPlanned","Number","clientName","date","toLocaleDateString","day","month","hour","minute","fillRule","clipRule","manualStart","manualEnd","ClientSelectModal","handleCreateClient","CreateClientModal","onTaskLinked","tasks","setTasks","filteredTasks","setFilteredTasks","selectedTaskId","setSelectedTaskId","loadTasks","task","activeTasks","TASKS","responsible","firstName","lastName","LINK_TASK","taskId","invoiceId","invoiceNumber","totalAmount","downloadingPdf","setDownloadingPdf","CheckCircleIcon","CONSULTATION_INVOICES","GENERATE_PDF","responseType","headers","blob","Blob","url","URL","createObjectURL","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","DocumentArrowDownIcon","handleViewInvoiceManagement","info","EyeIcon","consultations","onInvoiceCreated","hasPermission","usePermissions","settings","setSettings","createdInvoice","setCreatedInvoice","showSuccessModal","setShowSuccessModal","issueDate","format","dueDate","now","hourlyRate","vatRate","canCreateInvoices","loadInvoiceSettings","settingsData","INVOICE_SETTINGS","defaultHourlyRate","defaultVatRate","totalHours","duration","parseFloat","replace","estimatedTotal","vatAmount","totalWithVat","uniqueClientIds","Set","_consultations$","_consultations$$clien","invoice","CREATE_FROM_CONSULTATIONS","consultationIds","total","toFixed","step","DocumentTextIcon","InvoiceSuccessModal","handleCloseAll","CONSULTATIONS_TABLE_ID","forwardRef","navigate","useNavigate","setConsultations","setError","isFilterPanelOpen","setIsFilterPanelOpen","filterConditions","setFilterConditions","filterLogicalOperators","setFilterLogicalOperators","editingNotesId","setEditingNotesId","editingNotes","setEditingNotes","editingTimeId","setEditingTimeId","editingTimeType","setEditingTimeType","editingTimeValue","setEditingTimeValue","linkTaskModalOpen","setLinkTaskModalOpen","selectedConsultationId","setSelectedConsultationId","activeFilterName","setActiveFilterName","selectedFilterId","setSelectedFilterId","showCreateInvoiceModal","setShowCreateInvoiceModal","loadConsultations","from","to","params","URLSearchParams","append","toString","useImperativeHandle","refresh","addConsultation","updateConsultation","removeConsultation","activateClientFilter","createAndActivateClientFilter","SAVED_FILTERS","BY_TABLE","heuteFilter","applyFilterConditions","conditions","operators","setInitialFilter","clientFilter","newFilter","tableId","column","operator","refreshSavedFilters","localStorage","getItem","existingFilters","alleFilter","dieseWocheFilter","archivFilterExists","heuteFilterExists","wocheFilterExists","nichtAbgerechnetFilterExists","today","split","archivFilter","wocheFilter","nichtAbgerechnetFilter","createStandardFilters","timeoutId","condition","firstCondition","secondCondition","updateExistingFilters","existingClientFilters","currentRecentClientNames","existingFilter","clientFilterName","updateClientFilters","resetFilterConditions","getActiveFilterCount","handleNotesSave","handleNotesCancel","handleTimeEdit","timeType","currentTime","dbTime","year","getUTCFullYear","String","getUTCMonth","padStart","getUTCDate","hours","getUTCHours","minutes","getUTCMinutes","inputValue","handleTimeSave","timeString","handleTimeCancel","handleDeleteConsultation","applyFiltersAndSearch","search","_consultation$client$","_consultation$notes","_consultation$branch","_consultation$branch$","branch","_consultation$client2","_consultation$client3","_consultation$branch2","_consultation$branch3","_consultation$notes2","result","conditionResult","consultationDate","filterDate","localToday","correctedToday","weekFromToday","setDate","getDate","calculateDurationInMinutes","filterValue","isInvoiced","isConsultationInvoiced","isInMonthlyReport","isConsultationInMonthlyReport","filterValueLower","invoiceInfo","getConsultationInvoiceInfo","getInvoiceStatusText","monthlyReportInfo","getConsultationMonthlyReportInfo","start","filteredConsultations","sort","a","b","totalDuration","formatTotalDuration","timelineMarkers","markers","forEach","currentDate","currentDay","locale","de","currentHour","prevDate","push","label","position","prevHour","generateTimelineMarkers","monthlyReportId","monthlyReport","navigateToMonthlyReports","reportId","navigateToInvoices","navigateToTask","FunnelIcon","canCreateInvoice","every","handleCreateInvoice","FilterPane","columns","onApply","onReset","savedConditions","savedOperators","SavedFilterTags","onSelectFilter","onFilterChange","handleFilterChange","_consultation$client4","_consultation$client5","dayMarker","m","middayMarker","billingStatus","getConsultationBillingStatus","_billingStatus$info","_billingStatus$info2","getInvoiceStatusColor","ChartBarIcon","_billingStatus$info3","_billingStatus$info4","reportNumber","taskLinks","taskLink","LinkIcon","handleLinkTask","handleNotesEdit","LinkTaskModal","CreateInvoiceModal","Consultations","consultationListRef","handleConsultationChange","_consultationListRef$","_consultationListRef$2","_consultationListRef$3","_consultationListRef$4","_consultationListRef$5","call","handleConsultationStarted","_consultationListRef$6","_consultationListRef$7","_consultationListRef$8","ConsultationTracker","ConsultationList","formatDate","dateString","dateParts","parseInt","parseISO","startISOString","endsWith","substring","endISOString","durationMs","durationMinutes","convertWeekToDate","weekString","week","dayOfWeek","UTC","getUTCDay","daysToThursday","firstThursday","targetThursday","monday","formattedDate","warn","correctedMonday","startOfWeek","weekStartsOn","fallbackMonday","isWorktimeRelevantForSelectedDate","worktime","selectedDate","getWeekDays","weekStartDate","weekStart","weekDays","addDays","dayInfo","formatDateTimeForCerebro","dateTimeString","convertQuinzenaToDate","quinzenaString","quinzena","Error","parts","datePart","ceil","startDay","quinzenaStart","fallback","getQuinzenaDays","quinzenaStartDate","getFullYear","getMonth","daysCount","quinzenaDays","getCurrentQuinzena","dateObj","getQuinzenaFromDate","createLocalDate","totalMinutes","invoiceItems","ChevronDownIcon"],"sourceRoot":""}